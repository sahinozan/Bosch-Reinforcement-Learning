{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -133.0, "episode_reward_mean": -29.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-133.0, 21.0, -23.0, -12.0, -23.0, -23.0, -67.0, -1.0, -1.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178838782492198, "mean_inference_ms": 10.75234801634539, "mean_action_processing_ms": 0.10169946567770997, "mean_env_wait_ms": 0.05350257031394366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006320476531982422, "StateBufferConnector_ms": 0.0035071372985839844, "ViewRequirementAgentConnector_ms": 0.10508298873901367}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 7.770718574523926, "policy_loss": -0.01988776959478855, "vf_loss": 7.78753137588501, "vf_explained_var": 0.0003099573659710586, "kl": 0.015374438837170601, "entropy": 2.9806344509124756, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": -89.0, "episode_reward_mean": 6.923076923076923, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -1.0, 10.0, -23.0, -12.0, 32.0, 54.0, 54.0, 43.0, 21.0, -23.0, -23.0, 21.0, 21.0, 43.0, 43.0, -1.0, -1.0, 32.0, -7.0, 10.0, -1.0, 54.0, -1.0, -89.0, 10.0, -34.0, 10.0, -12.0, -34.0, 10.0, 32.0, 10.0, -34.0, -67.0, -45.0, -34.0, -23.0, 10.0, 32.0, 65.0, 54.0, 32.0, 32.0, 65.0, 10.0, -1.0, 10.0, -12.0, -1.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2010568205459927, "mean_inference_ms": 10.116086605637408, "mean_action_processing_ms": 0.08550360035342118, "mean_env_wait_ms": 0.04509901052950264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004969651882465069, "StateBufferConnector_ms": 0.002947678932776818, "ViewRequirementAgentConnector_ms": 0.0909433915064885}}, "episode_reward_max": 65.0, "episode_reward_min": -89.0, "episode_reward_mean": 6.923076923076923, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -1.0, 10.0, -23.0, -12.0, 32.0, 54.0, 54.0, 43.0, 21.0, -23.0, -23.0, 21.0, 21.0, 43.0, 43.0, -1.0, -1.0, 32.0, -7.0, 10.0, -1.0, 54.0, -1.0, -89.0, 10.0, -34.0, 10.0, -12.0, -34.0, 10.0, 32.0, 10.0, -34.0, -67.0, -45.0, -34.0, -23.0, 10.0, 32.0, 65.0, 54.0, 32.0, 32.0, 65.0, 10.0, -1.0, 10.0, -12.0, -1.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2010568205459927, "mean_inference_ms": 10.116086605637408, "mean_action_processing_ms": 0.08550360035342118, "mean_env_wait_ms": 0.04509901052950264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004969651882465069, "StateBufferConnector_ms": 0.002947678932776818, "ViewRequirementAgentConnector_ms": 0.0909433915064885}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 77528.435, "sample_time_ms": 41845.666, "learn_time_ms": 35675.089, "learn_throughput": 112.123, "synch_weights_time_ms": 6.884}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 52, "training_iteration": 1, "trial_id": "38794_00003", "date": "2023-06-01_22-44-41", "timestamp": 1685648681, "time_this_iter_s": 86.05320191383362, "time_total_s": 86.05320191383362, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 86.05320191383362, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.34297520661156, "ram_util_percent": 69.35123966942147}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -23.0, "episode_reward_mean": 27.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 10.0, 21.0, 32.0, 65.0, 43.0, 32.0, 32.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20643459347656573, "mean_inference_ms": 10.648210451526127, "mean_action_processing_ms": 0.09582843692736906, "mean_env_wait_ms": 0.04962507946408163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005571842193603516, "StateBufferConnector_ms": 0.0032520294189453125, "ViewRequirementAgentConnector_ms": 0.09363889694213867}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 7.155508518218994, "policy_loss": -0.027668867260217667, "vf_loss": 7.180569648742676, "vf_explained_var": 0.005141000729054213, "kl": 0.013038023374974728, "entropy": 2.979929208755493, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 14.78, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 54.0, 43.0, 21.0, -23.0, -23.0, 21.0, 21.0, 43.0, 43.0, -1.0, -1.0, 32.0, -7.0, 10.0, -1.0, 54.0, -1.0, -89.0, 10.0, -34.0, 10.0, -12.0, -34.0, 10.0, 32.0, 10.0, -34.0, -67.0, -45.0, -34.0, -23.0, 10.0, 32.0, 65.0, 54.0, 32.0, 32.0, 65.0, 10.0, -1.0, 10.0, -12.0, -1.0, 32.0, 54.0, -1.0, 21.0, 21.0, -67.0, -1.0, 21.0, 21.0, 32.0, 21.0, 32.0, 32.0, 43.0, 10.0, 65.0, -1.0, 32.0, 21.0, 10.0, 54.0, 10.0, 21.0, -1.0, -12.0, -12.0, -23.0, -23.0, 10.0, -23.0, -23.0, 10.0, -34.0, 76.0, 54.0, 43.0, 43.0, 32.0, 54.0, 32.0, -12.0, 10.0, 54.0, 54.0, 43.0, 76.0, -34.0, 21.0, 21.0, 32.0, 21.0, 10.0, 76.0, 21.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20521602671407962, "mean_inference_ms": 10.16202719854388, "mean_action_processing_ms": 0.08750393678796932, "mean_env_wait_ms": 0.04595028536984175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118370056152344, "StateBufferConnector_ms": 0.003152608871459961, "ViewRequirementAgentConnector_ms": 0.09518885612487793}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 14.78, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 54.0, 43.0, 21.0, -23.0, -23.0, 21.0, 21.0, 43.0, 43.0, -1.0, -1.0, 32.0, -7.0, 10.0, -1.0, 54.0, -1.0, -89.0, 10.0, -34.0, 10.0, -12.0, -34.0, 10.0, 32.0, 10.0, -34.0, -67.0, -45.0, -34.0, -23.0, 10.0, 32.0, 65.0, 54.0, 32.0, 32.0, 65.0, 10.0, -1.0, 10.0, -12.0, -1.0, 32.0, 54.0, -1.0, 21.0, 21.0, -67.0, -1.0, 21.0, 21.0, 32.0, 21.0, 32.0, 32.0, 43.0, 10.0, 65.0, -1.0, 32.0, 21.0, 10.0, 54.0, 10.0, 21.0, -1.0, -12.0, -12.0, -23.0, -23.0, 10.0, -23.0, -23.0, 10.0, -34.0, 76.0, 54.0, 43.0, 43.0, 32.0, 54.0, 32.0, -12.0, 10.0, 54.0, 54.0, 43.0, 76.0, -34.0, 21.0, 21.0, 32.0, 21.0, 10.0, 76.0, 21.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20521602671407962, "mean_inference_ms": 10.16202719854388, "mean_action_processing_ms": 0.08750393678796932, "mean_env_wait_ms": 0.04595028536984175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118370056152344, "StateBufferConnector_ms": 0.003152608871459961, "ViewRequirementAgentConnector_ms": 0.09518885612487793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 78831.065, "sample_time_ms": 42240.151, "learn_time_ms": 36582.823, "learn_throughput": 109.341, "synch_weights_time_ms": 7.365}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 105, "training_iteration": 2, "trial_id": "38794_00003", "date": "2023-06-01_22-46-10", "timestamp": 1685648770, "time_this_iter_s": 88.44722986221313, "time_total_s": 174.50043177604675, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 174.50043177604675, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.87786885245902, "ram_util_percent": 70.27868852459015}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -56.0, 65.0, 21.0, -1.0, 65.0, 76.0, 21.0, -1.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20157407637700234, "mean_inference_ms": 10.316148446035823, "mean_action_processing_ms": 0.09281109530170042, "mean_env_wait_ms": 0.047485329821568625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005965232849121094, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.09066581726074219}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 7.119748592376709, "policy_loss": -0.027186395600438118, "vf_loss": 7.144042015075684, "vf_explained_var": 0.011512693017721176, "kl": 0.01446484588086605, "entropy": 2.9629852771759033, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 14.07, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 21.0, 32.0, 21.0, 32.0, 32.0, 43.0, 10.0, 65.0, -1.0, 32.0, 21.0, 10.0, 54.0, 10.0, 21.0, -1.0, -12.0, -12.0, -23.0, -23.0, 10.0, -23.0, -23.0, 10.0, -34.0, 76.0, 54.0, 43.0, 43.0, 32.0, 54.0, 32.0, -12.0, 10.0, 54.0, 54.0, 43.0, 76.0, -34.0, 21.0, 21.0, 32.0, 21.0, 10.0, 76.0, 21.0, 32.0, 32.0, 65.0, -23.0, 65.0, 10.0, 32.0, -23.0, 21.0, 32.0, -12.0, -78.0, -34.0, -1.0, -45.0, 21.0, 32.0, 21.0, 32.0, 10.0, 21.0, 21.0, 43.0, 32.0, -12.0, 21.0, -1.0, 21.0, 10.0, 32.0, -1.0, 21.0, 10.0, 32.0, 32.0, 10.0, 10.0, 32.0, 21.0, -67.0, 21.0, -1.0, 65.0, 10.0, 10.0, -45.0, -67.0, -34.0, -12.0, 10.0, 10.0, -56.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21001192522264006, "mean_inference_ms": 10.287360661834715, "mean_action_processing_ms": 0.08972964717121319, "mean_env_wait_ms": 0.04682196616047456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00539708137512207, "StateBufferConnector_ms": 0.003309965133666992, "ViewRequirementAgentConnector_ms": 0.10005450248718262}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 14.07, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 21.0, 32.0, 21.0, 32.0, 32.0, 43.0, 10.0, 65.0, -1.0, 32.0, 21.0, 10.0, 54.0, 10.0, 21.0, -1.0, -12.0, -12.0, -23.0, -23.0, 10.0, -23.0, -23.0, 10.0, -34.0, 76.0, 54.0, 43.0, 43.0, 32.0, 54.0, 32.0, -12.0, 10.0, 54.0, 54.0, 43.0, 76.0, -34.0, 21.0, 21.0, 32.0, 21.0, 10.0, 76.0, 21.0, 32.0, 32.0, 65.0, -23.0, 65.0, 10.0, 32.0, -23.0, 21.0, 32.0, -12.0, -78.0, -34.0, -1.0, -45.0, 21.0, 32.0, 21.0, 32.0, 10.0, 21.0, 21.0, 43.0, 32.0, -12.0, 21.0, -1.0, 21.0, 10.0, 32.0, -1.0, 21.0, 10.0, 32.0, 32.0, 10.0, 10.0, 32.0, 21.0, -67.0, 21.0, -1.0, 65.0, 10.0, 10.0, -45.0, -67.0, -34.0, -12.0, 10.0, 10.0, -56.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21001192522264006, "mean_inference_ms": 10.287360661834715, "mean_action_processing_ms": 0.08972964717121319, "mean_env_wait_ms": 0.04682196616047456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00539708137512207, "StateBufferConnector_ms": 0.003309965133666992, "ViewRequirementAgentConnector_ms": 0.10005450248718262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 78884.228, "sample_time_ms": 42902.173, "learn_time_ms": 35974.239, "learn_throughput": 111.191, "synch_weights_time_ms": 7.133}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 157, "training_iteration": 3, "trial_id": "38794_00003", "date": "2023-06-01_22-47-37", "timestamp": 1685648857, "time_this_iter_s": 86.6196801662445, "time_total_s": 261.12011194229126, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 261.12011194229126, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.05289256198348, "ram_util_percent": 71.14793388429752}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 10.0, "episode_reward_mean": 39.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 21.0, 65.0, 76.0, 43.0, 43.0, 21.0, 32.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003101799214447, "mean_inference_ms": 10.311537140178586, "mean_action_processing_ms": 0.09154975512277842, "mean_env_wait_ms": 0.046644191999099874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005307197570800781, "StateBufferConnector_ms": 0.0030946731567382812, "ViewRequirementAgentConnector_ms": 0.09473323822021484}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 6.866079807281494, "policy_loss": -0.02963285893201828, "vf_loss": 6.8927998542785645, "vf_explained_var": 0.02203288860619068, "kl": 0.014561641961336136, "entropy": 2.952911376953125, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 7.96, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -23.0, 21.0, 32.0, -12.0, -78.0, -34.0, -1.0, -45.0, 21.0, 32.0, 21.0, 32.0, 10.0, 21.0, 21.0, 43.0, 32.0, -12.0, 21.0, -1.0, 21.0, 10.0, 32.0, -1.0, 21.0, 10.0, 32.0, 32.0, 10.0, 10.0, 32.0, 21.0, -67.0, 21.0, -1.0, 65.0, 10.0, 10.0, -45.0, -67.0, -34.0, -12.0, 10.0, 10.0, -56.0, -1.0, -23.0, 21.0, -34.0, 21.0, -12.0, -45.0, -23.0, 32.0, -12.0, 10.0, 32.0, 21.0, -23.0, -34.0, 65.0, 54.0, -1.0, 32.0, -23.0, -23.0, -1.0, 43.0, 54.0, 10.0, -34.0, -23.0, 76.0, 54.0, 43.0, 43.0, -34.0, 43.0, -23.0, 21.0, 10.0, 10.0, 32.0, 76.0, -12.0, -78.0, -23.0, -1.0, -34.0, -1.0, 10.0, 43.0, 4.0, 43.0, 54.0, 43.0, 21.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2111492366643791, "mean_inference_ms": 10.29464401054989, "mean_action_processing_ms": 0.09010032304761531, "mean_env_wait_ms": 0.04684116442024923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005297660827636719, "StateBufferConnector_ms": 0.003299236297607422, "ViewRequirementAgentConnector_ms": 0.09864544868469238}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 7.96, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -23.0, 21.0, 32.0, -12.0, -78.0, -34.0, -1.0, -45.0, 21.0, 32.0, 21.0, 32.0, 10.0, 21.0, 21.0, 43.0, 32.0, -12.0, 21.0, -1.0, 21.0, 10.0, 32.0, -1.0, 21.0, 10.0, 32.0, 32.0, 10.0, 10.0, 32.0, 21.0, -67.0, 21.0, -1.0, 65.0, 10.0, 10.0, -45.0, -67.0, -34.0, -12.0, 10.0, 10.0, -56.0, -1.0, -23.0, 21.0, -34.0, 21.0, -12.0, -45.0, -23.0, 32.0, -12.0, 10.0, 32.0, 21.0, -23.0, -34.0, 65.0, 54.0, -1.0, 32.0, -23.0, -23.0, -1.0, 43.0, 54.0, 10.0, -34.0, -23.0, 76.0, 54.0, 43.0, 43.0, -34.0, 43.0, -23.0, 21.0, 10.0, 10.0, 32.0, 76.0, -12.0, -78.0, -23.0, -1.0, -34.0, -1.0, 10.0, 43.0, 4.0, 43.0, 54.0, 43.0, 21.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2111492366643791, "mean_inference_ms": 10.29464401054989, "mean_action_processing_ms": 0.09010032304761531, "mean_env_wait_ms": 0.04684116442024923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005297660827636719, "StateBufferConnector_ms": 0.003299236297607422, "ViewRequirementAgentConnector_ms": 0.09864544868469238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 77805.36, "sample_time_ms": 42366.47, "learn_time_ms": 35431.331, "learn_throughput": 112.894, "synch_weights_time_ms": 6.891}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 210, "training_iteration": 4, "trial_id": "38794_00003", "date": "2023-06-01_22-48-59", "timestamp": 1685648939, "time_this_iter_s": 82.6941339969635, "time_total_s": 343.81424593925476, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 343.81424593925476, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 47.55000000000001, "ram_util_percent": 71.51293103448278}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -62.0, "episode_reward_mean": 19.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 32.0, 10.0, 32.0, 32.0, 10.0, -12.0, 21.0, -62.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19924165825566567, "mean_inference_ms": 10.217658095346001, "mean_action_processing_ms": 0.09097396872665217, "mean_env_wait_ms": 0.04608152540568709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004785060882568359, "StateBufferConnector_ms": 0.0030112266540527344, "ViewRequirementAgentConnector_ms": 0.09579181671142578}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 6.626791954040527, "policy_loss": -0.027995022013783455, "vf_loss": 6.651904582977295, "vf_explained_var": 0.02482917346060276, "kl": 0.01440952904522419, "entropy": 2.952526569366455, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 12.74, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 32.0, -12.0, 10.0, 32.0, 21.0, -23.0, -34.0, 65.0, 54.0, -1.0, 32.0, -23.0, -23.0, -1.0, 43.0, 54.0, 10.0, -34.0, -23.0, 76.0, 54.0, 43.0, 43.0, -34.0, 43.0, -23.0, 21.0, 10.0, 10.0, 32.0, 76.0, -12.0, -78.0, -23.0, -1.0, -34.0, -1.0, 10.0, 43.0, 4.0, 43.0, 54.0, 43.0, 21.0, 43.0, 43.0, 10.0, -34.0, -12.0, 32.0, 54.0, 65.0, 21.0, 37.0, 76.0, 21.0, 43.0, 65.0, 43.0, 54.0, 54.0, 65.0, 65.0, 65.0, 65.0, 54.0, -12.0, -45.0, 32.0, 21.0, 10.0, -12.0, -45.0, 43.0, 10.0, -100.0, -23.0, 10.0, -89.0, -23.0, -23.0, -89.0, -56.0, -1.0, -1.0, -23.0, -12.0, -45.0, -23.0, -34.0, -12.0, 54.0, 32.0, 65.0, 43.0, 43.0, 10.0, -1.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2102926206022183, "mean_inference_ms": 10.18543928746147, "mean_action_processing_ms": 0.08942841754674948, "mean_env_wait_ms": 0.046396083976916094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004996538162231445, "StateBufferConnector_ms": 0.0031664371490478516, "ViewRequirementAgentConnector_ms": 0.09464073181152344}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 12.74, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 32.0, -12.0, 10.0, 32.0, 21.0, -23.0, -34.0, 65.0, 54.0, -1.0, 32.0, -23.0, -23.0, -1.0, 43.0, 54.0, 10.0, -34.0, -23.0, 76.0, 54.0, 43.0, 43.0, -34.0, 43.0, -23.0, 21.0, 10.0, 10.0, 32.0, 76.0, -12.0, -78.0, -23.0, -1.0, -34.0, -1.0, 10.0, 43.0, 4.0, 43.0, 54.0, 43.0, 21.0, 43.0, 43.0, 10.0, -34.0, -12.0, 32.0, 54.0, 65.0, 21.0, 37.0, 76.0, 21.0, 43.0, 65.0, 43.0, 54.0, 54.0, 65.0, 65.0, 65.0, 65.0, 54.0, -12.0, -45.0, 32.0, 21.0, 10.0, -12.0, -45.0, 43.0, 10.0, -100.0, -23.0, 10.0, -89.0, -23.0, -23.0, -89.0, -56.0, -1.0, -1.0, -23.0, -12.0, -45.0, -23.0, -34.0, -12.0, 54.0, 32.0, 65.0, 43.0, 43.0, 10.0, -1.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2102926206022183, "mean_inference_ms": 10.18543928746147, "mean_action_processing_ms": 0.08942841754674948, "mean_env_wait_ms": 0.046396083976916094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004996538162231445, "StateBufferConnector_ms": 0.0031664371490478516, "ViewRequirementAgentConnector_ms": 0.09464073181152344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 77321.752, "sample_time_ms": 42000.137, "learn_time_ms": 35314.266, "learn_throughput": 113.269, "synch_weights_time_ms": 6.729}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 263, "training_iteration": 5, "trial_id": "38794_00003", "date": "2023-06-01_22-50-22", "timestamp": 1685649022, "time_this_iter_s": 83.16375708580017, "time_total_s": 426.97800302505493, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 426.97800302505493, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.3698275862069, "ram_util_percent": 71.66724137931034}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -89.0, "episode_reward_mean": 4.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -89.0, 21.0, -12.0, 32.0, -45.0, 43.0, 32.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19745616582474462, "mean_inference_ms": 10.09665092755974, "mean_action_processing_ms": 0.09006435634326161, "mean_env_wait_ms": 0.045440824793452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004901885986328125, "StateBufferConnector_ms": 0.0030517578125, "ViewRequirementAgentConnector_ms": 0.08960485458374023}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 7.351819038391113, "policy_loss": -0.032610002905130386, "vf_loss": 7.380279541015625, "vf_explained_var": 0.06958115100860596, "kl": 0.02074906788766384, "entropy": 2.925812244415283, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 0.81, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 21.0, 37.0, 76.0, 21.0, 43.0, 65.0, 43.0, 54.0, 54.0, 65.0, 65.0, 65.0, 65.0, 54.0, -12.0, -45.0, 32.0, 21.0, 10.0, -12.0, -45.0, 43.0, 10.0, -100.0, -23.0, 10.0, -89.0, -23.0, -23.0, -89.0, -56.0, -1.0, -1.0, -23.0, -12.0, -45.0, -23.0, -34.0, -12.0, 54.0, 32.0, 65.0, 43.0, 43.0, 10.0, -1.0, 65.0, -12.0, -34.0, 21.0, 21.0, 10.0, -1.0, 32.0, -1.0, 76.0, 54.0, 65.0, -1.0, 43.0, 32.0, 43.0, 32.0, 65.0, 21.0, 32.0, -12.0, 21.0, 32.0, -34.0, 54.0, -34.0, -12.0, 10.0, -100.0, -78.0, -45.0, -1.0, -45.0, -23.0, 43.0, -1.0, 32.0, -1.0, -67.0, -56.0, -45.0, 32.0, -45.0, -23.0, -122.0, -100.0, -45.0, -122.0, -23.0, 21.0, -67.0, -56.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20914405716980566, "mean_inference_ms": 10.103165284434924, "mean_action_processing_ms": 0.08879489842843524, "mean_env_wait_ms": 0.04600468909431345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004967689514160156, "StateBufferConnector_ms": 0.0030617713928222656, "ViewRequirementAgentConnector_ms": 0.09332060813903809}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 0.81, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 21.0, 37.0, 76.0, 21.0, 43.0, 65.0, 43.0, 54.0, 54.0, 65.0, 65.0, 65.0, 65.0, 54.0, -12.0, -45.0, 32.0, 21.0, 10.0, -12.0, -45.0, 43.0, 10.0, -100.0, -23.0, 10.0, -89.0, -23.0, -23.0, -89.0, -56.0, -1.0, -1.0, -23.0, -12.0, -45.0, -23.0, -34.0, -12.0, 54.0, 32.0, 65.0, 43.0, 43.0, 10.0, -1.0, 65.0, -12.0, -34.0, 21.0, 21.0, 10.0, -1.0, 32.0, -1.0, 76.0, 54.0, 65.0, -1.0, 43.0, 32.0, 43.0, 32.0, 65.0, 21.0, 32.0, -12.0, 21.0, 32.0, -34.0, 54.0, -34.0, -12.0, 10.0, -100.0, -78.0, -45.0, -1.0, -45.0, -23.0, 43.0, -1.0, 32.0, -1.0, -67.0, -56.0, -45.0, 32.0, -45.0, -23.0, -122.0, -100.0, -45.0, -122.0, -23.0, 21.0, -67.0, -56.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20914405716980566, "mean_inference_ms": 10.103165284434924, "mean_action_processing_ms": 0.08879489842843524, "mean_env_wait_ms": 0.04600468909431345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004967689514160156, "StateBufferConnector_ms": 0.0030617713928222656, "ViewRequirementAgentConnector_ms": 0.09332060813903809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 76772.496, "sample_time_ms": 41680.061, "learn_time_ms": 35084.953, "learn_throughput": 114.009, "synch_weights_time_ms": 6.705}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 315, "training_iteration": 6, "trial_id": "38794_00003", "date": "2023-06-01_22-51-44", "timestamp": 1685649104, "time_this_iter_s": 81.52617287635803, "time_total_s": 508.50417590141296, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 508.50417590141296, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 46.53716814159292, "ram_util_percent": 71.48141592920354}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -56.0, "episode_reward_mean": -1.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -12.0, 10.0, 10.0, -12.0, -23.0, -12.0, -56.0, 4.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19610028947078514, "mean_inference_ms": 10.060849258761234, "mean_action_processing_ms": 0.08925408533788494, "mean_env_wait_ms": 0.04497346876259474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005419254302978516, "StateBufferConnector_ms": 0.0029420852661132812, "ViewRequirementAgentConnector_ms": 0.09085655212402344}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.027753829956055, "policy_loss": -0.024453161284327507, "vf_loss": 7.048300266265869, "vf_explained_var": 0.01653401181101799, "kl": 0.013023040257394314, "entropy": 2.952171802520752, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": -1.88, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, -1.0, 76.0, 54.0, 65.0, -1.0, 43.0, 32.0, 43.0, 32.0, 65.0, 21.0, 32.0, -12.0, 21.0, 32.0, -34.0, 54.0, -34.0, -12.0, 10.0, -100.0, -78.0, -45.0, -1.0, -45.0, -23.0, 43.0, -1.0, 32.0, -1.0, -67.0, -56.0, -45.0, 32.0, -45.0, -23.0, -122.0, -100.0, -45.0, -122.0, -23.0, 21.0, -67.0, -56.0, -67.0, -144.0, -12.0, -34.0, -1.0, -12.0, 54.0, -12.0, 21.0, 43.0, -12.0, 10.0, 43.0, 32.0, 10.0, -45.0, 21.0, 32.0, -56.0, -45.0, -23.0, -34.0, 65.0, 65.0, 10.0, 43.0, -12.0, 54.0, -100.0, -67.0, -1.0, -12.0, 65.0, 32.0, -1.0, -23.0, -34.0, 32.0, 76.0, 10.0, 43.0, 32.0, 21.0, -23.0, 54.0, 10.0, 32.0, -34.0, -12.0, 65.0, 54.0, -1.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20863014346541342, "mean_inference_ms": 10.062340147251508, "mean_action_processing_ms": 0.08861041812293938, "mean_env_wait_ms": 0.04585707169158893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005119800567626953, "StateBufferConnector_ms": 0.0031194686889648438, "ViewRequirementAgentConnector_ms": 0.0934152603149414}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": -1.88, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, -1.0, 76.0, 54.0, 65.0, -1.0, 43.0, 32.0, 43.0, 32.0, 65.0, 21.0, 32.0, -12.0, 21.0, 32.0, -34.0, 54.0, -34.0, -12.0, 10.0, -100.0, -78.0, -45.0, -1.0, -45.0, -23.0, 43.0, -1.0, 32.0, -1.0, -67.0, -56.0, -45.0, 32.0, -45.0, -23.0, -122.0, -100.0, -45.0, -122.0, -23.0, 21.0, -67.0, -56.0, -67.0, -144.0, -12.0, -34.0, -1.0, -12.0, 54.0, -12.0, 21.0, 43.0, -12.0, 10.0, 43.0, 32.0, 10.0, -45.0, 21.0, 32.0, -56.0, -45.0, -23.0, -34.0, 65.0, 65.0, 10.0, 43.0, -12.0, 54.0, -100.0, -67.0, -1.0, -12.0, 65.0, 32.0, -1.0, -23.0, -34.0, 32.0, 76.0, 10.0, 43.0, 32.0, 21.0, -23.0, 54.0, 10.0, 32.0, -34.0, -12.0, 65.0, 54.0, -1.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20863014346541342, "mean_inference_ms": 10.062340147251508, "mean_action_processing_ms": 0.08861041812293938, "mean_env_wait_ms": 0.04585707169158893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005119800567626953, "StateBufferConnector_ms": 0.0031194686889648438, "ViewRequirementAgentConnector_ms": 0.0934152603149414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 76685.085, "sample_time_ms": 41654.615, "learn_time_ms": 35022.901, "learn_throughput": 114.211, "synch_weights_time_ms": 6.833}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 368, "training_iteration": 7, "trial_id": "38794_00003", "date": "2023-06-01_22-53-08", "timestamp": 1685649188, "time_this_iter_s": 83.92999696731567, "time_total_s": 592.4341728687286, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 592.4341728687286, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.75084745762712, "ram_util_percent": 70.17627118644069}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 19.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 10.0, -1.0, -34.0, 10.0, 43.0, 54.0, 65.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19508344408438955, "mean_inference_ms": 9.962575174126846, "mean_action_processing_ms": 0.08869453433939666, "mean_env_wait_ms": 0.04452291512799055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005218982696533203, "StateBufferConnector_ms": 0.0031042098999023438, "ViewRequirementAgentConnector_ms": 0.09022235870361328}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.008544445037842, "policy_loss": -0.022977275773882866, "vf_loss": 7.028016090393066, "vf_explained_var": 0.026527198031544685, "kl": 0.011683065444231033, "entropy": 2.9215376377105713, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 6.81, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 21.0, 43.0, -12.0, 10.0, 43.0, 32.0, 10.0, -45.0, 21.0, 32.0, -56.0, -45.0, -23.0, -34.0, 65.0, 65.0, 10.0, 43.0, -12.0, 54.0, -100.0, -67.0, -1.0, -12.0, 65.0, 32.0, -1.0, -23.0, -34.0, 32.0, 76.0, 10.0, 43.0, 32.0, 21.0, -23.0, 54.0, 10.0, 32.0, -34.0, -12.0, 65.0, 54.0, -1.0, 21.0, -1.0, 21.0, 32.0, -67.0, -1.0, 65.0, 21.0, 21.0, 65.0, 10.0, 54.0, 32.0, 54.0, 32.0, 32.0, 32.0, 43.0, 21.0, 21.0, 32.0, -34.0, 43.0, 10.0, -67.0, 32.0, 32.0, -56.0, -23.0, -45.0, -111.0, -12.0, -56.0, 21.0, -1.0, -45.0, -67.0, -34.0, -1.0, 10.0, -12.0, 32.0, 32.0, 21.0, -89.0, -12.0, 65.0, 21.0, 43.0, 43.0, 65.0, -34.0, -56.0, -45.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2082429896278928, "mean_inference_ms": 10.030530221467423, "mean_action_processing_ms": 0.08842528806765453, "mean_env_wait_ms": 0.04571393664907965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00508880615234375, "StateBufferConnector_ms": 0.0031468868255615234, "ViewRequirementAgentConnector_ms": 0.09330320358276367}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 6.81, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, 21.0, 43.0, -12.0, 10.0, 43.0, 32.0, 10.0, -45.0, 21.0, 32.0, -56.0, -45.0, -23.0, -34.0, 65.0, 65.0, 10.0, 43.0, -12.0, 54.0, -100.0, -67.0, -1.0, -12.0, 65.0, 32.0, -1.0, -23.0, -34.0, 32.0, 76.0, 10.0, 43.0, 32.0, 21.0, -23.0, 54.0, 10.0, 32.0, -34.0, -12.0, 65.0, 54.0, -1.0, 21.0, -1.0, 21.0, 32.0, -67.0, -1.0, 65.0, 21.0, 21.0, 65.0, 10.0, 54.0, 32.0, 54.0, 32.0, 32.0, 32.0, 43.0, 21.0, 21.0, 32.0, -34.0, 43.0, 10.0, -67.0, 32.0, 32.0, -56.0, -23.0, -45.0, -111.0, -12.0, -56.0, 21.0, -1.0, -45.0, -67.0, -34.0, -1.0, 10.0, -12.0, 32.0, 32.0, 21.0, -89.0, -12.0, 65.0, 21.0, 43.0, 43.0, 65.0, -34.0, -56.0, -45.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2082429896278928, "mean_inference_ms": 10.030530221467423, "mean_action_processing_ms": 0.08842528806765453, "mean_env_wait_ms": 0.04571393664907965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00508880615234375, "StateBufferConnector_ms": 0.0031468868255615234, "ViewRequirementAgentConnector_ms": 0.09330320358276367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 76267.213, "sample_time_ms": 41431.062, "learn_time_ms": 34828.716, "learn_throughput": 114.848, "synch_weights_time_ms": 6.737}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 421, "training_iteration": 8, "trial_id": "38794_00003", "date": "2023-06-01_22-54-29", "timestamp": 1685649269, "time_this_iter_s": 80.67634701728821, "time_total_s": 673.1105198860168, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 673.1105198860168, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.81160714285714, "ram_util_percent": 70.34107142857142}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -23.0, "episode_reward_mean": 30.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 76.0, -1.0, 32.0, 65.0, 32.0, -12.0, -23.0, 65.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19445110527922965, "mean_inference_ms": 9.942193317789727, "mean_action_processing_ms": 0.08812614254671967, "mean_env_wait_ms": 0.044238548184012724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408359527587891, "StateBufferConnector_ms": 0.003044605255126953, "ViewRequirementAgentConnector_ms": 0.09094953536987305}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.823927879333496, "policy_loss": -0.025617690756917, "vf_loss": 6.846038341522217, "vf_explained_var": 0.03263330087065697, "kl": 0.01169221568852663, "entropy": 2.911099433898926, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 5.87, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 21.0, 65.0, 10.0, 54.0, 32.0, 54.0, 32.0, 32.0, 32.0, 43.0, 21.0, 21.0, 32.0, -34.0, 43.0, 10.0, -67.0, 32.0, 32.0, -56.0, -23.0, -45.0, -111.0, -12.0, -56.0, 21.0, -1.0, -45.0, -67.0, -34.0, -1.0, 10.0, -12.0, 32.0, 32.0, 21.0, -89.0, -12.0, 65.0, 21.0, 43.0, 43.0, 65.0, -34.0, -56.0, -45.0, 43.0, 10.0, 65.0, -56.0, -34.0, 43.0, -1.0, 10.0, 21.0, 54.0, 59.0, 32.0, 43.0, 32.0, -1.0, -45.0, -12.0, -45.0, -67.0, 10.0, -34.0, 10.0, 32.0, 21.0, 54.0, -78.0, -34.0, -23.0, 43.0, 21.0, 54.0, 32.0, 76.0, 43.0, -1.0, 43.0, 43.0, 65.0, 32.0, -67.0, -45.0, -1.0, -34.0, 43.0, 10.0, -78.0, 10.0, 21.0, -1.0, 10.0, -78.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20839258863724525, "mean_inference_ms": 10.01259403746016, "mean_action_processing_ms": 0.08857763889005847, "mean_env_wait_ms": 0.04575960332074464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005109548568725586, "StateBufferConnector_ms": 0.0032625198364257812, "ViewRequirementAgentConnector_ms": 0.09636592864990234}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 5.87, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 21.0, 65.0, 10.0, 54.0, 32.0, 54.0, 32.0, 32.0, 32.0, 43.0, 21.0, 21.0, 32.0, -34.0, 43.0, 10.0, -67.0, 32.0, 32.0, -56.0, -23.0, -45.0, -111.0, -12.0, -56.0, 21.0, -1.0, -45.0, -67.0, -34.0, -1.0, 10.0, -12.0, 32.0, 32.0, 21.0, -89.0, -12.0, 65.0, 21.0, 43.0, 43.0, 65.0, -34.0, -56.0, -45.0, 43.0, 10.0, 65.0, -56.0, -34.0, 43.0, -1.0, 10.0, 21.0, 54.0, 59.0, 32.0, 43.0, 32.0, -1.0, -45.0, -12.0, -45.0, -67.0, 10.0, -34.0, 10.0, 32.0, 21.0, 54.0, -78.0, -34.0, -23.0, 43.0, 21.0, 54.0, 32.0, 76.0, 43.0, -1.0, 43.0, 43.0, 65.0, 32.0, -67.0, -45.0, -1.0, -34.0, 43.0, 10.0, -78.0, 10.0, 21.0, -1.0, 10.0, -78.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20839258863724525, "mean_inference_ms": 10.01259403746016, "mean_action_processing_ms": 0.08857763889005847, "mean_env_wait_ms": 0.04575960332074464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005109548568725586, "StateBufferConnector_ms": 0.0032625198364257812, "ViewRequirementAgentConnector_ms": 0.09636592864990234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 76232.004, "sample_time_ms": 41497.549, "learn_time_ms": 34726.908, "learn_throughput": 115.184, "synch_weights_time_ms": 6.866}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 473, "training_iteration": 9, "trial_id": "38794_00003", "date": "2023-06-01_22-55-52", "timestamp": 1685649352, "time_this_iter_s": 83.67449688911438, "time_total_s": 756.7850167751312, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 756.7850167751312, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 45.38461538461538, "ram_util_percent": 68.04358974358973}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -23.0, "episode_reward_mean": 33.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 65.0, 76.0, 43.0, 21.0, -23.0, 54.0, 10.0, 21.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1939746709642183, "mean_inference_ms": 9.907203290889395, "mean_action_processing_ms": 0.08793389102437435, "mean_env_wait_ms": 0.04410684116575815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005471706390380859, "StateBufferConnector_ms": 0.003044605255126953, "ViewRequirementAgentConnector_ms": 0.09031534194946289}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.487766742706299, "policy_loss": -0.02292204275727272, "vf_loss": 7.507030010223389, "vf_explained_var": 0.009747941978275776, "kl": 0.012195104733109474, "entropy": 2.9022130966186523, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 3.06, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 10.0, 21.0, 54.0, 59.0, 32.0, 43.0, 32.0, -1.0, -45.0, -12.0, -45.0, -67.0, 10.0, -34.0, 10.0, 32.0, 21.0, 54.0, -78.0, -34.0, -23.0, 43.0, 21.0, 54.0, 32.0, 76.0, 43.0, -1.0, 43.0, 43.0, 65.0, 32.0, -67.0, -45.0, -1.0, -34.0, 43.0, 10.0, -78.0, 10.0, 21.0, -1.0, 10.0, -78.0, 43.0, 54.0, 65.0, 32.0, 10.0, 10.0, -45.0, -45.0, 54.0, 43.0, 32.0, -78.0, -67.0, -56.0, -23.0, -56.0, -56.0, -23.0, -45.0, 10.0, 10.0, -23.0, -23.0, -45.0, 43.0, 32.0, 65.0, 43.0, 10.0, -34.0, 32.0, -1.0, -1.0, -23.0, 65.0, 43.0, -56.0, -12.0, 65.0, -23.0, 21.0, -1.0, 21.0, 43.0, -12.0, -23.0, 32.0, -67.0, -62.0, -56.0, 43.0, 65.0, -1.0, 32.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20825189752654755, "mean_inference_ms": 10.000388477035498, "mean_action_processing_ms": 0.08851317900704198, "mean_env_wait_ms": 0.04572226662421838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005142688751220703, "StateBufferConnector_ms": 0.0031270980834960938, "ViewRequirementAgentConnector_ms": 0.0952906608581543}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 3.06, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 10.0, 21.0, 54.0, 59.0, 32.0, 43.0, 32.0, -1.0, -45.0, -12.0, -45.0, -67.0, 10.0, -34.0, 10.0, 32.0, 21.0, 54.0, -78.0, -34.0, -23.0, 43.0, 21.0, 54.0, 32.0, 76.0, 43.0, -1.0, 43.0, 43.0, 65.0, 32.0, -67.0, -45.0, -1.0, -34.0, 43.0, 10.0, -78.0, 10.0, 21.0, -1.0, 10.0, -78.0, 43.0, 54.0, 65.0, 32.0, 10.0, 10.0, -45.0, -45.0, 54.0, 43.0, 32.0, -78.0, -67.0, -56.0, -23.0, -56.0, -56.0, -23.0, -45.0, 10.0, 10.0, -23.0, -23.0, -45.0, 43.0, 32.0, 65.0, 43.0, 10.0, -34.0, 32.0, -1.0, -1.0, -23.0, 65.0, 43.0, -56.0, -12.0, 65.0, -23.0, 21.0, -1.0, 21.0, 43.0, -12.0, -23.0, 32.0, -67.0, -62.0, -56.0, 43.0, 65.0, -1.0, 32.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20825189752654755, "mean_inference_ms": 10.000388477035498, "mean_action_processing_ms": 0.08851317900704198, "mean_env_wait_ms": 0.04572226662421838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005142688751220703, "StateBufferConnector_ms": 0.0031270980834960938, "ViewRequirementAgentConnector_ms": 0.0952906608581543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 75990.285, "sample_time_ms": 41342.995, "learn_time_ms": 34639.86, "learn_throughput": 115.474, "synch_weights_time_ms": 6.763}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 526, "training_iteration": 10, "trial_id": "38794_00003", "date": "2023-06-01_22-57-14", "timestamp": 1685649434, "time_this_iter_s": 81.39567303657532, "time_total_s": 838.1806898117065, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 838.1806898117065, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.87433628318584, "ram_util_percent": 67.65486725663717}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -45.0, "episode_reward_mean": 2.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -45.0, 32.0, -1.0, -23.0, 43.0, -1.0, -1.0, 10.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19375999326583887, "mean_inference_ms": 9.90504859780142, "mean_action_processing_ms": 0.08759788314259062, "mean_env_wait_ms": 0.04397803353231043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005409717559814453, "StateBufferConnector_ms": 0.0029087066650390625, "ViewRequirementAgentConnector_ms": 0.09126424789428711}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.902588844299316, "policy_loss": -0.031027615070343018, "vf_loss": 6.928796291351318, "vf_explained_var": 0.058895763009786606, "kl": 0.016067838296294212, "entropy": 2.850792646408081, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 2.23, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, 54.0, 43.0, 32.0, -78.0, -67.0, -56.0, -23.0, -56.0, -56.0, -23.0, -45.0, 10.0, 10.0, -23.0, -23.0, -45.0, 43.0, 32.0, 65.0, 43.0, 10.0, -34.0, 32.0, -1.0, -1.0, -23.0, 65.0, 43.0, -56.0, -12.0, 65.0, -23.0, 21.0, -1.0, 21.0, 43.0, -12.0, -23.0, 32.0, -67.0, -62.0, -56.0, 43.0, 65.0, -1.0, 32.0, -34.0, 21.0, -1.0, 21.0, 32.0, -12.0, 54.0, 32.0, 21.0, 10.0, -12.0, -12.0, 10.0, 10.0, -1.0, -67.0, -12.0, -45.0, 4.0, 37.0, -45.0, 32.0, -1.0, 65.0, -12.0, 43.0, 21.0, 43.0, -34.0, 32.0, 54.0, 43.0, 76.0, -45.0, 21.0, 54.0, 10.0, -12.0, -56.0, -89.0, 10.0, 10.0, -100.0, -23.0, -56.0, 32.0, 32.0, 54.0, -1.0, 54.0, -23.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078825519854229, "mean_inference_ms": 9.968927744397824, "mean_action_processing_ms": 0.08829020422492215, "mean_env_wait_ms": 0.0456068534515298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005144357681274414, "StateBufferConnector_ms": 0.003115415573120117, "ViewRequirementAgentConnector_ms": 0.09316301345825195}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 2.23, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, 54.0, 43.0, 32.0, -78.0, -67.0, -56.0, -23.0, -56.0, -56.0, -23.0, -45.0, 10.0, 10.0, -23.0, -23.0, -45.0, 43.0, 32.0, 65.0, 43.0, 10.0, -34.0, 32.0, -1.0, -1.0, -23.0, 65.0, 43.0, -56.0, -12.0, 65.0, -23.0, 21.0, -1.0, 21.0, 43.0, -12.0, -23.0, 32.0, -67.0, -62.0, -56.0, 43.0, 65.0, -1.0, 32.0, -34.0, 21.0, -1.0, 21.0, 32.0, -12.0, 54.0, 32.0, 21.0, 10.0, -12.0, -12.0, 10.0, 10.0, -1.0, -67.0, -12.0, -45.0, 4.0, 37.0, -45.0, 32.0, -1.0, 65.0, -12.0, 43.0, 21.0, 43.0, -34.0, 32.0, 54.0, 43.0, 76.0, -45.0, 21.0, 54.0, 10.0, -12.0, -56.0, -89.0, 10.0, 10.0, -100.0, -23.0, -56.0, 32.0, 32.0, 54.0, -1.0, 54.0, -23.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078825519854229, "mean_inference_ms": 9.968927744397824, "mean_action_processing_ms": 0.08829020422492215, "mean_env_wait_ms": 0.0456068534515298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005144357681274414, "StateBufferConnector_ms": 0.003115415573120117, "ViewRequirementAgentConnector_ms": 0.09316301345825195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 75571.807, "sample_time_ms": 41173.746, "learn_time_ms": 34390.734, "learn_throughput": 116.31, "synch_weights_time_ms": 6.701}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 578, "training_iteration": 11, "trial_id": "38794_00003", "date": "2023-06-01_22-58-35", "timestamp": 1685649515, "time_this_iter_s": 81.14588975906372, "time_total_s": 919.3265795707703, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 919.3265795707703, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.42017543859648, "ram_util_percent": 67.37105263157895}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": -1.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 10.0, -45.0, -34.0, 10.0, 21.0, 54.0, 54.0, -23.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19313232794938257, "mean_inference_ms": 9.862630830732774, "mean_action_processing_ms": 0.08740752899467705, "mean_env_wait_ms": 0.04377781776283514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005002021789550781, "StateBufferConnector_ms": 0.003185272216796875, "ViewRequirementAgentConnector_ms": 0.0882267951965332}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.0143609046936035, "policy_loss": -0.026015732437372208, "vf_loss": 6.036037921905518, "vf_explained_var": 0.025547508150339127, "kl": 0.0144645469263196, "entropy": 2.823556661605835, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.02, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 21.0, 10.0, -12.0, -12.0, 10.0, 10.0, -1.0, -67.0, -12.0, -45.0, 4.0, 37.0, -45.0, 32.0, -1.0, 65.0, -12.0, 43.0, 21.0, 43.0, -34.0, 32.0, 54.0, 43.0, 76.0, -45.0, 21.0, 54.0, 10.0, -12.0, -56.0, -89.0, 10.0, 10.0, -100.0, -23.0, -56.0, 32.0, 32.0, 54.0, -1.0, 54.0, -23.0, 54.0, 32.0, 43.0, 54.0, 54.0, 54.0, 21.0, 21.0, 54.0, 65.0, 65.0, 54.0, 54.0, 70.0, 43.0, 65.0, 76.0, 43.0, 21.0, 43.0, 54.0, 10.0, 43.0, 10.0, 54.0, 54.0, -89.0, -56.0, -78.0, -23.0, 32.0, 70.0, 65.0, 54.0, 32.0, -12.0, -1.0, 21.0, -1.0, 43.0, 32.0, 54.0, 76.0, 32.0, 10.0, 10.0, 21.0, -1.0, -12.0, -45.0, -23.0, 10.0, 10.0, -1.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20773807015996987, "mean_inference_ms": 9.963507755579235, "mean_action_processing_ms": 0.08821372551478003, "mean_env_wait_ms": 0.04557030628354766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005089759826660156, "StateBufferConnector_ms": 0.0030837059020996094, "ViewRequirementAgentConnector_ms": 0.09450554847717285}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.02, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 21.0, 10.0, -12.0, -12.0, 10.0, 10.0, -1.0, -67.0, -12.0, -45.0, 4.0, 37.0, -45.0, 32.0, -1.0, 65.0, -12.0, 43.0, 21.0, 43.0, -34.0, 32.0, 54.0, 43.0, 76.0, -45.0, 21.0, 54.0, 10.0, -12.0, -56.0, -89.0, 10.0, 10.0, -100.0, -23.0, -56.0, 32.0, 32.0, 54.0, -1.0, 54.0, -23.0, 54.0, 32.0, 43.0, 54.0, 54.0, 54.0, 21.0, 21.0, 54.0, 65.0, 65.0, 54.0, 54.0, 70.0, 43.0, 65.0, 76.0, 43.0, 21.0, 43.0, 54.0, 10.0, 43.0, 10.0, 54.0, 54.0, -89.0, -56.0, -78.0, -23.0, 32.0, 70.0, 65.0, 54.0, 32.0, -12.0, -1.0, 21.0, -1.0, 43.0, 32.0, 54.0, 76.0, 32.0, 10.0, 10.0, 21.0, -1.0, -12.0, -45.0, -23.0, 10.0, 10.0, -1.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20773807015996987, "mean_inference_ms": 9.963507755579235, "mean_action_processing_ms": 0.08821372551478003, "mean_env_wait_ms": 0.04557030628354766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005089759826660156, "StateBufferConnector_ms": 0.0030837059020996094, "ViewRequirementAgentConnector_ms": 0.09450554847717285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 75178.863, "sample_time_ms": 41099.702, "learn_time_ms": 34072.045, "learn_throughput": 117.398, "synch_weights_time_ms": 6.505}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 631, "training_iteration": 12, "trial_id": "38794_00003", "date": "2023-06-01_22-59-59", "timestamp": 1685649599, "time_this_iter_s": 83.6297390460968, "time_total_s": 1002.9563186168671, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1002.9563186168671, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 44.43879310344828, "ram_util_percent": 68.19827586206897}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -12.0, "episode_reward_mean": 15.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -1.0, 10.0, -1.0, 32.0, 10.0, -12.0, 21.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19362568553673237, "mean_inference_ms": 9.874988815922233, "mean_action_processing_ms": 0.08764137636371352, "mean_env_wait_ms": 0.043876402026522855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006067752838134766, "StateBufferConnector_ms": 0.0032973289489746094, "ViewRequirementAgentConnector_ms": 0.09921789169311523}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.748142719268799, "policy_loss": -0.02622659131884575, "vf_loss": 7.769624710083008, "vf_explained_var": 0.024040494114160538, "kl": 0.015812499448657036, "entropy": 2.821485996246338, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 6.74, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 65.0, 54.0, 54.0, 70.0, 43.0, 65.0, 76.0, 43.0, 21.0, 43.0, 54.0, 10.0, 43.0, 10.0, 54.0, 54.0, -89.0, -56.0, -78.0, -23.0, 32.0, 70.0, 65.0, 54.0, 32.0, -12.0, -1.0, 21.0, -1.0, 43.0, 32.0, 54.0, 76.0, 32.0, 10.0, 10.0, 21.0, -1.0, -12.0, -45.0, -23.0, 10.0, 10.0, -1.0, 43.0, 10.0, -1.0, 43.0, -1.0, 21.0, -45.0, -1.0, 43.0, 54.0, -1.0, -12.0, -23.0, 32.0, -1.0, -12.0, -34.0, -51.0, -12.0, -34.0, -111.0, -12.0, -45.0, -56.0, -12.0, -34.0, 43.0, 54.0, 10.0, 10.0, 32.0, -23.0, 32.0, 43.0, -12.0, -23.0, -12.0, 10.0, -78.0, -45.0, -45.0, -34.0, 10.0, -12.0, -23.0, -133.0, -45.0, 10.0, -12.0, 10.0, 54.0, 10.0, 21.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20767964592872765, "mean_inference_ms": 9.964330511440403, "mean_action_processing_ms": 0.08818541633725215, "mean_env_wait_ms": 0.045563581118008525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005179882049560547, "StateBufferConnector_ms": 0.0030846595764160156, "ViewRequirementAgentConnector_ms": 0.09533238410949707}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 6.74, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 65.0, 54.0, 54.0, 70.0, 43.0, 65.0, 76.0, 43.0, 21.0, 43.0, 54.0, 10.0, 43.0, 10.0, 54.0, 54.0, -89.0, -56.0, -78.0, -23.0, 32.0, 70.0, 65.0, 54.0, 32.0, -12.0, -1.0, 21.0, -1.0, 43.0, 32.0, 54.0, 76.0, 32.0, 10.0, 10.0, 21.0, -1.0, -12.0, -45.0, -23.0, 10.0, 10.0, -1.0, 43.0, 10.0, -1.0, 43.0, -1.0, 21.0, -45.0, -1.0, 43.0, 54.0, -1.0, -12.0, -23.0, 32.0, -1.0, -12.0, -34.0, -51.0, -12.0, -34.0, -111.0, -12.0, -45.0, -56.0, -12.0, -34.0, 43.0, 54.0, 10.0, 10.0, 32.0, -23.0, 32.0, 43.0, -12.0, -23.0, -12.0, 10.0, -78.0, -45.0, -45.0, -34.0, 10.0, -12.0, -23.0, -133.0, -45.0, 10.0, -12.0, 10.0, 54.0, 10.0, 21.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20767964592872765, "mean_inference_ms": 9.964330511440403, "mean_action_processing_ms": 0.08818541633725215, "mean_env_wait_ms": 0.045563581118008525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005179882049560547, "StateBufferConnector_ms": 0.0030846595764160156, "ViewRequirementAgentConnector_ms": 0.09533238410949707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 74739.631, "sample_time_ms": 40749.708, "learn_time_ms": 33981.56, "learn_throughput": 117.711, "synch_weights_time_ms": 7.729}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 684, "training_iteration": 13, "trial_id": "38794_00003", "date": "2023-06-01_23-01-21", "timestamp": 1685649681, "time_this_iter_s": 82.52091121673584, "time_total_s": 1085.477229833603, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1085.477229833603, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.79396551724138, "ram_util_percent": 69.00431034482757}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -29.0, "episode_reward_mean": 19.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 76.0, -23.0, -1.0, -23.0, 10.0, 54.0, 76.0, 10.0, -29.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19289470124475466, "mean_inference_ms": 9.856839565818062, "mean_action_processing_ms": 0.08720570114274837, "mean_env_wait_ms": 0.04365293841401883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005018711090087891, "StateBufferConnector_ms": 0.0032901763916015625, "ViewRequirementAgentConnector_ms": 0.08817434310913086}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.074460029602051, "policy_loss": -0.028513740748167038, "vf_loss": 6.098541259765625, "vf_explained_var": 0.1211804449558258, "kl": 0.014775640331208706, "entropy": 2.841498851776123, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 5.26, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -1.0, 43.0, 54.0, -1.0, -12.0, -23.0, 32.0, -1.0, -12.0, -34.0, -51.0, -12.0, -34.0, -111.0, -12.0, -45.0, -56.0, -12.0, -34.0, 43.0, 54.0, 10.0, 10.0, 32.0, -23.0, 32.0, 43.0, -12.0, -23.0, -12.0, 10.0, -78.0, -45.0, -45.0, -34.0, 10.0, -12.0, -23.0, -133.0, -45.0, 10.0, -12.0, 10.0, 54.0, 10.0, 21.0, -34.0, 54.0, 43.0, 32.0, 76.0, 32.0, -34.0, 32.0, 65.0, 76.0, 32.0, 43.0, 65.0, 65.0, 76.0, 21.0, 54.0, 4.0, 10.0, -78.0, -45.0, -34.0, -78.0, 10.0, -12.0, 10.0, 54.0, -12.0, -12.0, 10.0, 76.0, 76.0, 65.0, 76.0, 65.0, 54.0, 10.0, 54.0, 43.0, -12.0, 21.0, -34.0, -23.0, 10.0, 32.0, 10.0, -23.0, -1.0, -1.0, -56.0, -67.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20777947586299167, "mean_inference_ms": 9.967251746231637, "mean_action_processing_ms": 0.08826753586535876, "mean_env_wait_ms": 0.04560291246901535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052182674407958984, "StateBufferConnector_ms": 0.0031812191009521484, "ViewRequirementAgentConnector_ms": 0.09470677375793457}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 5.26, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -1.0, 43.0, 54.0, -1.0, -12.0, -23.0, 32.0, -1.0, -12.0, -34.0, -51.0, -12.0, -34.0, -111.0, -12.0, -45.0, -56.0, -12.0, -34.0, 43.0, 54.0, 10.0, 10.0, 32.0, -23.0, 32.0, 43.0, -12.0, -23.0, -12.0, 10.0, -78.0, -45.0, -45.0, -34.0, 10.0, -12.0, -23.0, -133.0, -45.0, 10.0, -12.0, 10.0, 54.0, 10.0, 21.0, -34.0, 54.0, 43.0, 32.0, 76.0, 32.0, -34.0, 32.0, 65.0, 76.0, 32.0, 43.0, 65.0, 65.0, 76.0, 21.0, 54.0, 4.0, 10.0, -78.0, -45.0, -34.0, -78.0, 10.0, -12.0, 10.0, 54.0, -12.0, -12.0, 10.0, 76.0, 76.0, 65.0, 76.0, 65.0, 54.0, 10.0, 54.0, 43.0, -12.0, 21.0, -34.0, -23.0, 10.0, 32.0, 10.0, -23.0, -1.0, -1.0, -56.0, -67.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20777947586299167, "mean_inference_ms": 9.967251746231637, "mean_action_processing_ms": 0.08826753586535876, "mean_env_wait_ms": 0.04560291246901535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052182674407958984, "StateBufferConnector_ms": 0.0031812191009521484, "ViewRequirementAgentConnector_ms": 0.09470677375793457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 75112.011, "sample_time_ms": 40887.04, "learn_time_ms": 34216.543, "learn_throughput": 116.903, "synch_weights_time_ms": 7.807}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 736, "training_iteration": 14, "trial_id": "38794_00003", "date": "2023-06-01_23-02-47", "timestamp": 1685649767, "time_this_iter_s": 85.88538432121277, "time_total_s": 1171.3626141548157, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1171.3626141548157, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 47.60588235294118, "ram_util_percent": 70.27226890756302}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -12.0, "episode_reward_mean": 33.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, 21.0, 43.0, 76.0, 32.0, -12.0, 21.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19277749213406145, "mean_inference_ms": 9.839991479262522, "mean_action_processing_ms": 0.08719856828338754, "mean_env_wait_ms": 0.04360893506479309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004870891571044922, "StateBufferConnector_ms": 0.003273487091064453, "ViewRequirementAgentConnector_ms": 0.09113073348999023}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.8257856369018555, "policy_loss": -0.028053898364305496, "vf_loss": 6.849876403808594, "vf_explained_var": 0.11473315209150314, "kl": 0.01321133691817522, "entropy": 2.808109998703003, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -161.0, "episode_reward_mean": 12.19, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 32.0, 65.0, 76.0, 32.0, 43.0, 65.0, 65.0, 76.0, 21.0, 54.0, 4.0, 10.0, -78.0, -45.0, -34.0, -78.0, 10.0, -12.0, 10.0, 54.0, -12.0, -12.0, 10.0, 76.0, 76.0, 65.0, 76.0, 65.0, 54.0, 10.0, 54.0, 43.0, -12.0, 21.0, -34.0, -23.0, 10.0, 32.0, 10.0, -23.0, -1.0, -1.0, -56.0, -67.0, 65.0, 76.0, 43.0, -45.0, 21.0, 54.0, 32.0, 32.0, 21.0, -45.0, -1.0, -1.0, -1.0, -23.0, 10.0, -45.0, 10.0, -12.0, 21.0, -23.0, 10.0, -111.0, -1.0, 10.0, -1.0, -122.0, -45.0, -1.0, -23.0, -23.0, -161.0, 10.0, 54.0, -1.0, 32.0, 43.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 65.0, 76.0, 54.0, 65.0, 43.0, 54.0, 43.0, 43.0, 32.0, 43.0, 32.0, 65.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2074309960678712, "mean_inference_ms": 9.947583764991206, "mean_action_processing_ms": 0.08810900191804759, "mean_env_wait_ms": 0.045500113864161223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00494694709777832, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.09085631370544434}}, "episode_reward_max": 76.0, "episode_reward_min": -161.0, "episode_reward_mean": 12.19, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, 32.0, 65.0, 76.0, 32.0, 43.0, 65.0, 65.0, 76.0, 21.0, 54.0, 4.0, 10.0, -78.0, -45.0, -34.0, -78.0, 10.0, -12.0, 10.0, 54.0, -12.0, -12.0, 10.0, 76.0, 76.0, 65.0, 76.0, 65.0, 54.0, 10.0, 54.0, 43.0, -12.0, 21.0, -34.0, -23.0, 10.0, 32.0, 10.0, -23.0, -1.0, -1.0, -56.0, -67.0, 65.0, 76.0, 43.0, -45.0, 21.0, 54.0, 32.0, 32.0, 21.0, -45.0, -1.0, -1.0, -1.0, -23.0, 10.0, -45.0, 10.0, -12.0, 21.0, -23.0, 10.0, -111.0, -1.0, 10.0, -1.0, -122.0, -45.0, -1.0, -23.0, -23.0, -161.0, 10.0, 54.0, -1.0, 32.0, 43.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 65.0, 76.0, 54.0, 65.0, 43.0, 54.0, 43.0, 43.0, 32.0, 43.0, 32.0, 65.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2074309960678712, "mean_inference_ms": 9.947583764991206, "mean_action_processing_ms": 0.08810900191804759, "mean_env_wait_ms": 0.045500113864161223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00494694709777832, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.09085631370544434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 74754.941, "sample_time_ms": 40648.605, "learn_time_ms": 34096.323, "learn_throughput": 117.315, "synch_weights_time_ms": 9.361}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 789, "training_iteration": 15, "trial_id": "38794_00003", "date": "2023-06-01_23-04-06", "timestamp": 1685649846, "time_this_iter_s": 79.41141700744629, "time_total_s": 1250.774031162262, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1250.774031162262, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.96396396396396, "ram_util_percent": 70.69819819819821}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 10.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 21.0, 54.0, 32.0, -1.0, 21.0, 10.0, -45.0, -45.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19307801543308628, "mean_inference_ms": 9.881506428084535, "mean_action_processing_ms": 0.08728525550553069, "mean_env_wait_ms": 0.04360174115242686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005323886871337891, "StateBufferConnector_ms": 0.0030303001403808594, "ViewRequirementAgentConnector_ms": 0.09385824203491211}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.497256755828857, "policy_loss": -0.026364954188466072, "vf_loss": 7.518823146820068, "vf_explained_var": 0.015364927239716053, "kl": 0.01599499210715294, "entropy": 2.821143627166748, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -161.0, "episode_reward_mean": -1.61, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -45.0, -1.0, -1.0, -1.0, -23.0, 10.0, -45.0, 10.0, -12.0, 21.0, -23.0, 10.0, -111.0, -1.0, 10.0, -1.0, -122.0, -45.0, -1.0, -23.0, -23.0, -161.0, 10.0, 54.0, -1.0, 32.0, 43.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 65.0, 76.0, 54.0, 65.0, 43.0, 54.0, 43.0, 43.0, 32.0, 43.0, 32.0, 65.0, -1.0, -1.0, -34.0, 10.0, 21.0, 21.0, 21.0, 32.0, -1.0, -12.0, -34.0, -1.0, -1.0, 43.0, -23.0, 43.0, -78.0, 32.0, 21.0, -23.0, 32.0, 65.0, -1.0, 32.0, -1.0, -67.0, -12.0, -12.0, -34.0, -1.0, -23.0, 10.0, -1.0, 43.0, -45.0, 21.0, -34.0, -78.0, -100.0, -1.0, -1.0, 43.0, 21.0, -1.0, -1.0, -23.0, -111.0, -12.0, -45.0, 21.0, -23.0, -56.0, -23.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20714893998360928, "mean_inference_ms": 9.921789516752506, "mean_action_processing_ms": 0.08798977996203948, "mean_env_wait_ms": 0.04541611382668485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004944562911987305, "StateBufferConnector_ms": 0.0029294490814208984, "ViewRequirementAgentConnector_ms": 0.0913534164428711}}, "episode_reward_max": 76.0, "episode_reward_min": -161.0, "episode_reward_mean": -1.61, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -45.0, -1.0, -1.0, -1.0, -23.0, 10.0, -45.0, 10.0, -12.0, 21.0, -23.0, 10.0, -111.0, -1.0, 10.0, -1.0, -122.0, -45.0, -1.0, -23.0, -23.0, -161.0, 10.0, 54.0, -1.0, 32.0, 43.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 65.0, 76.0, 54.0, 65.0, 43.0, 54.0, 43.0, 43.0, 32.0, 43.0, 32.0, 65.0, -1.0, -1.0, -34.0, 10.0, 21.0, 21.0, 21.0, 32.0, -1.0, -12.0, -34.0, -1.0, -1.0, 43.0, -23.0, 43.0, -78.0, 32.0, 21.0, -23.0, 32.0, 65.0, -1.0, 32.0, -1.0, -67.0, -12.0, -12.0, -34.0, -1.0, -23.0, 10.0, -1.0, 43.0, -45.0, 21.0, -34.0, -78.0, -100.0, -1.0, -1.0, 43.0, 21.0, -1.0, -1.0, -23.0, -111.0, -12.0, -45.0, 21.0, -23.0, -56.0, -23.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20714893998360928, "mean_inference_ms": 9.921789516752506, "mean_action_processing_ms": 0.08798977996203948, "mean_env_wait_ms": 0.04541611382668485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004944562911987305, "StateBufferConnector_ms": 0.0029294490814208984, "ViewRequirementAgentConnector_ms": 0.0913534164428711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 74955.871, "sample_time_ms": 40731.692, "learn_time_ms": 34214.252, "learn_throughput": 116.91, "synch_weights_time_ms": 9.382}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 842, "training_iteration": 16, "trial_id": "38794_00003", "date": "2023-06-01_23-05-31", "timestamp": 1685649931, "time_this_iter_s": 84.3208122253418, "time_total_s": 1335.0948433876038, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1335.0948433876038, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 46.37796610169491, "ram_util_percent": 69.86101694915254}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 15.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -23.0, -12.0, -12.0, 54.0, 43.0, 54.0, 21.0, -12.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19252609333823353, "mean_inference_ms": 9.84311852972903, "mean_action_processing_ms": 0.08702054867738172, "mean_env_wait_ms": 0.04339967291750559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004723072052001953, "StateBufferConnector_ms": 0.002918243408203125, "ViewRequirementAgentConnector_ms": 0.08642911911010742}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.040444850921631, "policy_loss": -0.024950724095106125, "vf_loss": 7.060620307922363, "vf_explained_var": 0.028857819736003876, "kl": 0.015921374782919884, "entropy": 2.8045761585235596, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -2.27, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 32.0, -1.0, -12.0, -34.0, -1.0, -1.0, 43.0, -23.0, 43.0, -78.0, 32.0, 21.0, -23.0, 32.0, 65.0, -1.0, 32.0, -1.0, -67.0, -12.0, -12.0, -34.0, -1.0, -23.0, 10.0, -1.0, 43.0, -45.0, 21.0, -34.0, -78.0, -100.0, -1.0, -1.0, 43.0, 21.0, -1.0, -1.0, -23.0, -111.0, -12.0, -45.0, 21.0, -23.0, -56.0, -23.0, -23.0, 65.0, 32.0, 76.0, -1.0, 43.0, 10.0, 54.0, 65.0, 54.0, 65.0, 10.0, -12.0, 32.0, 32.0, 43.0, -23.0, -1.0, -45.0, -100.0, -56.0, -67.0, -1.0, 32.0, 54.0, -78.0, -67.0, 26.0, -23.0, -1.0, -45.0, -12.0, 43.0, 21.0, -34.0, -23.0, 10.0, -1.0, -23.0, 10.0, 10.0, 32.0, -1.0, 10.0, 65.0, 21.0, 21.0, 21.0, -1.0, -34.0, 10.0, -45.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20726951450866085, "mean_inference_ms": 9.932268639850363, "mean_action_processing_ms": 0.0880805690715913, "mean_env_wait_ms": 0.04546505517462261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005121946334838867, "StateBufferConnector_ms": 0.0029747486114501953, "ViewRequirementAgentConnector_ms": 0.0948941707611084}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -2.27, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 32.0, -1.0, -12.0, -34.0, -1.0, -1.0, 43.0, -23.0, 43.0, -78.0, 32.0, 21.0, -23.0, 32.0, 65.0, -1.0, 32.0, -1.0, -67.0, -12.0, -12.0, -34.0, -1.0, -23.0, 10.0, -1.0, 43.0, -45.0, 21.0, -34.0, -78.0, -100.0, -1.0, -1.0, 43.0, 21.0, -1.0, -1.0, -23.0, -111.0, -12.0, -45.0, 21.0, -23.0, -56.0, -23.0, -23.0, 65.0, 32.0, 76.0, -1.0, 43.0, 10.0, 54.0, 65.0, 54.0, 65.0, 10.0, -12.0, 32.0, 32.0, 43.0, -23.0, -1.0, -45.0, -100.0, -56.0, -67.0, -1.0, 32.0, 54.0, -78.0, -67.0, 26.0, -23.0, -1.0, -45.0, -12.0, 43.0, 21.0, -34.0, -23.0, 10.0, -1.0, -23.0, 10.0, 10.0, 32.0, -1.0, 10.0, 65.0, 21.0, 21.0, 21.0, -1.0, -34.0, 10.0, -45.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20726951450866085, "mean_inference_ms": 9.932268639850363, "mean_action_processing_ms": 0.0880805690715913, "mean_env_wait_ms": 0.04546505517462261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005121946334838867, "StateBufferConnector_ms": 0.0029747486114501953, "ViewRequirementAgentConnector_ms": 0.0948941707611084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 74950.261, "sample_time_ms": 40848.708, "learn_time_ms": 34091.744, "learn_throughput": 117.33, "synch_weights_time_ms": 9.266}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 894, "training_iteration": 17, "trial_id": "38794_00003", "date": "2023-06-01_23-06-54", "timestamp": 1685650014, "time_this_iter_s": 83.40001893043518, "time_total_s": 1418.494862318039, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1418.494862318039, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 44.09568965517242, "ram_util_percent": 69.63793103448276}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -23.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -1.0, -1.0, 21.0, -1.0, 21.0, 65.0, 43.0, -23.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1925134090693772, "mean_inference_ms": 9.848443817546881, "mean_action_processing_ms": 0.08694258238800298, "mean_env_wait_ms": 0.043343316131094364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004992485046386719, "StateBufferConnector_ms": 0.002734661102294922, "ViewRequirementAgentConnector_ms": 0.09042978286743164}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.392003536224365, "policy_loss": -0.030012039467692375, "vf_loss": 7.417462348937988, "vf_explained_var": 0.018732590600848198, "kl": 0.01517605409026146, "entropy": 2.7671806812286377, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -1.67, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 54.0, 65.0, 54.0, 65.0, 10.0, -12.0, 32.0, 32.0, 43.0, -23.0, -1.0, -45.0, -100.0, -56.0, -67.0, -1.0, 32.0, 54.0, -78.0, -67.0, 26.0, -23.0, -1.0, -45.0, -12.0, 43.0, 21.0, -34.0, -23.0, 10.0, -1.0, -23.0, 10.0, 10.0, 32.0, -1.0, 10.0, 65.0, 21.0, 21.0, 21.0, -1.0, -34.0, 10.0, -45.0, -78.0, -23.0, -111.0, -67.0, 65.0, -34.0, 21.0, -12.0, -45.0, -34.0, 43.0, -56.0, 21.0, -100.0, -45.0, 10.0, 10.0, -45.0, -1.0, 32.0, -12.0, 32.0, 54.0, 54.0, 21.0, -1.0, 54.0, -12.0, 54.0, 10.0, -45.0, -1.0, 43.0, -12.0, 21.0, -67.0, -56.0, -89.0, -89.0, 32.0, 21.0, -12.0, -34.0, -12.0, 4.0, -1.0, 76.0, 54.0, 54.0, 43.0, -1.0, -23.0, -1.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20754216546522664, "mean_inference_ms": 9.95140632234996, "mean_action_processing_ms": 0.08826333246066681, "mean_env_wait_ms": 0.04556703601802517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053369998931884766, "StateBufferConnector_ms": 0.003069639205932617, "ViewRequirementAgentConnector_ms": 0.09558653831481934}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -1.67, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 54.0, 65.0, 54.0, 65.0, 10.0, -12.0, 32.0, 32.0, 43.0, -23.0, -1.0, -45.0, -100.0, -56.0, -67.0, -1.0, 32.0, 54.0, -78.0, -67.0, 26.0, -23.0, -1.0, -45.0, -12.0, 43.0, 21.0, -34.0, -23.0, 10.0, -1.0, -23.0, 10.0, 10.0, 32.0, -1.0, 10.0, 65.0, 21.0, 21.0, 21.0, -1.0, -34.0, 10.0, -45.0, -78.0, -23.0, -111.0, -67.0, 65.0, -34.0, 21.0, -12.0, -45.0, -34.0, 43.0, -56.0, 21.0, -100.0, -45.0, 10.0, 10.0, -45.0, -1.0, 32.0, -12.0, 32.0, 54.0, 54.0, 21.0, -1.0, 54.0, -12.0, 54.0, 10.0, -45.0, -1.0, 43.0, -12.0, 21.0, -67.0, -56.0, -89.0, -89.0, 32.0, 21.0, -12.0, -34.0, -12.0, 4.0, -1.0, 76.0, 54.0, 54.0, 43.0, -1.0, -23.0, -1.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20754216546522664, "mean_inference_ms": 9.95140632234996, "mean_action_processing_ms": 0.08826333246066681, "mean_env_wait_ms": 0.04556703601802517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053369998931884766, "StateBufferConnector_ms": 0.003069639205932617, "ViewRequirementAgentConnector_ms": 0.09558653831481934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 75201.842, "sample_time_ms": 41095.821, "learn_time_ms": 34096.188, "learn_throughput": 117.315, "synch_weights_time_ms": 9.285}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 947, "training_iteration": 18, "trial_id": "38794_00003", "date": "2023-06-01_23-08-18", "timestamp": 1685650098, "time_this_iter_s": 83.70210194587708, "time_total_s": 1502.196964263916, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1502.196964263916, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 46.63247863247863, "ram_util_percent": 70.84102564102565}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -18.0, "episode_reward_mean": 40.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 76.0, 10.0, -18.0, 32.0, 32.0, 76.0, 70.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19211615892701775, "mean_inference_ms": 9.814379461402172, "mean_action_processing_ms": 0.08669892437825712, "mean_env_wait_ms": 0.04318759147665703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004537105560302734, "StateBufferConnector_ms": 0.0029039382934570312, "ViewRequirementAgentConnector_ms": 0.08939027786254883}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.19470739364624, "policy_loss": -0.02318751998245716, "vf_loss": 6.213686466217041, "vf_explained_var": 0.02280152030289173, "kl": 0.014026716351509094, "entropy": 2.8192672729492188, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 10.81, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, -34.0, 43.0, -56.0, 21.0, -100.0, -45.0, 10.0, 10.0, -45.0, -1.0, 32.0, -12.0, 32.0, 54.0, 54.0, 21.0, -1.0, 54.0, -12.0, 54.0, 10.0, -45.0, -1.0, 43.0, -12.0, 21.0, -67.0, -56.0, -89.0, -89.0, 32.0, 21.0, -12.0, -34.0, -12.0, 4.0, -1.0, 76.0, 54.0, 54.0, 43.0, -1.0, -23.0, -1.0, 65.0, 10.0, 21.0, 43.0, -34.0, 21.0, 10.0, 32.0, 43.0, -1.0, -34.0, 21.0, -12.0, -23.0, -34.0, 65.0, 43.0, 43.0, 65.0, -23.0, 43.0, 76.0, 54.0, 65.0, 54.0, 21.0, 54.0, -45.0, -1.0, -34.0, -23.0, -67.0, 32.0, -12.0, 76.0, 54.0, -12.0, 10.0, 65.0, 65.0, 32.0, 65.0, 32.0, -51.0, -1.0, 65.0, 32.0, 54.0, 43.0, 37.0, -12.0, 10.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20753638771615793, "mean_inference_ms": 9.958282307143499, "mean_action_processing_ms": 0.08828353760668818, "mean_env_wait_ms": 0.045585296351304816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005201816558837891, "StateBufferConnector_ms": 0.0030205249786376953, "ViewRequirementAgentConnector_ms": 0.09393072128295898}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 10.81, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, -34.0, 43.0, -56.0, 21.0, -100.0, -45.0, 10.0, 10.0, -45.0, -1.0, 32.0, -12.0, 32.0, 54.0, 54.0, 21.0, -1.0, 54.0, -12.0, 54.0, 10.0, -45.0, -1.0, 43.0, -12.0, 21.0, -67.0, -56.0, -89.0, -89.0, 32.0, 21.0, -12.0, -34.0, -12.0, 4.0, -1.0, 76.0, 54.0, 54.0, 43.0, -1.0, -23.0, -1.0, 65.0, 10.0, 21.0, 43.0, -34.0, 21.0, 10.0, 32.0, 43.0, -1.0, -34.0, 21.0, -12.0, -23.0, -34.0, 65.0, 43.0, 43.0, 65.0, -23.0, 43.0, 76.0, 54.0, 65.0, 54.0, 21.0, 54.0, -45.0, -1.0, -34.0, -23.0, -67.0, 32.0, -12.0, 76.0, 54.0, -12.0, 10.0, 65.0, 65.0, 32.0, 65.0, 32.0, -51.0, -1.0, 65.0, 32.0, 54.0, 43.0, 37.0, -12.0, 10.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20753638771615793, "mean_inference_ms": 9.958282307143499, "mean_action_processing_ms": 0.08828353760668818, "mean_env_wait_ms": 0.045585296351304816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005201816558837891, "StateBufferConnector_ms": 0.0030205249786376953, "ViewRequirementAgentConnector_ms": 0.09393072128295898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 75176.33, "sample_time_ms": 41008.071, "learn_time_ms": 34158.563, "learn_throughput": 117.101, "synch_weights_time_ms": 9.15}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 1000, "training_iteration": 19, "trial_id": "38794_00003", "date": "2023-06-01_23-09-41", "timestamp": 1685650181, "time_this_iter_s": 82.97041416168213, "time_total_s": 1585.1673784255981, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1585.1673784255981, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 41.902586206896544, "ram_util_percent": 72.09482758620689}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -12.0, "episode_reward_mean": 40.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 65.0, 32.0, 32.0, -12.0, 10.0, 54.0, 54.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1924694952906123, "mean_inference_ms": 9.831781222956579, "mean_action_processing_ms": 0.08701689972170765, "mean_env_wait_ms": 0.04331681784983725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005345344543457031, "StateBufferConnector_ms": 0.0031375885009765625, "ViewRequirementAgentConnector_ms": 0.09224414825439453}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.89899206161499, "policy_loss": -0.026971375569701195, "vf_loss": 6.9209065437316895, "vf_explained_var": 0.08923816680908203, "kl": 0.01685597375035286, "entropy": 2.7847213745117188, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 10.76, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 43.0, -1.0, -34.0, 21.0, -12.0, -23.0, -34.0, 65.0, 43.0, 43.0, 65.0, -23.0, 43.0, 76.0, 54.0, 65.0, 54.0, 21.0, 54.0, -45.0, -1.0, -34.0, -23.0, -67.0, 32.0, -12.0, 76.0, 54.0, -12.0, 10.0, 65.0, 65.0, 32.0, 65.0, 32.0, -51.0, -1.0, 65.0, 32.0, 54.0, 43.0, 37.0, -12.0, 10.0, 43.0, -1.0, 54.0, -1.0, -78.0, -23.0, -1.0, -34.0, -144.0, -34.0, -45.0, -34.0, -100.0, 32.0, -45.0, -12.0, 21.0, 43.0, -12.0, 21.0, -1.0, 21.0, -56.0, -23.0, -12.0, -23.0, 65.0, 10.0, -1.0, -67.0, -1.0, 32.0, 32.0, 21.0, 43.0, -1.0, 10.0, 76.0, 65.0, 21.0, 54.0, -1.0, 10.0, 76.0, -1.0, 54.0, 54.0, -23.0, -34.0, -12.0, -89.0, 10.0, 76.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2074015376997661, "mean_inference_ms": 9.9570387406534, "mean_action_processing_ms": 0.0882388837294074, "mean_env_wait_ms": 0.0455682410020865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005066394805908203, "StateBufferConnector_ms": 0.002963542938232422, "ViewRequirementAgentConnector_ms": 0.09361815452575684}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 10.76, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 43.0, -1.0, -34.0, 21.0, -12.0, -23.0, -34.0, 65.0, 43.0, 43.0, 65.0, -23.0, 43.0, 76.0, 54.0, 65.0, 54.0, 21.0, 54.0, -45.0, -1.0, -34.0, -23.0, -67.0, 32.0, -12.0, 76.0, 54.0, -12.0, 10.0, 65.0, 65.0, 32.0, 65.0, 32.0, -51.0, -1.0, 65.0, 32.0, 54.0, 43.0, 37.0, -12.0, 10.0, 43.0, -1.0, 54.0, -1.0, -78.0, -23.0, -1.0, -34.0, -144.0, -34.0, -45.0, -34.0, -100.0, 32.0, -45.0, -12.0, 21.0, 43.0, -12.0, 21.0, -1.0, 21.0, -56.0, -23.0, -12.0, -23.0, 65.0, 10.0, -1.0, -67.0, -1.0, 32.0, 32.0, 21.0, 43.0, -1.0, 10.0, 76.0, 65.0, 21.0, 54.0, -1.0, 10.0, 76.0, -1.0, 54.0, 54.0, -23.0, -34.0, -12.0, -89.0, 10.0, 76.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2074015376997661, "mean_inference_ms": 9.9570387406534, "mean_action_processing_ms": 0.0882388837294074, "mean_env_wait_ms": 0.0455682410020865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005066394805908203, "StateBufferConnector_ms": 0.002963542938232422, "ViewRequirementAgentConnector_ms": 0.09361815452575684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 75276.364, "sample_time_ms": 41123.468, "learn_time_ms": 34142.849, "learn_throughput": 117.155, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 1052, "training_iteration": 20, "trial_id": "38794_00003", "date": "2023-06-01_23-11-04", "timestamp": 1685650264, "time_this_iter_s": 82.85187196731567, "time_total_s": 1668.0192503929138, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1668.0192503929138, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 46.52155172413792, "ram_util_percent": 72.11120689655174}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -23.0, "episode_reward_mean": 8.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 10.0, 32.0, -1.0, -23.0, -1.0, -23.0, 76.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19217856463151545, "mean_inference_ms": 9.831642105229687, "mean_action_processing_ms": 0.08675150013561497, "mean_env_wait_ms": 0.043193422069780184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004923343658447266, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.09270668029785156}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.342857837677002, "policy_loss": -0.018479129299521446, "vf_loss": 7.357263565063477, "vf_explained_var": 0.08048050850629807, "kl": 0.013576733879745007, "entropy": 2.7750751972198486, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -0.35, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -144.0, -34.0, -45.0, -34.0, -100.0, 32.0, -45.0, -12.0, 21.0, 43.0, -12.0, 21.0, -1.0, 21.0, -56.0, -23.0, -12.0, -23.0, 65.0, 10.0, -1.0, -67.0, -1.0, 32.0, 32.0, 21.0, 43.0, -1.0, 10.0, 76.0, 65.0, 21.0, 54.0, -1.0, 10.0, 76.0, -1.0, 54.0, 54.0, -23.0, -34.0, -12.0, -89.0, 10.0, 76.0, 65.0, 65.0, 76.0, 65.0, -12.0, -1.0, -1.0, -23.0, 32.0, 32.0, -12.0, 32.0, -56.0, -89.0, -155.0, -23.0, -45.0, -12.0, -51.0, -34.0, 10.0, -78.0, -12.0, 10.0, -56.0, 32.0, -12.0, -23.0, -111.0, -12.0, -29.0, 65.0, 54.0, 32.0, 21.0, 21.0, 43.0, -78.0, -23.0, 65.0, 10.0, 76.0, -23.0, 32.0, 43.0, 10.0, -34.0, -56.0, -1.0, 43.0, 10.0, -12.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20739905929302188, "mean_inference_ms": 9.956695553080896, "mean_action_processing_ms": 0.08827122659066194, "mean_env_wait_ms": 0.0455863575902383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051152706146240234, "StateBufferConnector_ms": 0.0030794143676757812, "ViewRequirementAgentConnector_ms": 0.09503412246704102}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -0.35, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -144.0, -34.0, -45.0, -34.0, -100.0, 32.0, -45.0, -12.0, 21.0, 43.0, -12.0, 21.0, -1.0, 21.0, -56.0, -23.0, -12.0, -23.0, 65.0, 10.0, -1.0, -67.0, -1.0, 32.0, 32.0, 21.0, 43.0, -1.0, 10.0, 76.0, 65.0, 21.0, 54.0, -1.0, 10.0, 76.0, -1.0, 54.0, 54.0, -23.0, -34.0, -12.0, -89.0, 10.0, 76.0, 65.0, 65.0, 76.0, 65.0, -12.0, -1.0, -1.0, -23.0, 32.0, 32.0, -12.0, 32.0, -56.0, -89.0, -155.0, -23.0, -45.0, -12.0, -51.0, -34.0, 10.0, -78.0, -12.0, 10.0, -56.0, 32.0, -12.0, -23.0, -111.0, -12.0, -29.0, 65.0, 54.0, 32.0, 21.0, 21.0, 43.0, -78.0, -23.0, 65.0, 10.0, 76.0, -23.0, 32.0, 43.0, 10.0, -34.0, -56.0, -1.0, 43.0, 10.0, -12.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20739905929302188, "mean_inference_ms": 9.956695553080896, "mean_action_processing_ms": 0.08827122659066194, "mean_env_wait_ms": 0.0455863575902383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051152706146240234, "StateBufferConnector_ms": 0.0030794143676757812, "ViewRequirementAgentConnector_ms": 0.09503412246704102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 75595.709, "sample_time_ms": 41239.596, "learn_time_ms": 34345.958, "learn_throughput": 116.462, "synch_weights_time_ms": 9.595}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 1105, "training_iteration": 21, "trial_id": "38794_00003", "date": "2023-06-01_23-12-28", "timestamp": 1685650348, "time_this_iter_s": 84.29070615768433, "time_total_s": 1752.3099565505981, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1752.3099565505981, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 45.04786324786325, "ram_util_percent": 72.73162393162393}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 40.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -34.0, 65.0, 43.0, 65.0, 32.0, 43.0, 76.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19235290427875534, "mean_inference_ms": 9.831510400894718, "mean_action_processing_ms": 0.08682896379263562, "mean_env_wait_ms": 0.04320763192759426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006525516510009766, "StateBufferConnector_ms": 0.0028276443481445312, "ViewRequirementAgentConnector_ms": 0.09479045867919922}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.939888000488281, "policy_loss": -0.022437836974859238, "vf_loss": 6.957962989807129, "vf_explained_var": 0.035039324313402176, "kl": 0.01454113982617855, "entropy": 2.776829242706299, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -2.11, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -23.0, 32.0, 32.0, -12.0, 32.0, -56.0, -89.0, -155.0, -23.0, -45.0, -12.0, -51.0, -34.0, 10.0, -78.0, -12.0, 10.0, -56.0, 32.0, -12.0, -23.0, -111.0, -12.0, -29.0, 65.0, 54.0, 32.0, 21.0, 21.0, 43.0, -78.0, -23.0, 65.0, 10.0, 76.0, -23.0, 32.0, 43.0, 10.0, -34.0, -56.0, -1.0, 43.0, 10.0, -12.0, 43.0, 10.0, -56.0, -23.0, 32.0, 65.0, 65.0, 65.0, 54.0, 43.0, 76.0, 43.0, 54.0, 54.0, 43.0, 65.0, -23.0, -89.0, 10.0, 21.0, -34.0, -1.0, 10.0, 54.0, -34.0, -89.0, -1.0, -23.0, -67.0, -1.0, 32.0, 10.0, -34.0, -45.0, 32.0, 32.0, -45.0, -56.0, -34.0, -133.0, -89.0, 21.0, 32.0, -1.0, -1.0, -45.0, -45.0, -1.0, 43.0, 32.0, 65.0, -1.0, 10.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20722604806270684, "mean_inference_ms": 9.950355466608123, "mean_action_processing_ms": 0.08820485233596095, "mean_env_wait_ms": 0.04555322605335472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005053997039794922, "StateBufferConnector_ms": 0.0029773712158203125, "ViewRequirementAgentConnector_ms": 0.09261012077331543}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -2.11, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -23.0, 32.0, 32.0, -12.0, 32.0, -56.0, -89.0, -155.0, -23.0, -45.0, -12.0, -51.0, -34.0, 10.0, -78.0, -12.0, 10.0, -56.0, 32.0, -12.0, -23.0, -111.0, -12.0, -29.0, 65.0, 54.0, 32.0, 21.0, 21.0, 43.0, -78.0, -23.0, 65.0, 10.0, 76.0, -23.0, 32.0, 43.0, 10.0, -34.0, -56.0, -1.0, 43.0, 10.0, -12.0, 43.0, 10.0, -56.0, -23.0, 32.0, 65.0, 65.0, 65.0, 54.0, 43.0, 76.0, 43.0, 54.0, 54.0, 43.0, 65.0, -23.0, -89.0, 10.0, 21.0, -34.0, -1.0, 10.0, 54.0, -34.0, -89.0, -1.0, -23.0, -67.0, -1.0, 32.0, 10.0, -34.0, -45.0, 32.0, 32.0, -45.0, -56.0, -34.0, -133.0, -89.0, 21.0, 32.0, -1.0, -1.0, -45.0, -45.0, -1.0, 43.0, 32.0, 65.0, -1.0, 10.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20722604806270684, "mean_inference_ms": 9.950355466608123, "mean_action_processing_ms": 0.08820485233596095, "mean_env_wait_ms": 0.04555322605335472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005053997039794922, "StateBufferConnector_ms": 0.0029773712158203125, "ViewRequirementAgentConnector_ms": 0.09261012077331543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 75419.024, "sample_time_ms": 41054.09, "learn_time_ms": 34354.725, "learn_throughput": 116.432, "synch_weights_time_ms": 9.651}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 1157, "training_iteration": 22, "trial_id": "38794_00003", "date": "2023-06-01_23-13-50", "timestamp": 1685650430, "time_this_iter_s": 82.2083990573883, "time_total_s": 1834.5183556079865, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1834.5183556079865, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 46.32347826086956, "ram_util_percent": 72.75130434782609}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 14.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 54.0, 26.0, 76.0, 32.0, 43.0, -12.0, -34.0, -56.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19231410506906244, "mean_inference_ms": 9.850824392739998, "mean_action_processing_ms": 0.08677789803657643, "mean_env_wait_ms": 0.04321333677502343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058841705322265625, "StateBufferConnector_ms": 0.0029754638671875, "ViewRequirementAgentConnector_ms": 0.09520530700683594}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.187714576721191, "policy_loss": -0.02106034941971302, "vf_loss": 7.203876972198486, "vf_explained_var": 0.05785316228866577, "kl": 0.016326947137713432, "entropy": 2.798234462738037, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -1.72, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 43.0, 76.0, 43.0, 54.0, 54.0, 43.0, 65.0, -23.0, -89.0, 10.0, 21.0, -34.0, -1.0, 10.0, 54.0, -34.0, -89.0, -1.0, -23.0, -67.0, -1.0, 32.0, 10.0, -34.0, -45.0, 32.0, 32.0, -45.0, -56.0, -34.0, -133.0, -89.0, 21.0, 32.0, -1.0, -1.0, -45.0, -45.0, -1.0, 43.0, 32.0, 65.0, -1.0, 10.0, 32.0, -12.0, 65.0, 32.0, 54.0, 21.0, 76.0, -23.0, 54.0, 32.0, -12.0, -45.0, -1.0, 54.0, 65.0, 10.0, 54.0, 10.0, -56.0, -45.0, -1.0, -78.0, -89.0, 10.0, -1.0, 54.0, 10.0, 21.0, -12.0, -1.0, 65.0, -1.0, -34.0, -12.0, -12.0, -12.0, -56.0, -100.0, -45.0, -34.0, 21.0, 4.0, -23.0, -45.0, -111.0, 10.0, 21.0, 32.0, -111.0, -1.0, 10.0, -1.0, 21.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2070676244462642, "mean_inference_ms": 9.939462232111971, "mean_action_processing_ms": 0.08817755288132918, "mean_env_wait_ms": 0.04552313277627084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005150794982910156, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.09267997741699219}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -1.72, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 43.0, 76.0, 43.0, 54.0, 54.0, 43.0, 65.0, -23.0, -89.0, 10.0, 21.0, -34.0, -1.0, 10.0, 54.0, -34.0, -89.0, -1.0, -23.0, -67.0, -1.0, 32.0, 10.0, -34.0, -45.0, 32.0, 32.0, -45.0, -56.0, -34.0, -133.0, -89.0, 21.0, 32.0, -1.0, -1.0, -45.0, -45.0, -1.0, 43.0, 32.0, 65.0, -1.0, 10.0, 32.0, -12.0, 65.0, 32.0, 54.0, 21.0, 76.0, -23.0, 54.0, 32.0, -12.0, -45.0, -1.0, 54.0, 65.0, 10.0, 54.0, 10.0, -56.0, -45.0, -1.0, -78.0, -89.0, 10.0, -1.0, 54.0, 10.0, 21.0, -12.0, -1.0, 65.0, -1.0, -34.0, -12.0, -12.0, -12.0, -56.0, -100.0, -45.0, -34.0, 21.0, 4.0, -23.0, -45.0, -111.0, 10.0, 21.0, 32.0, -111.0, -1.0, 10.0, -1.0, 21.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2070676244462642, "mean_inference_ms": 9.939462232111971, "mean_action_processing_ms": 0.08817755288132918, "mean_env_wait_ms": 0.04552313277627084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005150794982910156, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.09267997741699219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 75519.288, "sample_time_ms": 41020.132, "learn_time_ms": 34490.04, "learn_throughput": 115.976, "synch_weights_time_ms": 8.579}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 1210, "training_iteration": 23, "trial_id": "38794_00003", "date": "2023-06-01_23-15-14", "timestamp": 1685650514, "time_this_iter_s": 83.70905327796936, "time_total_s": 1918.2274088859558, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1918.2274088859558, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 49.83418803418804, "ram_util_percent": 72.01709401709404}}
{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -78.0, "episode_reward_mean": -20.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, 10.0, -23.0, -34.0, -23.0, -78.0, -1.0, -34.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19226461889111063, "mean_inference_ms": 9.83600746898443, "mean_action_processing_ms": 0.08673504788156312, "mean_env_wait_ms": 0.043194137522215036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051021575927734375, "StateBufferConnector_ms": 0.0029587745666503906, "ViewRequirementAgentConnector_ms": 0.09180545806884766}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.480771064758301, "policy_loss": -0.029061956331133842, "vf_loss": 6.504427909851074, "vf_explained_var": 0.007064043544232845, "kl": 0.01801534928381443, "entropy": 2.6917474269866943, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 5.87, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 54.0, 32.0, -12.0, -45.0, -1.0, 54.0, 65.0, 10.0, 54.0, 10.0, -56.0, -45.0, -1.0, -78.0, -89.0, 10.0, -1.0, 54.0, 10.0, 21.0, -12.0, -1.0, 65.0, -1.0, -34.0, -12.0, -12.0, -12.0, -56.0, -100.0, -45.0, -34.0, 21.0, 4.0, -23.0, -45.0, -111.0, 10.0, 21.0, 32.0, -111.0, -1.0, 10.0, -1.0, 21.0, -45.0, -12.0, 10.0, 21.0, 43.0, -23.0, 43.0, -1.0, -12.0, 76.0, 65.0, 54.0, 32.0, 65.0, 43.0, -12.0, -1.0, 43.0, 65.0, 32.0, 32.0, 21.0, 76.0, 54.0, 43.0, -1.0, 10.0, 43.0, -1.0, -1.0, -34.0, 32.0, 54.0, 54.0, -45.0, 54.0, 21.0, 76.0, 10.0, 10.0, 10.0, -23.0, 10.0, -89.0, -1.0, 43.0, -12.0, -34.0, -12.0, 76.0, 54.0, -23.0, -12.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20702246300430385, "mean_inference_ms": 9.939275136263355, "mean_action_processing_ms": 0.08817472502942814, "mean_env_wait_ms": 0.04552924187107154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005215167999267578, "StateBufferConnector_ms": 0.003136873245239258, "ViewRequirementAgentConnector_ms": 0.09468460083007812}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 5.87, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 54.0, 32.0, -12.0, -45.0, -1.0, 54.0, 65.0, 10.0, 54.0, 10.0, -56.0, -45.0, -1.0, -78.0, -89.0, 10.0, -1.0, 54.0, 10.0, 21.0, -12.0, -1.0, 65.0, -1.0, -34.0, -12.0, -12.0, -12.0, -56.0, -100.0, -45.0, -34.0, 21.0, 4.0, -23.0, -45.0, -111.0, 10.0, 21.0, 32.0, -111.0, -1.0, 10.0, -1.0, 21.0, -45.0, -12.0, 10.0, 21.0, 43.0, -23.0, 43.0, -1.0, -12.0, 76.0, 65.0, 54.0, 32.0, 65.0, 43.0, -12.0, -1.0, 43.0, 65.0, 32.0, 32.0, 21.0, 76.0, 54.0, 43.0, -1.0, 10.0, 43.0, -1.0, -1.0, -34.0, 32.0, 54.0, 54.0, -45.0, 54.0, 21.0, 76.0, 10.0, 10.0, 10.0, -23.0, 10.0, -89.0, -1.0, 43.0, -12.0, -34.0, -12.0, 76.0, 54.0, -23.0, -12.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20702246300430385, "mean_inference_ms": 9.939275136263355, "mean_action_processing_ms": 0.08817472502942814, "mean_env_wait_ms": 0.04552924187107154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005215167999267578, "StateBufferConnector_ms": 0.003136873245239258, "ViewRequirementAgentConnector_ms": 0.09468460083007812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 75287.917, "sample_time_ms": 40991.031, "learn_time_ms": 34287.834, "learn_throughput": 116.659, "synch_weights_time_ms": 8.513}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 1263, "training_iteration": 24, "trial_id": "38794_00003", "date": "2023-06-01_23-16-38", "timestamp": 1685650598, "time_this_iter_s": 83.48512816429138, "time_total_s": 2001.7125370502472, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2001.7125370502472, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 43.061206896551724, "ram_util_percent": 70.15948275862068}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -122.0, "episode_reward_mean": -39.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.0, -89.0, -23.0, 43.0, -78.0, -1.0, -111.0, -23.0, -12.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19239995374308655, "mean_inference_ms": 9.857614883202816, "mean_action_processing_ms": 0.08676334541914657, "mean_env_wait_ms": 0.04321573583786503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049114227294921875, "StateBufferConnector_ms": 0.003077983856201172, "ViewRequirementAgentConnector_ms": 0.09554147720336914}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.199434757232666, "policy_loss": -0.02006843499839306, "vf_loss": 6.215245246887207, "vf_explained_var": 0.06510961055755615, "kl": 0.014194369316101074, "entropy": 2.604362964630127, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 20.56, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -1.0, -12.0, 76.0, 65.0, 54.0, 32.0, 65.0, 43.0, -12.0, -1.0, 43.0, 65.0, 32.0, 32.0, 21.0, 76.0, 54.0, 43.0, -1.0, 10.0, 43.0, -1.0, -1.0, -34.0, 32.0, 54.0, 54.0, -45.0, 54.0, 21.0, 76.0, 10.0, 10.0, 10.0, -23.0, 10.0, -89.0, -1.0, 43.0, -12.0, -34.0, -12.0, 76.0, 54.0, -23.0, -12.0, 10.0, -67.0, -1.0, -1.0, 65.0, 32.0, 43.0, 54.0, 65.0, 76.0, 54.0, 32.0, 21.0, 54.0, 10.0, -34.0, 10.0, 43.0, -1.0, 43.0, -12.0, -56.0, -67.0, -56.0, 32.0, -12.0, 10.0, 65.0, 32.0, 32.0, 76.0, 32.0, 32.0, -23.0, 65.0, -45.0, -100.0, 43.0, 21.0, -1.0, -1.0, 10.0, 10.0, 65.0, 43.0, 65.0, 43.0, 43.0, 65.0, -45.0, 65.0, 65.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20703644428635257, "mean_inference_ms": 9.942863019978452, "mean_action_processing_ms": 0.08819364832464727, "mean_env_wait_ms": 0.04555330265931541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052661895751953125, "StateBufferConnector_ms": 0.0031130313873291016, "ViewRequirementAgentConnector_ms": 0.09493637084960938}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 20.56, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, -1.0, -12.0, 76.0, 65.0, 54.0, 32.0, 65.0, 43.0, -12.0, -1.0, 43.0, 65.0, 32.0, 32.0, 21.0, 76.0, 54.0, 43.0, -1.0, 10.0, 43.0, -1.0, -1.0, -34.0, 32.0, 54.0, 54.0, -45.0, 54.0, 21.0, 76.0, 10.0, 10.0, 10.0, -23.0, 10.0, -89.0, -1.0, 43.0, -12.0, -34.0, -12.0, 76.0, 54.0, -23.0, -12.0, 10.0, -67.0, -1.0, -1.0, 65.0, 32.0, 43.0, 54.0, 65.0, 76.0, 54.0, 32.0, 21.0, 54.0, 10.0, -34.0, 10.0, 43.0, -1.0, 43.0, -12.0, -56.0, -67.0, -56.0, 32.0, -12.0, 10.0, 65.0, 32.0, 32.0, 76.0, 32.0, 32.0, -23.0, 65.0, -45.0, -100.0, 43.0, 21.0, -1.0, -1.0, 10.0, 10.0, 65.0, 43.0, 65.0, 43.0, 43.0, 65.0, -45.0, 65.0, 65.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20703644428635257, "mean_inference_ms": 9.942863019978452, "mean_action_processing_ms": 0.08819364832464727, "mean_env_wait_ms": 0.04555330265931541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052661895751953125, "StateBufferConnector_ms": 0.0031130313873291016, "ViewRequirementAgentConnector_ms": 0.09493637084960938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 75695.408, "sample_time_ms": 41298.364, "learn_time_ms": 34389.259, "learn_throughput": 116.315, "synch_weights_time_ms": 7.263}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 1315, "training_iteration": 25, "trial_id": "38794_00003", "date": "2023-06-01_23-18-02", "timestamp": 1685650682, "time_this_iter_s": 84.0800187587738, "time_total_s": 2085.792555809021, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2085.792555809021, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 47.13474576271188, "ram_util_percent": 71.24406779661018}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -23.0, "episode_reward_mean": 13.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, -23.0, 10.0, -12.0, -12.0, 65.0, 54.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19256328198417624, "mean_inference_ms": 9.859608189851297, "mean_action_processing_ms": 0.08683358842946155, "mean_env_wait_ms": 0.043281677081622213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005373954772949219, "StateBufferConnector_ms": 0.003216266632080078, "ViewRequirementAgentConnector_ms": 0.09381771087646484}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.215878963470459, "policy_loss": -0.021059740334749222, "vf_loss": 6.231932640075684, "vf_explained_var": 0.05868222936987877, "kl": 0.016684452071785927, "entropy": 2.5456488132476807, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 21.98, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 54.0, 65.0, 76.0, 54.0, 32.0, 21.0, 54.0, 10.0, -34.0, 10.0, 43.0, -1.0, 43.0, -12.0, -56.0, -67.0, -56.0, 32.0, -12.0, 10.0, 65.0, 32.0, 32.0, 76.0, 32.0, 32.0, -23.0, 65.0, -45.0, -100.0, 43.0, 21.0, -1.0, -1.0, 10.0, 10.0, 65.0, 43.0, 65.0, 43.0, 43.0, 65.0, -45.0, 65.0, 65.0, 65.0, 54.0, 54.0, 43.0, 76.0, 76.0, 65.0, 21.0, 65.0, 54.0, -23.0, -40.0, 21.0, -12.0, 21.0, 54.0, 54.0, 76.0, 76.0, 54.0, 76.0, 32.0, 15.0, 10.0, 43.0, -67.0, -45.0, 43.0, 65.0, 32.0, 43.0, 32.0, 21.0, -1.0, 21.0, 10.0, -34.0, 10.0, -78.0, 21.0, 10.0, -1.0, -23.0, 43.0, -12.0, -1.0, -45.0, 10.0, -34.0, -12.0, 65.0, 54.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20685451291748236, "mean_inference_ms": 9.939597980760768, "mean_action_processing_ms": 0.08812328780342789, "mean_env_wait_ms": 0.045512252665818966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005079746246337891, "StateBufferConnector_ms": 0.0029931068420410156, "ViewRequirementAgentConnector_ms": 0.09296774864196777}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 21.98, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 54.0, 65.0, 76.0, 54.0, 32.0, 21.0, 54.0, 10.0, -34.0, 10.0, 43.0, -1.0, 43.0, -12.0, -56.0, -67.0, -56.0, 32.0, -12.0, 10.0, 65.0, 32.0, 32.0, 76.0, 32.0, 32.0, -23.0, 65.0, -45.0, -100.0, 43.0, 21.0, -1.0, -1.0, 10.0, 10.0, 65.0, 43.0, 65.0, 43.0, 43.0, 65.0, -45.0, 65.0, 65.0, 65.0, 54.0, 54.0, 43.0, 76.0, 76.0, 65.0, 21.0, 65.0, 54.0, -23.0, -40.0, 21.0, -12.0, 21.0, 54.0, 54.0, 76.0, 76.0, 54.0, 76.0, 32.0, 15.0, 10.0, 43.0, -67.0, -45.0, 43.0, 65.0, 32.0, 43.0, 32.0, 21.0, -1.0, 21.0, 10.0, -34.0, 10.0, -78.0, 21.0, 10.0, -1.0, -23.0, 43.0, -12.0, -1.0, -45.0, 10.0, -34.0, -12.0, 65.0, 54.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20685451291748236, "mean_inference_ms": 9.939597980760768, "mean_action_processing_ms": 0.08812328780342789, "mean_env_wait_ms": 0.045512252665818966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005079746246337891, "StateBufferConnector_ms": 0.0029931068420410156, "ViewRequirementAgentConnector_ms": 0.09296774864196777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 75680.062, "sample_time_ms": 41250.611, "learn_time_ms": 34421.642, "learn_throughput": 116.206, "synch_weights_time_ms": 7.286}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 1368, "training_iteration": 26, "trial_id": "38794_00003", "date": "2023-06-01_23-19-25", "timestamp": 1685650765, "time_this_iter_s": 83.71559190750122, "time_total_s": 2169.508147716522, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2169.508147716522, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 45.286206896551725, "ram_util_percent": 72.26379310344826}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, 21.0, 32.0, 32.0, -23.0, 43.0, 54.0, -45.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1925279578179227, "mean_inference_ms": 9.846118486251152, "mean_action_processing_ms": 0.08682590973701956, "mean_env_wait_ms": 0.04326054636401906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005097389221191406, "StateBufferConnector_ms": 0.0034570693969726562, "ViewRequirementAgentConnector_ms": 0.0897979736328125}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.027592658996582, "policy_loss": -0.022155098617076874, "vf_loss": 7.044886112213135, "vf_explained_var": 0.04311426356434822, "kl": 0.01620355248451233, "entropy": 2.626411199569702, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 10.43, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 65.0, 54.0, -23.0, -40.0, 21.0, -12.0, 21.0, 54.0, 54.0, 76.0, 76.0, 54.0, 76.0, 32.0, 15.0, 10.0, 43.0, -67.0, -45.0, 43.0, 65.0, 32.0, 43.0, 32.0, 21.0, -1.0, 21.0, 10.0, -34.0, 10.0, -78.0, 21.0, 10.0, -1.0, -23.0, 43.0, -12.0, -1.0, -45.0, 10.0, -34.0, -12.0, 65.0, 54.0, 43.0, 32.0, 32.0, 54.0, 43.0, 65.0, 43.0, 10.0, -56.0, -45.0, -45.0, -56.0, 43.0, -56.0, 10.0, 54.0, 65.0, -1.0, 65.0, 21.0, 76.0, 43.0, 10.0, -23.0, 21.0, -56.0, -56.0, -1.0, -78.0, -45.0, -56.0, -34.0, 10.0, 54.0, 54.0, -1.0, 54.0, -23.0, -34.0, 76.0, 32.0, 32.0, 21.0, 10.0, -45.0, -78.0, 21.0, -56.0, -56.0, 32.0, 32.0, 43.0, 10.0, 32.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20663506119163466, "mean_inference_ms": 9.93192625702418, "mean_action_processing_ms": 0.08803203647707832, "mean_env_wait_ms": 0.0454498153738611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004970073699951172, "StateBufferConnector_ms": 0.0029861927032470703, "ViewRequirementAgentConnector_ms": 0.0913090705871582}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 10.43, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 65.0, 54.0, -23.0, -40.0, 21.0, -12.0, 21.0, 54.0, 54.0, 76.0, 76.0, 54.0, 76.0, 32.0, 15.0, 10.0, 43.0, -67.0, -45.0, 43.0, 65.0, 32.0, 43.0, 32.0, 21.0, -1.0, 21.0, 10.0, -34.0, 10.0, -78.0, 21.0, 10.0, -1.0, -23.0, 43.0, -12.0, -1.0, -45.0, 10.0, -34.0, -12.0, 65.0, 54.0, 43.0, 32.0, 32.0, 54.0, 43.0, 65.0, 43.0, 10.0, -56.0, -45.0, -45.0, -56.0, 43.0, -56.0, 10.0, 54.0, 65.0, -1.0, 65.0, 21.0, 76.0, 43.0, 10.0, -23.0, 21.0, -56.0, -56.0, -1.0, -78.0, -45.0, -56.0, -34.0, 10.0, 54.0, 54.0, -1.0, 54.0, -23.0, -34.0, 76.0, 32.0, 32.0, 21.0, 10.0, -45.0, -78.0, 21.0, -56.0, -56.0, 32.0, 32.0, 43.0, 10.0, 32.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20663506119163466, "mean_inference_ms": 9.93192625702418, "mean_action_processing_ms": 0.08803203647707832, "mean_env_wait_ms": 0.0454498153738611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004970073699951172, "StateBufferConnector_ms": 0.0029861927032470703, "ViewRequirementAgentConnector_ms": 0.0913090705871582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 75487.045, "sample_time_ms": 41002.758, "learn_time_ms": 34476.478, "learn_throughput": 116.021, "synch_weights_time_ms": 7.286}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1421, "training_iteration": 27, "trial_id": "38794_00003", "date": "2023-06-01_23-20-47", "timestamp": 1685650847, "time_this_iter_s": 81.6850790977478, "time_total_s": 2251.19322681427, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2251.19322681427, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 43.54385964912281, "ram_util_percent": 72.2719298245614}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 6.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -78.0, 43.0, 10.0, 76.0, 43.0, 43.0, -67.0, -122.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1926747464544371, "mean_inference_ms": 9.872940371882496, "mean_action_processing_ms": 0.08687900872860381, "mean_env_wait_ms": 0.04330499689469554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005214214324951172, "StateBufferConnector_ms": 0.002949237823486328, "ViewRequirementAgentConnector_ms": 0.09661197662353516}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 5.877313613891602, "policy_loss": -0.02405073307454586, "vf_loss": 5.896585464477539, "vf_explained_var": 0.1680687963962555, "kl": 0.015930257737636566, "entropy": 2.6217739582061768, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 9.61, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -56.0, -45.0, -45.0, -56.0, 43.0, -56.0, 10.0, 54.0, 65.0, -1.0, 65.0, 21.0, 76.0, 43.0, 10.0, -23.0, 21.0, -56.0, -56.0, -1.0, -78.0, -45.0, -56.0, -34.0, 10.0, 54.0, 54.0, -1.0, 54.0, -23.0, -34.0, 76.0, 32.0, 32.0, 21.0, 10.0, -45.0, -78.0, 21.0, -56.0, -56.0, 32.0, 32.0, 43.0, 10.0, 32.0, -23.0, 37.0, 21.0, 43.0, 32.0, -23.0, 32.0, 21.0, 65.0, 76.0, -1.0, 65.0, 54.0, 65.0, 54.0, 54.0, -78.0, 10.0, -78.0, -78.0, -111.0, -45.0, -12.0, -1.0, -78.0, -23.0, -89.0, -1.0, 21.0, 10.0, -23.0, -1.0, 21.0, 32.0, 65.0, 76.0, 65.0, 65.0, 21.0, 54.0, 65.0, 76.0, 43.0, 43.0, 54.0, -1.0, 65.0, 43.0, 54.0, 32.0, 32.0, 32.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20656698189676795, "mean_inference_ms": 9.927789398730912, "mean_action_processing_ms": 0.0880256502549709, "mean_env_wait_ms": 0.04543369723734291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050506591796875, "StateBufferConnector_ms": 0.0031790733337402344, "ViewRequirementAgentConnector_ms": 0.09270167350769043}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 9.61, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -56.0, -45.0, -45.0, -56.0, 43.0, -56.0, 10.0, 54.0, 65.0, -1.0, 65.0, 21.0, 76.0, 43.0, 10.0, -23.0, 21.0, -56.0, -56.0, -1.0, -78.0, -45.0, -56.0, -34.0, 10.0, 54.0, 54.0, -1.0, 54.0, -23.0, -34.0, 76.0, 32.0, 32.0, 21.0, 10.0, -45.0, -78.0, 21.0, -56.0, -56.0, 32.0, 32.0, 43.0, 10.0, 32.0, -23.0, 37.0, 21.0, 43.0, 32.0, -23.0, 32.0, 21.0, 65.0, 76.0, -1.0, 65.0, 54.0, 65.0, 54.0, 54.0, -78.0, 10.0, -78.0, -78.0, -111.0, -45.0, -12.0, -1.0, -78.0, -23.0, -89.0, -1.0, 21.0, 10.0, -23.0, -1.0, 21.0, 32.0, 65.0, 76.0, 65.0, 65.0, 21.0, 54.0, 65.0, 76.0, 43.0, 43.0, 54.0, -1.0, 65.0, 43.0, 54.0, 32.0, 32.0, 32.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20656698189676795, "mean_inference_ms": 9.927789398730912, "mean_action_processing_ms": 0.0880256502549709, "mean_env_wait_ms": 0.04543369723734291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050506591796875, "StateBufferConnector_ms": 0.0031790733337402344, "ViewRequirementAgentConnector_ms": 0.09270167350769043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 75445.848, "sample_time_ms": 40878.933, "learn_time_ms": 34559.058, "learn_throughput": 115.744, "synch_weights_time_ms": 7.342}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1473, "training_iteration": 28, "trial_id": "38794_00003", "date": "2023-06-01_23-22-11", "timestamp": 1685650931, "time_this_iter_s": 83.79903888702393, "time_total_s": 2334.992265701294, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2334.992265701294, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 42.6145299145299, "ram_util_percent": 72.64102564102564}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 3.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 76.0, 65.0, 65.0, -23.0, -12.0, 32.0, -100.0, -100.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.192566957703509, "mean_inference_ms": 9.858920901836651, "mean_action_processing_ms": 0.08682932926605644, "mean_env_wait_ms": 0.04328740745895079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004646778106689453, "StateBufferConnector_ms": 0.0031304359436035156, "ViewRequirementAgentConnector_ms": 0.09009599685668945}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.709555149078369, "policy_loss": -0.028325382620096207, "vf_loss": 6.732092380523682, "vf_explained_var": 0.027869204059243202, "kl": 0.01929406076669693, "entropy": 2.575523853302002, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, 65.0, 76.0, -1.0, 65.0, 54.0, 65.0, 54.0, 54.0, -78.0, 10.0, -78.0, -78.0, -111.0, -45.0, -12.0, -1.0, -78.0, -23.0, -89.0, -1.0, 21.0, 10.0, -23.0, -1.0, 21.0, 32.0, 65.0, 76.0, 65.0, 65.0, 21.0, 54.0, 65.0, 76.0, 43.0, 43.0, 54.0, -1.0, 65.0, 43.0, 54.0, 32.0, 32.0, 32.0, -1.0, 10.0, 43.0, 10.0, -12.0, 10.0, 10.0, -56.0, -1.0, -12.0, -23.0, 21.0, 10.0, 10.0, -12.0, 54.0, 43.0, 43.0, -12.0, 21.0, -1.0, 10.0, -23.0, -23.0, 43.0, -1.0, 21.0, -45.0, 10.0, -23.0, 54.0, 21.0, 54.0, 76.0, 10.0, 43.0, 32.0, 54.0, -12.0, 21.0, 32.0, 32.0, 32.0, 43.0, 10.0, 10.0, -12.0, -34.0, -34.0, 32.0, 54.0, 65.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20651418462273938, "mean_inference_ms": 9.926333337176077, "mean_action_processing_ms": 0.08800048992771295, "mean_env_wait_ms": 0.045430661479887655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005159616470336914, "StateBufferConnector_ms": 0.003173351287841797, "ViewRequirementAgentConnector_ms": 0.09493565559387207}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 21.0, 65.0, 76.0, -1.0, 65.0, 54.0, 65.0, 54.0, 54.0, -78.0, 10.0, -78.0, -78.0, -111.0, -45.0, -12.0, -1.0, -78.0, -23.0, -89.0, -1.0, 21.0, 10.0, -23.0, -1.0, 21.0, 32.0, 65.0, 76.0, 65.0, 65.0, 21.0, 54.0, 65.0, 76.0, 43.0, 43.0, 54.0, -1.0, 65.0, 43.0, 54.0, 32.0, 32.0, 32.0, -1.0, 10.0, 43.0, 10.0, -12.0, 10.0, 10.0, -56.0, -1.0, -12.0, -23.0, 21.0, 10.0, 10.0, -12.0, 54.0, 43.0, 43.0, -12.0, 21.0, -1.0, 10.0, -23.0, -23.0, 43.0, -1.0, 21.0, -45.0, 10.0, -23.0, 54.0, 21.0, 54.0, 76.0, 10.0, 43.0, 32.0, 54.0, -12.0, 21.0, 32.0, 32.0, 32.0, 43.0, 10.0, 10.0, -12.0, -34.0, -34.0, 32.0, 54.0, 65.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20651418462273938, "mean_inference_ms": 9.926333337176077, "mean_action_processing_ms": 0.08800048992771295, "mean_env_wait_ms": 0.045430661479887655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005159616470336914, "StateBufferConnector_ms": 0.003173351287841797, "ViewRequirementAgentConnector_ms": 0.09493565559387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 75273.84, "sample_time_ms": 40842.777, "learn_time_ms": 34423.087, "learn_throughput": 116.201, "synch_weights_time_ms": 7.445}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1526, "training_iteration": 29, "trial_id": "38794_00003", "date": "2023-06-01_23-23-32", "timestamp": 1685651012, "time_this_iter_s": 81.45919704437256, "time_total_s": 2416.4514627456665, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2416.4514627456665, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 45.664912280701756, "ram_util_percent": 73.07719298245615}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -89.0, "episode_reward_mean": -18.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -34.0, -45.0, -12.0, -34.0, -34.0, -45.0, 43.0, 32.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19240579052581258, "mean_inference_ms": 9.88662013369304, "mean_action_processing_ms": 0.08668392814307312, "mean_env_wait_ms": 0.043221761414808255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005741119384765625, "StateBufferConnector_ms": 0.003039836883544922, "ViewRequirementAgentConnector_ms": 0.09036540985107422}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.413541793823242, "policy_loss": -0.01937825046479702, "vf_loss": 6.427948951721191, "vf_explained_var": -0.00616472540423274, "kl": 0.016569949686527252, "entropy": 2.545897960662842, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 18.69, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -56.0, -1.0, -12.0, -23.0, 21.0, 10.0, 10.0, -12.0, 54.0, 43.0, 43.0, -12.0, 21.0, -1.0, 10.0, -23.0, -23.0, 43.0, -1.0, 21.0, -45.0, 10.0, -23.0, 54.0, 21.0, 54.0, 76.0, 10.0, 43.0, 32.0, 54.0, -12.0, 21.0, 32.0, 32.0, 32.0, 43.0, 10.0, 10.0, -12.0, -34.0, -34.0, 32.0, 54.0, 65.0, 65.0, 43.0, 21.0, -12.0, -45.0, 65.0, 43.0, 32.0, 43.0, 54.0, 10.0, 10.0, -56.0, -23.0, -34.0, -23.0, -34.0, -78.0, 32.0, 65.0, 21.0, -12.0, 10.0, 21.0, 65.0, 65.0, -1.0, 43.0, 76.0, 65.0, 43.0, -1.0, -1.0, 43.0, -1.0, 43.0, -12.0, -23.0, 21.0, 54.0, 65.0, 54.0, 65.0, -34.0, 32.0, 65.0, 21.0, -12.0, 32.0, 43.0, 65.0, 76.0, -23.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20650763627166271, "mean_inference_ms": 9.92311141853229, "mean_action_processing_ms": 0.08801133522605797, "mean_env_wait_ms": 0.0454472159824911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005209207534790039, "StateBufferConnector_ms": 0.003144979476928711, "ViewRequirementAgentConnector_ms": 0.0951075553894043}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 18.69, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -56.0, -1.0, -12.0, -23.0, 21.0, 10.0, 10.0, -12.0, 54.0, 43.0, 43.0, -12.0, 21.0, -1.0, 10.0, -23.0, -23.0, 43.0, -1.0, 21.0, -45.0, 10.0, -23.0, 54.0, 21.0, 54.0, 76.0, 10.0, 43.0, 32.0, 54.0, -12.0, 21.0, 32.0, 32.0, 32.0, 43.0, 10.0, 10.0, -12.0, -34.0, -34.0, 32.0, 54.0, 65.0, 65.0, 43.0, 21.0, -12.0, -45.0, 65.0, 43.0, 32.0, 43.0, 54.0, 10.0, 10.0, -56.0, -23.0, -34.0, -23.0, -34.0, -78.0, 32.0, 65.0, 21.0, -12.0, 10.0, 21.0, 65.0, 65.0, -1.0, 43.0, 76.0, 65.0, 43.0, -1.0, -1.0, 43.0, -1.0, 43.0, -12.0, -23.0, 21.0, 54.0, 65.0, 54.0, 65.0, -34.0, 32.0, 65.0, 21.0, -12.0, 32.0, 43.0, 65.0, 76.0, -23.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20650763627166271, "mean_inference_ms": 9.92311141853229, "mean_action_processing_ms": 0.08801133522605797, "mean_env_wait_ms": 0.0454472159824911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005209207534790039, "StateBufferConnector_ms": 0.003144979476928711, "ViewRequirementAgentConnector_ms": 0.0951075553894043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 75256.09, "sample_time_ms": 40798.816, "learn_time_ms": 34449.567, "learn_throughput": 116.112, "synch_weights_time_ms": 7.187}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1578, "training_iteration": 30, "trial_id": "38794_00003", "date": "2023-06-01_23-24-55", "timestamp": 1685651095, "time_this_iter_s": 83.05007600784302, "time_total_s": 2499.5015387535095, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2499.5015387535095, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 46.96465517241379, "ram_util_percent": 72.50689655172413}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -23.0, "episode_reward_mean": 19.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, -12.0, 21.0, 21.0, 32.0, -23.0, 10.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1926008952017637, "mean_inference_ms": 9.876732338284866, "mean_action_processing_ms": 0.08673188459801859, "mean_env_wait_ms": 0.04325753526034731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005326271057128906, "StateBufferConnector_ms": 0.0032758712768554688, "ViewRequirementAgentConnector_ms": 0.09415626525878906}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.498205661773682, "policy_loss": -0.03341909870505333, "vf_loss": 7.526063442230225, "vf_explained_var": 0.026527421548962593, "kl": 0.018538150936365128, "entropy": 2.57769513130188, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 3.51, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 54.0, 10.0, 10.0, -56.0, -23.0, -34.0, -23.0, -34.0, -78.0, 32.0, 65.0, 21.0, -12.0, 10.0, 21.0, 65.0, 65.0, -1.0, 43.0, 76.0, 65.0, 43.0, -1.0, -1.0, 43.0, -1.0, 43.0, -12.0, -23.0, 21.0, 54.0, 65.0, 54.0, 65.0, -34.0, 32.0, 65.0, 21.0, -12.0, 32.0, 43.0, 65.0, 76.0, -23.0, 76.0, -1.0, 21.0, 65.0, -1.0, -12.0, 43.0, -1.0, -45.0, -56.0, -100.0, -45.0, -78.0, -111.0, -100.0, 21.0, -23.0, -111.0, -23.0, -23.0, 43.0, 32.0, -1.0, -1.0, 32.0, 65.0, 10.0, -34.0, -12.0, 43.0, -89.0, 65.0, -1.0, 10.0, -1.0, 10.0, 32.0, 21.0, 54.0, 43.0, -34.0, -122.0, -23.0, -122.0, -1.0, -34.0, 10.0, 32.0, -1.0, 10.0, -100.0, -67.0, 43.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20640495494624694, "mean_inference_ms": 9.922049453882893, "mean_action_processing_ms": 0.08795990224293317, "mean_env_wait_ms": 0.04543899501541718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005069732666015625, "StateBufferConnector_ms": 0.003123760223388672, "ViewRequirementAgentConnector_ms": 0.09327912330627441}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 3.51, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 54.0, 10.0, 10.0, -56.0, -23.0, -34.0, -23.0, -34.0, -78.0, 32.0, 65.0, 21.0, -12.0, 10.0, 21.0, 65.0, 65.0, -1.0, 43.0, 76.0, 65.0, 43.0, -1.0, -1.0, 43.0, -1.0, 43.0, -12.0, -23.0, 21.0, 54.0, 65.0, 54.0, 65.0, -34.0, 32.0, 65.0, 21.0, -12.0, 32.0, 43.0, 65.0, 76.0, -23.0, 76.0, -1.0, 21.0, 65.0, -1.0, -12.0, 43.0, -1.0, -45.0, -56.0, -100.0, -45.0, -78.0, -111.0, -100.0, 21.0, -23.0, -111.0, -23.0, -23.0, 43.0, 32.0, -1.0, -1.0, 32.0, 65.0, 10.0, -34.0, -12.0, 43.0, -89.0, 65.0, -1.0, 10.0, -1.0, 10.0, 32.0, 21.0, 54.0, 43.0, -34.0, -122.0, -23.0, -122.0, -1.0, -34.0, 10.0, 32.0, -1.0, 10.0, -100.0, -67.0, 43.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20640495494624694, "mean_inference_ms": 9.922049453882893, "mean_action_processing_ms": 0.08795990224293317, "mean_env_wait_ms": 0.04543899501541718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005069732666015625, "StateBufferConnector_ms": 0.003123760223388672, "ViewRequirementAgentConnector_ms": 0.09327912330627441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 75106.675, "sample_time_ms": 40788.279, "learn_time_ms": 34310.739, "learn_throughput": 116.582, "synch_weights_time_ms": 7.14}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1631, "training_iteration": 31, "trial_id": "38794_00003", "date": "2023-06-01_23-26-18", "timestamp": 1685651178, "time_this_iter_s": 82.62911176681519, "time_total_s": 2582.1306505203247, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2582.1306505203247, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 43.848695652173916, "ram_util_percent": 70.81304347826087}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -1.0, "episode_reward_mean": 40.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 43.0, 43.0, 32.0, 76.0, -1.0, 43.0, 76.0, 76.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19252533083521592, "mean_inference_ms": 9.873511666633217, "mean_action_processing_ms": 0.08667706904072722, "mean_env_wait_ms": 0.04322750092650669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005679130554199219, "StateBufferConnector_ms": 0.003070831298828125, "ViewRequirementAgentConnector_ms": 0.09155750274658203}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.626418113708496, "policy_loss": -0.02883722633123398, "vf_loss": 6.64994478225708, "vf_explained_var": 0.04907561093568802, "kl": 0.01770051009953022, "entropy": 2.5034444332122803, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": -133.0, "episode_reward_mean": -1.77, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -45.0, -56.0, -100.0, -45.0, -78.0, -111.0, -100.0, 21.0, -23.0, -111.0, -23.0, -23.0, 43.0, 32.0, -1.0, -1.0, 32.0, 65.0, 10.0, -34.0, -12.0, 43.0, -89.0, 65.0, -1.0, 10.0, -1.0, 10.0, 32.0, 21.0, 54.0, 43.0, -34.0, -122.0, -23.0, -122.0, -1.0, -34.0, 10.0, 32.0, -1.0, 10.0, -100.0, -67.0, 43.0, -23.0, -45.0, -23.0, 21.0, 21.0, 43.0, 43.0, 32.0, 32.0, 54.0, 54.0, 65.0, 43.0, 10.0, 32.0, 43.0, 21.0, 65.0, 65.0, -34.0, 21.0, -34.0, 10.0, -23.0, 32.0, 10.0, 65.0, 21.0, 32.0, 43.0, 32.0, 10.0, -56.0, -133.0, -12.0, -89.0, -23.0, -45.0, -23.0, 21.0, 32.0, 65.0, 43.0, 32.0, -12.0, -1.0, 43.0, -1.0, 21.0, -34.0, 32.0, 10.0, 32.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20643768908419338, "mean_inference_ms": 9.926329365331268, "mean_action_processing_ms": 0.08798211782664091, "mean_env_wait_ms": 0.04546485577123674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052642822265625, "StateBufferConnector_ms": 0.0031616687774658203, "ViewRequirementAgentConnector_ms": 0.0966038703918457}}, "episode_reward_max": 65.0, "episode_reward_min": -133.0, "episode_reward_mean": -1.77, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -45.0, -56.0, -100.0, -45.0, -78.0, -111.0, -100.0, 21.0, -23.0, -111.0, -23.0, -23.0, 43.0, 32.0, -1.0, -1.0, 32.0, 65.0, 10.0, -34.0, -12.0, 43.0, -89.0, 65.0, -1.0, 10.0, -1.0, 10.0, 32.0, 21.0, 54.0, 43.0, -34.0, -122.0, -23.0, -122.0, -1.0, -34.0, 10.0, 32.0, -1.0, 10.0, -100.0, -67.0, 43.0, -23.0, -45.0, -23.0, 21.0, 21.0, 43.0, 43.0, 32.0, 32.0, 54.0, 54.0, 65.0, 43.0, 10.0, 32.0, 43.0, 21.0, 65.0, 65.0, -34.0, 21.0, -34.0, 10.0, -23.0, 32.0, 10.0, 65.0, 21.0, 32.0, 43.0, 32.0, 10.0, -56.0, -133.0, -12.0, -89.0, -23.0, -45.0, -23.0, 21.0, 32.0, 65.0, 43.0, 32.0, -12.0, -1.0, 43.0, -1.0, 21.0, -34.0, 32.0, 10.0, 32.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20643768908419338, "mean_inference_ms": 9.926329365331268, "mean_action_processing_ms": 0.08798211782664091, "mean_env_wait_ms": 0.04546485577123674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052642822265625, "StateBufferConnector_ms": 0.0031616687774658203, "ViewRequirementAgentConnector_ms": 0.0966038703918457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 75274.561, "sample_time_ms": 40987.887, "learn_time_ms": 34279.064, "learn_throughput": 116.689, "synch_weights_time_ms": 7.088}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1684, "training_iteration": 32, "trial_id": "38794_00003", "date": "2023-06-01_23-27-42", "timestamp": 1685651262, "time_this_iter_s": 83.83446717262268, "time_total_s": 2665.9651176929474, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2665.9651176929474, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 48.46068376068376, "ram_util_percent": 72.17606837606839}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 65.0, 65.0, 54.0, 32.0, 21.0, -1.0, -34.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19244603774967833, "mean_inference_ms": 9.861071407022594, "mean_action_processing_ms": 0.0866027707465361, "mean_env_wait_ms": 0.04319261361012584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005490779876708984, "StateBufferConnector_ms": 0.0029611587524414062, "ViewRequirementAgentConnector_ms": 0.09279012680053711}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.197780132293701, "policy_loss": -0.023561080917716026, "vf_loss": 6.216403484344482, "vf_explained_var": 0.035017967224121094, "kl": 0.016459641978144646, "entropy": 2.6120197772979736, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 19.57, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, 32.0, 54.0, 54.0, 65.0, 43.0, 10.0, 32.0, 43.0, 21.0, 65.0, 65.0, -34.0, 21.0, -34.0, 10.0, -23.0, 32.0, 10.0, 65.0, 21.0, 32.0, 43.0, 32.0, 10.0, -56.0, -133.0, -12.0, -89.0, -23.0, -45.0, -23.0, 21.0, 32.0, 65.0, 43.0, 32.0, -12.0, -1.0, 43.0, -1.0, 21.0, -34.0, 32.0, 10.0, 32.0, -34.0, 21.0, 76.0, 54.0, 54.0, 65.0, 32.0, -1.0, 10.0, 32.0, 10.0, -23.0, -67.0, -34.0, 32.0, 21.0, 21.0, 54.0, 43.0, 65.0, 43.0, -34.0, -23.0, 32.0, -45.0, 21.0, -23.0, 65.0, -23.0, -12.0, 21.0, 43.0, 43.0, 65.0, -1.0, 32.0, 43.0, 43.0, 43.0, 32.0, 65.0, 21.0, -45.0, 43.0, 65.0, 32.0, 65.0, 76.0, 65.0, -1.0, 65.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20648639091608684, "mean_inference_ms": 9.93216016871911, "mean_action_processing_ms": 0.0880438299561229, "mean_env_wait_ms": 0.04549123552350023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005225181579589844, "StateBufferConnector_ms": 0.0031387805938720703, "ViewRequirementAgentConnector_ms": 0.09688377380371094}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 19.57, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 32.0, 32.0, 54.0, 54.0, 65.0, 43.0, 10.0, 32.0, 43.0, 21.0, 65.0, 65.0, -34.0, 21.0, -34.0, 10.0, -23.0, 32.0, 10.0, 65.0, 21.0, 32.0, 43.0, 32.0, 10.0, -56.0, -133.0, -12.0, -89.0, -23.0, -45.0, -23.0, 21.0, 32.0, 65.0, 43.0, 32.0, -12.0, -1.0, 43.0, -1.0, 21.0, -34.0, 32.0, 10.0, 32.0, -34.0, 21.0, 76.0, 54.0, 54.0, 65.0, 32.0, -1.0, 10.0, 32.0, 10.0, -23.0, -67.0, -34.0, 32.0, 21.0, 21.0, 54.0, 43.0, 65.0, 43.0, -34.0, -23.0, 32.0, -45.0, 21.0, -23.0, 65.0, -23.0, -12.0, 21.0, 43.0, 43.0, 65.0, -1.0, 32.0, 43.0, 43.0, 43.0, 32.0, 65.0, 21.0, -45.0, 43.0, 65.0, 32.0, 65.0, 76.0, 65.0, -1.0, 65.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20648639091608684, "mean_inference_ms": 9.93216016871911, "mean_action_processing_ms": 0.0880438299561229, "mean_env_wait_ms": 0.04549123552350023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005225181579589844, "StateBufferConnector_ms": 0.0031387805938720703, "ViewRequirementAgentConnector_ms": 0.09688377380371094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 75371.069, "sample_time_ms": 41125.051, "learn_time_ms": 34238.606, "learn_throughput": 116.827, "synch_weights_time_ms": 6.901}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1736, "training_iteration": 33, "trial_id": "38794_00003", "date": "2023-06-01_23-29-06", "timestamp": 1685651346, "time_this_iter_s": 84.04374194145203, "time_total_s": 2750.0088596343994, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2750.0088596343994, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 44.135897435897434, "ram_util_percent": 73.49145299145297}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -23.0, "episode_reward_mean": 16.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -23.0, 21.0, -7.0, 10.0, 43.0, 21.0, 65.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1924277542130201, "mean_inference_ms": 9.851485092911826, "mean_action_processing_ms": 0.08658947421875093, "mean_env_wait_ms": 0.0431867839889553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050449371337890625, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.09135723114013672}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.653428077697754, "policy_loss": -0.024338917806744576, "vf_loss": 6.6723103523254395, "vf_explained_var": 0.020900603383779526, "kl": 0.018189581111073494, "entropy": 2.4702913761138916, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 17.48, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -1.0, 10.0, 32.0, 10.0, -23.0, -67.0, -34.0, 32.0, 21.0, 21.0, 54.0, 43.0, 65.0, 43.0, -34.0, -23.0, 32.0, -45.0, 21.0, -23.0, 65.0, -23.0, -12.0, 21.0, 43.0, 43.0, 65.0, -1.0, 32.0, 43.0, 43.0, 43.0, 32.0, 65.0, 21.0, -45.0, 43.0, 65.0, 32.0, 65.0, 76.0, 65.0, -1.0, 65.0, 54.0, 10.0, -34.0, 21.0, 65.0, -1.0, -1.0, 21.0, 10.0, -12.0, 21.0, 43.0, -23.0, 10.0, -89.0, -1.0, -1.0, -12.0, 43.0, 76.0, 65.0, -23.0, 43.0, 32.0, -12.0, -23.0, -12.0, 21.0, 32.0, -12.0, 10.0, 21.0, 32.0, 32.0, -89.0, -78.0, 21.0, -1.0, -12.0, -1.0, 65.0, 76.0, -12.0, -23.0, 32.0, 10.0, 54.0, 43.0, 65.0, 10.0, 32.0, 65.0, 32.0, -12.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20648848751634374, "mean_inference_ms": 9.935646322124787, "mean_action_processing_ms": 0.0880654272740861, "mean_env_wait_ms": 0.04550614318159402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005168914794921875, "StateBufferConnector_ms": 0.003115415573120117, "ViewRequirementAgentConnector_ms": 0.09502506256103516}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 17.48, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -1.0, 10.0, 32.0, 10.0, -23.0, -67.0, -34.0, 32.0, 21.0, 21.0, 54.0, 43.0, 65.0, 43.0, -34.0, -23.0, 32.0, -45.0, 21.0, -23.0, 65.0, -23.0, -12.0, 21.0, 43.0, 43.0, 65.0, -1.0, 32.0, 43.0, 43.0, 43.0, 32.0, 65.0, 21.0, -45.0, 43.0, 65.0, 32.0, 65.0, 76.0, 65.0, -1.0, 65.0, 54.0, 10.0, -34.0, 21.0, 65.0, -1.0, -1.0, 21.0, 10.0, -12.0, 21.0, 43.0, -23.0, 10.0, -89.0, -1.0, -1.0, -12.0, 43.0, 76.0, 65.0, -23.0, 43.0, 32.0, -12.0, -23.0, -12.0, 21.0, 32.0, -12.0, 10.0, 21.0, 32.0, 32.0, -89.0, -78.0, 21.0, -1.0, -12.0, -1.0, 65.0, 76.0, -12.0, -23.0, 32.0, 10.0, 54.0, 43.0, 65.0, 10.0, 32.0, 65.0, 32.0, -12.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20648848751634374, "mean_inference_ms": 9.935646322124787, "mean_action_processing_ms": 0.0880654272740861, "mean_env_wait_ms": 0.04550614318159402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005168914794921875, "StateBufferConnector_ms": 0.003115415573120117, "ViewRequirementAgentConnector_ms": 0.09502506256103516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 75343.034, "sample_time_ms": 41085.989, "learn_time_ms": 34249.663, "learn_throughput": 116.789, "synch_weights_time_ms": 6.867}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1789, "training_iteration": 34, "trial_id": "38794_00003", "date": "2023-06-01_23-30-29", "timestamp": 1685651429, "time_this_iter_s": 83.23622798919678, "time_total_s": 2833.245087623596, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2833.245087623596, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 48.62564102564102, "ram_util_percent": 72.73760683760685}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": 8.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.0, 10.0, -1.0, -1.0, 21.0, -12.0, 65.0, 32.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19249457720728608, "mean_inference_ms": 9.862067838265643, "mean_action_processing_ms": 0.08656296450940924, "mean_env_wait_ms": 0.043200942825667873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004792213439941406, "StateBufferConnector_ms": 0.0029039382934570312, "ViewRequirementAgentConnector_ms": 0.09850740432739258}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.089305400848389, "policy_loss": -0.018004413694143295, "vf_loss": 7.102444648742676, "vf_explained_var": 0.030438879504799843, "kl": 0.016217773780226707, "entropy": 2.5480339527130127, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 2.41, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -12.0, 21.0, 43.0, -23.0, 10.0, -89.0, -1.0, -1.0, -12.0, 43.0, 76.0, 65.0, -23.0, 43.0, 32.0, -12.0, -23.0, -12.0, 21.0, 32.0, -12.0, 10.0, 21.0, 32.0, 32.0, -89.0, -78.0, 21.0, -1.0, -12.0, -1.0, 65.0, 76.0, -12.0, -23.0, 32.0, 10.0, 54.0, 43.0, 65.0, 10.0, 32.0, 65.0, 32.0, -12.0, 54.0, 76.0, -12.0, -67.0, 21.0, 54.0, 32.0, -45.0, 32.0, 32.0, 54.0, 65.0, -12.0, -12.0, 32.0, 21.0, 21.0, 21.0, 43.0, 10.0, 43.0, 21.0, 32.0, 43.0, -56.0, -100.0, -12.0, -89.0, -166.0, -89.0, -67.0, -34.0, -23.0, -155.0, 10.0, -89.0, -1.0, 54.0, 10.0, -34.0, -23.0, -23.0, 43.0, 54.0, 65.0, 32.0, -67.0, -34.0, 21.0, -56.0, -34.0, -89.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20653897829355417, "mean_inference_ms": 9.93585520292693, "mean_action_processing_ms": 0.08808392013199703, "mean_env_wait_ms": 0.04553127494458927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005263090133666992, "StateBufferConnector_ms": 0.003145933151245117, "ViewRequirementAgentConnector_ms": 0.09477829933166504}}, "episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 2.41, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -12.0, 21.0, 43.0, -23.0, 10.0, -89.0, -1.0, -1.0, -12.0, 43.0, 76.0, 65.0, -23.0, 43.0, 32.0, -12.0, -23.0, -12.0, 21.0, 32.0, -12.0, 10.0, 21.0, 32.0, 32.0, -89.0, -78.0, 21.0, -1.0, -12.0, -1.0, 65.0, 76.0, -12.0, -23.0, 32.0, 10.0, 54.0, 43.0, 65.0, 10.0, 32.0, 65.0, 32.0, -12.0, 54.0, 76.0, -12.0, -67.0, 21.0, 54.0, 32.0, -45.0, 32.0, 32.0, 54.0, 65.0, -12.0, -12.0, 32.0, 21.0, 21.0, 21.0, 43.0, 10.0, 43.0, 21.0, 32.0, 43.0, -56.0, -100.0, -12.0, -89.0, -166.0, -89.0, -67.0, -34.0, -23.0, -155.0, 10.0, -89.0, -1.0, 54.0, 10.0, -34.0, -23.0, -23.0, 43.0, 54.0, 65.0, 32.0, -67.0, -34.0, 21.0, -56.0, -34.0, -89.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20653897829355417, "mean_inference_ms": 9.93585520292693, "mean_action_processing_ms": 0.08808392013199703, "mean_env_wait_ms": 0.04553127494458927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005263090133666992, "StateBufferConnector_ms": 0.003145933151245117, "ViewRequirementAgentConnector_ms": 0.09477829933166504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 75336.979, "sample_time_ms": 41058.322, "learn_time_ms": 34271.53, "learn_throughput": 116.715, "synch_weights_time_ms": 6.619}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1842, "training_iteration": 35, "trial_id": "38794_00003", "date": "2023-06-01_23-31-53", "timestamp": 1685651513, "time_this_iter_s": 83.89451599121094, "time_total_s": 2917.139603614807, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2917.139603614807, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 45.67777777777778, "ram_util_percent": 72.56923076923078}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 14.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 65.0, 76.0, -1.0, -45.0, -56.0, 10.0, 10.0, -7.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19239026078668625, "mean_inference_ms": 9.847822334328868, "mean_action_processing_ms": 0.08652304431891164, "mean_env_wait_ms": 0.04316794018766162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054073333740234375, "StateBufferConnector_ms": 0.0032091140747070312, "ViewRequirementAgentConnector_ms": 0.08872032165527344}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.503020763397217, "policy_loss": -0.02032816782593727, "vf_loss": 6.51759147644043, "vf_explained_var": 0.02285417914390564, "kl": 0.019191302359104156, "entropy": 2.5311028957366943, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 4.72, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -45.0, 32.0, 32.0, 54.0, 65.0, -12.0, -12.0, 32.0, 21.0, 21.0, 21.0, 43.0, 10.0, 43.0, 21.0, 32.0, 43.0, -56.0, -100.0, -12.0, -89.0, -166.0, -89.0, -67.0, -34.0, -23.0, -155.0, 10.0, -89.0, -1.0, 54.0, 10.0, -34.0, -23.0, -23.0, 43.0, 54.0, 65.0, 32.0, -67.0, -34.0, 21.0, -56.0, -34.0, -89.0, 65.0, 21.0, 43.0, 76.0, 54.0, -1.0, -12.0, -23.0, -12.0, 54.0, -56.0, -45.0, -23.0, 21.0, 54.0, 65.0, 10.0, 10.0, -1.0, -23.0, -12.0, 54.0, -12.0, -12.0, 10.0, 21.0, -12.0, -34.0, 43.0, 43.0, 10.0, 54.0, 54.0, 10.0, -12.0, 54.0, 65.0, -23.0, -12.0, 10.0, 43.0, 43.0, 32.0, -1.0, -1.0, 54.0, 76.0, 65.0, 65.0, -34.0, 21.0, 43.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2064553691797337, "mean_inference_ms": 9.930760415309528, "mean_action_processing_ms": 0.0880205511240338, "mean_env_wait_ms": 0.04551181976796239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00504612922668457, "StateBufferConnector_ms": 0.0030579566955566406, "ViewRequirementAgentConnector_ms": 0.09270429611206055}}, "episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 4.72, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -45.0, 32.0, 32.0, 54.0, 65.0, -12.0, -12.0, 32.0, 21.0, 21.0, 21.0, 43.0, 10.0, 43.0, 21.0, 32.0, 43.0, -56.0, -100.0, -12.0, -89.0, -166.0, -89.0, -67.0, -34.0, -23.0, -155.0, 10.0, -89.0, -1.0, 54.0, 10.0, -34.0, -23.0, -23.0, 43.0, 54.0, 65.0, 32.0, -67.0, -34.0, 21.0, -56.0, -34.0, -89.0, 65.0, 21.0, 43.0, 76.0, 54.0, -1.0, -12.0, -23.0, -12.0, 54.0, -56.0, -45.0, -23.0, 21.0, 54.0, 65.0, 10.0, 10.0, -1.0, -23.0, -12.0, 54.0, -12.0, -12.0, 10.0, 21.0, -12.0, -34.0, 43.0, 43.0, 10.0, 54.0, 54.0, 10.0, -12.0, 54.0, 65.0, -23.0, -12.0, 10.0, 43.0, 43.0, 32.0, -1.0, -1.0, 54.0, 76.0, 65.0, 65.0, -34.0, 21.0, 43.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2064553691797337, "mean_inference_ms": 9.930760415309528, "mean_action_processing_ms": 0.0880205511240338, "mean_env_wait_ms": 0.04551181976796239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00504612922668457, "StateBufferConnector_ms": 0.0030579566955566406, "ViewRequirementAgentConnector_ms": 0.09270429611206055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 75134.711, "sample_time_ms": 41002.482, "learn_time_ms": 34124.847, "learn_throughput": 117.217, "synch_weights_time_ms": 6.875}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1894, "training_iteration": 36, "trial_id": "38794_00003", "date": "2023-06-01_23-33-14", "timestamp": 1685651594, "time_this_iter_s": 81.25912094116211, "time_total_s": 2998.3987245559692, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2998.3987245559692, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 43.47256637168141, "ram_util_percent": 72.46902654867256}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, 21.0, 43.0, -56.0, 21.0, 43.0, -45.0, -12.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19264729890056587, "mean_inference_ms": 9.871254087338041, "mean_action_processing_ms": 0.08667653563571923, "mean_env_wait_ms": 0.04324831293985858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005211830139160156, "StateBufferConnector_ms": 0.0033283233642578125, "ViewRequirementAgentConnector_ms": 0.09917974472045898}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.019141674041748, "policy_loss": -0.025068214163184166, "vf_loss": 6.0388407707214355, "vf_explained_var": 0.020594779402017593, "kl": 0.017897460609674454, "entropy": 2.310256004333496, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 20.28, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -12.0, 54.0, -56.0, -45.0, -23.0, 21.0, 54.0, 65.0, 10.0, 10.0, -1.0, -23.0, -12.0, 54.0, -12.0, -12.0, 10.0, 21.0, -12.0, -34.0, 43.0, 43.0, 10.0, 54.0, 54.0, 10.0, -12.0, 54.0, 65.0, -23.0, -12.0, 10.0, 43.0, 43.0, 32.0, -1.0, -1.0, 54.0, 76.0, 65.0, 65.0, -34.0, 21.0, 43.0, -1.0, 10.0, -34.0, 54.0, 10.0, 10.0, 43.0, 43.0, 54.0, 21.0, 76.0, 76.0, -1.0, 65.0, 32.0, 76.0, 54.0, 32.0, -23.0, 76.0, 32.0, 32.0, 10.0, -12.0, 21.0, 65.0, -56.0, -78.0, -23.0, 76.0, -89.0, 43.0, 43.0, 21.0, -1.0, 43.0, 32.0, 10.0, 43.0, -45.0, 54.0, 76.0, -1.0, 21.0, 32.0, 76.0, 32.0, 43.0, -56.0, 10.0, 37.0, -1.0, 65.0, 10.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2064220330369838, "mean_inference_ms": 9.927878544307989, "mean_action_processing_ms": 0.08800975179074681, "mean_env_wait_ms": 0.04551220321418958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050733089447021484, "StateBufferConnector_ms": 0.003075122833251953, "ViewRequirementAgentConnector_ms": 0.09332418441772461}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 20.28, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, -12.0, 54.0, -56.0, -45.0, -23.0, 21.0, 54.0, 65.0, 10.0, 10.0, -1.0, -23.0, -12.0, 54.0, -12.0, -12.0, 10.0, 21.0, -12.0, -34.0, 43.0, 43.0, 10.0, 54.0, 54.0, 10.0, -12.0, 54.0, 65.0, -23.0, -12.0, 10.0, 43.0, 43.0, 32.0, -1.0, -1.0, 54.0, 76.0, 65.0, 65.0, -34.0, 21.0, 43.0, -1.0, 10.0, -34.0, 54.0, 10.0, 10.0, 43.0, 43.0, 54.0, 21.0, 76.0, 76.0, -1.0, 65.0, 32.0, 76.0, 54.0, 32.0, -23.0, 76.0, 32.0, 32.0, 10.0, -12.0, 21.0, 65.0, -56.0, -78.0, -23.0, 76.0, -89.0, 43.0, 43.0, 21.0, -1.0, 43.0, 32.0, 10.0, 43.0, -45.0, 54.0, 76.0, -1.0, 21.0, 32.0, 76.0, 32.0, 43.0, -56.0, 10.0, 37.0, -1.0, 65.0, 10.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2064220330369838, "mean_inference_ms": 9.927878544307989, "mean_action_processing_ms": 0.08800975179074681, "mean_env_wait_ms": 0.04551220321418958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050733089447021484, "StateBufferConnector_ms": 0.003075122833251953, "ViewRequirementAgentConnector_ms": 0.09332418441772461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 75161.173, "sample_time_ms": 41130.477, "learn_time_ms": 34023.24, "learn_throughput": 117.567, "synch_weights_time_ms": 6.949}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1947, "training_iteration": 37, "trial_id": "38794_00003", "date": "2023-06-01_23-34-37", "timestamp": 1685651677, "time_this_iter_s": 82.89034223556519, "time_total_s": 3081.2890667915344, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3081.2890667915344, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 42.78103448275862, "ram_util_percent": 71.02672413793104}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -12.0, "episode_reward_mean": 27.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 54.0, 32.0, -12.0, 21.0, -12.0, 21.0, 10.0, 21.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1930216624174524, "mean_inference_ms": 9.894391299243415, "mean_action_processing_ms": 0.08690810831773356, "mean_env_wait_ms": 0.043358120420154855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0033211708068847656, "ViewRequirementAgentConnector_ms": 0.09958744049072266}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 5.02452278137207, "policy_loss": -0.019057750701904297, "vf_loss": 5.038487911224365, "vf_explained_var": 0.03742481395602226, "kl": 0.016973964869976044, "entropy": 2.3240911960601807, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 33.48, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 21.0, 76.0, 76.0, -1.0, 65.0, 32.0, 76.0, 54.0, 32.0, -23.0, 76.0, 32.0, 32.0, 10.0, -12.0, 21.0, 65.0, -56.0, -78.0, -23.0, 76.0, -89.0, 43.0, 43.0, 21.0, -1.0, 43.0, 32.0, 10.0, 43.0, -45.0, 54.0, 76.0, -1.0, 21.0, 32.0, 76.0, 32.0, 43.0, -56.0, 10.0, 37.0, -1.0, 65.0, 10.0, 54.0, 54.0, 54.0, 54.0, 43.0, 21.0, -12.0, -45.0, -1.0, 65.0, 76.0, 65.0, 76.0, 76.0, 32.0, 43.0, 54.0, 43.0, 54.0, 76.0, 76.0, 65.0, 76.0, 76.0, 43.0, 21.0, -45.0, 10.0, 43.0, -1.0, 10.0, -45.0, 54.0, 76.0, 54.0, 43.0, 65.0, 32.0, 54.0, 10.0, 65.0, 32.0, 32.0, 10.0, 21.0, 32.0, 76.0, 32.0, 21.0, 76.0, 54.0, 43.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20643302451413137, "mean_inference_ms": 9.935868341504165, "mean_action_processing_ms": 0.08802193580204555, "mean_env_wait_ms": 0.045525103721023384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005225181579589844, "StateBufferConnector_ms": 0.0031185150146484375, "ViewRequirementAgentConnector_ms": 0.0956270694732666}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 33.48, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 21.0, 76.0, 76.0, -1.0, 65.0, 32.0, 76.0, 54.0, 32.0, -23.0, 76.0, 32.0, 32.0, 10.0, -12.0, 21.0, 65.0, -56.0, -78.0, -23.0, 76.0, -89.0, 43.0, 43.0, 21.0, -1.0, 43.0, 32.0, 10.0, 43.0, -45.0, 54.0, 76.0, -1.0, 21.0, 32.0, 76.0, 32.0, 43.0, -56.0, 10.0, 37.0, -1.0, 65.0, 10.0, 54.0, 54.0, 54.0, 54.0, 43.0, 21.0, -12.0, -45.0, -1.0, 65.0, 76.0, 65.0, 76.0, 76.0, 32.0, 43.0, 54.0, 43.0, 54.0, 76.0, 76.0, 65.0, 76.0, 76.0, 43.0, 21.0, -45.0, 10.0, 43.0, -1.0, 10.0, -45.0, 54.0, 76.0, 54.0, 43.0, 65.0, 32.0, 54.0, 10.0, 65.0, 32.0, 32.0, 10.0, 21.0, 32.0, 76.0, 32.0, 21.0, 76.0, 54.0, 43.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20643302451413137, "mean_inference_ms": 9.935868341504165, "mean_action_processing_ms": 0.08802193580204555, "mean_env_wait_ms": 0.045525103721023384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005225181579589844, "StateBufferConnector_ms": 0.0031185150146484375, "ViewRequirementAgentConnector_ms": 0.0956270694732666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 75499.247, "sample_time_ms": 41329.424, "learn_time_ms": 34162.209, "learn_throughput": 117.088, "synch_weights_time_ms": 7.09}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2000, "training_iteration": 38, "trial_id": "38794_00003", "date": "2023-06-01_23-36-05", "timestamp": 1685651765, "time_this_iter_s": 87.32387208938599, "time_total_s": 3168.6129388809204, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3168.6129388809204, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 47.625409836065565, "ram_util_percent": 68.65901639344261}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, 65.0, 76.0, -12.0, 65.0, 54.0, 76.0, 32.0, 43.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19292716237400825, "mean_inference_ms": 9.889771873090863, "mean_action_processing_ms": 0.08683616319273306, "mean_env_wait_ms": 0.0433359972672369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004913806915283203, "StateBufferConnector_ms": 0.003082752227783203, "ViewRequirementAgentConnector_ms": 0.09136199951171875}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.605997085571289, "policy_loss": -0.021501105278730392, "vf_loss": 6.621973514556885, "vf_explained_var": 0.05147435516119003, "kl": 0.01841585710644722, "entropy": 2.389338731765747, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 26.28, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, -1.0, 65.0, 76.0, 65.0, 76.0, 76.0, 32.0, 43.0, 54.0, 43.0, 54.0, 76.0, 76.0, 65.0, 76.0, 76.0, 43.0, 21.0, -45.0, 10.0, 43.0, -1.0, 10.0, -45.0, 54.0, 76.0, 54.0, 43.0, 65.0, 32.0, 54.0, 10.0, 65.0, 32.0, 32.0, 10.0, 21.0, 32.0, 76.0, 32.0, 21.0, 76.0, 54.0, 43.0, 76.0, 76.0, 76.0, 21.0, 32.0, 32.0, 21.0, -34.0, 21.0, 43.0, 43.0, 32.0, -45.0, 43.0, -34.0, 43.0, 65.0, 32.0, -23.0, -111.0, 43.0, 54.0, 54.0, -1.0, 43.0, 54.0, 76.0, 54.0, 76.0, 65.0, 43.0, -67.0, -12.0, -23.0, -122.0, 10.0, 21.0, 32.0, 54.0, -12.0, 10.0, -1.0, -1.0, 21.0, 10.0, -23.0, -23.0, -1.0, -1.0, -23.0, 65.0, -45.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20642254689121672, "mean_inference_ms": 9.941357879718069, "mean_action_processing_ms": 0.08801449780364971, "mean_env_wait_ms": 0.0455253646231468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005177021026611328, "StateBufferConnector_ms": 0.003132343292236328, "ViewRequirementAgentConnector_ms": 0.09544754028320312}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 26.28, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, -1.0, 65.0, 76.0, 65.0, 76.0, 76.0, 32.0, 43.0, 54.0, 43.0, 54.0, 76.0, 76.0, 65.0, 76.0, 76.0, 43.0, 21.0, -45.0, 10.0, 43.0, -1.0, 10.0, -45.0, 54.0, 76.0, 54.0, 43.0, 65.0, 32.0, 54.0, 10.0, 65.0, 32.0, 32.0, 10.0, 21.0, 32.0, 76.0, 32.0, 21.0, 76.0, 54.0, 43.0, 76.0, 76.0, 76.0, 21.0, 32.0, 32.0, 21.0, -34.0, 21.0, 43.0, 43.0, 32.0, -45.0, 43.0, -34.0, 43.0, 65.0, 32.0, -23.0, -111.0, 43.0, 54.0, 54.0, -1.0, 43.0, 54.0, 76.0, 54.0, 76.0, 65.0, 43.0, -67.0, -12.0, -23.0, -122.0, 10.0, 21.0, 32.0, 54.0, -12.0, 10.0, -1.0, -1.0, 21.0, 10.0, -23.0, -23.0, -1.0, -1.0, -23.0, 65.0, -45.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20642254689121672, "mean_inference_ms": 9.941357879718069, "mean_action_processing_ms": 0.08801449780364971, "mean_env_wait_ms": 0.0455253646231468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005177021026611328, "StateBufferConnector_ms": 0.003132343292236328, "ViewRequirementAgentConnector_ms": 0.09544754028320312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 75809.444, "sample_time_ms": 41348.88, "learn_time_ms": 34453.049, "learn_throughput": 116.1, "synch_weights_time_ms": 7.015}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 2052, "training_iteration": 39, "trial_id": "38794_00003", "date": "2023-06-01_23-37-30", "timestamp": 1685651850, "time_this_iter_s": 84.7474091053009, "time_total_s": 3253.3603479862213, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3253.3603479862213, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 49.62966101694916, "ram_util_percent": 69.12881355932203}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -12.0, "episode_reward_mean": 20.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 43.0, 43.0, 54.0, 10.0, -12.0, 10.0, 21.0, -7.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19336478466509371, "mean_inference_ms": 9.910404272390968, "mean_action_processing_ms": 0.08707574933638898, "mean_env_wait_ms": 0.04345059986942037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006177425384521484, "StateBufferConnector_ms": 0.0030231475830078125, "ViewRequirementAgentConnector_ms": 0.10287284851074219}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 7.353071212768555, "policy_loss": -0.023085691034793854, "vf_loss": 7.369818687438965, "vf_explained_var": 0.02537495829164982, "kl": 0.021129850298166275, "entropy": 2.472444772720337, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -0.02, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 21.0, 43.0, 43.0, 32.0, -45.0, 43.0, -34.0, 43.0, 65.0, 32.0, -23.0, -111.0, 43.0, 54.0, 54.0, -1.0, 43.0, 54.0, 76.0, 54.0, 76.0, 65.0, 43.0, -67.0, -12.0, -23.0, -122.0, 10.0, 21.0, 32.0, 54.0, -12.0, 10.0, -1.0, -1.0, 21.0, 10.0, -23.0, -23.0, -1.0, -1.0, -23.0, 65.0, -45.0, -12.0, -12.0, -45.0, -45.0, -34.0, -67.0, 32.0, -34.0, -78.0, -1.0, -7.0, -78.0, 10.0, -23.0, -45.0, -23.0, 32.0, 21.0, 32.0, -1.0, -133.0, -155.0, 43.0, 10.0, 21.0, 43.0, -1.0, -12.0, -23.0, 10.0, -23.0, -1.0, 54.0, -12.0, 21.0, -12.0, -34.0, -89.0, -1.0, -56.0, -12.0, 54.0, -89.0, 76.0, -1.0, 54.0, 76.0, 21.0, 54.0, -34.0, 10.0, -1.0, 54.0, 15.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20657355885340578, "mean_inference_ms": 9.954624377940483, "mean_action_processing_ms": 0.08808740404085867, "mean_env_wait_ms": 0.045569105271412065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052640438079833984, "StateBufferConnector_ms": 0.003258943557739258, "ViewRequirementAgentConnector_ms": 0.0980081558227539}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -0.02, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, 21.0, 43.0, 43.0, 32.0, -45.0, 43.0, -34.0, 43.0, 65.0, 32.0, -23.0, -111.0, 43.0, 54.0, 54.0, -1.0, 43.0, 54.0, 76.0, 54.0, 76.0, 65.0, 43.0, -67.0, -12.0, -23.0, -122.0, 10.0, 21.0, 32.0, 54.0, -12.0, 10.0, -1.0, -1.0, 21.0, 10.0, -23.0, -23.0, -1.0, -1.0, -23.0, 65.0, -45.0, -12.0, -12.0, -45.0, -45.0, -34.0, -67.0, 32.0, -34.0, -78.0, -1.0, -7.0, -78.0, 10.0, -23.0, -45.0, -23.0, 32.0, 21.0, 32.0, -1.0, -133.0, -155.0, 43.0, 10.0, 21.0, 43.0, -1.0, -12.0, -23.0, 10.0, -23.0, -1.0, 54.0, -12.0, 21.0, -12.0, -34.0, -89.0, -1.0, -56.0, -12.0, 54.0, -89.0, 76.0, -1.0, 54.0, 76.0, 21.0, 54.0, -34.0, 10.0, -1.0, 54.0, 15.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20657355885340578, "mean_inference_ms": 9.954624377940483, "mean_action_processing_ms": 0.08808740404085867, "mean_env_wait_ms": 0.045569105271412065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052640438079833984, "StateBufferConnector_ms": 0.003258943557739258, "ViewRequirementAgentConnector_ms": 0.0980081558227539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 76623.314, "sample_time_ms": 41824.938, "learn_time_ms": 34790.77, "learn_throughput": 114.973, "synch_weights_time_ms": 7.051}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2105, "training_iteration": 40, "trial_id": "38794_00003", "date": "2023-06-01_23-39-01", "timestamp": 1685651941, "time_this_iter_s": 91.2453191280365, "time_total_s": 3344.605667114258, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3344.605667114258, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 49.89527559055118, "ram_util_percent": 71.75511811023621}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -100.0, "episode_reward_mean": -13.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -56.0, 21.0, 54.0, 10.0, -100.0, -34.0, -23.0, 32.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1938659654135408, "mean_inference_ms": 9.955838174875954, "mean_action_processing_ms": 0.08740736054026008, "mean_env_wait_ms": 0.043593445820709106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00621795654296875, "StateBufferConnector_ms": 0.003299713134765625, "ViewRequirementAgentConnector_ms": 0.10203361511230469}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.705953121185303, "policy_loss": -0.02480190247297287, "vf_loss": 6.722416877746582, "vf_explained_var": 0.046045031398534775, "kl": 0.01852985844016075, "entropy": 2.3379251956939697, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 2.51, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -78.0, -1.0, -7.0, -78.0, 10.0, -23.0, -45.0, -23.0, 32.0, 21.0, 32.0, -1.0, -133.0, -155.0, 43.0, 10.0, 21.0, 43.0, -1.0, -12.0, -23.0, 10.0, -23.0, -1.0, 54.0, -12.0, 21.0, -12.0, -34.0, -89.0, -1.0, -56.0, -12.0, 54.0, -89.0, 76.0, -1.0, 54.0, 76.0, 21.0, 54.0, -34.0, 10.0, -1.0, 54.0, 15.0, -56.0, 65.0, -23.0, -23.0, 32.0, -89.0, 32.0, 10.0, 65.0, 10.0, -1.0, 54.0, 65.0, 32.0, 10.0, -1.0, 54.0, 32.0, 65.0, -1.0, -1.0, 54.0, 54.0, 43.0, -23.0, -34.0, 21.0, 43.0, 10.0, 54.0, -34.0, 10.0, -1.0, 10.0, 32.0, 65.0, 65.0, 32.0, -56.0, -23.0, -45.0, -12.0, -1.0, 54.0, 65.0, -45.0, 21.0, -1.0, -23.0, -23.0, -45.0, -67.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2068035444567668, "mean_inference_ms": 9.972559032981582, "mean_action_processing_ms": 0.08821396238543976, "mean_env_wait_ms": 0.04564694134124693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005366802215576172, "StateBufferConnector_ms": 0.0033419132232666016, "ViewRequirementAgentConnector_ms": 0.10077595710754395}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 2.51, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -78.0, -1.0, -7.0, -78.0, 10.0, -23.0, -45.0, -23.0, 32.0, 21.0, 32.0, -1.0, -133.0, -155.0, 43.0, 10.0, 21.0, 43.0, -1.0, -12.0, -23.0, 10.0, -23.0, -1.0, 54.0, -12.0, 21.0, -12.0, -34.0, -89.0, -1.0, -56.0, -12.0, 54.0, -89.0, 76.0, -1.0, 54.0, 76.0, 21.0, 54.0, -34.0, 10.0, -1.0, 54.0, 15.0, -56.0, 65.0, -23.0, -23.0, 32.0, -89.0, 32.0, 10.0, 65.0, 10.0, -1.0, 54.0, 65.0, 32.0, 10.0, -1.0, 54.0, 32.0, 65.0, -1.0, -1.0, 54.0, 54.0, 43.0, -23.0, -34.0, 21.0, 43.0, 10.0, 54.0, -34.0, 10.0, -1.0, 10.0, 32.0, 65.0, 65.0, 32.0, -56.0, -23.0, -45.0, -12.0, -1.0, 54.0, 65.0, -45.0, 21.0, -1.0, -23.0, -23.0, -45.0, -67.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2068035444567668, "mean_inference_ms": 9.972559032981582, "mean_action_processing_ms": 0.08821396238543976, "mean_env_wait_ms": 0.04564694134124693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005366802215576172, "StateBufferConnector_ms": 0.0033419132232666016, "ViewRequirementAgentConnector_ms": 0.10077595710754395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 76805.357, "sample_time_ms": 42016.276, "learn_time_ms": 34781.279, "learn_throughput": 115.004, "synch_weights_time_ms": 7.244}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2157, "training_iteration": 41, "trial_id": "38794_00003", "date": "2023-06-01_23-40-27", "timestamp": 1685652027, "time_this_iter_s": 86.14155173301697, "time_total_s": 3430.747218847275, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3430.747218847275, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 50.13333333333333, "ram_util_percent": 71.0375}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -78.0, "episode_reward_mean": 0.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 32.0, -12.0, -12.0, 10.0, 54.0, 32.0, 43.0, -78.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19364164144539234, "mean_inference_ms": 9.951070034617091, "mean_action_processing_ms": 0.08724345356027105, "mean_env_wait_ms": 0.04351682439789557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005431175231933594, "StateBufferConnector_ms": 0.0029087066650390625, "ViewRequirementAgentConnector_ms": 0.08875131607055664}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.838472843170166, "policy_loss": -0.015116272494196892, "vf_loss": 5.847602367401123, "vf_explained_var": 0.05956464633345604, "kl": 0.013304843567311764, "entropy": 2.3038060665130615, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 19.13, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 10.0, 65.0, 10.0, -1.0, 54.0, 65.0, 32.0, 10.0, -1.0, 54.0, 32.0, 65.0, -1.0, -1.0, 54.0, 54.0, 43.0, -23.0, -34.0, 21.0, 43.0, 10.0, 54.0, -34.0, 10.0, -1.0, 10.0, 32.0, 65.0, 65.0, 32.0, -56.0, -23.0, -45.0, -12.0, -1.0, 54.0, 65.0, -45.0, 21.0, -1.0, -23.0, -23.0, -45.0, -67.0, -12.0, 21.0, -34.0, 10.0, -1.0, 32.0, 10.0, -34.0, -12.0, 21.0, -1.0, 54.0, -56.0, -1.0, -34.0, -1.0, 54.0, 65.0, 54.0, -12.0, 43.0, 65.0, 10.0, 65.0, 76.0, 43.0, 10.0, 76.0, 76.0, 43.0, 65.0, 76.0, 43.0, 21.0, 65.0, 32.0, 65.0, -56.0, -56.0, 76.0, 43.0, 65.0, -1.0, -45.0, 21.0, 54.0, -1.0, -1.0, 65.0, 43.0, -1.0, 65.0, -34.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20707428628627067, "mean_inference_ms": 9.990968377819849, "mean_action_processing_ms": 0.08838956072506099, "mean_env_wait_ms": 0.04574095061602103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054166316986083984, "StateBufferConnector_ms": 0.003410816192626953, "ViewRequirementAgentConnector_ms": 0.10254216194152832}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 19.13, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 10.0, 65.0, 10.0, -1.0, 54.0, 65.0, 32.0, 10.0, -1.0, 54.0, 32.0, 65.0, -1.0, -1.0, 54.0, 54.0, 43.0, -23.0, -34.0, 21.0, 43.0, 10.0, 54.0, -34.0, 10.0, -1.0, 10.0, 32.0, 65.0, 65.0, 32.0, -56.0, -23.0, -45.0, -12.0, -1.0, 54.0, 65.0, -45.0, 21.0, -1.0, -23.0, -23.0, -45.0, -67.0, -12.0, 21.0, -34.0, 10.0, -1.0, 32.0, 10.0, -34.0, -12.0, 21.0, -1.0, 54.0, -56.0, -1.0, -34.0, -1.0, 54.0, 65.0, 54.0, -12.0, 43.0, 65.0, 10.0, 65.0, 76.0, 43.0, 10.0, 76.0, 76.0, 43.0, 65.0, 76.0, 43.0, 21.0, 65.0, 32.0, 65.0, -56.0, -56.0, 76.0, 43.0, 65.0, -1.0, -45.0, 21.0, 54.0, -1.0, -1.0, 65.0, 43.0, -1.0, 65.0, -34.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20707428628627067, "mean_inference_ms": 9.990968377819849, "mean_action_processing_ms": 0.08838956072506099, "mean_env_wait_ms": 0.04574095061602103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054166316986083984, "StateBufferConnector_ms": 0.003410816192626953, "ViewRequirementAgentConnector_ms": 0.10254216194152832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 77124.038, "sample_time_ms": 42374.033, "learn_time_ms": 34742.101, "learn_throughput": 115.134, "synch_weights_time_ms": 7.352}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2210, "training_iteration": 42, "trial_id": "38794_00003", "date": "2023-06-01_23-41-54", "timestamp": 1685652114, "time_this_iter_s": 86.99423003196716, "time_total_s": 3517.741448879242, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3517.741448879242, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 49.07786885245902, "ram_util_percent": 71.32704918032786}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -67.0, "episode_reward_mean": -19.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -67.0, -67.0, -23.0, -45.0, -12.0, 54.0, -45.0, 21.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19398795898517807, "mean_inference_ms": 9.969244059907636, "mean_action_processing_ms": 0.08741689681831746, "mean_env_wait_ms": 0.04360671507524695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005977153778076172, "StateBufferConnector_ms": 0.0035238265991210938, "ViewRequirementAgentConnector_ms": 0.10057926177978516}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.818385124206543, "policy_loss": -0.021957647055387497, "vf_loss": 5.832819938659668, "vf_explained_var": 0.07873347401618958, "kl": 0.016717083752155304, "entropy": 2.3912863731384277, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 27.37, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -12.0, 21.0, -1.0, 54.0, -56.0, -1.0, -34.0, -1.0, 54.0, 65.0, 54.0, -12.0, 43.0, 65.0, 10.0, 65.0, 76.0, 43.0, 10.0, 76.0, 76.0, 43.0, 65.0, 76.0, 43.0, 21.0, 65.0, 32.0, 65.0, -56.0, -56.0, 76.0, 43.0, 65.0, -1.0, -45.0, 21.0, 54.0, -1.0, -1.0, 65.0, 43.0, -1.0, 65.0, -34.0, 54.0, 65.0, 21.0, 43.0, 43.0, 21.0, 54.0, 76.0, 43.0, 76.0, 21.0, 76.0, 76.0, 54.0, 21.0, 43.0, -56.0, 21.0, -56.0, -1.0, 21.0, 21.0, 10.0, -56.0, -89.0, -34.0, 21.0, 32.0, 21.0, 43.0, 32.0, 32.0, 43.0, 10.0, 10.0, 4.0, 10.0, 21.0, 10.0, 43.0, 21.0, 76.0, 76.0, 76.0, 54.0, 65.0, 54.0, 76.0, 43.0, 10.0, 48.0, -45.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20717335397911746, "mean_inference_ms": 9.999994661927428, "mean_action_processing_ms": 0.08844978160407845, "mean_env_wait_ms": 0.04577484239117483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005303859710693359, "StateBufferConnector_ms": 0.003251314163208008, "ViewRequirementAgentConnector_ms": 0.09900593757629395}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 27.37, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -12.0, 21.0, -1.0, 54.0, -56.0, -1.0, -34.0, -1.0, 54.0, 65.0, 54.0, -12.0, 43.0, 65.0, 10.0, 65.0, 76.0, 43.0, 10.0, 76.0, 76.0, 43.0, 65.0, 76.0, 43.0, 21.0, 65.0, 32.0, 65.0, -56.0, -56.0, 76.0, 43.0, 65.0, -1.0, -45.0, 21.0, 54.0, -1.0, -1.0, 65.0, 43.0, -1.0, 65.0, -34.0, 54.0, 65.0, 21.0, 43.0, 43.0, 21.0, 54.0, 76.0, 43.0, 76.0, 21.0, 76.0, 76.0, 54.0, 21.0, 43.0, -56.0, 21.0, -56.0, -1.0, 21.0, 21.0, 10.0, -56.0, -89.0, -34.0, 21.0, 32.0, 21.0, 43.0, 32.0, 32.0, 43.0, 10.0, 10.0, 4.0, 10.0, 21.0, 10.0, 43.0, 21.0, 76.0, 76.0, 76.0, 54.0, 65.0, 54.0, 76.0, 43.0, 10.0, 48.0, -45.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20717335397911746, "mean_inference_ms": 9.999994661927428, "mean_action_processing_ms": 0.08844978160407845, "mean_env_wait_ms": 0.04577484239117483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005303859710693359, "StateBufferConnector_ms": 0.003251314163208008, "ViewRequirementAgentConnector_ms": 0.09900593757629395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 77132.422, "sample_time_ms": 42249.492, "learn_time_ms": 34875.014, "learn_throughput": 114.695, "synch_weights_time_ms": 7.367}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2263, "training_iteration": 43, "trial_id": "38794_00003", "date": "2023-06-01_23-43-19", "timestamp": 1685652199, "time_this_iter_s": 85.15038990974426, "time_total_s": 3602.891838788986, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3602.891838788986, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 49.844915254237286, "ram_util_percent": 71.55254237288136}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 32.0, 54.0, 21.0, 43.0, 10.0, 10.0, -45.0, 21.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19444424314456982, "mean_inference_ms": 10.083028679205459, "mean_action_processing_ms": 0.0876872819924639, "mean_env_wait_ms": 0.04374579890507736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005719661712646484, "StateBufferConnector_ms": 0.0035810470581054688, "ViewRequirementAgentConnector_ms": 0.10682106018066406}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.739049434661865, "policy_loss": -0.016462229192256927, "vf_loss": 6.747474670410156, "vf_explained_var": 0.031537968665361404, "kl": 0.017859330400824547, "entropy": 2.5320074558258057, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 20.55, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 43.0, 76.0, 21.0, 76.0, 76.0, 54.0, 21.0, 43.0, -56.0, 21.0, -56.0, -1.0, 21.0, 21.0, 10.0, -56.0, -89.0, -34.0, 21.0, 32.0, 21.0, 43.0, 32.0, 32.0, 43.0, 10.0, 10.0, 4.0, 10.0, 21.0, 10.0, 43.0, 21.0, 76.0, 76.0, 76.0, 54.0, 65.0, 54.0, 76.0, 43.0, 10.0, 48.0, -45.0, 43.0, 32.0, 21.0, -56.0, 43.0, -100.0, -34.0, 54.0, 43.0, 54.0, -12.0, 32.0, 10.0, 32.0, 10.0, -1.0, 21.0, 21.0, -34.0, -34.0, 21.0, -1.0, -34.0, -67.0, 43.0, 54.0, -45.0, -12.0, 32.0, -1.0, 76.0, 21.0, -89.0, -34.0, 10.0, 54.0, 10.0, -1.0, 21.0, -12.0, 54.0, 54.0, 76.0, 54.0, 76.0, 76.0, 65.0, 32.0, 54.0, 65.0, -12.0, 54.0, 43.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20734603942490915, "mean_inference_ms": 10.018210883048319, "mean_action_processing_ms": 0.08853893979747081, "mean_env_wait_ms": 0.04583876989153045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005319833755493164, "StateBufferConnector_ms": 0.0033407211303710938, "ViewRequirementAgentConnector_ms": 0.09992456436157227}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 20.55, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 43.0, 76.0, 21.0, 76.0, 76.0, 54.0, 21.0, 43.0, -56.0, 21.0, -56.0, -1.0, 21.0, 21.0, 10.0, -56.0, -89.0, -34.0, 21.0, 32.0, 21.0, 43.0, 32.0, 32.0, 43.0, 10.0, 10.0, 4.0, 10.0, 21.0, 10.0, 43.0, 21.0, 76.0, 76.0, 76.0, 54.0, 65.0, 54.0, 76.0, 43.0, 10.0, 48.0, -45.0, 43.0, 32.0, 21.0, -56.0, 43.0, -100.0, -34.0, 54.0, 43.0, 54.0, -12.0, 32.0, 10.0, 32.0, 10.0, -1.0, 21.0, 21.0, -34.0, -34.0, 21.0, -1.0, -34.0, -67.0, 43.0, 54.0, -45.0, -12.0, 32.0, -1.0, 76.0, 21.0, -89.0, -34.0, 10.0, 54.0, 10.0, -1.0, 21.0, -12.0, 54.0, 54.0, 76.0, 54.0, 76.0, 76.0, 65.0, 32.0, 54.0, 65.0, -12.0, 54.0, 43.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20734603942490915, "mean_inference_ms": 10.018210883048319, "mean_action_processing_ms": 0.08853893979747081, "mean_env_wait_ms": 0.04583876989153045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005319833755493164, "StateBufferConnector_ms": 0.0033407211303710938, "ViewRequirementAgentConnector_ms": 0.09992456436157227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 78683.064, "sample_time_ms": 42956.637, "learn_time_ms": 35718.447, "learn_throughput": 111.987, "synch_weights_time_ms": 7.396}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 2315, "training_iteration": 44, "trial_id": "38794_00003", "date": "2023-06-01_23-45-02", "timestamp": 1685652302, "time_this_iter_s": 102.92365908622742, "time_total_s": 3705.8154978752136, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3705.8154978752136, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 60.30909090909091, "ram_util_percent": 73.28251748251748}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -40.0, "episode_reward_mean": 24.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 76.0, 54.0, 65.0, -1.0, -12.0, 10.0, 43.0, -40.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19435911707555906, "mean_inference_ms": 10.07097267462515, "mean_action_processing_ms": 0.0876181132821102, "mean_env_wait_ms": 0.04370342008252126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004715919494628906, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.0891566276550293}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.494888782501221, "policy_loss": -0.02142271399497986, "vf_loss": 5.507920265197754, "vf_explained_var": 0.07226365059614182, "kl": 0.018648261204361916, "entropy": 2.5598738193511963, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 25.78, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 54.0, -12.0, 32.0, 10.0, 32.0, 10.0, -1.0, 21.0, 21.0, -34.0, -34.0, 21.0, -1.0, -34.0, -67.0, 43.0, 54.0, -45.0, -12.0, 32.0, -1.0, 76.0, 21.0, -89.0, -34.0, 10.0, 54.0, 10.0, -1.0, 21.0, -12.0, 54.0, 54.0, 76.0, 54.0, 76.0, 76.0, 65.0, 32.0, 54.0, 65.0, -12.0, 54.0, 43.0, -34.0, -34.0, 65.0, 76.0, 54.0, 65.0, 65.0, 10.0, -1.0, 76.0, 54.0, 54.0, 54.0, 43.0, 54.0, 76.0, -12.0, 43.0, 65.0, 76.0, 65.0, 43.0, 43.0, 43.0, -12.0, 21.0, 32.0, 32.0, 32.0, -1.0, 65.0, -45.0, 21.0, -12.0, -1.0, 54.0, -12.0, -12.0, 65.0, 32.0, 43.0, 76.0, 54.0, 32.0, -12.0, 10.0, 59.0, -56.0, 21.0, 76.0, 65.0, 10.0, 21.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2076911481925667, "mean_inference_ms": 10.059788004769814, "mean_action_processing_ms": 0.08871530929788182, "mean_env_wait_ms": 0.04595597645307723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006727933883666992, "StateBufferConnector_ms": 0.003429889678955078, "ViewRequirementAgentConnector_ms": 0.10476827621459961}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 25.78, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 54.0, -12.0, 32.0, 10.0, 32.0, 10.0, -1.0, 21.0, 21.0, -34.0, -34.0, 21.0, -1.0, -34.0, -67.0, 43.0, 54.0, -45.0, -12.0, 32.0, -1.0, 76.0, 21.0, -89.0, -34.0, 10.0, 54.0, 10.0, -1.0, 21.0, -12.0, 54.0, 54.0, 76.0, 54.0, 76.0, 76.0, 65.0, 32.0, 54.0, 65.0, -12.0, 54.0, 43.0, -34.0, -34.0, 65.0, 76.0, 54.0, 65.0, 65.0, 10.0, -1.0, 76.0, 54.0, 54.0, 54.0, 43.0, 54.0, 76.0, -12.0, 43.0, 65.0, 76.0, 65.0, 43.0, 43.0, 43.0, -12.0, 21.0, 32.0, 32.0, 32.0, -1.0, 65.0, -45.0, 21.0, -12.0, -1.0, 54.0, -12.0, -12.0, 65.0, 32.0, 43.0, 76.0, 54.0, 32.0, -12.0, 10.0, 59.0, -56.0, 21.0, 76.0, 65.0, 10.0, 21.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2076911481925667, "mean_inference_ms": 10.059788004769814, "mean_action_processing_ms": 0.08871530929788182, "mean_env_wait_ms": 0.04595597645307723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006727933883666992, "StateBufferConnector_ms": 0.003429889678955078, "ViewRequirementAgentConnector_ms": 0.10476827621459961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 79830.914, "sample_time_ms": 43793.701, "learn_time_ms": 36029.212, "learn_throughput": 111.021, "synch_weights_time_ms": 7.371}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 2368, "training_iteration": 45, "trial_id": "38794_00003", "date": "2023-06-01_23-46-37", "timestamp": 1685652397, "time_this_iter_s": 94.8545868396759, "time_total_s": 3800.6700847148895, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3800.6700847148895, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 51.399248120300754, "ram_util_percent": 72.00751879699249}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -56.0, "episode_reward_mean": -7.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 43.0, -34.0, 10.0, 10.0, -23.0, -56.0, -45.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19444507127399965, "mean_inference_ms": 10.075124804049755, "mean_action_processing_ms": 0.0876633356673259, "mean_env_wait_ms": 0.043714678310351626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190372467041016, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.09409904479980469}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.9796223640441895, "policy_loss": -0.02079152502119541, "vf_loss": 5.9940595626831055, "vf_explained_var": 0.06054723635315895, "kl": 0.014120252802968025, "entropy": 2.4732308387756348, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 27.43, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -1.0, 76.0, 54.0, 54.0, 54.0, 43.0, 54.0, 76.0, -12.0, 43.0, 65.0, 76.0, 65.0, 43.0, 43.0, 43.0, -12.0, 21.0, 32.0, 32.0, 32.0, -1.0, 65.0, -45.0, 21.0, -12.0, -1.0, 54.0, -12.0, -12.0, 65.0, 32.0, 43.0, 76.0, 54.0, 32.0, -12.0, 10.0, 59.0, -56.0, 21.0, 76.0, 65.0, 10.0, 21.0, -56.0, -12.0, 43.0, -34.0, -34.0, -45.0, -56.0, -12.0, 32.0, 43.0, -1.0, 32.0, 21.0, 54.0, 32.0, -56.0, 32.0, -12.0, 32.0, 21.0, -78.0, 21.0, 21.0, 76.0, 43.0, 32.0, 65.0, 43.0, 65.0, 54.0, 21.0, 10.0, 32.0, 76.0, 43.0, 32.0, 65.0, 76.0, 32.0, 65.0, 32.0, 76.0, 32.0, 32.0, 65.0, 54.0, 54.0, 65.0, 76.0, -1.0, -45.0, -1.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20787576763383683, "mean_inference_ms": 10.086907124923819, "mean_action_processing_ms": 0.08881741770963732, "mean_env_wait_ms": 0.046016127361842366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00670623779296875, "StateBufferConnector_ms": 0.003265380859375, "ViewRequirementAgentConnector_ms": 0.10254406929016113}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 27.43, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -1.0, 76.0, 54.0, 54.0, 54.0, 43.0, 54.0, 76.0, -12.0, 43.0, 65.0, 76.0, 65.0, 43.0, 43.0, 43.0, -12.0, 21.0, 32.0, 32.0, 32.0, -1.0, 65.0, -45.0, 21.0, -12.0, -1.0, 54.0, -12.0, -12.0, 65.0, 32.0, 43.0, 76.0, 54.0, 32.0, -12.0, 10.0, 59.0, -56.0, 21.0, 76.0, 65.0, 10.0, 21.0, -56.0, -12.0, 43.0, -34.0, -34.0, -45.0, -56.0, -12.0, 32.0, 43.0, -1.0, 32.0, 21.0, 54.0, 32.0, -56.0, 32.0, -12.0, 32.0, 21.0, -78.0, 21.0, 21.0, 76.0, 43.0, 32.0, 65.0, 43.0, 65.0, 54.0, 21.0, 10.0, 32.0, 76.0, 43.0, 32.0, 65.0, 76.0, 32.0, 65.0, 32.0, 76.0, 32.0, 32.0, 65.0, 54.0, 54.0, 65.0, 76.0, -1.0, -45.0, -1.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20787576763383683, "mean_inference_ms": 10.086907124923819, "mean_action_processing_ms": 0.08881741770963732, "mean_env_wait_ms": 0.046016127361842366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00670623779296875, "StateBufferConnector_ms": 0.003265380859375, "ViewRequirementAgentConnector_ms": 0.10254406929016113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 80346.786, "sample_time_ms": 44230.702, "learn_time_ms": 36107.965, "learn_throughput": 110.779, "synch_weights_time_ms": 7.476}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 2421, "training_iteration": 46, "trial_id": "38794_00003", "date": "2023-06-01_23-48-04", "timestamp": 1685652484, "time_this_iter_s": 87.12139177322388, "time_total_s": 3887.7914764881134, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3887.7914764881134, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 48.56363636363636, "ram_util_percent": 66.99173553719008}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -100.0, "episode_reward_mean": -1.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -100.0, -12.0, 32.0, 32.0, 21.0, -1.0, -23.0, 65.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19443023445417945, "mean_inference_ms": 10.075846263287145, "mean_action_processing_ms": 0.08764349998123203, "mean_env_wait_ms": 0.04370811054245434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005404949188232422, "StateBufferConnector_ms": 0.002982616424560547, "ViewRequirementAgentConnector_ms": 0.0957489013671875}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.038317680358887, "policy_loss": -0.016649391502141953, "vf_loss": 6.048268795013428, "vf_explained_var": 0.023805927485227585, "kl": 0.01488533429801464, "entropy": 2.226487636566162, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 25.84, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -12.0, 32.0, 43.0, -1.0, 32.0, 21.0, 54.0, 32.0, -56.0, 32.0, -12.0, 32.0, 21.0, -78.0, 21.0, 21.0, 76.0, 43.0, 32.0, 65.0, 43.0, 65.0, 54.0, 21.0, 10.0, 32.0, 76.0, 43.0, 32.0, 65.0, 76.0, 32.0, 65.0, 32.0, 76.0, 32.0, 32.0, 65.0, 54.0, 54.0, 65.0, 76.0, -1.0, -45.0, -1.0, 32.0, 10.0, -56.0, 43.0, 43.0, -67.0, -1.0, 65.0, 10.0, 54.0, 21.0, 43.0, -45.0, -34.0, 21.0, -1.0, -1.0, -1.0, -12.0, 65.0, -12.0, -100.0, 65.0, 43.0, 32.0, 21.0, 32.0, 43.0, 43.0, 43.0, 54.0, 65.0, 54.0, 32.0, -45.0, 54.0, 43.0, 10.0, 65.0, 76.0, 10.0, 10.0, 65.0, 65.0, 21.0, -12.0, 32.0, -67.0, 10.0, 32.0, 43.0, 43.0, 76.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20794532333757915, "mean_inference_ms": 10.099501069370387, "mean_action_processing_ms": 0.08886358671843307, "mean_env_wait_ms": 0.046039798754230664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005300283432006836, "StateBufferConnector_ms": 0.003125905990600586, "ViewRequirementAgentConnector_ms": 0.09772109985351562}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 25.84, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -12.0, 32.0, 43.0, -1.0, 32.0, 21.0, 54.0, 32.0, -56.0, 32.0, -12.0, 32.0, 21.0, -78.0, 21.0, 21.0, 76.0, 43.0, 32.0, 65.0, 43.0, 65.0, 54.0, 21.0, 10.0, 32.0, 76.0, 43.0, 32.0, 65.0, 76.0, 32.0, 65.0, 32.0, 76.0, 32.0, 32.0, 65.0, 54.0, 54.0, 65.0, 76.0, -1.0, -45.0, -1.0, 32.0, 10.0, -56.0, 43.0, 43.0, -67.0, -1.0, 65.0, 10.0, 54.0, 21.0, 43.0, -45.0, -34.0, 21.0, -1.0, -1.0, -1.0, -12.0, 65.0, -12.0, -100.0, 65.0, 43.0, 32.0, 21.0, 32.0, 43.0, 43.0, 43.0, 54.0, 65.0, 54.0, 32.0, -45.0, 54.0, 43.0, 10.0, 65.0, 76.0, 10.0, 10.0, 65.0, 65.0, 21.0, -12.0, 32.0, -67.0, 10.0, 32.0, 43.0, 43.0, 76.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20794532333757915, "mean_inference_ms": 10.099501069370387, "mean_action_processing_ms": 0.08886358671843307, "mean_env_wait_ms": 0.046039798754230664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005300283432006836, "StateBufferConnector_ms": 0.003125905990600586, "ViewRequirementAgentConnector_ms": 0.09772109985351562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 80931.16, "sample_time_ms": 44490.648, "learn_time_ms": 36432.435, "learn_throughput": 109.792, "synch_weights_time_ms": 7.425}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 2473, "training_iteration": 47, "trial_id": "38794_00003", "date": "2023-06-01_23-49-32", "timestamp": 1685652572, "time_this_iter_s": 88.26264882087708, "time_total_s": 3976.0541253089905, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3976.0541253089905, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 48.76422764227642, "ram_util_percent": 69.80081300813009}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": 10.0, "episode_reward_mean": 38.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 65.0, 21.0, 43.0, 54.0, 54.0, 43.0, 10.0, 21.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19495408330641145, "mean_inference_ms": 10.14538889753953, "mean_action_processing_ms": 0.08796738452848116, "mean_env_wait_ms": 0.043875808853848335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063610076904296875, "StateBufferConnector_ms": 0.0034117698669433594, "ViewRequirementAgentConnector_ms": 0.10805130004882812}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.137997627258301, "policy_loss": -0.021971222013235092, "vf_loss": 6.15264368057251, "vf_explained_var": 0.03311537206172943, "kl": 0.01627771556377411, "entropy": 2.4230306148529053, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 20.78, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 10.0, 54.0, 21.0, 43.0, -45.0, -34.0, 21.0, -1.0, -1.0, -1.0, -12.0, 65.0, -12.0, -100.0, 65.0, 43.0, 32.0, 21.0, 32.0, 43.0, 43.0, 43.0, 54.0, 65.0, 54.0, 32.0, -45.0, 54.0, 43.0, 10.0, 65.0, 76.0, 10.0, 10.0, 65.0, 65.0, 21.0, -12.0, 32.0, -67.0, 10.0, 32.0, 43.0, 43.0, 76.0, 54.0, 76.0, 65.0, 76.0, 54.0, 54.0, 54.0, -89.0, 32.0, 21.0, 43.0, -34.0, 54.0, 54.0, 54.0, 54.0, 43.0, 65.0, 76.0, 65.0, 65.0, 54.0, 10.0, 10.0, -23.0, 10.0, 10.0, 10.0, 10.0, 10.0, 43.0, 32.0, 10.0, 21.0, -23.0, 21.0, 43.0, 76.0, 43.0, 43.0, -45.0, -122.0, -166.0, -67.0, -34.0, -56.0, -67.0, -34.0, -12.0, 43.0, 65.0, 54.0, 54.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20800717332982266, "mean_inference_ms": 10.108070527317572, "mean_action_processing_ms": 0.08889384527352806, "mean_env_wait_ms": 0.04605887916406384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005183219909667969, "StateBufferConnector_ms": 0.0032181739807128906, "ViewRequirementAgentConnector_ms": 0.09579300880432129}}, "episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 20.78, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 10.0, 54.0, 21.0, 43.0, -45.0, -34.0, 21.0, -1.0, -1.0, -1.0, -12.0, 65.0, -12.0, -100.0, 65.0, 43.0, 32.0, 21.0, 32.0, 43.0, 43.0, 43.0, 54.0, 65.0, 54.0, 32.0, -45.0, 54.0, 43.0, 10.0, 65.0, 76.0, 10.0, 10.0, 65.0, 65.0, 21.0, -12.0, 32.0, -67.0, 10.0, 32.0, 43.0, 43.0, 76.0, 54.0, 76.0, 65.0, 76.0, 54.0, 54.0, 54.0, -89.0, 32.0, 21.0, 43.0, -34.0, 54.0, 54.0, 54.0, 54.0, 43.0, 65.0, 76.0, 65.0, 65.0, 54.0, 10.0, 10.0, -23.0, 10.0, 10.0, 10.0, 10.0, 10.0, 43.0, 32.0, 10.0, 21.0, -23.0, 21.0, 43.0, 76.0, 43.0, 43.0, -45.0, -122.0, -166.0, -67.0, -34.0, -56.0, -67.0, -34.0, -12.0, 43.0, 65.0, 54.0, 54.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20800717332982266, "mean_inference_ms": 10.108070527317572, "mean_action_processing_ms": 0.08889384527352806, "mean_env_wait_ms": 0.04605887916406384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005183219909667969, "StateBufferConnector_ms": 0.0032181739807128906, "ViewRequirementAgentConnector_ms": 0.09579300880432129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 81012.454, "sample_time_ms": 44468.619, "learn_time_ms": 36535.687, "learn_throughput": 109.482, "synch_weights_time_ms": 7.479}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 2526, "training_iteration": 48, "trial_id": "38794_00003", "date": "2023-06-01_23-51-03", "timestamp": 1685652663, "time_this_iter_s": 90.18556380271912, "time_total_s": 4066.2396891117096, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4066.2396891117096, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 52.25, "ram_util_percent": 71.71984126984128}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -111.0, "episode_reward_mean": -2.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 10.0, -89.0, -111.0, -23.0, -12.0, 48.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19508127603971087, "mean_inference_ms": 10.156287308560767, "mean_action_processing_ms": 0.08804967588366962, "mean_env_wait_ms": 0.04389586873381136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118846893310547, "StateBufferConnector_ms": 0.003693103790283203, "ViewRequirementAgentConnector_ms": 0.10113954544067383}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.977439880371094, "policy_loss": -0.02316473238170147, "vf_loss": 5.993231296539307, "vf_explained_var": 0.050261687487363815, "kl": 0.01638435199856758, "entropy": 2.355762004852295, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 18.91, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, -89.0, 32.0, 21.0, 43.0, -34.0, 54.0, 54.0, 54.0, 54.0, 43.0, 65.0, 76.0, 65.0, 65.0, 54.0, 10.0, 10.0, -23.0, 10.0, 10.0, 10.0, 10.0, 10.0, 43.0, 32.0, 10.0, 21.0, -23.0, 21.0, 43.0, 76.0, 43.0, 43.0, -45.0, -122.0, -166.0, -67.0, -34.0, -56.0, -67.0, -34.0, -12.0, 43.0, 65.0, 54.0, 54.0, -12.0, 54.0, -1.0, 21.0, -45.0, -56.0, -34.0, -1.0, -1.0, 32.0, 65.0, 32.0, 43.0, -89.0, 21.0, 43.0, -23.0, -23.0, -23.0, -34.0, 65.0, 54.0, 43.0, 21.0, 54.0, -12.0, 65.0, 65.0, 43.0, 32.0, -34.0, 43.0, 32.0, 32.0, 10.0, 65.0, 32.0, 43.0, 65.0, 54.0, 32.0, -12.0, 65.0, 65.0, 65.0, 54.0, 43.0, 10.0, 54.0, 65.0, 21.0, 54.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20813151134152771, "mean_inference_ms": 10.116361674152904, "mean_action_processing_ms": 0.08896442352112163, "mean_env_wait_ms": 0.046101395444471345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005339860916137695, "StateBufferConnector_ms": 0.0033910274505615234, "ViewRequirementAgentConnector_ms": 0.09835243225097656}}, "episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 18.91, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -89.0, 32.0, 21.0, 43.0, -34.0, 54.0, 54.0, 54.0, 54.0, 43.0, 65.0, 76.0, 65.0, 65.0, 54.0, 10.0, 10.0, -23.0, 10.0, 10.0, 10.0, 10.0, 10.0, 43.0, 32.0, 10.0, 21.0, -23.0, 21.0, 43.0, 76.0, 43.0, 43.0, -45.0, -122.0, -166.0, -67.0, -34.0, -56.0, -67.0, -34.0, -12.0, 43.0, 65.0, 54.0, 54.0, -12.0, 54.0, -1.0, 21.0, -45.0, -56.0, -34.0, -1.0, -1.0, 32.0, 65.0, 32.0, 43.0, -89.0, 21.0, 43.0, -23.0, -23.0, -23.0, -34.0, 65.0, 54.0, 43.0, 21.0, 54.0, -12.0, 65.0, 65.0, 43.0, 32.0, -34.0, 43.0, 32.0, 32.0, 10.0, 65.0, 32.0, 43.0, 65.0, 54.0, 32.0, -12.0, 65.0, 65.0, 65.0, 54.0, 43.0, 10.0, 54.0, 65.0, 21.0, 54.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20813151134152771, "mean_inference_ms": 10.116361674152904, "mean_action_processing_ms": 0.08896442352112163, "mean_env_wait_ms": 0.046101395444471345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005339860916137695, "StateBufferConnector_ms": 0.0033910274505615234, "ViewRequirementAgentConnector_ms": 0.09835243225097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 81251.152, "sample_time_ms": 44782.426, "learn_time_ms": 36460.57, "learn_throughput": 109.708, "synch_weights_time_ms": 7.474}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 2578, "training_iteration": 49, "trial_id": "38794_00003", "date": "2023-06-01_23-52-31", "timestamp": 1685652751, "time_this_iter_s": 87.88808488845825, "time_total_s": 4154.127774000168, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4154.127774000168, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 51.683606557377054, "ram_util_percent": 73.5860655737705}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 21.0, "episode_reward_mean": 59.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 54.0, 65.0, 76.0, 54.0, 21.0, 65.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19494909565215554, "mean_inference_ms": 10.142501795066977, "mean_action_processing_ms": 0.08798375863382205, "mean_env_wait_ms": 0.043856771691015324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005209445953369141, "StateBufferConnector_ms": 0.0032472610473632812, "ViewRequirementAgentConnector_ms": 0.0881052017211914}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.296250343322754, "policy_loss": -0.01898752897977829, "vf_loss": 5.30932092666626, "vf_explained_var": 0.08962821960449219, "kl": 0.013148520141839981, "entropy": 2.376939296722412, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 29.03, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -1.0, -1.0, 32.0, 65.0, 32.0, 43.0, -89.0, 21.0, 43.0, -23.0, -23.0, -23.0, -34.0, 65.0, 54.0, 43.0, 21.0, 54.0, -12.0, 65.0, 65.0, 43.0, 32.0, -34.0, 43.0, 32.0, 32.0, 10.0, 65.0, 32.0, 43.0, 65.0, 54.0, 32.0, -12.0, 65.0, 65.0, 65.0, 54.0, 43.0, 10.0, 54.0, 65.0, 21.0, 54.0, 54.0, 21.0, 10.0, 32.0, -12.0, -12.0, -89.0, 76.0, 43.0, -23.0, -89.0, 65.0, 10.0, -1.0, -45.0, 54.0, 65.0, 65.0, 65.0, 65.0, 43.0, 76.0, 54.0, 43.0, 65.0, 76.0, 54.0, 43.0, 76.0, 32.0, 65.0, 76.0, 76.0, 76.0, 43.0, 54.0, 32.0, 43.0, 65.0, 54.0, 76.0, 65.0, -34.0, 32.0, -12.0, -34.0, 43.0, -12.0, -45.0, -45.0, 10.0, -12.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2083258500945642, "mean_inference_ms": 10.132273577587913, "mean_action_processing_ms": 0.08907741985792782, "mean_env_wait_ms": 0.046172338879175163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005358219146728516, "StateBufferConnector_ms": 0.003251314163208008, "ViewRequirementAgentConnector_ms": 0.10038232803344727}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 29.03, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -1.0, -1.0, 32.0, 65.0, 32.0, 43.0, -89.0, 21.0, 43.0, -23.0, -23.0, -23.0, -34.0, 65.0, 54.0, 43.0, 21.0, 54.0, -12.0, 65.0, 65.0, 43.0, 32.0, -34.0, 43.0, 32.0, 32.0, 10.0, 65.0, 32.0, 43.0, 65.0, 54.0, 32.0, -12.0, 65.0, 65.0, 65.0, 54.0, 43.0, 10.0, 54.0, 65.0, 21.0, 54.0, 54.0, 21.0, 10.0, 32.0, -12.0, -12.0, -89.0, 76.0, 43.0, -23.0, -89.0, 65.0, 10.0, -1.0, -45.0, 54.0, 65.0, 65.0, 65.0, 65.0, 43.0, 76.0, 54.0, 43.0, 65.0, 76.0, 54.0, 43.0, 76.0, 32.0, 65.0, 76.0, 76.0, 76.0, 43.0, 54.0, 32.0, 43.0, 65.0, 54.0, 76.0, 65.0, -34.0, 32.0, -12.0, -34.0, 43.0, -12.0, -45.0, -45.0, 10.0, -12.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2083258500945642, "mean_inference_ms": 10.132273577587913, "mean_action_processing_ms": 0.08907741985792782, "mean_env_wait_ms": 0.046172338879175163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005358219146728516, "StateBufferConnector_ms": 0.003251314163208008, "ViewRequirementAgentConnector_ms": 0.10038232803344727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 80918.057, "sample_time_ms": 44835.954, "learn_time_ms": 36074.092, "learn_throughput": 110.883, "synch_weights_time_ms": 7.367}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 2631, "training_iteration": 50, "trial_id": "38794_00003", "date": "2023-06-01_23-53-57", "timestamp": 1685652837, "time_this_iter_s": 86.92745995521545, "time_total_s": 4241.055233955383, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4241.055233955383, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 48.32066115702479, "ram_util_percent": 73.26528925619834}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -111.0, "episode_reward_mean": 11.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 32.0, -1.0, -23.0, -111.0, -12.0, 43.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19521017087625062, "mean_inference_ms": 10.167070028198223, "mean_action_processing_ms": 0.08811532662215671, "mean_env_wait_ms": 0.043936943953129706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005135536193847656, "StateBufferConnector_ms": 0.0029730796813964844, "ViewRequirementAgentConnector_ms": 0.1003408432006836}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.987215995788574, "policy_loss": -0.024113651365041733, "vf_loss": 6.002976894378662, "vf_explained_var": 0.049576181918382645, "kl": 0.0185624361038208, "entropy": 2.338043212890625, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 31.39, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 43.0, -23.0, -89.0, 65.0, 10.0, -1.0, -45.0, 54.0, 65.0, 65.0, 65.0, 65.0, 43.0, 76.0, 54.0, 43.0, 65.0, 76.0, 54.0, 43.0, 76.0, 32.0, 65.0, 76.0, 76.0, 76.0, 43.0, 54.0, 32.0, 43.0, 65.0, 54.0, 76.0, 65.0, -34.0, 32.0, -12.0, -34.0, 43.0, -12.0, -45.0, -45.0, 10.0, -12.0, 43.0, 32.0, 65.0, -1.0, 54.0, 76.0, 32.0, 32.0, 43.0, 43.0, 32.0, 21.0, -23.0, -12.0, -23.0, -1.0, -12.0, 54.0, -23.0, 43.0, 59.0, 54.0, 43.0, 65.0, 21.0, 43.0, 65.0, -34.0, -1.0, -23.0, -1.0, 21.0, 32.0, 43.0, 54.0, 76.0, 32.0, -12.0, 65.0, 10.0, 43.0, 65.0, 10.0, 43.0, 43.0, 21.0, -34.0, 43.0, 43.0, -12.0, 65.0, 54.0, 21.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20858256220169707, "mean_inference_ms": 10.149306959719752, "mean_action_processing_ms": 0.08923522712076569, "mean_env_wait_ms": 0.04625830816345497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005577802658081055, "StateBufferConnector_ms": 0.0032417774200439453, "ViewRequirementAgentConnector_ms": 0.1024932861328125}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 31.39, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 43.0, -23.0, -89.0, 65.0, 10.0, -1.0, -45.0, 54.0, 65.0, 65.0, 65.0, 65.0, 43.0, 76.0, 54.0, 43.0, 65.0, 76.0, 54.0, 43.0, 76.0, 32.0, 65.0, 76.0, 76.0, 76.0, 43.0, 54.0, 32.0, 43.0, 65.0, 54.0, 76.0, 65.0, -34.0, 32.0, -12.0, -34.0, 43.0, -12.0, -45.0, -45.0, 10.0, -12.0, 43.0, 32.0, 65.0, -1.0, 54.0, 76.0, 32.0, 32.0, 43.0, 43.0, 32.0, 21.0, -23.0, -12.0, -23.0, -1.0, -12.0, 54.0, -23.0, 43.0, 59.0, 54.0, 43.0, 65.0, 21.0, 43.0, 65.0, -34.0, -1.0, -23.0, -1.0, 21.0, 32.0, 43.0, 54.0, 76.0, 32.0, -12.0, 65.0, 10.0, 43.0, 65.0, 10.0, 43.0, 43.0, 21.0, -34.0, 43.0, 43.0, -12.0, 65.0, 54.0, 21.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20858256220169707, "mean_inference_ms": 10.149306959719752, "mean_action_processing_ms": 0.08923522712076569, "mean_env_wait_ms": 0.04625830816345497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005577802658081055, "StateBufferConnector_ms": 0.0032417774200439453, "ViewRequirementAgentConnector_ms": 0.1024932861328125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 81486.493, "sample_time_ms": 45030.754, "learn_time_ms": 36447.887, "learn_throughput": 109.746, "synch_weights_time_ms": 7.178}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 2684, "training_iteration": 51, "trial_id": "38794_00003", "date": "2023-06-01_23-55-29", "timestamp": 1685652929, "time_this_iter_s": 91.52940535545349, "time_total_s": 4332.584639310837, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4332.584639310837, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 53.146875, "ram_util_percent": 72.23671875}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -133.0, "episode_reward_mean": -7.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 10.0, -45.0, -34.0, 65.0, 32.0, -1.0, -12.0, -133.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1956038905651185, "mean_inference_ms": 10.193202524592268, "mean_action_processing_ms": 0.08830376619245507, "mean_env_wait_ms": 0.04403262554502769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055599212646484375, "StateBufferConnector_ms": 0.0030732154846191406, "ViewRequirementAgentConnector_ms": 0.10542869567871094}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.2257184982299805, "policy_loss": -0.013744952157139778, "vf_loss": 6.233015060424805, "vf_explained_var": 0.01078694500029087, "kl": 0.014331205748021603, "entropy": 2.3067896366119385, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -73.0, "episode_reward_mean": 24.45, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 43.0, 32.0, 21.0, -23.0, -12.0, -23.0, -1.0, -12.0, 54.0, -23.0, 43.0, 59.0, 54.0, 43.0, 65.0, 21.0, 43.0, 65.0, -34.0, -1.0, -23.0, -1.0, 21.0, 32.0, 43.0, 54.0, 76.0, 32.0, -12.0, 65.0, 10.0, 43.0, 65.0, 10.0, 43.0, 43.0, 21.0, -34.0, 43.0, 43.0, -12.0, 65.0, 54.0, 21.0, 43.0, 76.0, 43.0, 43.0, 37.0, 21.0, 21.0, 43.0, 32.0, 43.0, -56.0, -12.0, -12.0, 65.0, 65.0, 43.0, 21.0, 32.0, 10.0, 32.0, -23.0, 32.0, 43.0, 10.0, 21.0, 21.0, 54.0, 65.0, -1.0, 65.0, -45.0, -67.0, -45.0, 21.0, 65.0, 32.0, 54.0, -1.0, 43.0, 43.0, 65.0, -34.0, 32.0, -73.0, -12.0, 10.0, 43.0, -1.0, 54.0, 43.0, 43.0, -12.0, 76.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20876430727342699, "mean_inference_ms": 10.162181022891968, "mean_action_processing_ms": 0.08934059897630531, "mean_env_wait_ms": 0.046313415649424525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005542278289794922, "StateBufferConnector_ms": 0.0033223628997802734, "ViewRequirementAgentConnector_ms": 0.10254144668579102}}, "episode_reward_max": 76.0, "episode_reward_min": -73.0, "episode_reward_mean": 24.45, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 43.0, 32.0, 21.0, -23.0, -12.0, -23.0, -1.0, -12.0, 54.0, -23.0, 43.0, 59.0, 54.0, 43.0, 65.0, 21.0, 43.0, 65.0, -34.0, -1.0, -23.0, -1.0, 21.0, 32.0, 43.0, 54.0, 76.0, 32.0, -12.0, 65.0, 10.0, 43.0, 65.0, 10.0, 43.0, 43.0, 21.0, -34.0, 43.0, 43.0, -12.0, 65.0, 54.0, 21.0, 43.0, 76.0, 43.0, 43.0, 37.0, 21.0, 21.0, 43.0, 32.0, 43.0, -56.0, -12.0, -12.0, 65.0, 65.0, 43.0, 21.0, 32.0, 10.0, 32.0, -23.0, 32.0, 43.0, 10.0, 21.0, 21.0, 54.0, 65.0, -1.0, 65.0, -45.0, -67.0, -45.0, 21.0, 65.0, 32.0, 54.0, -1.0, 43.0, 43.0, 65.0, -34.0, 32.0, -73.0, -12.0, 10.0, 43.0, -1.0, 54.0, 43.0, 43.0, -12.0, 76.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20876430727342699, "mean_inference_ms": 10.162181022891968, "mean_action_processing_ms": 0.08934059897630531, "mean_env_wait_ms": 0.046313415649424525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005542278289794922, "StateBufferConnector_ms": 0.0033223628997802734, "ViewRequirementAgentConnector_ms": 0.10254144668579102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 81859.712, "sample_time_ms": 44918.912, "learn_time_ms": 36932.874, "learn_throughput": 108.305, "synch_weights_time_ms": 7.24}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 2736, "training_iteration": 52, "trial_id": "38794_00003", "date": "2023-06-01_23-57-01", "timestamp": 1685653021, "time_this_iter_s": 92.12992000579834, "time_total_s": 4424.714559316635, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4424.714559316635, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 51.63828125, "ram_util_percent": 71.80859375}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 8.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -1.0, 43.0, 21.0, 54.0, 10.0, 10.0, -45.0, -45.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1959043043833652, "mean_inference_ms": 10.21199970264775, "mean_action_processing_ms": 0.08844503600305995, "mean_env_wait_ms": 0.04409045585468868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005817413330078125, "StateBufferConnector_ms": 0.003211498260498047, "ViewRequirementAgentConnector_ms": 0.10104894638061523}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.917320728302002, "policy_loss": -0.01887660101056099, "vf_loss": 5.928580284118652, "vf_explained_var": 0.09069439768791199, "kl": 0.016927162185311317, "entropy": 2.1669182777404785, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 21.21, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, 43.0, -56.0, -12.0, -12.0, 65.0, 65.0, 43.0, 21.0, 32.0, 10.0, 32.0, -23.0, 32.0, 43.0, 10.0, 21.0, 21.0, 54.0, 65.0, -1.0, 65.0, -45.0, -67.0, -45.0, 21.0, 65.0, 32.0, 54.0, -1.0, 43.0, 43.0, 65.0, -34.0, 32.0, -73.0, -12.0, 10.0, 43.0, -1.0, 54.0, 43.0, 43.0, -12.0, 76.0, 43.0, -12.0, 43.0, 32.0, 76.0, 76.0, 65.0, -23.0, 65.0, 43.0, 76.0, 65.0, 43.0, 10.0, 65.0, 76.0, 76.0, 54.0, 32.0, -12.0, -45.0, -1.0, 21.0, -67.0, -12.0, -34.0, -78.0, -12.0, -56.0, -100.0, 37.0, 43.0, 43.0, 65.0, 54.0, 10.0, 76.0, 43.0, 10.0, 76.0, 32.0, 54.0, 32.0, -78.0, 43.0, -12.0, -1.0, -23.0, 21.0, 65.0, 32.0, -1.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20887553919496293, "mean_inference_ms": 10.169278707058037, "mean_action_processing_ms": 0.08939752805765369, "mean_env_wait_ms": 0.046341840215127036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005245685577392578, "StateBufferConnector_ms": 0.003292083740234375, "ViewRequirementAgentConnector_ms": 0.09889411926269531}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 21.21, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 32.0, 43.0, -56.0, -12.0, -12.0, 65.0, 65.0, 43.0, 21.0, 32.0, 10.0, 32.0, -23.0, 32.0, 43.0, 10.0, 21.0, 21.0, 54.0, 65.0, -1.0, 65.0, -45.0, -67.0, -45.0, 21.0, 65.0, 32.0, 54.0, -1.0, 43.0, 43.0, 65.0, -34.0, 32.0, -73.0, -12.0, 10.0, 43.0, -1.0, 54.0, 43.0, 43.0, -12.0, 76.0, 43.0, -12.0, 43.0, 32.0, 76.0, 76.0, 65.0, -23.0, 65.0, 43.0, 76.0, 65.0, 43.0, 10.0, 65.0, 76.0, 76.0, 54.0, 32.0, -12.0, -45.0, -1.0, 21.0, -67.0, -12.0, -34.0, -78.0, -12.0, -56.0, -100.0, 37.0, 43.0, 43.0, 65.0, 54.0, 10.0, 76.0, 43.0, 10.0, 76.0, 32.0, 54.0, 32.0, -78.0, 43.0, -12.0, -1.0, -23.0, 21.0, 65.0, 32.0, -1.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20887553919496293, "mean_inference_ms": 10.169278707058037, "mean_action_processing_ms": 0.08939752805765369, "mean_env_wait_ms": 0.046341840215127036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005245685577392578, "StateBufferConnector_ms": 0.003292083740234375, "ViewRequirementAgentConnector_ms": 0.09889411926269531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 82093.685, "sample_time_ms": 45142.781, "learn_time_ms": 36943.008, "learn_throughput": 108.275, "synch_weights_time_ms": 7.199}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 2789, "training_iteration": 53, "trial_id": "38794_00003", "date": "2023-06-01_23-58-29", "timestamp": 1685653109, "time_this_iter_s": 87.81766486167908, "time_total_s": 4512.532224178314, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4512.532224178314, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 45.808196721311475, "ram_util_percent": 71.97213114754098}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 29.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 10.0, 54.0, 76.0, 10.0, 65.0, 48.0, 43.0, 21.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19612532139974698, "mean_inference_ms": 10.233661804929794, "mean_action_processing_ms": 0.08857876744257195, "mean_env_wait_ms": 0.044155090641363685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005469322204589844, "StateBufferConnector_ms": 0.0034546852111816406, "ViewRequirementAgentConnector_ms": 0.10244131088256836}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.694113731384277, "policy_loss": -0.019565971568226814, "vf_loss": 6.7061004638671875, "vf_explained_var": 0.0492941290140152, "kl": 0.016842488199472427, "entropy": 2.51991868019104, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 15.11, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 65.0, 43.0, 76.0, 65.0, 43.0, 10.0, 65.0, 76.0, 76.0, 54.0, 32.0, -12.0, -45.0, -1.0, 21.0, -67.0, -12.0, -34.0, -78.0, -12.0, -56.0, -100.0, 37.0, 43.0, 43.0, 65.0, 54.0, 10.0, 76.0, 43.0, 10.0, 76.0, 32.0, 54.0, 32.0, -78.0, 43.0, -12.0, -1.0, -23.0, 21.0, 65.0, 32.0, -1.0, 54.0, 10.0, 10.0, 21.0, 54.0, 21.0, 32.0, 76.0, 32.0, 32.0, 43.0, 32.0, -23.0, -56.0, -12.0, -56.0, -23.0, 21.0, 54.0, -1.0, 65.0, -12.0, -23.0, 32.0, 43.0, 43.0, 21.0, -56.0, -78.0, 43.0, 21.0, -1.0, -12.0, 54.0, -45.0, -1.0, 21.0, 32.0, -12.0, -45.0, -1.0, 21.0, 76.0, 32.0, -12.0, 65.0, 21.0, 32.0, -45.0, 43.0, 43.0, -1.0, -23.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20901577891245446, "mean_inference_ms": 10.178088362896961, "mean_action_processing_ms": 0.08946767108237338, "mean_env_wait_ms": 0.046375246111405435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190372467041016, "StateBufferConnector_ms": 0.003397703170776367, "ViewRequirementAgentConnector_ms": 0.09803938865661621}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 15.11, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 65.0, 43.0, 76.0, 65.0, 43.0, 10.0, 65.0, 76.0, 76.0, 54.0, 32.0, -12.0, -45.0, -1.0, 21.0, -67.0, -12.0, -34.0, -78.0, -12.0, -56.0, -100.0, 37.0, 43.0, 43.0, 65.0, 54.0, 10.0, 76.0, 43.0, 10.0, 76.0, 32.0, 54.0, 32.0, -78.0, 43.0, -12.0, -1.0, -23.0, 21.0, 65.0, 32.0, -1.0, 54.0, 10.0, 10.0, 21.0, 54.0, 21.0, 32.0, 76.0, 32.0, 32.0, 43.0, 32.0, -23.0, -56.0, -12.0, -56.0, -23.0, 21.0, 54.0, -1.0, 65.0, -12.0, -23.0, 32.0, 43.0, 43.0, 21.0, -56.0, -78.0, 43.0, 21.0, -1.0, -12.0, 54.0, -45.0, -1.0, 21.0, 32.0, -12.0, -45.0, -1.0, 21.0, 76.0, 32.0, -12.0, 65.0, 21.0, 32.0, -45.0, 43.0, 43.0, -1.0, -23.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20901577891245446, "mean_inference_ms": 10.178088362896961, "mean_action_processing_ms": 0.08946767108237338, "mean_env_wait_ms": 0.046375246111405435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190372467041016, "StateBufferConnector_ms": 0.003397703170776367, "ViewRequirementAgentConnector_ms": 0.09803938865661621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 81215.808, "sample_time_ms": 44810.614, "learn_time_ms": 36397.235, "learn_throughput": 109.898, "synch_weights_time_ms": 7.299}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 2842, "training_iteration": 54, "trial_id": "38794_00003", "date": "2023-06-02_00-00-00", "timestamp": 1685653200, "time_this_iter_s": 91.39575815200806, "time_total_s": 4603.927982330322, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4603.927982330322, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 48.65905511811024, "ram_util_percent": 72.5748031496063}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -23.0, "episode_reward_mean": 41.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 10.0, 65.0, 54.0, 76.0, -23.0, 54.0, 76.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19626425674681955, "mean_inference_ms": 10.24485627976517, "mean_action_processing_ms": 0.08869508799090717, "mean_env_wait_ms": 0.044205791000395775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005526542663574219, "StateBufferConnector_ms": 0.0032806396484375, "ViewRequirementAgentConnector_ms": 0.09442567825317383}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.479089260101318, "policy_loss": -0.021011192351579666, "vf_loss": 6.491620063781738, "vf_explained_var": 0.028593214228749275, "kl": 0.01884617656469345, "entropy": 2.1425821781158447, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 15.22, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 32.0, 32.0, 43.0, 32.0, -23.0, -56.0, -12.0, -56.0, -23.0, 21.0, 54.0, -1.0, 65.0, -12.0, -23.0, 32.0, 43.0, 43.0, 21.0, -56.0, -78.0, 43.0, 21.0, -1.0, -12.0, 54.0, -45.0, -1.0, 21.0, 32.0, -12.0, -45.0, -1.0, 21.0, 76.0, 32.0, -12.0, 65.0, 21.0, 32.0, -45.0, 43.0, 43.0, -1.0, -23.0, 43.0, -1.0, -12.0, -45.0, 4.0, -23.0, 65.0, 54.0, 10.0, 54.0, 43.0, 65.0, 32.0, 32.0, 43.0, 43.0, 54.0, 43.0, 65.0, -23.0, -1.0, 43.0, -12.0, -34.0, -34.0, 54.0, 21.0, -12.0, 21.0, -23.0, 65.0, -12.0, 21.0, -34.0, -45.0, -1.0, 10.0, 21.0, -12.0, 43.0, 65.0, 32.0, 10.0, 21.0, 43.0, 65.0, 65.0, 54.0, -1.0, 43.0, -12.0, 43.0, -12.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20920300231476976, "mean_inference_ms": 10.198399736838038, "mean_action_processing_ms": 0.08956898866192724, "mean_env_wait_ms": 0.04642875197041086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053691864013671875, "StateBufferConnector_ms": 0.0034885406494140625, "ViewRequirementAgentConnector_ms": 0.10195279121398926}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 15.22, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 32.0, 32.0, 43.0, 32.0, -23.0, -56.0, -12.0, -56.0, -23.0, 21.0, 54.0, -1.0, 65.0, -12.0, -23.0, 32.0, 43.0, 43.0, 21.0, -56.0, -78.0, 43.0, 21.0, -1.0, -12.0, 54.0, -45.0, -1.0, 21.0, 32.0, -12.0, -45.0, -1.0, 21.0, 76.0, 32.0, -12.0, 65.0, 21.0, 32.0, -45.0, 43.0, 43.0, -1.0, -23.0, 43.0, -1.0, -12.0, -45.0, 4.0, -23.0, 65.0, 54.0, 10.0, 54.0, 43.0, 65.0, 32.0, 32.0, 43.0, 43.0, 54.0, 43.0, 65.0, -23.0, -1.0, 43.0, -12.0, -34.0, -34.0, 54.0, 21.0, -12.0, 21.0, -23.0, 65.0, -12.0, 21.0, -34.0, -45.0, -1.0, 10.0, 21.0, -12.0, 43.0, 65.0, 32.0, 10.0, 21.0, 43.0, 65.0, 65.0, 54.0, -1.0, 43.0, -12.0, 43.0, -12.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20920300231476976, "mean_inference_ms": 10.198399736838038, "mean_action_processing_ms": 0.08956898866192724, "mean_env_wait_ms": 0.04642875197041086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053691864013671875, "StateBufferConnector_ms": 0.0034885406494140625, "ViewRequirementAgentConnector_ms": 0.10195279121398926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 81006.277, "sample_time_ms": 44684.509, "learn_time_ms": 36313.683, "learn_throughput": 110.151, "synch_weights_time_ms": 7.425}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 2894, "training_iteration": 55, "trial_id": "38794_00003", "date": "2023-06-02_00-01-34", "timestamp": 1685653294, "time_this_iter_s": 93.7800440788269, "time_total_s": 4697.708026409149, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4697.708026409149, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 56.63740458015267, "ram_util_percent": 76.76793893129769}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -67.0, "episode_reward_mean": 18.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 65.0, -1.0, 32.0, 54.0, 65.0, -67.0, 54.0, -12.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19627145009981822, "mean_inference_ms": 10.258058047306381, "mean_action_processing_ms": 0.08867395369227518, "mean_env_wait_ms": 0.0442048749939167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051021575927734375, "StateBufferConnector_ms": 0.0029516220092773438, "ViewRequirementAgentConnector_ms": 0.09569168090820312}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.708913803100586, "policy_loss": -0.01964123733341694, "vf_loss": 6.719069957733154, "vf_explained_var": 0.036893703043460846, "kl": 0.02107793465256691, "entropy": 2.329991579055786, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 15.28, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 10.0, 54.0, 43.0, 65.0, 32.0, 32.0, 43.0, 43.0, 54.0, 43.0, 65.0, -23.0, -1.0, 43.0, -12.0, -34.0, -34.0, 54.0, 21.0, -12.0, 21.0, -23.0, 65.0, -12.0, 21.0, -34.0, -45.0, -1.0, 10.0, 21.0, -12.0, 43.0, 65.0, 32.0, 10.0, 21.0, 43.0, 65.0, 65.0, 54.0, -1.0, 43.0, -12.0, 43.0, -12.0, 21.0, -56.0, -23.0, -1.0, 54.0, 32.0, 65.0, 32.0, 21.0, -12.0, -34.0, -89.0, -56.0, -12.0, -23.0, 10.0, -67.0, 43.0, 32.0, 65.0, 43.0, 76.0, -34.0, 32.0, -34.0, -45.0, 32.0, 32.0, -12.0, 43.0, -23.0, -45.0, 32.0, 65.0, 10.0, 43.0, 10.0, 32.0, 65.0, 32.0, -67.0, -12.0, 21.0, -1.0, 54.0, 65.0, -1.0, -12.0, 10.0, 21.0, 43.0, 54.0, -67.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2093165665462286, "mean_inference_ms": 10.219404304505952, "mean_action_processing_ms": 0.08964694581159056, "mean_env_wait_ms": 0.04646935682680972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054438114166259766, "StateBufferConnector_ms": 0.003350973129272461, "ViewRequirementAgentConnector_ms": 0.10107183456420898}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 15.28, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 10.0, 54.0, 43.0, 65.0, 32.0, 32.0, 43.0, 43.0, 54.0, 43.0, 65.0, -23.0, -1.0, 43.0, -12.0, -34.0, -34.0, 54.0, 21.0, -12.0, 21.0, -23.0, 65.0, -12.0, 21.0, -34.0, -45.0, -1.0, 10.0, 21.0, -12.0, 43.0, 65.0, 32.0, 10.0, 21.0, 43.0, 65.0, 65.0, 54.0, -1.0, 43.0, -12.0, 43.0, -12.0, 21.0, -56.0, -23.0, -1.0, 54.0, 32.0, 65.0, 32.0, 21.0, -12.0, -34.0, -89.0, -56.0, -12.0, -23.0, 10.0, -67.0, 43.0, 32.0, 65.0, 43.0, 76.0, -34.0, 32.0, -34.0, -45.0, 32.0, 32.0, -12.0, 43.0, -23.0, -45.0, 32.0, 65.0, 10.0, 43.0, 10.0, 32.0, 65.0, 32.0, -67.0, -12.0, 21.0, -1.0, 54.0, 65.0, -1.0, -12.0, 10.0, 21.0, 43.0, 54.0, -67.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2093165665462286, "mean_inference_ms": 10.219404304505952, "mean_action_processing_ms": 0.08964694581159056, "mean_env_wait_ms": 0.04646935682680972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054438114166259766, "StateBufferConnector_ms": 0.003350973129272461, "ViewRequirementAgentConnector_ms": 0.10107183456420898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 81209.014, "sample_time_ms": 44841.677, "learn_time_ms": 36359.518, "learn_throughput": 110.012, "synch_weights_time_ms": 7.093}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 2947, "training_iteration": 56, "trial_id": "38794_00003", "date": "2023-06-02_00-03-04", "timestamp": 1685653384, "time_this_iter_s": 89.70122814178467, "time_total_s": 4787.409254550934, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4787.409254550934, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 51.59596774193548, "ram_util_percent": 78.85241935483869}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -12.0, "episode_reward_mean": 43.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 65.0, 43.0, 65.0, 43.0, 32.0, 65.0, 54.0, 32.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19627076866625587, "mean_inference_ms": 10.268504334350242, "mean_action_processing_ms": 0.088690984959346, "mean_env_wait_ms": 0.04420176219616578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004897117614746094, "StateBufferConnector_ms": 0.003101825714111328, "ViewRequirementAgentConnector_ms": 0.09267091751098633}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.442108154296875, "policy_loss": -0.014597775414586067, "vf_loss": 5.444499492645264, "vf_explained_var": 0.045663151890039444, "kl": 0.018083849921822548, "entropy": 2.355560779571533, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 22.53, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, -12.0, -34.0, -89.0, -56.0, -12.0, -23.0, 10.0, -67.0, 43.0, 32.0, 65.0, 43.0, 76.0, -34.0, 32.0, -34.0, -45.0, 32.0, 32.0, -12.0, 43.0, -23.0, -45.0, 32.0, 65.0, 10.0, 43.0, 10.0, 32.0, 65.0, 32.0, -67.0, -12.0, 21.0, -1.0, 54.0, 65.0, -1.0, -12.0, 10.0, 21.0, 43.0, 54.0, -67.0, 54.0, 65.0, 43.0, 43.0, -12.0, 65.0, 48.0, 21.0, 43.0, 32.0, 21.0, 32.0, 32.0, 43.0, 43.0, 76.0, -12.0, 76.0, 10.0, -12.0, 54.0, 48.0, 43.0, 76.0, 76.0, 65.0, 54.0, 43.0, 43.0, 76.0, 65.0, -12.0, -1.0, 10.0, -45.0, -78.0, 21.0, -23.0, -45.0, 65.0, 43.0, 54.0, 76.0, 43.0, 76.0, 65.0, -1.0, 65.0, -23.0, -23.0, 54.0, 76.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2093074774005317, "mean_inference_ms": 10.237667841040581, "mean_action_processing_ms": 0.08966071183190419, "mean_env_wait_ms": 0.046479396817356945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005247354507446289, "StateBufferConnector_ms": 0.0031898021697998047, "ViewRequirementAgentConnector_ms": 0.09634828567504883}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 22.53, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 21.0, -12.0, -34.0, -89.0, -56.0, -12.0, -23.0, 10.0, -67.0, 43.0, 32.0, 65.0, 43.0, 76.0, -34.0, 32.0, -34.0, -45.0, 32.0, 32.0, -12.0, 43.0, -23.0, -45.0, 32.0, 65.0, 10.0, 43.0, 10.0, 32.0, 65.0, 32.0, -67.0, -12.0, 21.0, -1.0, 54.0, 65.0, -1.0, -12.0, 10.0, 21.0, 43.0, 54.0, -67.0, 54.0, 65.0, 43.0, 43.0, -12.0, 65.0, 48.0, 21.0, 43.0, 32.0, 21.0, 32.0, 32.0, 43.0, 43.0, 76.0, -12.0, 76.0, 10.0, -12.0, 54.0, 48.0, 43.0, 76.0, 76.0, 65.0, 54.0, 43.0, 43.0, 76.0, 65.0, -12.0, -1.0, 10.0, -45.0, -78.0, 21.0, -23.0, -45.0, 65.0, 43.0, 54.0, 76.0, 43.0, 76.0, 65.0, -1.0, 65.0, -23.0, -23.0, 54.0, 76.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2093074774005317, "mean_inference_ms": 10.237667841040581, "mean_action_processing_ms": 0.08966071183190419, "mean_env_wait_ms": 0.046479396817356945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005247354507446289, "StateBufferConnector_ms": 0.0031898021697998047, "ViewRequirementAgentConnector_ms": 0.09634828567504883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 81402.557, "sample_time_ms": 45134.089, "learn_time_ms": 36260.441, "learn_throughput": 110.313, "synch_weights_time_ms": 7.27}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 3000, "training_iteration": 57, "trial_id": "38794_00003", "date": "2023-06-02_00-04-35", "timestamp": 1685653475, "time_this_iter_s": 90.77770805358887, "time_total_s": 4878.186962604523, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4878.186962604523, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 48.92913385826773, "ram_util_percent": 77.05118110236221}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -12.0, "episode_reward_mean": 27.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 10.0, 21.0, -12.0, 10.0, 32.0, 65.0, 54.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1961213999739338, "mean_inference_ms": 10.26885270591018, "mean_action_processing_ms": 0.08859008294409257, "mean_env_wait_ms": 0.04414765583468512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005009174346923828, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.08925199508666992}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.427506923675537, "policy_loss": -0.015779146924614906, "vf_loss": 6.4349822998046875, "vf_explained_var": 0.046397123485803604, "kl": 0.012301625683903694, "entropy": 2.209160566329956, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 22.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.0, 21.0, 43.0, 32.0, 21.0, 32.0, 32.0, 43.0, 43.0, 76.0, -12.0, 76.0, 10.0, -12.0, 54.0, 48.0, 43.0, 76.0, 76.0, 65.0, 54.0, 43.0, 43.0, 76.0, 65.0, -12.0, -1.0, 10.0, -45.0, -78.0, 21.0, -23.0, -45.0, 65.0, 43.0, 54.0, 76.0, 43.0, 76.0, 65.0, -1.0, 65.0, -23.0, -23.0, 54.0, 76.0, 54.0, 76.0, 54.0, 32.0, -1.0, 76.0, 43.0, 32.0, -100.0, -56.0, 21.0, 10.0, 43.0, -1.0, 48.0, 54.0, 43.0, 65.0, -45.0, -12.0, 32.0, -12.0, -12.0, 65.0, -12.0, -34.0, -23.0, -1.0, -12.0, -45.0, 21.0, -23.0, -34.0, -34.0, -12.0, 32.0, 76.0, 65.0, 32.0, 54.0, 65.0, 54.0, 76.0, 65.0, 54.0, 54.0, 65.0, 65.0, -34.0, -111.0, -45.0, -56.0, 10.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20921291687937754, "mean_inference_ms": 10.250471816940113, "mean_action_processing_ms": 0.08964859419493132, "mean_env_wait_ms": 0.04646686252030422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005036592483520508, "StateBufferConnector_ms": 0.0031952857971191406, "ViewRequirementAgentConnector_ms": 0.0929877758026123}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 22.8, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.0, 21.0, 43.0, 32.0, 21.0, 32.0, 32.0, 43.0, 43.0, 76.0, -12.0, 76.0, 10.0, -12.0, 54.0, 48.0, 43.0, 76.0, 76.0, 65.0, 54.0, 43.0, 43.0, 76.0, 65.0, -12.0, -1.0, 10.0, -45.0, -78.0, 21.0, -23.0, -45.0, 65.0, 43.0, 54.0, 76.0, 43.0, 76.0, 65.0, -1.0, 65.0, -23.0, -23.0, 54.0, 76.0, 54.0, 76.0, 54.0, 32.0, -1.0, 76.0, 43.0, 32.0, -100.0, -56.0, 21.0, 10.0, 43.0, -1.0, 48.0, 54.0, 43.0, 65.0, -45.0, -12.0, 32.0, -12.0, -12.0, 65.0, -12.0, -34.0, -23.0, -1.0, -12.0, -45.0, 21.0, -23.0, -34.0, -34.0, -12.0, 32.0, 76.0, 65.0, 32.0, 54.0, 65.0, 54.0, 76.0, 65.0, 54.0, 54.0, 65.0, 65.0, -34.0, -111.0, -45.0, -56.0, 10.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20921291687937754, "mean_inference_ms": 10.250471816940113, "mean_action_processing_ms": 0.08964859419493132, "mean_env_wait_ms": 0.04646686252030422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005036592483520508, "StateBufferConnector_ms": 0.0031952857971191406, "ViewRequirementAgentConnector_ms": 0.0929877758026123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 81119.188, "sample_time_ms": 45225.86, "learn_time_ms": 35885.452, "learn_throughput": 111.466, "synch_weights_time_ms": 7.113}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 3052, "training_iteration": 58, "trial_id": "38794_00003", "date": "2023-06-02_00-06-00", "timestamp": 1685653560, "time_this_iter_s": 84.91741609573364, "time_total_s": 4963.104378700256, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4963.104378700256, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 47.11949152542374, "ram_util_percent": 73.77203389830508}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": 27.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 32.0, -45.0, 10.0, -1.0, 21.0, 43.0, 10.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19608326923389674, "mean_inference_ms": 10.277237236780255, "mean_action_processing_ms": 0.08857170724812415, "mean_env_wait_ms": 0.04415159463026413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004580020904541016, "StateBufferConnector_ms": 0.0031614303588867188, "ViewRequirementAgentConnector_ms": 0.0916743278503418}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.015867233276367, "policy_loss": -0.017571453005075455, "vf_loss": 6.024495601654053, "vf_explained_var": 0.028225744143128395, "kl": 0.013248850591480732, "entropy": 2.195394277572632, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 16.81, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -100.0, -56.0, 21.0, 10.0, 43.0, -1.0, 48.0, 54.0, 43.0, 65.0, -45.0, -12.0, 32.0, -12.0, -12.0, 65.0, -12.0, -34.0, -23.0, -1.0, -12.0, -45.0, 21.0, -23.0, -34.0, -34.0, -12.0, 32.0, 76.0, 65.0, 32.0, 54.0, 65.0, 54.0, 76.0, 65.0, 54.0, 54.0, 65.0, 65.0, -34.0, -111.0, -45.0, -56.0, 10.0, -34.0, 32.0, -1.0, -1.0, 32.0, -34.0, -23.0, 76.0, 21.0, 21.0, -12.0, 21.0, 10.0, 21.0, 65.0, 10.0, 32.0, 65.0, 43.0, -34.0, 65.0, 65.0, 21.0, 10.0, -12.0, -23.0, 32.0, 43.0, -29.0, 76.0, 65.0, 32.0, -1.0, 65.0, 54.0, 21.0, 65.0, 76.0, 65.0, -1.0, -12.0, 21.0, -34.0, 43.0, 21.0, 10.0, -12.0, -12.0, 76.0, 54.0, 10.0, -1.0, -12.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2090604717502329, "mean_inference_ms": 10.259679180384332, "mean_action_processing_ms": 0.089604377343957, "mean_env_wait_ms": 0.04643091879861645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004888296127319336, "StateBufferConnector_ms": 0.003064870834350586, "ViewRequirementAgentConnector_ms": 0.09148097038269043}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 16.81, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -100.0, -56.0, 21.0, 10.0, 43.0, -1.0, 48.0, 54.0, 43.0, 65.0, -45.0, -12.0, 32.0, -12.0, -12.0, 65.0, -12.0, -34.0, -23.0, -1.0, -12.0, -45.0, 21.0, -23.0, -34.0, -34.0, -12.0, 32.0, 76.0, 65.0, 32.0, 54.0, 65.0, 54.0, 76.0, 65.0, 54.0, 54.0, 65.0, 65.0, -34.0, -111.0, -45.0, -56.0, 10.0, -34.0, 32.0, -1.0, -1.0, 32.0, -34.0, -23.0, 76.0, 21.0, 21.0, -12.0, 21.0, 10.0, 21.0, 65.0, 10.0, 32.0, 65.0, 43.0, -34.0, 65.0, 65.0, 21.0, 10.0, -12.0, -23.0, 32.0, 43.0, -29.0, 76.0, 65.0, 32.0, -1.0, 65.0, 54.0, 21.0, 65.0, 76.0, 65.0, -1.0, -12.0, 21.0, -34.0, 43.0, 21.0, 10.0, -12.0, -12.0, 76.0, 54.0, 10.0, -1.0, -12.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2090604717502329, "mean_inference_ms": 10.259679180384332, "mean_action_processing_ms": 0.089604377343957, "mean_env_wait_ms": 0.04643091879861645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004888296127319336, "StateBufferConnector_ms": 0.003064870834350586, "ViewRequirementAgentConnector_ms": 0.09148097038269043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 81317.885, "sample_time_ms": 45330.635, "learn_time_ms": 35979.353, "learn_throughput": 111.175, "synch_weights_time_ms": 7.124}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 3105, "training_iteration": 59, "trial_id": "38794_00003", "date": "2023-06-02_00-07-30", "timestamp": 1685653650, "time_this_iter_s": 89.93336391448975, "time_total_s": 5053.037742614746, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5053.037742614746, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 50.7404761904762, "ram_util_percent": 76.35555555555555}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -111.0, "episode_reward_mean": -36.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 10.0, -100.0, -56.0, -89.0, 32.0, -12.0, -111.0, -56.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19609513783339347, "mean_inference_ms": 10.295999177973854, "mean_action_processing_ms": 0.08862530598789241, "mean_env_wait_ms": 0.044171134279667325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005664825439453125, "StateBufferConnector_ms": 0.0037789344787597656, "ViewRequirementAgentConnector_ms": 0.10100841522216797}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.181550025939941, "policy_loss": -0.01344663929194212, "vf_loss": 6.187058925628662, "vf_explained_var": 0.04999895766377449, "kl": 0.011759957298636436, "entropy": 2.285200595855713, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 17.85, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 76.0, 21.0, 21.0, -12.0, 21.0, 10.0, 21.0, 65.0, 10.0, 32.0, 65.0, 43.0, -34.0, 65.0, 65.0, 21.0, 10.0, -12.0, -23.0, 32.0, 43.0, -29.0, 76.0, 65.0, 32.0, -1.0, 65.0, 54.0, 21.0, 65.0, 76.0, 65.0, -1.0, -12.0, 21.0, -34.0, 43.0, 21.0, 10.0, -12.0, -12.0, 76.0, 54.0, 10.0, -1.0, -12.0, 43.0, 32.0, -67.0, 43.0, -23.0, -78.0, 32.0, 43.0, 32.0, 76.0, 32.0, 54.0, 65.0, 76.0, 54.0, 43.0, -56.0, 43.0, -45.0, 54.0, -1.0, -12.0, 43.0, -1.0, -34.0, -56.0, 43.0, 54.0, 43.0, 65.0, 43.0, 32.0, -67.0, -7.0, -23.0, 4.0, -23.0, -34.0, -45.0, -111.0, -1.0, -111.0, -12.0, 21.0, 65.0, 76.0, 54.0, 43.0, 21.0, 54.0, 10.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2089489430720409, "mean_inference_ms": 10.268755184083524, "mean_action_processing_ms": 0.0895783974268371, "mean_env_wait_ms": 0.0464097121548014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049550533294677734, "StateBufferConnector_ms": 0.0030508041381835938, "ViewRequirementAgentConnector_ms": 0.0924835205078125}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 17.85, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 76.0, 21.0, 21.0, -12.0, 21.0, 10.0, 21.0, 65.0, 10.0, 32.0, 65.0, 43.0, -34.0, 65.0, 65.0, 21.0, 10.0, -12.0, -23.0, 32.0, 43.0, -29.0, 76.0, 65.0, 32.0, -1.0, 65.0, 54.0, 21.0, 65.0, 76.0, 65.0, -1.0, -12.0, 21.0, -34.0, 43.0, 21.0, 10.0, -12.0, -12.0, 76.0, 54.0, 10.0, -1.0, -12.0, 43.0, 32.0, -67.0, 43.0, -23.0, -78.0, 32.0, 43.0, 32.0, 76.0, 32.0, 54.0, 65.0, 76.0, 54.0, 43.0, -56.0, 43.0, -45.0, 54.0, -1.0, -12.0, 43.0, -1.0, -34.0, -56.0, 43.0, 54.0, 43.0, 65.0, 43.0, 32.0, -67.0, -7.0, -23.0, 4.0, -23.0, -34.0, -45.0, -111.0, -1.0, -111.0, -12.0, 21.0, 65.0, 76.0, 54.0, 43.0, 21.0, 54.0, 10.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2089489430720409, "mean_inference_ms": 10.268755184083524, "mean_action_processing_ms": 0.0895783974268371, "mean_env_wait_ms": 0.0464097121548014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049550533294677734, "StateBufferConnector_ms": 0.0030508041381835938, "ViewRequirementAgentConnector_ms": 0.0924835205078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 81435.984, "sample_time_ms": 45143.055, "learn_time_ms": 36284.724, "learn_throughput": 110.239, "synch_weights_time_ms": 7.436}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 3157, "training_iteration": 60, "trial_id": "38794_00003", "date": "2023-06-02_00-08-59", "timestamp": 1685653739, "time_this_iter_s": 89.60072088241577, "time_total_s": 5142.638463497162, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5142.638463497162, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 53.83520000000001, "ram_util_percent": 76.44959999999998}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -56.0, "episode_reward_mean": -8.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -23.0, 21.0, -12.0, 10.0, -34.0, -34.0, -12.0, -56.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960119461905763, "mean_inference_ms": 10.300999414298287, "mean_action_processing_ms": 0.08859000515889978, "mean_env_wait_ms": 0.04415375187513176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005571842193603516, "StateBufferConnector_ms": 0.0031447410583496094, "ViewRequirementAgentConnector_ms": 0.09384393692016602}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.633166313171387, "policy_loss": -0.018385402858257294, "vf_loss": 5.640493869781494, "vf_explained_var": 0.015686938539147377, "kl": 0.016382979229092598, "entropy": 2.3286025524139404, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 23.41, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 32.0, 76.0, 32.0, 54.0, 65.0, 76.0, 54.0, 43.0, -56.0, 43.0, -45.0, 54.0, -1.0, -12.0, 43.0, -1.0, -34.0, -56.0, 43.0, 54.0, 43.0, 65.0, 43.0, 32.0, -67.0, -7.0, -23.0, 4.0, -23.0, -34.0, -45.0, -111.0, -1.0, -111.0, -12.0, 21.0, 65.0, 76.0, 54.0, 43.0, 21.0, 54.0, 10.0, 21.0, 21.0, -12.0, -23.0, -122.0, -34.0, 65.0, 43.0, 54.0, 32.0, 21.0, 43.0, 32.0, 32.0, 32.0, 43.0, 65.0, 76.0, 65.0, 76.0, 54.0, 32.0, 43.0, -1.0, 54.0, 43.0, 65.0, 10.0, 65.0, 21.0, 32.0, -1.0, 43.0, 10.0, 32.0, 65.0, 65.0, 76.0, 43.0, 10.0, -56.0, -23.0, 43.0, 65.0, 65.0, 43.0, 10.0, 43.0, 76.0, 54.0, 43.0, 10.0, 54.0, -34.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20892223813380814, "mean_inference_ms": 10.281012655870295, "mean_action_processing_ms": 0.08959251091331605, "mean_env_wait_ms": 0.04641530021901354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050508975982666016, "StateBufferConnector_ms": 0.003168821334838867, "ViewRequirementAgentConnector_ms": 0.09581565856933594}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 23.41, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 32.0, 76.0, 32.0, 54.0, 65.0, 76.0, 54.0, 43.0, -56.0, 43.0, -45.0, 54.0, -1.0, -12.0, 43.0, -1.0, -34.0, -56.0, 43.0, 54.0, 43.0, 65.0, 43.0, 32.0, -67.0, -7.0, -23.0, 4.0, -23.0, -34.0, -45.0, -111.0, -1.0, -111.0, -12.0, 21.0, 65.0, 76.0, 54.0, 43.0, 21.0, 54.0, 10.0, 21.0, 21.0, -12.0, -23.0, -122.0, -34.0, 65.0, 43.0, 54.0, 32.0, 21.0, 43.0, 32.0, 32.0, 32.0, 43.0, 65.0, 76.0, 65.0, 76.0, 54.0, 32.0, 43.0, -1.0, 54.0, 43.0, 65.0, 10.0, 65.0, 21.0, 32.0, -1.0, 43.0, 10.0, 32.0, 65.0, 65.0, 76.0, 43.0, 10.0, -56.0, -23.0, 43.0, 65.0, 65.0, 43.0, 10.0, 43.0, 76.0, 54.0, 43.0, 10.0, 54.0, -34.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20892223813380814, "mean_inference_ms": 10.281012655870295, "mean_action_processing_ms": 0.08959251091331605, "mean_env_wait_ms": 0.04641530021901354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050508975982666016, "StateBufferConnector_ms": 0.003168821334838867, "ViewRequirementAgentConnector_ms": 0.09581565856933594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 81518.659, "sample_time_ms": 45303.575, "learn_time_ms": 36206.662, "learn_throughput": 110.477, "synch_weights_time_ms": 7.682}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 3210, "training_iteration": 61, "trial_id": "38794_00003", "date": "2023-06-02_00-10-31", "timestamp": 1685653831, "time_this_iter_s": 91.7337999343872, "time_total_s": 5234.372263431549, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5234.372263431549, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 53.37890625, "ram_util_percent": 75.52656249999998}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 48.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, 54.0, 65.0, 76.0, 43.0, 76.0, 65.0, 54.0, 54.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19577032175734194, "mean_inference_ms": 10.28830663920213, "mean_action_processing_ms": 0.08848167275818794, "mean_env_wait_ms": 0.04408190583882192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004868507385253906, "StateBufferConnector_ms": 0.0026917457580566406, "ViewRequirementAgentConnector_ms": 0.0869894027709961}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.520254135131836, "policy_loss": -0.01725691929459572, "vf_loss": 5.527245998382568, "vf_explained_var": 0.05186227709054947, "kl": 0.015207254327833652, "entropy": 2.219193935394287, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 33.26, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 21.0, 43.0, 32.0, 32.0, 32.0, 43.0, 65.0, 76.0, 65.0, 76.0, 54.0, 32.0, 43.0, -1.0, 54.0, 43.0, 65.0, 10.0, 65.0, 21.0, 32.0, -1.0, 43.0, 10.0, 32.0, 65.0, 65.0, 76.0, 43.0, 10.0, -56.0, -23.0, 43.0, 65.0, 65.0, 43.0, 10.0, 43.0, 76.0, 54.0, 43.0, 10.0, 54.0, -34.0, 21.0, 65.0, 76.0, 65.0, -23.0, 54.0, 32.0, 21.0, 54.0, -23.0, 76.0, 76.0, 65.0, 65.0, 54.0, 43.0, 43.0, -1.0, 32.0, 32.0, 65.0, 65.0, 76.0, -12.0, 76.0, 65.0, 54.0, 54.0, -34.0, -56.0, 54.0, 32.0, 15.0, -23.0, 76.0, 43.0, 32.0, -56.0, -133.0, 43.0, 21.0, 43.0, -1.0, -56.0, 76.0, 65.0, 76.0, 54.0, -1.0, 65.0, 10.0, -23.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20879113040989558, "mean_inference_ms": 10.282882788570603, "mean_action_processing_ms": 0.08953243424109132, "mean_env_wait_ms": 0.04637369162359627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00463414192199707, "StateBufferConnector_ms": 0.002873659133911133, "ViewRequirementAgentConnector_ms": 0.09098529815673828}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 33.26, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 21.0, 43.0, 32.0, 32.0, 32.0, 43.0, 65.0, 76.0, 65.0, 76.0, 54.0, 32.0, 43.0, -1.0, 54.0, 43.0, 65.0, 10.0, 65.0, 21.0, 32.0, -1.0, 43.0, 10.0, 32.0, 65.0, 65.0, 76.0, 43.0, 10.0, -56.0, -23.0, 43.0, 65.0, 65.0, 43.0, 10.0, 43.0, 76.0, 54.0, 43.0, 10.0, 54.0, -34.0, 21.0, 65.0, 76.0, 65.0, -23.0, 54.0, 32.0, 21.0, 54.0, -23.0, 76.0, 76.0, 65.0, 65.0, 54.0, 43.0, 43.0, -1.0, 32.0, 32.0, 65.0, 65.0, 76.0, -12.0, 76.0, 65.0, 54.0, 54.0, -34.0, -56.0, 54.0, 32.0, 15.0, -23.0, 76.0, 43.0, 32.0, -56.0, -133.0, 43.0, 21.0, 43.0, -1.0, -56.0, 76.0, 65.0, 76.0, 54.0, -1.0, 65.0, 10.0, -23.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20879113040989558, "mean_inference_ms": 10.282882788570603, "mean_action_processing_ms": 0.08953243424109132, "mean_env_wait_ms": 0.04637369162359627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00463414192199707, "StateBufferConnector_ms": 0.002873659133911133, "ViewRequirementAgentConnector_ms": 0.09098529815673828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 80374.213, "sample_time_ms": 44813.029, "learn_time_ms": 35552.902, "learn_throughput": 112.508, "synch_weights_time_ms": 7.548}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 3263, "training_iteration": 62, "trial_id": "38794_00003", "date": "2023-06-02_00-11-50", "timestamp": 1685653910, "time_this_iter_s": 79.10019898414612, "time_total_s": 5313.472462415695, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5313.472462415695, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 44.09272727272728, "ram_util_percent": 75.18272727272729}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 12.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 21.0, 32.0, 32.0, 54.0, -100.0, -56.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19564180654386054, "mean_inference_ms": 10.288810598524348, "mean_action_processing_ms": 0.08840118842087993, "mean_env_wait_ms": 0.04405013919536418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052165985107421875, "StateBufferConnector_ms": 0.0029611587524414062, "ViewRequirementAgentConnector_ms": 0.09035110473632812}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.238324165344238, "policy_loss": -0.014785023406147957, "vf_loss": 6.245108127593994, "vf_explained_var": 0.047339025884866714, "kl": 0.011853561736643314, "entropy": 2.242227077484131, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 22.64, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, 54.0, -23.0, 76.0, 76.0, 65.0, 65.0, 54.0, 43.0, 43.0, -1.0, 32.0, 32.0, 65.0, 65.0, 76.0, -12.0, 76.0, 65.0, 54.0, 54.0, -34.0, -56.0, 54.0, 32.0, 15.0, -23.0, 76.0, 43.0, 32.0, -56.0, -133.0, 43.0, 21.0, 43.0, -1.0, -56.0, 76.0, 65.0, 76.0, 54.0, -1.0, 65.0, 10.0, -23.0, -1.0, 10.0, -56.0, 32.0, -23.0, -34.0, -78.0, 10.0, -56.0, 54.0, 43.0, 54.0, -12.0, 21.0, -56.0, -12.0, -45.0, 65.0, 65.0, 76.0, 76.0, -45.0, 65.0, 54.0, 65.0, 21.0, 37.0, 10.0, 21.0, 21.0, 21.0, -67.0, 21.0, 54.0, 10.0, -45.0, -34.0, -1.0, 32.0, 65.0, 21.0, 54.0, 43.0, 43.0, 54.0, 65.0, 21.0, -1.0, 32.0, 32.0, 54.0, 32.0, -12.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20851249201882768, "mean_inference_ms": 10.271495629589413, "mean_action_processing_ms": 0.0894114052657265, "mean_env_wait_ms": 0.04628512556993286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044918060302734375, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.08555412292480469}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 22.64, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 21.0, 54.0, -23.0, 76.0, 76.0, 65.0, 65.0, 54.0, 43.0, 43.0, -1.0, 32.0, 32.0, 65.0, 65.0, 76.0, -12.0, 76.0, 65.0, 54.0, 54.0, -34.0, -56.0, 54.0, 32.0, 15.0, -23.0, 76.0, 43.0, 32.0, -56.0, -133.0, 43.0, 21.0, 43.0, -1.0, -56.0, 76.0, 65.0, 76.0, 54.0, -1.0, 65.0, 10.0, -23.0, -1.0, 10.0, -56.0, 32.0, -23.0, -34.0, -78.0, 10.0, -56.0, 54.0, 43.0, 54.0, -12.0, 21.0, -56.0, -12.0, -45.0, 65.0, 65.0, 76.0, 76.0, -45.0, 65.0, 54.0, 65.0, 21.0, 37.0, 10.0, 21.0, 21.0, 21.0, -67.0, 21.0, 54.0, 10.0, -45.0, -34.0, -1.0, 32.0, 65.0, 21.0, 54.0, 43.0, 43.0, 54.0, 65.0, 21.0, -1.0, 32.0, 32.0, 54.0, 32.0, -12.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20851249201882768, "mean_inference_ms": 10.271495629589413, "mean_action_processing_ms": 0.0894114052657265, "mean_env_wait_ms": 0.04628512556993286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044918060302734375, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.08555412292480469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 79801.483, "sample_time_ms": 44489.426, "learn_time_ms": 35303.539, "learn_throughput": 113.303, "synch_weights_time_ms": 7.777}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 3315, "training_iteration": 63, "trial_id": "38794_00003", "date": "2023-06-02_00-13-12", "timestamp": 1685653992, "time_this_iter_s": 81.39753913879395, "time_total_s": 5394.870001554489, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5394.870001554489, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 44.782456140350874, "ram_util_percent": 75.05701754385964}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -56.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 65.0, 54.0, 32.0, 65.0, 43.0, -56.0, -12.0, -23.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953755580649334, "mean_inference_ms": 10.276933687964185, "mean_action_processing_ms": 0.08828106543330637, "mean_env_wait_ms": 0.04397671154211457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004541873931884766, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.08395910263061523}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.288748264312744, "policy_loss": -0.011307960376143456, "vf_loss": 6.290473937988281, "vf_explained_var": 0.021377144381403923, "kl": 0.014195212163031101, "entropy": 2.384600877761841, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 17.36, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -56.0, 54.0, 43.0, 54.0, -12.0, 21.0, -56.0, -12.0, -45.0, 65.0, 65.0, 76.0, 76.0, -45.0, 65.0, 54.0, 65.0, 21.0, 37.0, 10.0, 21.0, 21.0, 21.0, -67.0, 21.0, 54.0, 10.0, -45.0, -34.0, -1.0, 32.0, 65.0, 21.0, 54.0, 43.0, 43.0, 54.0, 65.0, 21.0, -1.0, 32.0, 32.0, 54.0, 32.0, -12.0, 54.0, -12.0, 54.0, 65.0, 65.0, 32.0, 54.0, 65.0, 54.0, 76.0, -1.0, 32.0, 15.0, 54.0, -1.0, 43.0, 21.0, 54.0, -23.0, 43.0, 43.0, -45.0, -56.0, -34.0, -12.0, -34.0, 10.0, -56.0, -56.0, -78.0, 43.0, 43.0, -12.0, 65.0, -34.0, 32.0, -100.0, -12.0, 54.0, 54.0, 54.0, 21.0, 54.0, 65.0, 43.0, 76.0, -78.0, -1.0, -133.0, -23.0, -56.0, 32.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20823735407927338, "mean_inference_ms": 10.262526219323545, "mean_action_processing_ms": 0.08929328148781719, "mean_env_wait_ms": 0.04620299650631472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004602909088134766, "StateBufferConnector_ms": 0.002863645553588867, "ViewRequirementAgentConnector_ms": 0.08711409568786621}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 17.36, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -56.0, 54.0, 43.0, 54.0, -12.0, 21.0, -56.0, -12.0, -45.0, 65.0, 65.0, 76.0, 76.0, -45.0, 65.0, 54.0, 65.0, 21.0, 37.0, 10.0, 21.0, 21.0, 21.0, -67.0, 21.0, 54.0, 10.0, -45.0, -34.0, -1.0, 32.0, 65.0, 21.0, 54.0, 43.0, 43.0, 54.0, 65.0, 21.0, -1.0, 32.0, 32.0, 54.0, 32.0, -12.0, 54.0, -12.0, 54.0, 65.0, 65.0, 32.0, 54.0, 65.0, 54.0, 76.0, -1.0, 32.0, 15.0, 54.0, -1.0, 43.0, 21.0, 54.0, -23.0, 43.0, 43.0, -45.0, -56.0, -34.0, -12.0, -34.0, 10.0, -56.0, -56.0, -78.0, 43.0, 43.0, -12.0, 65.0, -34.0, 32.0, -100.0, -12.0, 54.0, 54.0, 54.0, 21.0, 54.0, 65.0, 43.0, 76.0, -78.0, -1.0, -133.0, -23.0, -56.0, 32.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20823735407927338, "mean_inference_ms": 10.262526219323545, "mean_action_processing_ms": 0.08929328148781719, "mean_env_wait_ms": 0.04620299650631472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004602909088134766, "StateBufferConnector_ms": 0.002863645553588867, "ViewRequirementAgentConnector_ms": 0.08711409568786621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 78925.805, "sample_time_ms": 44038.197, "learn_time_ms": 34879.053, "learn_throughput": 114.682, "synch_weights_time_ms": 7.811}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 3368, "training_iteration": 64, "trial_id": "38794_00003", "date": "2023-06-02_00-14-33", "timestamp": 1685654073, "time_this_iter_s": 81.18425512313843, "time_total_s": 5476.054256677628, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5476.054256677628, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 43.37433628318583, "ram_util_percent": 75.50619469026549}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 43.0, "episode_reward_mean": 60.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 54.0, 54.0, 65.0, 76.0, 76.0, 65.0, 54.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19512251609177858, "mean_inference_ms": 10.271450751286423, "mean_action_processing_ms": 0.08815293495371425, "mean_env_wait_ms": 0.04390788868355299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004198551177978516, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.08479595184326172}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.085986137390137, "policy_loss": -0.01691768877208233, "vf_loss": 6.0914812088012695, "vf_explained_var": 0.027084456756711006, "kl": 0.016922902315855026, "entropy": 2.264911413192749, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 17.08, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 76.0, -1.0, 32.0, 15.0, 54.0, -1.0, 43.0, 21.0, 54.0, -23.0, 43.0, 43.0, -45.0, -56.0, -34.0, -12.0, -34.0, 10.0, -56.0, -56.0, -78.0, 43.0, 43.0, -12.0, 65.0, -34.0, 32.0, -100.0, -12.0, 54.0, 54.0, 54.0, 21.0, 54.0, 65.0, 43.0, 76.0, -78.0, -1.0, -133.0, -23.0, -56.0, 32.0, 54.0, 43.0, 54.0, 32.0, 10.0, 10.0, 10.0, 54.0, -12.0, -12.0, 65.0, 10.0, 21.0, 10.0, 21.0, 21.0, 76.0, 65.0, -1.0, 65.0, 54.0, 43.0, -1.0, -1.0, 32.0, -1.0, 43.0, 43.0, 43.0, 43.0, 65.0, 65.0, 43.0, 43.0, 10.0, -12.0, -45.0, 32.0, 21.0, -34.0, -23.0, 21.0, 37.0, -34.0, 21.0, -100.0, 21.0, 54.0, 54.0, 59.0, 32.0, 54.0, 65.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20800822037030237, "mean_inference_ms": 10.256455555871357, "mean_action_processing_ms": 0.08919625887945823, "mean_env_wait_ms": 0.0461365271555972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004544973373413086, "StateBufferConnector_ms": 0.003022432327270508, "ViewRequirementAgentConnector_ms": 0.08709907531738281}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 17.08, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 76.0, -1.0, 32.0, 15.0, 54.0, -1.0, 43.0, 21.0, 54.0, -23.0, 43.0, 43.0, -45.0, -56.0, -34.0, -12.0, -34.0, 10.0, -56.0, -56.0, -78.0, 43.0, 43.0, -12.0, 65.0, -34.0, 32.0, -100.0, -12.0, 54.0, 54.0, 54.0, 21.0, 54.0, 65.0, 43.0, 76.0, -78.0, -1.0, -133.0, -23.0, -56.0, 32.0, 54.0, 43.0, 54.0, 32.0, 10.0, 10.0, 10.0, 54.0, -12.0, -12.0, 65.0, 10.0, 21.0, 10.0, 21.0, 21.0, 76.0, 65.0, -1.0, 65.0, 54.0, 43.0, -1.0, -1.0, 32.0, -1.0, 43.0, 43.0, 43.0, 43.0, 65.0, 65.0, 43.0, 43.0, 10.0, -12.0, -45.0, 32.0, 21.0, -34.0, -23.0, 21.0, 37.0, -34.0, 21.0, -100.0, 21.0, 54.0, 54.0, 59.0, 32.0, 54.0, 65.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20800822037030237, "mean_inference_ms": 10.256455555871357, "mean_action_processing_ms": 0.08919625887945823, "mean_env_wait_ms": 0.0461365271555972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004544973373413086, "StateBufferConnector_ms": 0.003022432327270508, "ViewRequirementAgentConnector_ms": 0.08709907531738281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 77740.178, "sample_time_ms": 43322.119, "learn_time_ms": 34409.572, "learn_throughput": 116.247, "synch_weights_time_ms": 7.779}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 3421, "training_iteration": 65, "trial_id": "38794_00003", "date": "2023-06-02_00-15-54", "timestamp": 1685654154, "time_this_iter_s": 81.17145085334778, "time_total_s": 5557.225707530975, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5557.225707530975, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 47.17345132743363, "ram_util_percent": 73.98495575221241}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 10.0, "episode_reward_mean": 47.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 76.0, 54.0, 21.0, 76.0, 76.0, 54.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1948989204559901, "mean_inference_ms": 10.261393176109767, "mean_action_processing_ms": 0.08806521445616745, "mean_env_wait_ms": 0.043845828342222906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004684925079345703, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.08315086364746094}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.220611572265625, "policy_loss": -0.018408704549074173, "vf_loss": 6.23036003112793, "vf_explained_var": 0.01214881706982851, "kl": 0.012829858809709549, "entropy": 2.2037713527679443, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 18.68, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, -12.0, -12.0, 65.0, 10.0, 21.0, 10.0, 21.0, 21.0, 76.0, 65.0, -1.0, 65.0, 54.0, 43.0, -1.0, -1.0, 32.0, -1.0, 43.0, 43.0, 43.0, 43.0, 65.0, 65.0, 43.0, 43.0, 10.0, -12.0, -45.0, 32.0, 21.0, -34.0, -23.0, 21.0, 37.0, -34.0, 21.0, -100.0, 21.0, 54.0, 54.0, 59.0, 32.0, 54.0, 65.0, 54.0, 10.0, 65.0, 54.0, -12.0, -23.0, 10.0, -144.0, 10.0, 76.0, 54.0, -34.0, -89.0, -122.0, -23.0, 65.0, 65.0, -1.0, 32.0, -12.0, 21.0, 21.0, 32.0, 32.0, 54.0, 43.0, 43.0, -1.0, -1.0, 76.0, 65.0, 10.0, 10.0, 32.0, -23.0, 10.0, 21.0, -67.0, 76.0, 43.0, 21.0, 21.0, 21.0, 65.0, 65.0, 54.0, 43.0, -67.0, -12.0, 32.0, 32.0, 10.0, -45.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20781177221014474, "mean_inference_ms": 10.251698976241396, "mean_action_processing_ms": 0.08910874345975092, "mean_env_wait_ms": 0.04607497166366115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00452113151550293, "StateBufferConnector_ms": 0.0030145645141601562, "ViewRequirementAgentConnector_ms": 0.08848214149475098}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 18.68, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -12.0, -12.0, 65.0, 10.0, 21.0, 10.0, 21.0, 21.0, 76.0, 65.0, -1.0, 65.0, 54.0, 43.0, -1.0, -1.0, 32.0, -1.0, 43.0, 43.0, 43.0, 43.0, 65.0, 65.0, 43.0, 43.0, 10.0, -12.0, -45.0, 32.0, 21.0, -34.0, -23.0, 21.0, 37.0, -34.0, 21.0, -100.0, 21.0, 54.0, 54.0, 59.0, 32.0, 54.0, 65.0, 54.0, 10.0, 65.0, 54.0, -12.0, -23.0, 10.0, -144.0, 10.0, 76.0, 54.0, -34.0, -89.0, -122.0, -23.0, 65.0, 65.0, -1.0, 32.0, -12.0, 21.0, 21.0, 32.0, 32.0, 54.0, 43.0, 43.0, -1.0, -1.0, 76.0, 65.0, 10.0, 10.0, 32.0, -23.0, 10.0, 21.0, -67.0, 76.0, 43.0, 21.0, 21.0, 21.0, 65.0, 65.0, 54.0, 43.0, -67.0, -12.0, 32.0, 32.0, 10.0, -45.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20781177221014474, "mean_inference_ms": 10.251698976241396, "mean_action_processing_ms": 0.08910874345975092, "mean_env_wait_ms": 0.04607497166366115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00452113151550293, "StateBufferConnector_ms": 0.0030145645141601562, "ViewRequirementAgentConnector_ms": 0.08848214149475098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 77222.592, "sample_time_ms": 42867.21, "learn_time_ms": 34347.122, "learn_throughput": 116.458, "synch_weights_time_ms": 7.634}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 3473, "training_iteration": 66, "trial_id": "38794_00003", "date": "2023-06-02_00-17-17", "timestamp": 1685654237, "time_this_iter_s": 83.44873023033142, "time_total_s": 5640.674437761307, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5640.674437761307, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 43.928205128205114, "ram_util_percent": 74.95299145299144}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 10.0, "episode_reward_mean": 47.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 21.0, 32.0, 76.0, 54.0, 65.0, 32.0, 65.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19479271275617768, "mean_inference_ms": 10.259134214467206, "mean_action_processing_ms": 0.08803252883910831, "mean_env_wait_ms": 0.04381552057379917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004985332489013672, "StateBufferConnector_ms": 0.0029540061950683594, "ViewRequirementAgentConnector_ms": 0.08690834045410156}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.258254051208496, "policy_loss": -0.018236009404063225, "vf_loss": 6.267545700073242, "vf_explained_var": 0.05567450821399689, "kl": 0.013251441530883312, "entropy": 2.108170509338379, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 16.38, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-144.0, 10.0, 76.0, 54.0, -34.0, -89.0, -122.0, -23.0, 65.0, 65.0, -1.0, 32.0, -12.0, 21.0, 21.0, 32.0, 32.0, 54.0, 43.0, 43.0, -1.0, -1.0, 76.0, 65.0, 10.0, 10.0, 32.0, -23.0, 10.0, 21.0, -67.0, 76.0, 43.0, 21.0, 21.0, 21.0, 65.0, 65.0, 54.0, 43.0, -67.0, -12.0, 32.0, 32.0, 10.0, -45.0, -34.0, 21.0, -1.0, 21.0, -23.0, -100.0, 32.0, 10.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 21.0, -34.0, 54.0, -12.0, 43.0, -23.0, -12.0, 43.0, 76.0, 32.0, -34.0, 43.0, -34.0, -1.0, 32.0, 21.0, 43.0, 10.0, -78.0, -34.0, -45.0, -34.0, 43.0, 32.0, 43.0, 43.0, 54.0, 76.0, 65.0, -12.0, 76.0, 54.0, 43.0, 21.0, 54.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20778977076506094, "mean_inference_ms": 10.258915318248942, "mean_action_processing_ms": 0.08910232337291013, "mean_env_wait_ms": 0.046073405419236144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00496363639831543, "StateBufferConnector_ms": 0.003152608871459961, "ViewRequirementAgentConnector_ms": 0.09540772438049316}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 16.38, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-144.0, 10.0, 76.0, 54.0, -34.0, -89.0, -122.0, -23.0, 65.0, 65.0, -1.0, 32.0, -12.0, 21.0, 21.0, 32.0, 32.0, 54.0, 43.0, 43.0, -1.0, -1.0, 76.0, 65.0, 10.0, 10.0, 32.0, -23.0, 10.0, 21.0, -67.0, 76.0, 43.0, 21.0, 21.0, 21.0, 65.0, 65.0, 54.0, 43.0, -67.0, -12.0, 32.0, 32.0, 10.0, -45.0, -34.0, 21.0, -1.0, 21.0, -23.0, -100.0, 32.0, 10.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 21.0, -34.0, 54.0, -12.0, 43.0, -23.0, -12.0, 43.0, 76.0, 32.0, -34.0, 43.0, -34.0, -1.0, 32.0, 21.0, 43.0, 10.0, -78.0, -34.0, -45.0, -34.0, 43.0, 32.0, 43.0, 43.0, 54.0, 76.0, 65.0, -12.0, 76.0, 54.0, 43.0, 21.0, 54.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20778977076506094, "mean_inference_ms": 10.258915318248942, "mean_action_processing_ms": 0.08910232337291013, "mean_env_wait_ms": 0.046073405419236144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00496363639831543, "StateBufferConnector_ms": 0.003152608871459961, "ViewRequirementAgentConnector_ms": 0.09540772438049316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 77302.065, "sample_time_ms": 42879.289, "learn_time_ms": 34414.596, "learn_throughput": 116.23, "synch_weights_time_ms": 7.571}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 3526, "training_iteration": 67, "trial_id": "38794_00003", "date": "2023-06-02_00-18-48", "timestamp": 1685654328, "time_this_iter_s": 90.99025511741638, "time_total_s": 5731.664692878723, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5731.664692878723, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 54.20866141732284, "ram_util_percent": 77.0976377952756}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": 21.0, "episode_reward_mean": 51.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 65.0, 43.0, 65.0, 54.0, 65.0, 54.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1948223203326644, "mean_inference_ms": 10.269718719514604, "mean_action_processing_ms": 0.08805968375266982, "mean_env_wait_ms": 0.04384162955091192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054168701171875, "StateBufferConnector_ms": 0.003032684326171875, "ViewRequirementAgentConnector_ms": 0.09602069854736328}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.481144905090332, "policy_loss": -0.015869827941060066, "vf_loss": 5.489354610443115, "vf_explained_var": 0.07733485102653503, "kl": 0.0113483602181077, "entropy": 2.0478689670562744, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 27.49, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 10.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 21.0, -34.0, 54.0, -12.0, 43.0, -23.0, -12.0, 43.0, 76.0, 32.0, -34.0, 43.0, -34.0, -1.0, 32.0, 21.0, 43.0, 10.0, -78.0, -34.0, -45.0, -34.0, 43.0, 32.0, 43.0, 43.0, 54.0, 76.0, 65.0, -12.0, 76.0, 54.0, 43.0, 21.0, 54.0, 21.0, 21.0, 21.0, 76.0, 10.0, 32.0, 10.0, -56.0, -23.0, -23.0, 10.0, 65.0, 43.0, 65.0, 76.0, 76.0, 65.0, 65.0, 54.0, 21.0, 65.0, -34.0, 54.0, 43.0, 54.0, 54.0, 65.0, 65.0, 76.0, 54.0, 65.0, 54.0, 32.0, 10.0, 43.0, -34.0, 54.0, 76.0, 10.0, -23.0, 65.0, 32.0, -78.0, -1.0, 32.0, 21.0, 76.0, 76.0, 65.0, 10.0, -34.0, -45.0, 32.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078578775516468, "mean_inference_ms": 10.271000955553873, "mean_action_processing_ms": 0.08915649172617923, "mean_env_wait_ms": 0.04610463781794802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005196571350097656, "StateBufferConnector_ms": 0.0032117366790771484, "ViewRequirementAgentConnector_ms": 0.09863805770874023}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 27.49, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 10.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 43.0, 21.0, -34.0, 54.0, -12.0, 43.0, -23.0, -12.0, 43.0, 76.0, 32.0, -34.0, 43.0, -34.0, -1.0, 32.0, 21.0, 43.0, 10.0, -78.0, -34.0, -45.0, -34.0, 43.0, 32.0, 43.0, 43.0, 54.0, 76.0, 65.0, -12.0, 76.0, 54.0, 43.0, 21.0, 54.0, 21.0, 21.0, 21.0, 76.0, 10.0, 32.0, 10.0, -56.0, -23.0, -23.0, 10.0, 65.0, 43.0, 65.0, 76.0, 76.0, 65.0, 65.0, 54.0, 21.0, 65.0, -34.0, 54.0, 43.0, 54.0, 54.0, 65.0, 65.0, 76.0, 54.0, 65.0, 54.0, 32.0, 10.0, 43.0, -34.0, 54.0, 76.0, 10.0, -23.0, 65.0, 32.0, -78.0, -1.0, 32.0, 21.0, 76.0, 76.0, 65.0, 10.0, -34.0, -45.0, 32.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078578775516468, "mean_inference_ms": 10.271000955553873, "mean_action_processing_ms": 0.08915649172617923, "mean_env_wait_ms": 0.04610463781794802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005196571350097656, "StateBufferConnector_ms": 0.0032117366790771484, "ViewRequirementAgentConnector_ms": 0.09863805770874023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 77616.714, "sample_time_ms": 42958.05, "learn_time_ms": 34650.474, "learn_throughput": 115.439, "synch_weights_time_ms": 7.597}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 3578, "training_iteration": 68, "trial_id": "38794_00003", "date": "2023-06-02_00-20-17", "timestamp": 1685654417, "time_this_iter_s": 88.59858918190002, "time_total_s": 5820.263282060623, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5820.263282060623, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 51.485365853658536, "ram_util_percent": 75.3520325203252}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 23.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -12.0, 43.0, 76.0, -1.0, -23.0, 32.0, 54.0, -34.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19483625296653834, "mean_inference_ms": 10.270518115987057, "mean_action_processing_ms": 0.08806955264017967, "mean_env_wait_ms": 0.0438310241597379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045680999755859375, "StateBufferConnector_ms": 0.0027441978454589844, "ViewRequirementAgentConnector_ms": 0.09376287460327148}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 4.942217826843262, "policy_loss": -0.01930011436343193, "vf_loss": 4.952471733093262, "vf_explained_var": 0.07471232116222382, "kl": 0.013401187025010586, "entropy": 2.17375111579895, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 31.88, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -23.0, -23.0, 10.0, 65.0, 43.0, 65.0, 76.0, 76.0, 65.0, 65.0, 54.0, 21.0, 65.0, -34.0, 54.0, 43.0, 54.0, 54.0, 65.0, 65.0, 76.0, 54.0, 65.0, 54.0, 32.0, 10.0, 43.0, -34.0, 54.0, 76.0, 10.0, -23.0, 65.0, 32.0, -78.0, -1.0, 32.0, 21.0, 76.0, 76.0, 65.0, 10.0, -34.0, -45.0, 32.0, -12.0, -133.0, -45.0, 10.0, 32.0, 32.0, 43.0, 10.0, 32.0, -67.0, -45.0, 32.0, -23.0, -1.0, -34.0, 43.0, 32.0, 32.0, 65.0, 65.0, 54.0, -12.0, 10.0, -12.0, 54.0, 43.0, 43.0, 65.0, 65.0, 65.0, 76.0, 43.0, 76.0, 65.0, 76.0, 76.0, 65.0, 76.0, 43.0, -133.0, -12.0, 43.0, 54.0, 76.0, 76.0, 43.0, 43.0, 43.0, 76.0, 76.0, 64.0, 76.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078688972541776, "mean_inference_ms": 10.277690740615592, "mean_action_processing_ms": 0.08918281491358165, "mean_env_wait_ms": 0.04611205049962594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050640106201171875, "StateBufferConnector_ms": 0.003103971481323242, "ViewRequirementAgentConnector_ms": 0.09666705131530762}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 31.88, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -23.0, -23.0, 10.0, 65.0, 43.0, 65.0, 76.0, 76.0, 65.0, 65.0, 54.0, 21.0, 65.0, -34.0, 54.0, 43.0, 54.0, 54.0, 65.0, 65.0, 76.0, 54.0, 65.0, 54.0, 32.0, 10.0, 43.0, -34.0, 54.0, 76.0, 10.0, -23.0, 65.0, 32.0, -78.0, -1.0, 32.0, 21.0, 76.0, 76.0, 65.0, 10.0, -34.0, -45.0, 32.0, -12.0, -133.0, -45.0, 10.0, 32.0, 32.0, 43.0, 10.0, 32.0, -67.0, -45.0, 32.0, -23.0, -1.0, -34.0, 43.0, 32.0, 32.0, 65.0, 65.0, 54.0, -12.0, 10.0, -12.0, 54.0, 43.0, 43.0, 65.0, 65.0, 65.0, 76.0, 43.0, 76.0, 65.0, 76.0, 76.0, 65.0, 76.0, 43.0, -133.0, -12.0, 43.0, 54.0, 76.0, 76.0, 43.0, 43.0, 43.0, 76.0, 76.0, 64.0, 76.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078688972541776, "mean_inference_ms": 10.277690740615592, "mean_action_processing_ms": 0.08918281491358165, "mean_env_wait_ms": 0.04611205049962594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050640106201171875, "StateBufferConnector_ms": 0.003103971481323242, "ViewRequirementAgentConnector_ms": 0.09666705131530762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 77388.394, "sample_time_ms": 42851.065, "learn_time_ms": 34529.121, "learn_throughput": 115.844, "synch_weights_time_ms": 7.635}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 3631, "training_iteration": 69, "trial_id": "38794_00003", "date": "2023-06-02_00-21-44", "timestamp": 1685654504, "time_this_iter_s": 87.31157112121582, "time_total_s": 5907.574853181839, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5907.574853181839, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 49.890983606557384, "ram_util_percent": 74.54754098360655}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -1.0, "episode_reward_mean": 44.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 10.0, 54.0, -1.0, 65.0, 43.0, 32.0, 32.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19494918649289525, "mean_inference_ms": 10.286620769220013, "mean_action_processing_ms": 0.0881138395715039, "mean_env_wait_ms": 0.043861884057630494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005934238433837891, "StateBufferConnector_ms": 0.003516674041748047, "ViewRequirementAgentConnector_ms": 0.09848594665527344}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.6893768310546875, "policy_loss": -0.0127124497666955, "vf_loss": 5.691777229309082, "vf_explained_var": 0.07193008810281754, "kl": 0.015277186408638954, "entropy": 2.2531306743621826, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 33.86, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 32.0, -67.0, -45.0, 32.0, -23.0, -1.0, -34.0, 43.0, 32.0, 32.0, 65.0, 65.0, 54.0, -12.0, 10.0, -12.0, 54.0, 43.0, 43.0, 65.0, 65.0, 65.0, 76.0, 43.0, 76.0, 65.0, 76.0, 76.0, 65.0, 76.0, 43.0, -133.0, -12.0, 43.0, 54.0, 76.0, 76.0, 43.0, 43.0, 43.0, 76.0, 76.0, 64.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 65.0, 65.0, 54.0, 32.0, 21.0, 21.0, 43.0, -1.0, -23.0, -23.0, 10.0, 43.0, 43.0, 10.0, 76.0, 32.0, 43.0, 65.0, 43.0, 10.0, 43.0, -1.0, 21.0, 54.0, 32.0, 43.0, 65.0, -67.0, -12.0, 32.0, -1.0, 65.0, 43.0, 65.0, 65.0, 10.0, -23.0, 10.0, 10.0, 21.0, -78.0, -1.0, 10.0, -1.0, 21.0, 65.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20784243370107042, "mean_inference_ms": 10.280070233415499, "mean_action_processing_ms": 0.08919688133711962, "mean_env_wait_ms": 0.046111925530872434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005072593688964844, "StateBufferConnector_ms": 0.00310516357421875, "ViewRequirementAgentConnector_ms": 0.09450268745422363}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 33.86, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 32.0, -67.0, -45.0, 32.0, -23.0, -1.0, -34.0, 43.0, 32.0, 32.0, 65.0, 65.0, 54.0, -12.0, 10.0, -12.0, 54.0, 43.0, 43.0, 65.0, 65.0, 65.0, 76.0, 43.0, 76.0, 65.0, 76.0, 76.0, 65.0, 76.0, 43.0, -133.0, -12.0, 43.0, 54.0, 76.0, 76.0, 43.0, 43.0, 43.0, 76.0, 76.0, 64.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 65.0, 65.0, 54.0, 32.0, 21.0, 21.0, 43.0, -1.0, -23.0, -23.0, 10.0, 43.0, 43.0, 10.0, 76.0, 32.0, 43.0, 65.0, 43.0, 10.0, 43.0, -1.0, 21.0, 54.0, 32.0, 43.0, 65.0, -67.0, -12.0, 32.0, -1.0, 65.0, 43.0, 65.0, 65.0, 10.0, -23.0, 10.0, 10.0, 21.0, -78.0, -1.0, 10.0, -1.0, 21.0, 65.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20784243370107042, "mean_inference_ms": 10.280070233415499, "mean_action_processing_ms": 0.08919688133711962, "mean_env_wait_ms": 0.046111925530872434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005072593688964844, "StateBufferConnector_ms": 0.00310516357421875, "ViewRequirementAgentConnector_ms": 0.09450268745422363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 77065.353, "sample_time_ms": 42678.564, "learn_time_ms": 34378.752, "learn_throughput": 116.351, "synch_weights_time_ms": 7.467}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 3684, "training_iteration": 70, "trial_id": "38794_00003", "date": "2023-06-02_00-23-11", "timestamp": 1685654591, "time_this_iter_s": 86.36796855926514, "time_total_s": 5993.942821741104, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5993.942821741104, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 61.54833333333334, "ram_util_percent": 74.81749999999998}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -23.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 21.0, 10.0, -23.0, 21.0, 32.0, 21.0, -12.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19522247523706177, "mean_inference_ms": 10.316774663573295, "mean_action_processing_ms": 0.0882770139406102, "mean_env_wait_ms": 0.0439448948775672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005409717559814453, "StateBufferConnector_ms": 0.003299713134765625, "ViewRequirementAgentConnector_ms": 0.09884834289550781}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.721540451049805, "policy_loss": -0.01240679994225502, "vf_loss": 6.725822448730469, "vf_explained_var": 0.041742634028196335, "kl": 0.012036464177072048, "entropy": 2.193509817123413, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 17.04, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 54.0, 32.0, 21.0, 21.0, 43.0, -1.0, -23.0, -23.0, 10.0, 43.0, 43.0, 10.0, 76.0, 32.0, 43.0, 65.0, 43.0, 10.0, 43.0, -1.0, 21.0, 54.0, 32.0, 43.0, 65.0, -67.0, -12.0, 32.0, -1.0, 65.0, 43.0, 65.0, 65.0, 10.0, -23.0, 10.0, 10.0, 21.0, -78.0, -1.0, 10.0, -1.0, 21.0, 65.0, 32.0, 65.0, 21.0, 54.0, 54.0, 10.0, -56.0, -23.0, 32.0, 54.0, -12.0, 54.0, -1.0, 54.0, -1.0, 21.0, -1.0, -34.0, -34.0, -67.0, -45.0, -34.0, 21.0, 65.0, 32.0, 21.0, 32.0, 43.0, 54.0, -45.0, -56.0, 21.0, 10.0, 32.0, -23.0, 10.0, -1.0, -122.0, 32.0, -1.0, -100.0, 43.0, 65.0, 43.0, 65.0, -1.0, 43.0, 76.0, 65.0, -1.0, 21.0, 21.0, 76.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078610429608493, "mean_inference_ms": 10.288005437623399, "mean_action_processing_ms": 0.08921504554185923, "mean_env_wait_ms": 0.046121982283957426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051517486572265625, "StateBufferConnector_ms": 0.0031082630157470703, "ViewRequirementAgentConnector_ms": 0.0948941707611084}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 17.04, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 54.0, 32.0, 21.0, 21.0, 43.0, -1.0, -23.0, -23.0, 10.0, 43.0, 43.0, 10.0, 76.0, 32.0, 43.0, 65.0, 43.0, 10.0, 43.0, -1.0, 21.0, 54.0, 32.0, 43.0, 65.0, -67.0, -12.0, 32.0, -1.0, 65.0, 43.0, 65.0, 65.0, 10.0, -23.0, 10.0, 10.0, 21.0, -78.0, -1.0, 10.0, -1.0, 21.0, 65.0, 32.0, 65.0, 21.0, 54.0, 54.0, 10.0, -56.0, -23.0, 32.0, 54.0, -12.0, 54.0, -1.0, 54.0, -1.0, 21.0, -1.0, -34.0, -34.0, -67.0, -45.0, -34.0, 21.0, 65.0, 32.0, 21.0, 32.0, 43.0, 54.0, -45.0, -56.0, 21.0, 10.0, 32.0, -23.0, 10.0, -1.0, -122.0, 32.0, -1.0, -100.0, 43.0, 65.0, 43.0, 65.0, -1.0, 43.0, 76.0, 65.0, -1.0, 21.0, 21.0, 76.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078610429608493, "mean_inference_ms": 10.288005437623399, "mean_action_processing_ms": 0.08921504554185923, "mean_env_wait_ms": 0.046121982283957426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051517486572265625, "StateBufferConnector_ms": 0.0031082630157470703, "ViewRequirementAgentConnector_ms": 0.0948941707611084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 77090.441, "sample_time_ms": 42716.885, "learn_time_ms": 34365.55, "learn_throughput": 116.396, "synch_weights_time_ms": 7.386}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 3736, "training_iteration": 71, "trial_id": "38794_00003", "date": "2023-06-02_00-24-44", "timestamp": 1685654684, "time_this_iter_s": 93.41180205345154, "time_total_s": 6087.354623794556, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6087.354623794556, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 64.14274809160305, "ram_util_percent": 75.6648854961832}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -12.0, "episode_reward_mean": 29.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -1.0, -1.0, 43.0, 76.0, 65.0, -12.0, -1.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511274443486437, "mean_inference_ms": 10.317766893629123, "mean_action_processing_ms": 0.088231622518123, "mean_env_wait_ms": 0.04392044404927158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005128383636474609, "StateBufferConnector_ms": 0.0028562545776367188, "ViewRequirementAgentConnector_ms": 0.08895635604858398}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.400848865509033, "policy_loss": -0.01687702164053917, "vf_loss": 6.407330513000488, "vf_explained_var": 0.04732205718755722, "kl": 0.015400469303131104, "entropy": 2.129054069519043, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 14.89, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 32.0, 54.0, -12.0, 54.0, -1.0, 54.0, -1.0, 21.0, -1.0, -34.0, -34.0, -67.0, -45.0, -34.0, 21.0, 65.0, 32.0, 21.0, 32.0, 43.0, 54.0, -45.0, -56.0, 21.0, 10.0, 32.0, -23.0, 10.0, -1.0, -122.0, 32.0, -1.0, -100.0, 43.0, 65.0, 43.0, 65.0, -1.0, 43.0, 76.0, 65.0, -1.0, 21.0, 21.0, 76.0, -100.0, 43.0, -12.0, -78.0, 10.0, -23.0, -45.0, 21.0, 43.0, -1.0, 54.0, 43.0, 32.0, 54.0, 43.0, -67.0, 32.0, 43.0, -12.0, 76.0, 43.0, -34.0, 43.0, 43.0, 43.0, -12.0, 10.0, 32.0, 65.0, 37.0, 43.0, 54.0, 65.0, 65.0, 76.0, 21.0, 54.0, 21.0, 21.0, 10.0, 21.0, 43.0, 10.0, -12.0, -34.0, 21.0, 10.0, 43.0, 43.0, 43.0, -12.0, -23.0, 10.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20796600402797424, "mean_inference_ms": 10.304317383624314, "mean_action_processing_ms": 0.08927074576976239, "mean_env_wait_ms": 0.04615898449217239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005421161651611328, "StateBufferConnector_ms": 0.003112316131591797, "ViewRequirementAgentConnector_ms": 0.1002202033996582}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 14.89, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 32.0, 54.0, -12.0, 54.0, -1.0, 54.0, -1.0, 21.0, -1.0, -34.0, -34.0, -67.0, -45.0, -34.0, 21.0, 65.0, 32.0, 21.0, 32.0, 43.0, 54.0, -45.0, -56.0, 21.0, 10.0, 32.0, -23.0, 10.0, -1.0, -122.0, 32.0, -1.0, -100.0, 43.0, 65.0, 43.0, 65.0, -1.0, 43.0, 76.0, 65.0, -1.0, 21.0, 21.0, 76.0, -100.0, 43.0, -12.0, -78.0, 10.0, -23.0, -45.0, 21.0, 43.0, -1.0, 54.0, 43.0, 32.0, 54.0, 43.0, -67.0, 32.0, 43.0, -12.0, 76.0, 43.0, -34.0, 43.0, 43.0, 43.0, -12.0, 10.0, 32.0, 65.0, 37.0, 43.0, 54.0, 65.0, 65.0, 76.0, 21.0, 54.0, 21.0, 21.0, 10.0, 21.0, 43.0, 10.0, -12.0, -34.0, 21.0, 10.0, 43.0, 43.0, 43.0, -12.0, -23.0, 10.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20796600402797424, "mean_inference_ms": 10.304317383624314, "mean_action_processing_ms": 0.08927074576976239, "mean_env_wait_ms": 0.04615898449217239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005421161651611328, "StateBufferConnector_ms": 0.003112316131591797, "ViewRequirementAgentConnector_ms": 0.1002202033996582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 78060.415, "sample_time_ms": 43500.03, "learn_time_ms": 34552.252, "learn_throughput": 115.767, "synch_weights_time_ms": 7.49}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 3789, "training_iteration": 72, "trial_id": "38794_00003", "date": "2023-06-02_00-26-14", "timestamp": 1685654774, "time_this_iter_s": 89.47288608551025, "time_total_s": 6176.827509880066, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6176.827509880066, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 62.5733870967742, "ram_util_percent": 69.91370967741933}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 6.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -45.0, 32.0, 32.0, -45.0, -1.0, 54.0, -23.0, 21.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19493996178467204, "mean_inference_ms": 10.312651808360147, "mean_action_processing_ms": 0.0881748449050156, "mean_env_wait_ms": 0.04387453199238666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004696846008300781, "StateBufferConnector_ms": 0.0027513504028320312, "ViewRequirementAgentConnector_ms": 0.08248090744018555}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.4161458015441895, "policy_loss": -0.016945822164416313, "vf_loss": 5.422806739807129, "vf_explained_var": 0.05411690101027489, "kl": 0.015235856175422668, "entropy": 2.1978790760040283, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 29.85, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, -1.0, 54.0, 43.0, 32.0, 54.0, 43.0, -67.0, 32.0, 43.0, -12.0, 76.0, 43.0, -34.0, 43.0, 43.0, 43.0, -12.0, 10.0, 32.0, 65.0, 37.0, 43.0, 54.0, 65.0, 65.0, 76.0, 21.0, 54.0, 21.0, 21.0, 10.0, 21.0, 43.0, 10.0, -12.0, -34.0, 21.0, 10.0, 43.0, 43.0, 43.0, -12.0, -23.0, 10.0, -34.0, 43.0, 43.0, -12.0, -1.0, 32.0, 10.0, 21.0, 10.0, 65.0, 21.0, -1.0, 54.0, 43.0, 65.0, 54.0, 32.0, 10.0, -1.0, 21.0, 32.0, 43.0, -34.0, -23.0, 21.0, 43.0, 76.0, 65.0, 54.0, 43.0, 54.0, 76.0, 43.0, 65.0, 54.0, -12.0, 43.0, 76.0, 76.0, 21.0, -78.0, 21.0, 21.0, 76.0, 32.0, 10.0, 32.0, 43.0, 43.0, 32.0, 65.0, 65.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2079999181203062, "mean_inference_ms": 10.315297871981185, "mean_action_processing_ms": 0.0892954579454795, "mean_env_wait_ms": 0.046176127103594825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052301883697509766, "StateBufferConnector_ms": 0.0031332969665527344, "ViewRequirementAgentConnector_ms": 0.0987098217010498}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 29.85, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 43.0, -1.0, 54.0, 43.0, 32.0, 54.0, 43.0, -67.0, 32.0, 43.0, -12.0, 76.0, 43.0, -34.0, 43.0, 43.0, 43.0, -12.0, 10.0, 32.0, 65.0, 37.0, 43.0, 54.0, 65.0, 65.0, 76.0, 21.0, 54.0, 21.0, 21.0, 10.0, 21.0, 43.0, 10.0, -12.0, -34.0, 21.0, 10.0, 43.0, 43.0, 43.0, -12.0, -23.0, 10.0, -34.0, 43.0, 43.0, -12.0, -1.0, 32.0, 10.0, 21.0, 10.0, 65.0, 21.0, -1.0, 54.0, 43.0, 65.0, 54.0, 32.0, 10.0, -1.0, 21.0, 32.0, 43.0, -34.0, -23.0, 21.0, 43.0, 76.0, 65.0, 54.0, 43.0, 54.0, 76.0, 43.0, 65.0, 54.0, -12.0, 43.0, 76.0, 76.0, 21.0, -78.0, 21.0, 21.0, 76.0, 32.0, 10.0, 32.0, 43.0, 43.0, 32.0, 65.0, 65.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2079999181203062, "mean_inference_ms": 10.315297871981185, "mean_action_processing_ms": 0.0892954579454795, "mean_env_wait_ms": 0.046176127103594825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052301883697509766, "StateBufferConnector_ms": 0.0031332969665527344, "ViewRequirementAgentConnector_ms": 0.0987098217010498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 78731.374, "sample_time_ms": 43990.802, "learn_time_ms": 34732.543, "learn_throughput": 115.166, "synch_weights_time_ms": 7.404}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 3842, "training_iteration": 73, "trial_id": "38794_00003", "date": "2023-06-02_00-27-42", "timestamp": 1685654862, "time_this_iter_s": 87.80995488166809, "time_total_s": 6264.637464761734, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6264.637464761734, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 53.28130081300812, "ram_util_percent": 69.16504065040651}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -23.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 32.0, -1.0, -23.0, -1.0, 76.0, 54.0, 43.0, 54.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1949143633136467, "mean_inference_ms": 10.320700507264808, "mean_action_processing_ms": 0.0881933686497587, "mean_env_wait_ms": 0.04387340615855959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005524158477783203, "StateBufferConnector_ms": 0.0031757354736328125, "ViewRequirementAgentConnector_ms": 0.09708881378173828}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.490940570831299, "policy_loss": -0.018997546285390854, "vf_loss": 6.499672889709473, "vf_explained_var": 0.029475461691617966, "kl": 0.015208151191473007, "entropy": 2.2697625160217285, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 22.54, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 21.0, 10.0, 65.0, 21.0, -1.0, 54.0, 43.0, 65.0, 54.0, 32.0, 10.0, -1.0, 21.0, 32.0, 43.0, -34.0, -23.0, 21.0, 43.0, 76.0, 65.0, 54.0, 43.0, 54.0, 76.0, 43.0, 65.0, 54.0, -12.0, 43.0, 76.0, 76.0, 21.0, -78.0, 21.0, 21.0, 76.0, 32.0, 10.0, 32.0, 43.0, 43.0, 32.0, 65.0, 65.0, 65.0, 43.0, 54.0, 65.0, 54.0, 43.0, -12.0, 76.0, 43.0, 54.0, -45.0, -34.0, -12.0, 43.0, 32.0, 43.0, 10.0, 32.0, -23.0, 21.0, -23.0, -12.0, -56.0, 10.0, 21.0, -34.0, -67.0, -67.0, 21.0, 54.0, 43.0, 10.0, 43.0, -1.0, -34.0, -1.0, -23.0, 43.0, 54.0, 21.0, 76.0, -1.0, -23.0, -1.0, 32.0, 32.0, 10.0, 43.0, 65.0, -45.0, -122.0, 10.0, -23.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20793751296423812, "mean_inference_ms": 10.318555063659218, "mean_action_processing_ms": 0.08927380358652887, "mean_env_wait_ms": 0.04615639204944176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049173831939697266, "StateBufferConnector_ms": 0.0030519962310791016, "ViewRequirementAgentConnector_ms": 0.09409904479980469}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 22.54, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 21.0, 10.0, 65.0, 21.0, -1.0, 54.0, 43.0, 65.0, 54.0, 32.0, 10.0, -1.0, 21.0, 32.0, 43.0, -34.0, -23.0, 21.0, 43.0, 76.0, 65.0, 54.0, 43.0, 54.0, 76.0, 43.0, 65.0, 54.0, -12.0, 43.0, 76.0, 76.0, 21.0, -78.0, 21.0, 21.0, 76.0, 32.0, 10.0, 32.0, 43.0, 43.0, 32.0, 65.0, 65.0, 65.0, 43.0, 54.0, 65.0, 54.0, 43.0, -12.0, 76.0, 43.0, 54.0, -45.0, -34.0, -12.0, 43.0, 32.0, 43.0, 10.0, 32.0, -23.0, 21.0, -23.0, -12.0, -56.0, 10.0, 21.0, -34.0, -67.0, -67.0, 21.0, 54.0, 43.0, 10.0, 43.0, -1.0, -34.0, -1.0, -23.0, 43.0, 54.0, 21.0, 76.0, -1.0, -23.0, -1.0, 32.0, 32.0, 10.0, 43.0, 65.0, -45.0, -122.0, 10.0, -23.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20793751296423812, "mean_inference_ms": 10.318555063659218, "mean_action_processing_ms": 0.08927380358652887, "mean_env_wait_ms": 0.04615639204944176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049173831939697266, "StateBufferConnector_ms": 0.0030519962310791016, "ViewRequirementAgentConnector_ms": 0.09409904479980469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 78995.115, "sample_time_ms": 44209.032, "learn_time_ms": 34778.215, "learn_throughput": 115.015, "synch_weights_time_ms": 7.244}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 3894, "training_iteration": 74, "trial_id": "38794_00003", "date": "2023-06-02_00-29-06", "timestamp": 1685654946, "time_this_iter_s": 84.8927710056305, "time_total_s": 6349.5302357673645, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6349.5302357673645, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 47.815254237288144, "ram_util_percent": 69.59406779661018}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -12.0, "episode_reward_mean": 26.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, 54.0, -1.0, 54.0, 43.0, 43.0, 21.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19493545306962598, "mean_inference_ms": 10.333697140562945, "mean_action_processing_ms": 0.08819616082881564, "mean_env_wait_ms": 0.04388068831198462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047588348388671875, "StateBufferConnector_ms": 0.003345012664794922, "ViewRequirementAgentConnector_ms": 0.09393692016601562}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 7.292555809020996, "policy_loss": -0.015325194224715233, "vf_loss": 7.297273635864258, "vf_explained_var": 0.03534157574176788, "kl": 0.01571403630077839, "entropy": 2.3803961277008057, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -210.0, "episode_reward_mean": 5.27, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 43.0, 54.0, -45.0, -34.0, -12.0, 43.0, 32.0, 43.0, 10.0, 32.0, -23.0, 21.0, -23.0, -12.0, -56.0, 10.0, 21.0, -34.0, -67.0, -67.0, 21.0, 54.0, 43.0, 10.0, 43.0, -1.0, -34.0, -1.0, -23.0, 43.0, 54.0, 21.0, 76.0, -1.0, -23.0, -1.0, 32.0, 32.0, 10.0, 43.0, 65.0, -45.0, -122.0, 10.0, -23.0, 65.0, 10.0, 43.0, 43.0, 76.0, 10.0, -1.0, -34.0, -1.0, -23.0, -45.0, 65.0, -45.0, 21.0, 21.0, -1.0, 76.0, 43.0, 10.0, 10.0, -12.0, -1.0, -34.0, -23.0, 10.0, -23.0, 54.0, -23.0, -12.0, -12.0, 10.0, -45.0, -210.0, 21.0, 10.0, -12.0, -34.0, -23.0, -1.0, -34.0, -45.0, 32.0, 21.0, 43.0, 65.0, 65.0, 76.0, 10.0, 21.0, 10.0, 21.0, 54.0, -45.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2079395085829347, "mean_inference_ms": 10.324374609462128, "mean_action_processing_ms": 0.08929480290760719, "mean_env_wait_ms": 0.046152426009755575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005112886428833008, "StateBufferConnector_ms": 0.003042936325073242, "ViewRequirementAgentConnector_ms": 0.09496808052062988}}, "episode_reward_max": 76.0, "episode_reward_min": -210.0, "episode_reward_mean": 5.27, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 43.0, 54.0, -45.0, -34.0, -12.0, 43.0, 32.0, 43.0, 10.0, 32.0, -23.0, 21.0, -23.0, -12.0, -56.0, 10.0, 21.0, -34.0, -67.0, -67.0, 21.0, 54.0, 43.0, 10.0, 43.0, -1.0, -34.0, -1.0, -23.0, 43.0, 54.0, 21.0, 76.0, -1.0, -23.0, -1.0, 32.0, 32.0, 10.0, 43.0, 65.0, -45.0, -122.0, 10.0, -23.0, 65.0, 10.0, 43.0, 43.0, 76.0, 10.0, -1.0, -34.0, -1.0, -23.0, -45.0, 65.0, -45.0, 21.0, 21.0, -1.0, 76.0, 43.0, 10.0, 10.0, -12.0, -1.0, -34.0, -23.0, 10.0, -23.0, 54.0, -23.0, -12.0, -12.0, 10.0, -45.0, -210.0, 21.0, 10.0, -12.0, -34.0, -23.0, -1.0, -34.0, -45.0, 32.0, 21.0, 43.0, 65.0, 65.0, 76.0, 10.0, 21.0, 10.0, 21.0, 54.0, -45.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2079395085829347, "mean_inference_ms": 10.324374609462128, "mean_action_processing_ms": 0.08929480290760719, "mean_env_wait_ms": 0.046152426009755575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005112886428833008, "StateBufferConnector_ms": 0.003042936325073242, "ViewRequirementAgentConnector_ms": 0.09496808052062988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 80049.689, "sample_time_ms": 44702.439, "learn_time_ms": 35339.462, "learn_throughput": 113.188, "synch_weights_time_ms": 7.168}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 3947, "training_iteration": 75, "trial_id": "38794_00003", "date": "2023-06-02_00-30-39", "timestamp": 1685655039, "time_this_iter_s": 92.79141187667847, "time_total_s": 6442.321647644043, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6442.321647644043, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 52.548837209302334, "ram_util_percent": 70.72713178294573}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -56.0, "episode_reward_mean": 18.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 10.0, 32.0, -56.0, -34.0, 10.0, 54.0, 43.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1946055524449639, "mean_inference_ms": 10.318691018351668, "mean_action_processing_ms": 0.08805874087007641, "mean_env_wait_ms": 0.043773021239991335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043582916259765625, "StateBufferConnector_ms": 0.002696514129638672, "ViewRequirementAgentConnector_ms": 0.07923603057861328}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.890103340148926, "policy_loss": -0.020368274301290512, "vf_loss": 5.899487018585205, "vf_explained_var": 0.08865268528461456, "kl": 0.01627383381128311, "entropy": 2.345764636993408, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -210.0, "episode_reward_mean": 12.75, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -1.0, -23.0, -45.0, 65.0, -45.0, 21.0, 21.0, -1.0, 76.0, 43.0, 10.0, 10.0, -12.0, -1.0, -34.0, -23.0, 10.0, -23.0, 54.0, -23.0, -12.0, -12.0, 10.0, -45.0, -210.0, 21.0, 10.0, -12.0, -34.0, -23.0, -1.0, -34.0, -45.0, 32.0, 21.0, 43.0, 65.0, 65.0, 76.0, 10.0, 21.0, 10.0, 21.0, 54.0, -45.0, -45.0, -67.0, 32.0, 32.0, 65.0, 76.0, 76.0, 65.0, 10.0, -23.0, 65.0, 32.0, -1.0, 10.0, 65.0, 21.0, 65.0, 76.0, 65.0, 65.0, 76.0, 65.0, 76.0, 32.0, 32.0, 54.0, 32.0, 32.0, 10.0, -1.0, -34.0, -1.0, 32.0, 54.0, -23.0, -34.0, -23.0, 43.0, 32.0, 43.0, 21.0, -23.0, -45.0, -133.0, -12.0, 32.0, 21.0, 32.0, -1.0, 32.0, 43.0, 43.0, 65.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20782934846554363, "mean_inference_ms": 10.324797174421674, "mean_action_processing_ms": 0.08925155730975477, "mean_env_wait_ms": 0.04611682692464871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004910945892333984, "StateBufferConnector_ms": 0.002988100051879883, "ViewRequirementAgentConnector_ms": 0.08976411819458008}}, "episode_reward_max": 76.0, "episode_reward_min": -210.0, "episode_reward_mean": 12.75, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -1.0, -23.0, -45.0, 65.0, -45.0, 21.0, 21.0, -1.0, 76.0, 43.0, 10.0, 10.0, -12.0, -1.0, -34.0, -23.0, 10.0, -23.0, 54.0, -23.0, -12.0, -12.0, 10.0, -45.0, -210.0, 21.0, 10.0, -12.0, -34.0, -23.0, -1.0, -34.0, -45.0, 32.0, 21.0, 43.0, 65.0, 65.0, 76.0, 10.0, 21.0, 10.0, 21.0, 54.0, -45.0, -45.0, -67.0, 32.0, 32.0, 65.0, 76.0, 76.0, 65.0, 10.0, -23.0, 65.0, 32.0, -1.0, 10.0, 65.0, 21.0, 65.0, 76.0, 65.0, 65.0, 76.0, 65.0, 76.0, 32.0, 32.0, 54.0, 32.0, 32.0, 10.0, -1.0, -34.0, -1.0, 32.0, 54.0, -23.0, -34.0, -23.0, 43.0, 32.0, 43.0, 21.0, -23.0, -45.0, -133.0, -12.0, 32.0, 21.0, 32.0, -1.0, 32.0, 43.0, 43.0, 65.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20782934846554363, "mean_inference_ms": 10.324797174421674, "mean_action_processing_ms": 0.08925155730975477, "mean_env_wait_ms": 0.04611682692464871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004910945892333984, "StateBufferConnector_ms": 0.002988100051879883, "ViewRequirementAgentConnector_ms": 0.08976411819458008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 79640.182, "sample_time_ms": 44580.132, "learn_time_ms": 35052.231, "learn_throughput": 114.115, "synch_weights_time_ms": 7.205}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 4000, "training_iteration": 76, "trial_id": "38794_00003", "date": "2023-06-02_00-31-58", "timestamp": 1685655118, "time_this_iter_s": 79.02144503593445, "time_total_s": 6521.343092679977, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6521.343092679977, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 40.77207207207206, "ram_util_percent": 66.54594594594596}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 19.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 21.0, 43.0, 76.0, 43.0, -1.0, -1.0, -1.0, 32.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19429393717531357, "mean_inference_ms": 10.30906616314321, "mean_action_processing_ms": 0.08789097357732487, "mean_env_wait_ms": 0.04367757398862469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004484653472900391, "StateBufferConnector_ms": 0.002467632293701172, "ViewRequirementAgentConnector_ms": 0.08055925369262695}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.8207621574401855, "policy_loss": -0.022267276421189308, "vf_loss": 5.832602024078369, "vf_explained_var": 0.052412454038858414, "kl": 0.015447819605469704, "entropy": 2.363206386566162, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 26.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 65.0, 10.0, -23.0, 65.0, 32.0, -1.0, 10.0, 65.0, 21.0, 65.0, 76.0, 65.0, 65.0, 76.0, 65.0, 76.0, 32.0, 32.0, 54.0, 32.0, 32.0, 10.0, -1.0, -34.0, -1.0, 32.0, 54.0, -23.0, -34.0, -23.0, 43.0, 32.0, 43.0, 21.0, -23.0, -45.0, -133.0, -12.0, 32.0, 21.0, 32.0, -1.0, 32.0, 43.0, 43.0, 65.0, -12.0, -12.0, 21.0, -111.0, -12.0, -67.0, 10.0, -34.0, 43.0, 21.0, 10.0, 10.0, 65.0, -1.0, 43.0, 10.0, 43.0, 76.0, 32.0, 21.0, 10.0, 54.0, -12.0, 21.0, 54.0, 21.0, -1.0, 76.0, 21.0, 43.0, 32.0, 54.0, 10.0, 65.0, 65.0, 54.0, 65.0, 10.0, 76.0, 76.0, 54.0, 43.0, 76.0, 76.0, -1.0, 43.0, 43.0, 43.0, 54.0, 54.0, -1.0, 65.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20753019081806412, "mean_inference_ms": 10.31375439427143, "mean_action_processing_ms": 0.08911395664257352, "mean_env_wait_ms": 0.04601951920127607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004411220550537109, "StateBufferConnector_ms": 0.0027985572814941406, "ViewRequirementAgentConnector_ms": 0.0803985595703125}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 26.5, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 65.0, 10.0, -23.0, 65.0, 32.0, -1.0, 10.0, 65.0, 21.0, 65.0, 76.0, 65.0, 65.0, 76.0, 65.0, 76.0, 32.0, 32.0, 54.0, 32.0, 32.0, 10.0, -1.0, -34.0, -1.0, 32.0, 54.0, -23.0, -34.0, -23.0, 43.0, 32.0, 43.0, 21.0, -23.0, -45.0, -133.0, -12.0, 32.0, 21.0, 32.0, -1.0, 32.0, 43.0, 43.0, 65.0, -12.0, -12.0, 21.0, -111.0, -12.0, -67.0, 10.0, -34.0, 43.0, 21.0, 10.0, 10.0, 65.0, -1.0, 43.0, 10.0, 43.0, 76.0, 32.0, 21.0, 10.0, 54.0, -12.0, 21.0, 54.0, 21.0, -1.0, 76.0, 21.0, 43.0, 32.0, 54.0, 10.0, 65.0, 65.0, 54.0, 65.0, 10.0, 76.0, 76.0, 54.0, 43.0, 76.0, 76.0, -1.0, 43.0, 43.0, 43.0, 54.0, 54.0, -1.0, 65.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20753019081806412, "mean_inference_ms": 10.31375439427143, "mean_action_processing_ms": 0.08911395664257352, "mean_env_wait_ms": 0.04601951920127607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004411220550537109, "StateBufferConnector_ms": 0.0027985572814941406, "ViewRequirementAgentConnector_ms": 0.0803985595703125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 78347.495, "sample_time_ms": 43697.749, "learn_time_ms": 34642.05, "learn_throughput": 115.467, "synch_weights_time_ms": 7.108}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 4052, "training_iteration": 77, "trial_id": "38794_00003", "date": "2023-06-02_00-33-16", "timestamp": 1685655196, "time_this_iter_s": 77.62367010116577, "time_total_s": 6598.966762781143, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6598.966762781143, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 37.12407407407408, "ram_util_percent": 65.55185185185186}}
{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -111.0, "episode_reward_mean": -32.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 21.0, -1.0, -78.0, -45.0, -23.0, -12.0, -67.0, -34.0, -111.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19398493470857825, "mean_inference_ms": 10.296375882084442, "mean_action_processing_ms": 0.08772763663627979, "mean_env_wait_ms": 0.04356884465293442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004327297210693359, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.08298635482788086}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.69520378112793, "policy_loss": -0.019304612651467323, "vf_loss": 5.702376365661621, "vf_explained_var": 0.06658157706260681, "kl": 0.01797386258840561, "entropy": 2.2511465549468994, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 28.53, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -34.0, 43.0, 21.0, 10.0, 10.0, 65.0, -1.0, 43.0, 10.0, 43.0, 76.0, 32.0, 21.0, 10.0, 54.0, -12.0, 21.0, 54.0, 21.0, -1.0, 76.0, 21.0, 43.0, 32.0, 54.0, 10.0, 65.0, 65.0, 54.0, 65.0, 10.0, 76.0, 76.0, 54.0, 43.0, 76.0, 76.0, -1.0, 43.0, 43.0, 43.0, 54.0, 54.0, -1.0, 65.0, -12.0, -111.0, -78.0, 10.0, 65.0, 10.0, 32.0, 54.0, 65.0, 65.0, 32.0, -1.0, -12.0, 54.0, 76.0, 21.0, -1.0, -12.0, 54.0, 21.0, 43.0, 54.0, 32.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 43.0, 76.0, -45.0, 21.0, 76.0, 65.0, 76.0, 54.0, 76.0, 32.0, 32.0, -100.0, -34.0, 32.0, 15.0, -12.0, 10.0, -12.0, 10.0, -12.0, 10.0, 21.0, -45.0, -78.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20721405264118112, "mean_inference_ms": 10.302931633773436, "mean_action_processing_ms": 0.08896204802635893, "mean_env_wait_ms": 0.04591221607213795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004368782043457031, "StateBufferConnector_ms": 0.002766132354736328, "ViewRequirementAgentConnector_ms": 0.08136820793151855}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 28.53, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -34.0, 43.0, 21.0, 10.0, 10.0, 65.0, -1.0, 43.0, 10.0, 43.0, 76.0, 32.0, 21.0, 10.0, 54.0, -12.0, 21.0, 54.0, 21.0, -1.0, 76.0, 21.0, 43.0, 32.0, 54.0, 10.0, 65.0, 65.0, 54.0, 65.0, 10.0, 76.0, 76.0, 54.0, 43.0, 76.0, 76.0, -1.0, 43.0, 43.0, 43.0, 54.0, 54.0, -1.0, 65.0, -12.0, -111.0, -78.0, 10.0, 65.0, 10.0, 32.0, 54.0, 65.0, 65.0, 32.0, -1.0, -12.0, 54.0, 76.0, 21.0, -1.0, -12.0, 54.0, 21.0, 43.0, 54.0, 32.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 43.0, 76.0, -45.0, 21.0, 76.0, 65.0, 76.0, 54.0, 76.0, 32.0, 32.0, -100.0, -34.0, 32.0, 15.0, -12.0, 10.0, -12.0, 10.0, -12.0, 10.0, 21.0, -45.0, -78.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20721405264118112, "mean_inference_ms": 10.302931633773436, "mean_action_processing_ms": 0.08896204802635893, "mean_env_wait_ms": 0.04591221607213795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004368782043457031, "StateBufferConnector_ms": 0.002766132354736328, "ViewRequirementAgentConnector_ms": 0.08136820793151855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 77629.67, "sample_time_ms": 43236.473, "learn_time_ms": 34385.684, "learn_throughput": 116.327, "synch_weights_time_ms": 6.935}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 4105, "training_iteration": 78, "trial_id": "38794_00003", "date": "2023-06-02_00-34-36", "timestamp": 1685655276, "time_this_iter_s": 80.11601209640503, "time_total_s": 6679.082774877548, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6679.082774877548, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 36.48571428571429, "ram_util_percent": 66.27946428571428}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -12.0, "episode_reward_mean": 42.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -12.0, 54.0, 65.0, 48.0, 43.0, 43.0, 76.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19383316118186955, "mean_inference_ms": 10.300027142974214, "mean_action_processing_ms": 0.08767373187678443, "mean_env_wait_ms": 0.043507695736120025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004448890686035156, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0802159309387207}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.428285121917725, "policy_loss": -0.02294164150953293, "vf_loss": 6.441466808319092, "vf_explained_var": 0.04884231835603714, "kl": 0.014459382742643356, "entropy": 2.3421401977539062, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 21.65, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 65.0, 65.0, 32.0, -1.0, -12.0, 54.0, 76.0, 21.0, -1.0, -12.0, 54.0, 21.0, 43.0, 54.0, 32.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 43.0, 76.0, -45.0, 21.0, 76.0, 65.0, 76.0, 54.0, 76.0, 32.0, 32.0, -100.0, -34.0, 32.0, 15.0, -12.0, 10.0, -12.0, 10.0, -12.0, 10.0, 21.0, -45.0, -78.0, 21.0, -1.0, 70.0, 32.0, 32.0, 21.0, -12.0, -1.0, 43.0, 10.0, 10.0, -67.0, 21.0, -34.0, -45.0, -144.0, -12.0, -12.0, -12.0, -12.0, 10.0, 65.0, 10.0, 43.0, 54.0, -23.0, 54.0, -1.0, 65.0, 65.0, 32.0, 65.0, 65.0, 54.0, 10.0, 54.0, 54.0, 21.0, 43.0, -23.0, -12.0, 43.0, 10.0, 32.0, -67.0, 65.0, 65.0, 32.0, 54.0, -23.0, 21.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2069230172002571, "mean_inference_ms": 10.292998870893893, "mean_action_processing_ms": 0.08881790154476478, "mean_env_wait_ms": 0.045813778273816066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004364728927612305, "StateBufferConnector_ms": 0.0028154850006103516, "ViewRequirementAgentConnector_ms": 0.08183026313781738}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 21.65, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 65.0, 65.0, 32.0, -1.0, -12.0, 54.0, 76.0, 21.0, -1.0, -12.0, 54.0, 21.0, 43.0, 54.0, 32.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 43.0, 76.0, -45.0, 21.0, 76.0, 65.0, 76.0, 54.0, 76.0, 32.0, 32.0, -100.0, -34.0, 32.0, 15.0, -12.0, 10.0, -12.0, 10.0, -12.0, 10.0, 21.0, -45.0, -78.0, 21.0, -1.0, 70.0, 32.0, 32.0, 21.0, -12.0, -1.0, 43.0, 10.0, 10.0, -67.0, 21.0, -34.0, -45.0, -144.0, -12.0, -12.0, -12.0, -12.0, 10.0, 65.0, 10.0, 43.0, 54.0, -23.0, 54.0, -1.0, 65.0, 65.0, 32.0, 65.0, 65.0, 54.0, 10.0, 54.0, 54.0, 21.0, 43.0, -23.0, -12.0, 43.0, 10.0, 32.0, -67.0, 65.0, 65.0, 32.0, 54.0, -23.0, 21.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2069230172002571, "mean_inference_ms": 10.292998870893893, "mean_action_processing_ms": 0.08881790154476478, "mean_env_wait_ms": 0.045813778273816066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004364728927612305, "StateBufferConnector_ms": 0.0028154850006103516, "ViewRequirementAgentConnector_ms": 0.08183026313781738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 76727.421, "sample_time_ms": 42695.345, "learn_time_ms": 34024.623, "learn_throughput": 117.562, "synch_weights_time_ms": 6.877}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 4157, "training_iteration": 79, "trial_id": "38794_00003", "date": "2023-06-02_00-35-55", "timestamp": 1685655355, "time_this_iter_s": 78.47027015686035, "time_total_s": 6757.553045034409, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6757.553045034409, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 40.51926605504588, "ram_util_percent": 65.96513761467891}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 65.0, 65.0, -23.0, -34.0, -23.0, 21.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19367578258989032, "mean_inference_ms": 10.30141882487746, "mean_action_processing_ms": 0.08761581430560504, "mean_env_wait_ms": 0.043472630658319675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005042552947998047, "StateBufferConnector_ms": 0.0029778480529785156, "ViewRequirementAgentConnector_ms": 0.08798599243164062}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.60832405090332, "policy_loss": -0.014768064953386784, "vf_loss": 5.61435079574585, "vf_explained_var": 0.04552717134356499, "kl": 0.012950625270605087, "entropy": 2.287870168685913, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 23.31, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -1.0, 43.0, 10.0, 10.0, -67.0, 21.0, -34.0, -45.0, -144.0, -12.0, -12.0, -12.0, -12.0, 10.0, 65.0, 10.0, 43.0, 54.0, -23.0, 54.0, -1.0, 65.0, 65.0, 32.0, 65.0, 65.0, 54.0, 10.0, 54.0, 54.0, 21.0, 43.0, -23.0, -12.0, 43.0, 10.0, 32.0, -67.0, 65.0, 65.0, 32.0, 54.0, -23.0, 21.0, 54.0, 10.0, 65.0, 43.0, 10.0, 54.0, 54.0, 54.0, 21.0, 76.0, 43.0, -12.0, -45.0, 21.0, 21.0, 43.0, 10.0, 10.0, 10.0, -78.0, -1.0, 32.0, 54.0, -1.0, 21.0, 10.0, 65.0, 21.0, 65.0, -12.0, 54.0, 10.0, 21.0, 10.0, -1.0, 54.0, 54.0, 54.0, 54.0, 76.0, 76.0, 65.0, 32.0, 54.0, 76.0, 76.0, 76.0, 76.0, 54.0, 32.0, 10.0, -12.0, -100.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20671582373850952, "mean_inference_ms": 10.292581495464082, "mean_action_processing_ms": 0.08870754611326298, "mean_env_wait_ms": 0.045749798309784644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046498775482177734, "StateBufferConnector_ms": 0.002922534942626953, "ViewRequirementAgentConnector_ms": 0.08599185943603516}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 23.31, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -1.0, 43.0, 10.0, 10.0, -67.0, 21.0, -34.0, -45.0, -144.0, -12.0, -12.0, -12.0, -12.0, 10.0, 65.0, 10.0, 43.0, 54.0, -23.0, 54.0, -1.0, 65.0, 65.0, 32.0, 65.0, 65.0, 54.0, 10.0, 54.0, 54.0, 21.0, 43.0, -23.0, -12.0, 43.0, 10.0, 32.0, -67.0, 65.0, 65.0, 32.0, 54.0, -23.0, 21.0, 54.0, 10.0, 65.0, 43.0, 10.0, 54.0, 54.0, 54.0, 21.0, 76.0, 43.0, -12.0, -45.0, 21.0, 21.0, 43.0, 10.0, 10.0, 10.0, -78.0, -1.0, 32.0, 54.0, -1.0, 21.0, 10.0, 65.0, 21.0, 65.0, -12.0, 54.0, 10.0, 21.0, 10.0, -1.0, 54.0, 54.0, 54.0, 54.0, 76.0, 76.0, 65.0, 32.0, 54.0, 76.0, 76.0, 76.0, 76.0, 54.0, 32.0, 10.0, -12.0, -100.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20671582373850952, "mean_inference_ms": 10.292581495464082, "mean_action_processing_ms": 0.08870754611326298, "mean_env_wait_ms": 0.045749798309784644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046498775482177734, "StateBufferConnector_ms": 0.002922534942626953, "ViewRequirementAgentConnector_ms": 0.08599185943603516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 77061.306, "sample_time_ms": 43025.278, "learn_time_ms": 34028.002, "learn_throughput": 117.55, "synch_weights_time_ms": 7.423}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 4210, "training_iteration": 80, "trial_id": "38794_00003", "date": "2023-06-02_00-37-24", "timestamp": 1685655444, "time_this_iter_s": 88.92981815338135, "time_total_s": 6846.48286318779, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6846.48286318779, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 43.97741935483872, "ram_util_percent": 73.35322580645162}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -56.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 21.0, 10.0, 54.0, -56.0, 21.0, 65.0, -34.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19347476567292707, "mean_inference_ms": 10.293224603370977, "mean_action_processing_ms": 0.0875388430940255, "mean_env_wait_ms": 0.04340967133822059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004470348358154297, "StateBufferConnector_ms": 0.002887248992919922, "ViewRequirementAgentConnector_ms": 0.08444070816040039}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.460710048675537, "policy_loss": -0.018541725352406502, "vf_loss": 5.469380855560303, "vf_explained_var": 0.0384933166205883, "kl": 0.014624216593801975, "entropy": 2.212601661682129, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 29.74, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 76.0, 43.0, -12.0, -45.0, 21.0, 21.0, 43.0, 10.0, 10.0, 10.0, -78.0, -1.0, 32.0, 54.0, -1.0, 21.0, 10.0, 65.0, 21.0, 65.0, -12.0, 54.0, 10.0, 21.0, 10.0, -1.0, 54.0, 54.0, 54.0, 54.0, 76.0, 76.0, 65.0, 32.0, 54.0, 76.0, 76.0, 76.0, 76.0, 54.0, 32.0, 10.0, -12.0, -100.0, 43.0, -1.0, 76.0, 76.0, 54.0, 43.0, 43.0, 54.0, 21.0, -133.0, 65.0, 65.0, 43.0, 76.0, 32.0, 65.0, -1.0, 43.0, 10.0, 76.0, 21.0, 76.0, 43.0, -1.0, 76.0, -1.0, 76.0, 21.0, -67.0, 65.0, 21.0, 76.0, 76.0, -1.0, 65.0, 43.0, 76.0, 10.0, 21.0, 21.0, 54.0, 76.0, 10.0, 54.0, 4.0, 10.0, -1.0, -78.0, 21.0, 10.0, 76.0, -56.0, 43.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2065909673342851, "mean_inference_ms": 10.299244759461823, "mean_action_processing_ms": 0.08863842376180851, "mean_env_wait_ms": 0.04571930569473899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004811525344848633, "StateBufferConnector_ms": 0.002852916717529297, "ViewRequirementAgentConnector_ms": 0.08967781066894531}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 29.74, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 76.0, 43.0, -12.0, -45.0, 21.0, 21.0, 43.0, 10.0, 10.0, 10.0, -78.0, -1.0, 32.0, 54.0, -1.0, 21.0, 10.0, 65.0, 21.0, 65.0, -12.0, 54.0, 10.0, 21.0, 10.0, -1.0, 54.0, 54.0, 54.0, 54.0, 76.0, 76.0, 65.0, 32.0, 54.0, 76.0, 76.0, 76.0, 76.0, 54.0, 32.0, 10.0, -12.0, -100.0, 43.0, -1.0, 76.0, 76.0, 54.0, 43.0, 43.0, 54.0, 21.0, -133.0, 65.0, 65.0, 43.0, 76.0, 32.0, 65.0, -1.0, 43.0, 10.0, 76.0, 21.0, 76.0, 43.0, -1.0, 76.0, -1.0, 76.0, 21.0, -67.0, 65.0, 21.0, 76.0, 76.0, -1.0, 65.0, 43.0, 76.0, 10.0, 21.0, 21.0, 54.0, 76.0, 10.0, 54.0, 4.0, 10.0, -1.0, -78.0, 21.0, 10.0, 76.0, -56.0, 43.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2065909673342851, "mean_inference_ms": 10.299244759461823, "mean_action_processing_ms": 0.08863842376180851, "mean_env_wait_ms": 0.04571930569473899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004811525344848633, "StateBufferConnector_ms": 0.002852916717529297, "ViewRequirementAgentConnector_ms": 0.08967781066894531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 76437.219, "sample_time_ms": 42693.532, "learn_time_ms": 33735.847, "learn_throughput": 118.568, "synch_weights_time_ms": 7.289}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 4263, "training_iteration": 81, "trial_id": "38794_00003", "date": "2023-06-02_00-38-49", "timestamp": 1685655529, "time_this_iter_s": 84.98208594322205, "time_total_s": 6931.464949131012, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6931.464949131012, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 41.21271186440677, "ram_util_percent": 72.70423728813559}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 37.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -1.0, 10.0, 32.0, 65.0, 65.0, 76.0, 54.0, 43.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1932094301465628, "mean_inference_ms": 10.285718157796362, "mean_action_processing_ms": 0.0874066589652217, "mean_env_wait_ms": 0.04332487666674427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004687309265136719, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.08475065231323242}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.1678996086120605, "policy_loss": -0.024225132539868355, "vf_loss": 5.182365417480469, "vf_explained_var": 0.10548021644353867, "kl": 0.01445912104099989, "entropy": 1.7627899646759033, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 31.61, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 21.0, -133.0, 65.0, 65.0, 43.0, 76.0, 32.0, 65.0, -1.0, 43.0, 10.0, 76.0, 21.0, 76.0, 43.0, -1.0, 76.0, -1.0, 76.0, 21.0, -67.0, 65.0, 21.0, 76.0, 76.0, -1.0, 65.0, 43.0, 76.0, 10.0, 21.0, 21.0, 54.0, 76.0, 10.0, 54.0, 4.0, 10.0, -1.0, -78.0, 21.0, 10.0, 76.0, -56.0, 43.0, -1.0, 10.0, -34.0, -56.0, 43.0, 76.0, 65.0, 54.0, 65.0, 76.0, 43.0, 10.0, 54.0, 65.0, 65.0, 43.0, 32.0, 54.0, -89.0, 21.0, 54.0, 54.0, -1.0, 32.0, -1.0, -1.0, -1.0, -1.0, 10.0, -34.0, -67.0, 76.0, 54.0, 76.0, 76.0, 54.0, 76.0, 32.0, 65.0, 54.0, 65.0, 76.0, 54.0, 43.0, 65.0, 76.0, 76.0, 32.0, -1.0, 65.0, 54.0, -67.0, -1.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20642593363549966, "mean_inference_ms": 10.296731250918857, "mean_action_processing_ms": 0.08855995908053373, "mean_env_wait_ms": 0.04566940323341135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00469517707824707, "StateBufferConnector_ms": 0.00279998779296875, "ViewRequirementAgentConnector_ms": 0.08648252487182617}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 31.61, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 21.0, -133.0, 65.0, 65.0, 43.0, 76.0, 32.0, 65.0, -1.0, 43.0, 10.0, 76.0, 21.0, 76.0, 43.0, -1.0, 76.0, -1.0, 76.0, 21.0, -67.0, 65.0, 21.0, 76.0, 76.0, -1.0, 65.0, 43.0, 76.0, 10.0, 21.0, 21.0, 54.0, 76.0, 10.0, 54.0, 4.0, 10.0, -1.0, -78.0, 21.0, 10.0, 76.0, -56.0, 43.0, -1.0, 10.0, -34.0, -56.0, 43.0, 76.0, 65.0, 54.0, 65.0, 76.0, 43.0, 10.0, 54.0, 65.0, 65.0, 43.0, 32.0, 54.0, -89.0, 21.0, 54.0, 54.0, -1.0, 32.0, -1.0, -1.0, -1.0, -1.0, 10.0, -34.0, -67.0, 76.0, 54.0, 76.0, 76.0, 54.0, 76.0, 32.0, 65.0, 54.0, 65.0, 76.0, 54.0, 43.0, 65.0, 76.0, 76.0, 32.0, -1.0, 65.0, 54.0, -67.0, -1.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20642593363549966, "mean_inference_ms": 10.296731250918857, "mean_action_processing_ms": 0.08855995908053373, "mean_env_wait_ms": 0.04566940323341135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00469517707824707, "StateBufferConnector_ms": 0.00279998779296875, "ViewRequirementAgentConnector_ms": 0.08648252487182617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 75572.127, "sample_time_ms": 41930.008, "learn_time_ms": 33634.362, "learn_throughput": 118.926, "synch_weights_time_ms": 7.239}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 4315, "training_iteration": 82, "trial_id": "38794_00003", "date": "2023-06-02_00-40-09", "timestamp": 1685655609, "time_this_iter_s": 80.25713801383972, "time_total_s": 7011.722087144852, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7011.722087144852, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 41.447321428571435, "ram_util_percent": 57.198214285714286}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -100.0, "episode_reward_mean": -5.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -34.0, -100.0, -56.0, -1.0, 65.0, 65.0, -56.0, 65.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19296436291974922, "mean_inference_ms": 10.273538026836752, "mean_action_processing_ms": 0.08728225211403542, "mean_env_wait_ms": 0.043237113508160174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004634857177734375, "StateBufferConnector_ms": 0.0024700164794921875, "ViewRequirementAgentConnector_ms": 0.0783228874206543}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.108908176422119, "policy_loss": -0.0162429790943861, "vf_loss": 6.113833904266357, "vf_explained_var": 0.03133058547973633, "kl": 0.016765166074037552, "entropy": 2.192056894302368, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 28.59, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 76.0, 43.0, 10.0, 54.0, 65.0, 65.0, 43.0, 32.0, 54.0, -89.0, 21.0, 54.0, 54.0, -1.0, 32.0, -1.0, -1.0, -1.0, -1.0, 10.0, -34.0, -67.0, 76.0, 54.0, 76.0, 76.0, 54.0, 76.0, 32.0, 65.0, 54.0, 65.0, 76.0, 54.0, 43.0, 65.0, 76.0, 76.0, 32.0, -1.0, 65.0, 54.0, -67.0, -1.0, 65.0, 76.0, 76.0, 65.0, 65.0, 43.0, 43.0, 32.0, 21.0, -12.0, 65.0, 54.0, 32.0, 65.0, -45.0, -1.0, -56.0, -56.0, -34.0, 65.0, 43.0, -23.0, -12.0, 54.0, 43.0, -56.0, 43.0, -1.0, 32.0, 54.0, -1.0, 43.0, 43.0, 32.0, 76.0, 54.0, 54.0, 76.0, 54.0, 54.0, -12.0, 43.0, 10.0, -12.0, -23.0, -12.0, 21.0, -12.0, -23.0, 32.0, -78.0, -23.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.206200861222624, "mean_inference_ms": 10.28827136502419, "mean_action_processing_ms": 0.08844436574040952, "mean_env_wait_ms": 0.045593270466340936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004553794860839844, "StateBufferConnector_ms": 0.0028076171875, "ViewRequirementAgentConnector_ms": 0.08391880989074707}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 28.59, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 76.0, 43.0, 10.0, 54.0, 65.0, 65.0, 43.0, 32.0, 54.0, -89.0, 21.0, 54.0, 54.0, -1.0, 32.0, -1.0, -1.0, -1.0, -1.0, 10.0, -34.0, -67.0, 76.0, 54.0, 76.0, 76.0, 54.0, 76.0, 32.0, 65.0, 54.0, 65.0, 76.0, 54.0, 43.0, 65.0, 76.0, 76.0, 32.0, -1.0, 65.0, 54.0, -67.0, -1.0, 65.0, 76.0, 76.0, 65.0, 65.0, 43.0, 43.0, 32.0, 21.0, -12.0, 65.0, 54.0, 32.0, 65.0, -45.0, -1.0, -56.0, -56.0, -34.0, 65.0, 43.0, -23.0, -12.0, 54.0, 43.0, -56.0, 43.0, -1.0, 32.0, 54.0, -1.0, 43.0, 43.0, 32.0, 76.0, 54.0, 54.0, 76.0, 54.0, 54.0, -12.0, 43.0, 10.0, -12.0, -23.0, -12.0, 21.0, -12.0, -23.0, 32.0, -78.0, -23.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.206200861222624, "mean_inference_ms": 10.28827136502419, "mean_action_processing_ms": 0.08844436574040952, "mean_env_wait_ms": 0.045593270466340936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004553794860839844, "StateBufferConnector_ms": 0.0028076171875, "ViewRequirementAgentConnector_ms": 0.08391880989074707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 74692.453, "sample_time_ms": 41447.296, "learn_time_ms": 33237.457, "learn_throughput": 120.346, "synch_weights_time_ms": 7.184}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 4368, "training_iteration": 83, "trial_id": "38794_00003", "date": "2023-06-02_00-41-27", "timestamp": 1685655687, "time_this_iter_s": 78.4873480796814, "time_total_s": 7090.209435224533, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7090.209435224533, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 37.92727272727274, "ram_util_percent": 57.28636363636364}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -45.0, "episode_reward_mean": 18.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -45.0, 32.0, 54.0, -12.0, 10.0, 43.0, 10.0, 65.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19268214938817652, "mean_inference_ms": 10.264441874430549, "mean_action_processing_ms": 0.0871326897191037, "mean_env_wait_ms": 0.04314065448241553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004363059997558594, "StateBufferConnector_ms": 0.002715587615966797, "ViewRequirementAgentConnector_ms": 0.08351564407348633}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.796883583068848, "policy_loss": -0.013558491133153439, "vf_loss": 5.802239418029785, "vf_explained_var": 0.03194984421133995, "kl": 0.012151750735938549, "entropy": 2.0340757369995117, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 20.61, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, -12.0, 65.0, 54.0, 32.0, 65.0, -45.0, -1.0, -56.0, -56.0, -34.0, 65.0, 43.0, -23.0, -12.0, 54.0, 43.0, -56.0, 43.0, -1.0, 32.0, 54.0, -1.0, 43.0, 43.0, 32.0, 76.0, 54.0, 54.0, 76.0, 54.0, 54.0, -12.0, 43.0, 10.0, -12.0, -23.0, -12.0, 21.0, -12.0, -23.0, 32.0, -78.0, -23.0, 43.0, 43.0, 65.0, 21.0, 54.0, -34.0, -12.0, 32.0, 43.0, 21.0, 65.0, 10.0, 21.0, 65.0, 76.0, 65.0, 21.0, 76.0, 59.0, 76.0, 32.0, 21.0, 65.0, 76.0, 65.0, 32.0, 10.0, -1.0, -12.0, 65.0, -12.0, 54.0, 43.0, 65.0, 43.0, 43.0, 54.0, 43.0, 65.0, 65.0, -45.0, -133.0, -34.0, -78.0, -67.0, 10.0, 65.0, 65.0, -100.0, -12.0, 65.0, 10.0, -1.0, -1.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20594129008672923, "mean_inference_ms": 10.278020287598475, "mean_action_processing_ms": 0.08831871017435237, "mean_env_wait_ms": 0.04550521631027039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004403352737426758, "StateBufferConnector_ms": 0.0027260780334472656, "ViewRequirementAgentConnector_ms": 0.08076786994934082}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 20.61, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 21.0, -12.0, 65.0, 54.0, 32.0, 65.0, -45.0, -1.0, -56.0, -56.0, -34.0, 65.0, 43.0, -23.0, -12.0, 54.0, 43.0, -56.0, 43.0, -1.0, 32.0, 54.0, -1.0, 43.0, 43.0, 32.0, 76.0, 54.0, 54.0, 76.0, 54.0, 54.0, -12.0, 43.0, 10.0, -12.0, -23.0, -12.0, 21.0, -12.0, -23.0, 32.0, -78.0, -23.0, 43.0, 43.0, 65.0, 21.0, 54.0, -34.0, -12.0, 32.0, 43.0, 21.0, 65.0, 10.0, 21.0, 65.0, 76.0, 65.0, 21.0, 76.0, 59.0, 76.0, 32.0, 21.0, 65.0, 76.0, 65.0, 32.0, 10.0, -1.0, -12.0, 65.0, -12.0, 54.0, 43.0, 65.0, 43.0, 43.0, 54.0, 43.0, 65.0, 65.0, -45.0, -133.0, -34.0, -78.0, -67.0, 10.0, 65.0, 65.0, -100.0, -12.0, 65.0, 10.0, -1.0, -1.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20594129008672923, "mean_inference_ms": 10.278020287598475, "mean_action_processing_ms": 0.08831871017435237, "mean_env_wait_ms": 0.04550521631027039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004403352737426758, "StateBufferConnector_ms": 0.0027260780334472656, "ViewRequirementAgentConnector_ms": 0.08076786994934082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 74065.601, "sample_time_ms": 41000.882, "learn_time_ms": 33056.488, "learn_throughput": 121.005, "synch_weights_time_ms": 7.675}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 4421, "training_iteration": 84, "trial_id": "38794_00003", "date": "2023-06-02_00-42-45", "timestamp": 1685655765, "time_this_iter_s": 77.5224838256836, "time_total_s": 7167.731919050217, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7167.731919050217, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 36.513888888888886, "ram_util_percent": 57.61018518518518}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -1.0, "episode_reward_mean": 41.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 43.0, 32.0, 43.0, 54.0, 76.0, 76.0, 76.0, 10.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19249186659964226, "mean_inference_ms": 10.257243364599564, "mean_action_processing_ms": 0.0870599534271269, "mean_env_wait_ms": 0.04308842754229675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027751922607421875, "ViewRequirementAgentConnector_ms": 0.08086681365966797}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.723519802093506, "policy_loss": -0.01725739985704422, "vf_loss": 5.729262828826904, "vf_explained_var": 0.07960109412670135, "kl": 0.01705838553607464, "entropy": 2.2718558311462402, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 25.12, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 21.0, 65.0, 10.0, 21.0, 65.0, 76.0, 65.0, 21.0, 76.0, 59.0, 76.0, 32.0, 21.0, 65.0, 76.0, 65.0, 32.0, 10.0, -1.0, -12.0, 65.0, -12.0, 54.0, 43.0, 65.0, 43.0, 43.0, 54.0, 43.0, 65.0, 65.0, -45.0, -133.0, -34.0, -78.0, -67.0, 10.0, 65.0, 65.0, -100.0, -12.0, 65.0, 10.0, -1.0, -1.0, -12.0, -34.0, -12.0, 21.0, 65.0, 65.0, 43.0, 21.0, 32.0, 65.0, 43.0, 54.0, 10.0, 65.0, 32.0, -67.0, 21.0, -23.0, 54.0, 65.0, 76.0, 76.0, -23.0, -56.0, -67.0, -1.0, -23.0, -1.0, 21.0, -34.0, -67.0, 10.0, 32.0, 32.0, 54.0, 32.0, 54.0, 21.0, -34.0, 43.0, 10.0, 76.0, 76.0, 65.0, 54.0, 54.0, 10.0, 32.0, 43.0, 76.0, 54.0, 54.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.205658278761556, "mean_inference_ms": 10.268616665217468, "mean_action_processing_ms": 0.08818370492393399, "mean_env_wait_ms": 0.04541084263353061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042078495025634766, "StateBufferConnector_ms": 0.0026662349700927734, "ViewRequirementAgentConnector_ms": 0.07977843284606934}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 25.12, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 21.0, 65.0, 10.0, 21.0, 65.0, 76.0, 65.0, 21.0, 76.0, 59.0, 76.0, 32.0, 21.0, 65.0, 76.0, 65.0, 32.0, 10.0, -1.0, -12.0, 65.0, -12.0, 54.0, 43.0, 65.0, 43.0, 43.0, 54.0, 43.0, 65.0, 65.0, -45.0, -133.0, -34.0, -78.0, -67.0, 10.0, 65.0, 65.0, -100.0, -12.0, 65.0, 10.0, -1.0, -1.0, -12.0, -34.0, -12.0, 21.0, 65.0, 65.0, 43.0, 21.0, 32.0, 65.0, 43.0, 54.0, 10.0, 65.0, 32.0, -67.0, 21.0, -23.0, 54.0, 65.0, 76.0, 76.0, -23.0, -56.0, -67.0, -1.0, -23.0, -1.0, 21.0, -34.0, -67.0, 10.0, 32.0, 32.0, 54.0, 32.0, 54.0, 21.0, -34.0, 43.0, 10.0, 76.0, 76.0, 65.0, 54.0, 54.0, 10.0, 32.0, 43.0, 76.0, 54.0, 54.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.205658278761556, "mean_inference_ms": 10.268616665217468, "mean_action_processing_ms": 0.08818370492393399, "mean_env_wait_ms": 0.04541084263353061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042078495025634766, "StateBufferConnector_ms": 0.0026662349700927734, "ViewRequirementAgentConnector_ms": 0.07977843284606934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 72967.659, "sample_time_ms": 40395.586, "learn_time_ms": 32563.624, "learn_throughput": 122.836, "synch_weights_time_ms": 7.881}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 4473, "training_iteration": 85, "trial_id": "38794_00003", "date": "2023-06-02_00-44-05", "timestamp": 1685655845, "time_this_iter_s": 80.53148484230042, "time_total_s": 7248.263403892517, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7248.263403892517, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 38.69464285714286, "ram_util_percent": 58.23928571428571}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -56.0, "episode_reward_mean": 30.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 43.0, 43.0, -56.0, 54.0, 10.0, 32.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19221219323266922, "mean_inference_ms": 10.244887687244328, "mean_action_processing_ms": 0.08693479473559737, "mean_env_wait_ms": 0.04298931268960576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043582916259765625, "StateBufferConnector_ms": 0.0026917457580566406, "ViewRequirementAgentConnector_ms": 0.07665872573852539}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.560440540313721, "policy_loss": -0.019270624965429306, "vf_loss": 6.56968879699707, "vf_explained_var": 0.0396503210067749, "kl": 0.014847743324935436, "entropy": 2.1786701679229736, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 18.36, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 21.0, 32.0, 65.0, 43.0, 54.0, 10.0, 65.0, 32.0, -67.0, 21.0, -23.0, 54.0, 65.0, 76.0, 76.0, -23.0, -56.0, -67.0, -1.0, -23.0, -1.0, 21.0, -34.0, -67.0, 10.0, 32.0, 32.0, 54.0, 32.0, 54.0, 21.0, -34.0, 43.0, 10.0, 76.0, 76.0, 65.0, 54.0, 54.0, 10.0, 32.0, 43.0, 76.0, 54.0, 54.0, 65.0, 76.0, 54.0, 76.0, 65.0, -23.0, 21.0, 21.0, 76.0, 43.0, 43.0, 65.0, 43.0, -23.0, 32.0, 32.0, 76.0, 54.0, 43.0, -122.0, 32.0, 76.0, -67.0, -34.0, -1.0, -1.0, -12.0, 65.0, 54.0, 43.0, 21.0, 43.0, -34.0, -45.0, -34.0, -1.0, -34.0, -100.0, 10.0, 10.0, 54.0, -23.0, 43.0, -67.0, 43.0, -45.0, 43.0, -78.0, -23.0, 32.0, 65.0, 43.0, -23.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20539548542757813, "mean_inference_ms": 10.259439231458389, "mean_action_processing_ms": 0.08805725682233426, "mean_env_wait_ms": 0.04532304429304968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224538803100586, "StateBufferConnector_ms": 0.0027306079864501953, "ViewRequirementAgentConnector_ms": 0.08069491386413574}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 18.36, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 21.0, 32.0, 65.0, 43.0, 54.0, 10.0, 65.0, 32.0, -67.0, 21.0, -23.0, 54.0, 65.0, 76.0, 76.0, -23.0, -56.0, -67.0, -1.0, -23.0, -1.0, 21.0, -34.0, -67.0, 10.0, 32.0, 32.0, 54.0, 32.0, 54.0, 21.0, -34.0, 43.0, 10.0, 76.0, 76.0, 65.0, 54.0, 54.0, 10.0, 32.0, 43.0, 76.0, 54.0, 54.0, 65.0, 76.0, 54.0, 76.0, 65.0, -23.0, 21.0, 21.0, 76.0, 43.0, 43.0, 65.0, 43.0, -23.0, 32.0, 32.0, 76.0, 54.0, 43.0, -122.0, 32.0, 76.0, -67.0, -34.0, -1.0, -1.0, -12.0, 65.0, 54.0, 43.0, 21.0, 43.0, -34.0, -45.0, -34.0, -1.0, -34.0, -100.0, 10.0, 10.0, 54.0, -23.0, 43.0, -67.0, 43.0, -45.0, 43.0, -78.0, -23.0, 32.0, 65.0, 43.0, -23.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20539548542757813, "mean_inference_ms": 10.259439231458389, "mean_action_processing_ms": 0.08805725682233426, "mean_env_wait_ms": 0.04532304429304968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224538803100586, "StateBufferConnector_ms": 0.0027306079864501953, "ViewRequirementAgentConnector_ms": 0.08069491386413574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 72840.764, "sample_time_ms": 40257.98, "learn_time_ms": 32574.278, "learn_throughput": 122.796, "synch_weights_time_ms": 7.933}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 4526, "training_iteration": 86, "trial_id": "38794_00003", "date": "2023-06-02_00-45-23", "timestamp": 1685655923, "time_this_iter_s": 77.75684809684753, "time_total_s": 7326.020251989365, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7326.020251989365, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 39.675229357798166, "ram_util_percent": 58.56605504587156}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -144.0, "episode_reward_mean": -19.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 21.0, -23.0, 32.0, -34.0, -78.0, -144.0, -12.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19205660243152706, "mean_inference_ms": 10.240640328141426, "mean_action_processing_ms": 0.08685325145094028, "mean_env_wait_ms": 0.042938479000361615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043773651123046875, "StateBufferConnector_ms": 0.002803802490234375, "ViewRequirementAgentConnector_ms": 0.08590221405029297}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.866677761077881, "policy_loss": -0.018694976344704628, "vf_loss": 5.873351573944092, "vf_explained_var": 0.0421951599419117, "kl": 0.017809081822633743, "entropy": 1.9591445922851562, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 16.82, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 21.0, 76.0, 43.0, 43.0, 65.0, 43.0, -23.0, 32.0, 32.0, 76.0, 54.0, 43.0, -122.0, 32.0, 76.0, -67.0, -34.0, -1.0, -1.0, -12.0, 65.0, 54.0, 43.0, 21.0, 43.0, -34.0, -45.0, -34.0, -1.0, -34.0, -100.0, 10.0, 10.0, 54.0, -23.0, 43.0, -67.0, 43.0, -45.0, 43.0, -78.0, -23.0, 32.0, 65.0, 43.0, -23.0, -100.0, 54.0, -12.0, -12.0, -34.0, 32.0, -89.0, -67.0, -78.0, -1.0, 10.0, -12.0, 32.0, -1.0, 32.0, -23.0, 21.0, 65.0, 54.0, 65.0, 76.0, 76.0, 65.0, 43.0, 21.0, 54.0, 76.0, -12.0, 54.0, 54.0, 32.0, -1.0, -1.0, 32.0, 43.0, 32.0, 43.0, 65.0, 43.0, 54.0, 65.0, 54.0, 54.0, 32.0, 32.0, 21.0, 10.0, -1.0, 32.0, 21.0, 21.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20518149800475488, "mean_inference_ms": 10.252624924571855, "mean_action_processing_ms": 0.08795862477694893, "mean_env_wait_ms": 0.045254900154391604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043408870697021484, "StateBufferConnector_ms": 0.002776622772216797, "ViewRequirementAgentConnector_ms": 0.08341479301452637}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 16.82, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 21.0, 76.0, 43.0, 43.0, 65.0, 43.0, -23.0, 32.0, 32.0, 76.0, 54.0, 43.0, -122.0, 32.0, 76.0, -67.0, -34.0, -1.0, -1.0, -12.0, 65.0, 54.0, 43.0, 21.0, 43.0, -34.0, -45.0, -34.0, -1.0, -34.0, -100.0, 10.0, 10.0, 54.0, -23.0, 43.0, -67.0, 43.0, -45.0, 43.0, -78.0, -23.0, 32.0, 65.0, 43.0, -23.0, -100.0, 54.0, -12.0, -12.0, -34.0, 32.0, -89.0, -67.0, -78.0, -1.0, 10.0, -12.0, 32.0, -1.0, 32.0, -23.0, 21.0, 65.0, 54.0, 65.0, 76.0, 76.0, 65.0, 43.0, 21.0, 54.0, 76.0, -12.0, 54.0, 54.0, 32.0, -1.0, -1.0, 32.0, 43.0, 32.0, 43.0, 65.0, 43.0, 54.0, 65.0, 54.0, 54.0, 32.0, 32.0, 21.0, 10.0, -1.0, 32.0, 21.0, 21.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20518149800475488, "mean_inference_ms": 10.252624924571855, "mean_action_processing_ms": 0.08795862477694893, "mean_env_wait_ms": 0.045254900154391604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043408870697021484, "StateBufferConnector_ms": 0.002776622772216797, "ViewRequirementAgentConnector_ms": 0.08341479301452637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 73348.283, "sample_time_ms": 40534.279, "learn_time_ms": 32805.457, "learn_throughput": 121.931, "synch_weights_time_ms": 7.974}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 4578, "training_iteration": 87, "trial_id": "38794_00003", "date": "2023-06-02_00-46-46", "timestamp": 1685656006, "time_this_iter_s": 82.93759202957153, "time_total_s": 7408.957844018936, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7408.957844018936, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 42.856521739130436, "ram_util_percent": 61.07652173913044}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 10.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -12.0, 43.0, 10.0, -12.0, 76.0, -34.0, 10.0, -34.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19180692519670475, "mean_inference_ms": 10.228844596995232, "mean_action_processing_ms": 0.08672783547715689, "mean_env_wait_ms": 0.04284727047762392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004398822784423828, "StateBufferConnector_ms": 0.0026917457580566406, "ViewRequirementAgentConnector_ms": 0.07771492004394531}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 4.970656394958496, "policy_loss": -0.014992590993642807, "vf_loss": 4.9776387214660645, "vf_explained_var": 0.07830110937356949, "kl": 0.0118663115426898, "entropy": 1.9106829166412354, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 31.89, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -67.0, -78.0, -1.0, 10.0, -12.0, 32.0, -1.0, 32.0, -23.0, 21.0, 65.0, 54.0, 65.0, 76.0, 76.0, 65.0, 43.0, 21.0, 54.0, 76.0, -12.0, 54.0, 54.0, 32.0, -1.0, -1.0, 32.0, 43.0, 32.0, 43.0, 65.0, 43.0, 54.0, 65.0, 54.0, 54.0, 32.0, 32.0, 21.0, 10.0, -1.0, 32.0, 21.0, 21.0, 32.0, 65.0, 32.0, 54.0, 43.0, -34.0, -45.0, 10.0, 21.0, -78.0, 32.0, 54.0, -23.0, 54.0, 76.0, 65.0, 76.0, 32.0, 32.0, 65.0, 43.0, 32.0, 65.0, 76.0, 76.0, -23.0, 21.0, 21.0, 32.0, -12.0, 43.0, 10.0, -12.0, 43.0, 54.0, -1.0, -1.0, 76.0, 54.0, 65.0, 21.0, 10.0, 21.0, 32.0, 76.0, 32.0, 65.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, -1.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20495022801054083, "mean_inference_ms": 10.24535914220242, "mean_action_processing_ms": 0.08784832777709724, "mean_env_wait_ms": 0.04517886902240978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004330635070800781, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.08256721496582031}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 31.89, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.0, -67.0, -78.0, -1.0, 10.0, -12.0, 32.0, -1.0, 32.0, -23.0, 21.0, 65.0, 54.0, 65.0, 76.0, 76.0, 65.0, 43.0, 21.0, 54.0, 76.0, -12.0, 54.0, 54.0, 32.0, -1.0, -1.0, 32.0, 43.0, 32.0, 43.0, 65.0, 43.0, 54.0, 65.0, 54.0, 54.0, 32.0, 32.0, 21.0, 10.0, -1.0, 32.0, 21.0, 21.0, 32.0, 65.0, 32.0, 54.0, 43.0, -34.0, -45.0, 10.0, 21.0, -78.0, 32.0, 54.0, -23.0, 54.0, 76.0, 65.0, 76.0, 32.0, 32.0, 65.0, 43.0, 32.0, 65.0, 76.0, 76.0, -23.0, 21.0, 21.0, 32.0, -12.0, 43.0, 10.0, -12.0, 43.0, 54.0, -1.0, -1.0, 76.0, 54.0, 65.0, 21.0, 10.0, 21.0, 32.0, 76.0, 32.0, 65.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, -1.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20495022801054083, "mean_inference_ms": 10.24535914220242, "mean_action_processing_ms": 0.08784832777709724, "mean_env_wait_ms": 0.04517886902240978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004330635070800781, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.08256721496582031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 73078.75, "sample_time_ms": 40391.306, "learn_time_ms": 32678.869, "learn_throughput": 122.403, "synch_weights_time_ms": 8.006}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 4631, "training_iteration": 88, "trial_id": "38794_00003", "date": "2023-06-02_00-48-04", "timestamp": 1685656084, "time_this_iter_s": 77.33082699775696, "time_total_s": 7486.288671016693, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7486.288671016693, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 38.625, "ram_util_percent": 57.539814814814825}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -100.0, "episode_reward_mean": 8.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.0, 10.0, 10.0, 65.0, 65.0, -78.0, 10.0, 43.0, 32.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19155535085544467, "mean_inference_ms": 10.221553002848115, "mean_action_processing_ms": 0.08660042297022197, "mean_env_wait_ms": 0.042763518542679166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.07883310317993164}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.848028182983398, "policy_loss": -0.0146188884973526, "vf_loss": 5.852515697479248, "vf_explained_var": 0.016287419945001602, "kl": 0.01500894408673048, "entropy": 2.052398443222046, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 29.85, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -78.0, 32.0, 54.0, -23.0, 54.0, 76.0, 65.0, 76.0, 32.0, 32.0, 65.0, 43.0, 32.0, 65.0, 76.0, 76.0, -23.0, 21.0, 21.0, 32.0, -12.0, 43.0, 10.0, -12.0, 43.0, 54.0, -1.0, -1.0, 76.0, 54.0, 65.0, 21.0, 10.0, 21.0, 32.0, 76.0, 32.0, 65.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, -1.0, 54.0, 65.0, 21.0, 32.0, 43.0, -78.0, -23.0, -84.0, -67.0, 43.0, -56.0, -34.0, 76.0, -34.0, 65.0, 54.0, 32.0, 54.0, 76.0, -1.0, 43.0, 76.0, 76.0, 21.0, 32.0, 10.0, 76.0, -12.0, 21.0, 54.0, 32.0, 54.0, 76.0, 10.0, -100.0, -1.0, -23.0, 43.0, 32.0, 54.0, 43.0, 43.0, 65.0, 21.0, 54.0, 10.0, 43.0, 43.0, 43.0, 54.0, 32.0, -67.0, -34.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20470015408451772, "mean_inference_ms": 10.23527244701675, "mean_action_processing_ms": 0.08772858659274817, "mean_env_wait_ms": 0.04508957369658576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004205465316772461, "StateBufferConnector_ms": 0.0027496814727783203, "ViewRequirementAgentConnector_ms": 0.07969307899475098}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 29.85, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -78.0, 32.0, 54.0, -23.0, 54.0, 76.0, 65.0, 76.0, 32.0, 32.0, 65.0, 43.0, 32.0, 65.0, 76.0, 76.0, -23.0, 21.0, 21.0, 32.0, -12.0, 43.0, 10.0, -12.0, 43.0, 54.0, -1.0, -1.0, 76.0, 54.0, 65.0, 21.0, 10.0, 21.0, 32.0, 76.0, 32.0, 65.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, -1.0, 54.0, 65.0, 21.0, 32.0, 43.0, -78.0, -23.0, -84.0, -67.0, 43.0, -56.0, -34.0, 76.0, -34.0, 65.0, 54.0, 32.0, 54.0, 76.0, -1.0, 43.0, 76.0, 76.0, 21.0, 32.0, 10.0, 76.0, -12.0, 21.0, 54.0, 32.0, 54.0, 76.0, 10.0, -100.0, -1.0, -23.0, 43.0, 32.0, 54.0, 43.0, 43.0, 65.0, 21.0, 54.0, 10.0, 43.0, 43.0, 43.0, 54.0, 32.0, -67.0, -34.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20470015408451772, "mean_inference_ms": 10.23527244701675, "mean_action_processing_ms": 0.08772858659274817, "mean_env_wait_ms": 0.04508957369658576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004205465316772461, "StateBufferConnector_ms": 0.0027496814727783203, "ViewRequirementAgentConnector_ms": 0.07969307899475098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 73218.941, "sample_time_ms": 40395.394, "learn_time_ms": 32814.939, "learn_throughput": 121.896, "synch_weights_time_ms": 8.046}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 4684, "training_iteration": 89, "trial_id": "38794_00003", "date": "2023-06-02_00-49-23", "timestamp": 1685656163, "time_this_iter_s": 79.08490419387817, "time_total_s": 7565.373575210571, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7565.373575210571, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 35.24999999999999, "ram_util_percent": 57.55909090909091}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 29.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 76.0, -12.0, 32.0, 65.0, -12.0, 32.0, 54.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1912797567947251, "mean_inference_ms": 10.210300164254715, "mean_action_processing_ms": 0.08648223440277059, "mean_env_wait_ms": 0.04267472624508613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039052963256835938, "StateBufferConnector_ms": 0.002510547637939453, "ViewRequirementAgentConnector_ms": 0.07678985595703125}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.240660667419434, "policy_loss": -0.01860400289297104, "vf_loss": 5.248881816864014, "vf_explained_var": 0.0939115658402443, "kl": 0.015380757860839367, "entropy": 2.178797483444214, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 29.46, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -84.0, -67.0, 43.0, -56.0, -34.0, 76.0, -34.0, 65.0, 54.0, 32.0, 54.0, 76.0, -1.0, 43.0, 76.0, 76.0, 21.0, 32.0, 10.0, 76.0, -12.0, 21.0, 54.0, 32.0, 54.0, 76.0, 10.0, -100.0, -1.0, -23.0, 43.0, 32.0, 54.0, 43.0, 43.0, 65.0, 21.0, 54.0, 10.0, 43.0, 43.0, 43.0, 54.0, 32.0, -67.0, -34.0, 43.0, 65.0, 43.0, -23.0, 76.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -1.0, 43.0, 76.0, 43.0, 43.0, 43.0, 54.0, 54.0, 65.0, 32.0, -34.0, -45.0, 21.0, 21.0, 65.0, 43.0, 32.0, 43.0, 43.0, 4.0, 10.0, -23.0, -23.0, 76.0, 21.0, -23.0, 21.0, -1.0, 76.0, 65.0, 54.0, 21.0, 21.0, -23.0, 21.0, 10.0, -34.0, 65.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2044420401184046, "mean_inference_ms": 10.225589728001108, "mean_action_processing_ms": 0.08760534109444629, "mean_env_wait_ms": 0.04500165790580368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041773319244384766, "StateBufferConnector_ms": 0.0027680397033691406, "ViewRequirementAgentConnector_ms": 0.08034801483154297}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 29.46, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, -84.0, -67.0, 43.0, -56.0, -34.0, 76.0, -34.0, 65.0, 54.0, 32.0, 54.0, 76.0, -1.0, 43.0, 76.0, 76.0, 21.0, 32.0, 10.0, 76.0, -12.0, 21.0, 54.0, 32.0, 54.0, 76.0, 10.0, -100.0, -1.0, -23.0, 43.0, 32.0, 54.0, 43.0, 43.0, 65.0, 21.0, 54.0, 10.0, 43.0, 43.0, 43.0, 54.0, 32.0, -67.0, -34.0, 43.0, 65.0, 43.0, -23.0, 76.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -1.0, 43.0, 76.0, 43.0, 43.0, 43.0, 54.0, 54.0, 65.0, 32.0, -34.0, -45.0, 21.0, 21.0, 65.0, 43.0, 32.0, 43.0, 43.0, 4.0, 10.0, -23.0, -23.0, 76.0, 21.0, -23.0, 21.0, -1.0, 76.0, 65.0, 54.0, 21.0, 21.0, -23.0, 21.0, 10.0, -34.0, 65.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2044420401184046, "mean_inference_ms": 10.225589728001108, "mean_action_processing_ms": 0.08760534109444629, "mean_env_wait_ms": 0.04500165790580368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041773319244384766, "StateBufferConnector_ms": 0.0027680397033691406, "ViewRequirementAgentConnector_ms": 0.08034801483154297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 72197.887, "sample_time_ms": 39688.151, "learn_time_ms": 32501.807, "learn_throughput": 123.07, "synch_weights_time_ms": 7.406}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 4736, "training_iteration": 90, "trial_id": "38794_00003", "date": "2023-06-02_00-50-40", "timestamp": 1685656240, "time_this_iter_s": 77.77865076065063, "time_total_s": 7643.152225971222, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7643.152225971222, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 38.055963302752296, "ram_util_percent": 58.217431192660555}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 30.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -1.0, 21.0, 43.0, 76.0, 32.0, 54.0, 32.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19105133902966082, "mean_inference_ms": 10.202824925502798, "mean_action_processing_ms": 0.08635881453486646, "mean_env_wait_ms": 0.04259493167551938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943443298339844, "StateBufferConnector_ms": 0.0024890899658203125, "ViewRequirementAgentConnector_ms": 0.08152961730957031}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.07166051864624, "policy_loss": -0.020028216764330864, "vf_loss": 6.07968807220459, "vf_explained_var": 0.05640120804309845, "kl": 0.017778167501091957, "entropy": 2.3139898777008057, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 30.56, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -1.0, 43.0, 76.0, 43.0, 43.0, 43.0, 54.0, 54.0, 65.0, 32.0, -34.0, -45.0, 21.0, 21.0, 65.0, 43.0, 32.0, 43.0, 43.0, 4.0, 10.0, -23.0, -23.0, 76.0, 21.0, -23.0, 21.0, -1.0, 76.0, 65.0, 54.0, 21.0, 21.0, -23.0, 21.0, 10.0, -34.0, 65.0, 65.0, 76.0, 65.0, 65.0, 65.0, 32.0, -56.0, 76.0, 21.0, -23.0, -23.0, -1.0, -56.0, 10.0, -23.0, 65.0, -23.0, 10.0, 32.0, 65.0, 10.0, 43.0, 32.0, 32.0, 21.0, -67.0, -23.0, 21.0, 54.0, 21.0, 43.0, 43.0, 32.0, 48.0, 65.0, 10.0, 76.0, 54.0, 21.0, 65.0, 43.0, 54.0, 54.0, 54.0, 32.0, -1.0, -12.0, 32.0, 32.0, 65.0, 32.0, -12.0, 54.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20417029109312806, "mean_inference_ms": 10.215367935999188, "mean_action_processing_ms": 0.08748624808500584, "mean_env_wait_ms": 0.044911921273863946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004088163375854492, "StateBufferConnector_ms": 0.0026357173919677734, "ViewRequirementAgentConnector_ms": 0.07942390441894531}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 30.56, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -1.0, 43.0, 76.0, 43.0, 43.0, 43.0, 54.0, 54.0, 65.0, 32.0, -34.0, -45.0, 21.0, 21.0, 65.0, 43.0, 32.0, 43.0, 43.0, 4.0, 10.0, -23.0, -23.0, 76.0, 21.0, -23.0, 21.0, -1.0, 76.0, 65.0, 54.0, 21.0, 21.0, -23.0, 21.0, 10.0, -34.0, 65.0, 65.0, 76.0, 65.0, 65.0, 65.0, 32.0, -56.0, 76.0, 21.0, -23.0, -23.0, -1.0, -56.0, 10.0, -23.0, 65.0, -23.0, 10.0, 32.0, 65.0, 10.0, 43.0, 32.0, 32.0, 21.0, -67.0, -23.0, 21.0, 54.0, 21.0, 43.0, 43.0, 32.0, 48.0, 65.0, 10.0, 76.0, 54.0, 21.0, 65.0, 43.0, 54.0, 54.0, 54.0, 32.0, -1.0, -12.0, 32.0, 32.0, 65.0, 32.0, -12.0, 54.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20417029109312806, "mean_inference_ms": 10.215367935999188, "mean_action_processing_ms": 0.08748624808500584, "mean_env_wait_ms": 0.044911921273863946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004088163375854492, "StateBufferConnector_ms": 0.0026357173919677734, "ViewRequirementAgentConnector_ms": 0.07942390441894531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 71458.205, "sample_time_ms": 39146.482, "learn_time_ms": 32303.817, "learn_throughput": 123.824, "synch_weights_time_ms": 7.391}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 4789, "training_iteration": 91, "trial_id": "38794_00003", "date": "2023-06-02_00-51-58", "timestamp": 1685656318, "time_this_iter_s": 77.488853931427, "time_total_s": 7720.641079902649, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7720.641079902649, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 38.27870370370371, "ram_util_percent": 58.09907407407408}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -12.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -12.0, 10.0, 32.0, 43.0, 21.0, 43.0, 54.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19093023619248958, "mean_inference_ms": 10.203001781202891, "mean_action_processing_ms": 0.08629912040890378, "mean_env_wait_ms": 0.042559313874016846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005323886871337891, "StateBufferConnector_ms": 0.0028753280639648438, "ViewRequirementAgentConnector_ms": 0.08648157119750977}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.192837715148926, "policy_loss": -0.014873694628477097, "vf_loss": 5.198329448699951, "vf_explained_var": 0.018528545275330544, "kl": 0.013897901400923729, "entropy": 1.858442783355713, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 32.43, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -23.0, -23.0, -1.0, -56.0, 10.0, -23.0, 65.0, -23.0, 10.0, 32.0, 65.0, 10.0, 43.0, 32.0, 32.0, 21.0, -67.0, -23.0, 21.0, 54.0, 21.0, 43.0, 43.0, 32.0, 48.0, 65.0, 10.0, 76.0, 54.0, 21.0, 65.0, 43.0, 54.0, 54.0, 54.0, 32.0, -1.0, -12.0, 32.0, 32.0, 65.0, 32.0, -12.0, 54.0, 54.0, 32.0, 43.0, 65.0, 10.0, 43.0, 21.0, -1.0, 76.0, 54.0, 21.0, 54.0, -12.0, 43.0, 54.0, 54.0, 65.0, 76.0, 65.0, 76.0, 54.0, -12.0, -34.0, 32.0, 43.0, 32.0, 43.0, 21.0, 21.0, 76.0, -1.0, 54.0, -12.0, 32.0, 65.0, -23.0, 65.0, 65.0, 43.0, 76.0, 54.0, 43.0, 65.0, 76.0, 32.0, 65.0, 54.0, 10.0, 65.0, 48.0, 43.0, 65.0, -67.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20394349740967307, "mean_inference_ms": 10.21203651448039, "mean_action_processing_ms": 0.08738145642381234, "mean_env_wait_ms": 0.04484136918877956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004281520843505859, "StateBufferConnector_ms": 0.0026450157165527344, "ViewRequirementAgentConnector_ms": 0.08169341087341309}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 32.43, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -23.0, -23.0, -1.0, -56.0, 10.0, -23.0, 65.0, -23.0, 10.0, 32.0, 65.0, 10.0, 43.0, 32.0, 32.0, 21.0, -67.0, -23.0, 21.0, 54.0, 21.0, 43.0, 43.0, 32.0, 48.0, 65.0, 10.0, 76.0, 54.0, 21.0, 65.0, 43.0, 54.0, 54.0, 54.0, 32.0, -1.0, -12.0, 32.0, 32.0, 65.0, 32.0, -12.0, 54.0, 54.0, 32.0, 43.0, 65.0, 10.0, 43.0, 21.0, -1.0, 76.0, 54.0, 21.0, 54.0, -12.0, 43.0, 54.0, 54.0, 65.0, 76.0, 65.0, 76.0, 54.0, -12.0, -34.0, 32.0, 43.0, 32.0, 43.0, 21.0, 21.0, 76.0, -1.0, 54.0, -12.0, 32.0, 65.0, -23.0, 65.0, 65.0, 43.0, 76.0, 54.0, 43.0, 65.0, 76.0, 32.0, 65.0, 54.0, 10.0, 65.0, 48.0, 43.0, 65.0, -67.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20394349740967307, "mean_inference_ms": 10.21203651448039, "mean_action_processing_ms": 0.08738145642381234, "mean_env_wait_ms": 0.04484136918877956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004281520843505859, "StateBufferConnector_ms": 0.0026450157165527344, "ViewRequirementAgentConnector_ms": 0.08169341087341309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 71957.763, "sample_time_ms": 39484.829, "learn_time_ms": 32464.99, "learn_throughput": 123.21, "synch_weights_time_ms": 7.427}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 4842, "training_iteration": 92, "trial_id": "38794_00003", "date": "2023-06-02_00-53-24", "timestamp": 1685656404, "time_this_iter_s": 85.67702889442444, "time_total_s": 7806.318108797073, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7806.318108797073, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 45.66806722689075, "ram_util_percent": 61.39663865546218}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": 10.0, "episode_reward_mean": 51.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 65.0, 43.0, 65.0, 54.0, 65.0, 65.0, 54.0, 10.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19080720752179542, "mean_inference_ms": 10.202837112464971, "mean_action_processing_ms": 0.08625820660921359, "mean_env_wait_ms": 0.042532557628634456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004961490631103516, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.08664369583129883}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.116272926330566, "policy_loss": -0.012911501340568066, "vf_loss": 5.115724563598633, "vf_explained_var": 0.07118868827819824, "kl": 0.019940216094255447, "entropy": 2.2535276412963867, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 39.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 76.0, 54.0, 21.0, 54.0, -12.0, 43.0, 54.0, 54.0, 65.0, 76.0, 65.0, 76.0, 54.0, -12.0, -34.0, 32.0, 43.0, 32.0, 43.0, 21.0, 21.0, 76.0, -1.0, 54.0, -12.0, 32.0, 65.0, -23.0, 65.0, 65.0, 43.0, 76.0, 54.0, 43.0, 65.0, 76.0, 32.0, 65.0, 54.0, 10.0, 65.0, 48.0, 43.0, 65.0, -67.0, 21.0, 54.0, 43.0, 76.0, 54.0, 32.0, 21.0, 54.0, -1.0, 32.0, 10.0, 10.0, -34.0, -1.0, 43.0, 10.0, 43.0, 32.0, 10.0, 43.0, 43.0, 32.0, 43.0, 76.0, 21.0, 32.0, 21.0, 54.0, 76.0, 10.0, 76.0, 76.0, 76.0, 21.0, 10.0, 21.0, -12.0, -34.0, 54.0, 76.0, 65.0, 76.0, 54.0, 76.0, 76.0, 43.0, 65.0, 65.0, 32.0, 76.0, 32.0, 76.0, 54.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2037881853424666, "mean_inference_ms": 10.213614890553432, "mean_action_processing_ms": 0.08731212040740845, "mean_env_wait_ms": 0.04480105219992587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004621267318725586, "StateBufferConnector_ms": 0.002748727798461914, "ViewRequirementAgentConnector_ms": 0.0863032341003418}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 39.2, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 76.0, 54.0, 21.0, 54.0, -12.0, 43.0, 54.0, 54.0, 65.0, 76.0, 65.0, 76.0, 54.0, -12.0, -34.0, 32.0, 43.0, 32.0, 43.0, 21.0, 21.0, 76.0, -1.0, 54.0, -12.0, 32.0, 65.0, -23.0, 65.0, 65.0, 43.0, 76.0, 54.0, 43.0, 65.0, 76.0, 32.0, 65.0, 54.0, 10.0, 65.0, 48.0, 43.0, 65.0, -67.0, 21.0, 54.0, 43.0, 76.0, 54.0, 32.0, 21.0, 54.0, -1.0, 32.0, 10.0, 10.0, -34.0, -1.0, 43.0, 10.0, 43.0, 32.0, 10.0, 43.0, 43.0, 32.0, 43.0, 76.0, 21.0, 32.0, 21.0, 54.0, 76.0, 10.0, 76.0, 76.0, 76.0, 21.0, 10.0, 21.0, -12.0, -34.0, 54.0, 76.0, 65.0, 76.0, 54.0, 76.0, 76.0, 43.0, 65.0, 65.0, 32.0, 76.0, 32.0, 76.0, 54.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2037881853424666, "mean_inference_ms": 10.213614890553432, "mean_action_processing_ms": 0.08731212040740845, "mean_env_wait_ms": 0.04480105219992587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004621267318725586, "StateBufferConnector_ms": 0.002748727798461914, "ViewRequirementAgentConnector_ms": 0.0863032341003418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 72397.563, "sample_time_ms": 39756.787, "learn_time_ms": 32632.706, "learn_throughput": 122.576, "synch_weights_time_ms": 7.559}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 4894, "training_iteration": 93, "trial_id": "38794_00003", "date": "2023-06-02_00-54-47", "timestamp": 1685656487, "time_this_iter_s": 83.59734797477722, "time_total_s": 7889.915456771851, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7889.915456771851, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 39.52222222222222, "ram_util_percent": 62.26239316239316}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 22.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 54.0, -23.0, 10.0, 32.0, 65.0, 76.0, -23.0, -56.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19062202652675325, "mean_inference_ms": 10.208867481635526, "mean_action_processing_ms": 0.08615913016804021, "mean_env_wait_ms": 0.04249229734978262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004553794860839844, "StateBufferConnector_ms": 0.0025582313537597656, "ViewRequirementAgentConnector_ms": 0.08407115936279297}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.3277201652526855, "policy_loss": -0.013159617781639099, "vf_loss": 5.332312107086182, "vf_explained_var": 0.026703424751758575, "kl": 0.012692796997725964, "entropy": 2.1252856254577637, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 33.43, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, -1.0, 32.0, 10.0, 10.0, -34.0, -1.0, 43.0, 10.0, 43.0, 32.0, 10.0, 43.0, 43.0, 32.0, 43.0, 76.0, 21.0, 32.0, 21.0, 54.0, 76.0, 10.0, 76.0, 76.0, 76.0, 21.0, 10.0, 21.0, -12.0, -34.0, 54.0, 76.0, 65.0, 76.0, 54.0, 76.0, 76.0, 43.0, 65.0, 65.0, 32.0, 76.0, 32.0, 76.0, 54.0, -12.0, 32.0, 54.0, -23.0, -144.0, 10.0, 76.0, 76.0, 10.0, -45.0, 32.0, 43.0, 76.0, 65.0, -56.0, 54.0, 21.0, 65.0, 54.0, 32.0, 76.0, 32.0, -1.0, 76.0, 43.0, 43.0, -12.0, 32.0, 65.0, 65.0, 10.0, 65.0, 32.0, 65.0, 76.0, 43.0, 54.0, 76.0, 76.0, 76.0, -56.0, -34.0, 65.0, 76.0, 32.0, -100.0, 10.0, -23.0, -34.0, 65.0, 65.0, 54.0, -1.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20366196083546784, "mean_inference_ms": 10.216710380260217, "mean_action_processing_ms": 0.08726013874277479, "mean_env_wait_ms": 0.04476989123208272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004675626754760742, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.0877375602722168}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 33.43, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -1.0, 32.0, 10.0, 10.0, -34.0, -1.0, 43.0, 10.0, 43.0, 32.0, 10.0, 43.0, 43.0, 32.0, 43.0, 76.0, 21.0, 32.0, 21.0, 54.0, 76.0, 10.0, 76.0, 76.0, 76.0, 21.0, 10.0, 21.0, -12.0, -34.0, 54.0, 76.0, 65.0, 76.0, 54.0, 76.0, 76.0, 43.0, 65.0, 65.0, 32.0, 76.0, 32.0, 76.0, 54.0, -12.0, 32.0, 54.0, -23.0, -144.0, 10.0, 76.0, 76.0, 10.0, -45.0, 32.0, 43.0, 76.0, 65.0, -56.0, 54.0, 21.0, 65.0, 54.0, 32.0, 76.0, 32.0, -1.0, 76.0, 43.0, 43.0, -12.0, 32.0, 65.0, 65.0, 10.0, 65.0, 32.0, 65.0, 76.0, 43.0, 54.0, 76.0, 76.0, 76.0, -56.0, -34.0, 65.0, 76.0, 32.0, -100.0, 10.0, -23.0, -34.0, 65.0, 65.0, 54.0, -1.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20366196083546784, "mean_inference_ms": 10.216710380260217, "mean_action_processing_ms": 0.08726013874277479, "mean_env_wait_ms": 0.04476989123208272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004675626754760742, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.0877375602722168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 73290.257, "sample_time_ms": 40337.522, "learn_time_ms": 32944.975, "learn_throughput": 121.415, "synch_weights_time_ms": 7.297}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 4947, "training_iteration": 94, "trial_id": "38794_00003", "date": "2023-06-02_00-56-15", "timestamp": 1685656575, "time_this_iter_s": 87.41549706459045, "time_total_s": 7977.330953836441, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7977.330953836441, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 38.647933884297515, "ram_util_percent": 62.79421487603306}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -95.0, "episode_reward_mean": 0.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, 10.0, 65.0, 10.0, 32.0, -95.0, -23.0, 43.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19050066815283012, "mean_inference_ms": 10.207314694090064, "mean_action_processing_ms": 0.08610618690531616, "mean_env_wait_ms": 0.04245682080758463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004363059997558594, "StateBufferConnector_ms": 0.002658367156982422, "ViewRequirementAgentConnector_ms": 0.08453845977783203}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.562342166900635, "policy_loss": -0.01814269833266735, "vf_loss": 6.57121467590332, "vf_explained_var": 0.016708655282855034, "kl": 0.01373366080224514, "entropy": 1.9579334259033203, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 21.93, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 10.0, -45.0, 32.0, 43.0, 76.0, 65.0, -56.0, 54.0, 21.0, 65.0, 54.0, 32.0, 76.0, 32.0, -1.0, 76.0, 43.0, 43.0, -12.0, 32.0, 65.0, 65.0, 10.0, 65.0, 32.0, 65.0, 76.0, 43.0, 54.0, 76.0, 76.0, 76.0, -56.0, -34.0, 65.0, 76.0, 32.0, -100.0, 10.0, -23.0, -34.0, 65.0, 65.0, 54.0, -1.0, -1.0, -1.0, -12.0, 21.0, -34.0, 10.0, 32.0, 32.0, 21.0, 54.0, 21.0, 10.0, -23.0, -56.0, 10.0, -67.0, -122.0, -45.0, -12.0, -45.0, 54.0, 54.0, 10.0, -1.0, 54.0, -1.0, 21.0, 43.0, 32.0, 10.0, 76.0, 43.0, -67.0, 26.0, 76.0, -1.0, 43.0, 10.0, 10.0, 10.0, 21.0, 21.0, -23.0, 43.0, 32.0, 10.0, -23.0, -1.0, 65.0, 65.0, 54.0, -1.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20353420109549872, "mean_inference_ms": 10.219386159980811, "mean_action_processing_ms": 0.08720415917502024, "mean_env_wait_ms": 0.044739572371346965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047016143798828125, "StateBufferConnector_ms": 0.0026895999908447266, "ViewRequirementAgentConnector_ms": 0.08773183822631836}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 21.93, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 10.0, -45.0, 32.0, 43.0, 76.0, 65.0, -56.0, 54.0, 21.0, 65.0, 54.0, 32.0, 76.0, 32.0, -1.0, 76.0, 43.0, 43.0, -12.0, 32.0, 65.0, 65.0, 10.0, 65.0, 32.0, 65.0, 76.0, 43.0, 54.0, 76.0, 76.0, 76.0, -56.0, -34.0, 65.0, 76.0, 32.0, -100.0, 10.0, -23.0, -34.0, 65.0, 65.0, 54.0, -1.0, -1.0, -1.0, -12.0, 21.0, -34.0, 10.0, 32.0, 32.0, 21.0, 54.0, 21.0, 10.0, -23.0, -56.0, 10.0, -67.0, -122.0, -45.0, -12.0, -45.0, 54.0, 54.0, 10.0, -1.0, 54.0, -1.0, 21.0, 43.0, 32.0, 10.0, 76.0, 43.0, -67.0, 26.0, 76.0, -1.0, 43.0, 10.0, 10.0, 10.0, 21.0, 21.0, -23.0, 43.0, 32.0, 10.0, -23.0, -1.0, 65.0, 65.0, 54.0, -1.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20353420109549872, "mean_inference_ms": 10.219386159980811, "mean_action_processing_ms": 0.08720415917502024, "mean_env_wait_ms": 0.044739572371346965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047016143798828125, "StateBufferConnector_ms": 0.0026895999908447266, "ViewRequirementAgentConnector_ms": 0.08773183822631836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 73541.568, "sample_time_ms": 40585.065, "learn_time_ms": 32949.02, "learn_throughput": 121.4, "synch_weights_time_ms": 7.042}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 5000, "training_iteration": 95, "trial_id": "38794_00003", "date": "2023-06-02_00-57-38", "timestamp": 1685656658, "time_this_iter_s": 83.35875201225281, "time_total_s": 8060.689705848694, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8060.689705848694, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 41.87241379310345, "ram_util_percent": 63.843965517241394}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 15.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -45.0, -23.0, 43.0, 10.0, 54.0, 21.0, 32.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19031712344905732, "mean_inference_ms": 10.211090876151248, "mean_action_processing_ms": 0.08600954570862543, "mean_env_wait_ms": 0.04241006128395308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004372596740722656, "StateBufferConnector_ms": 0.0025343894958496094, "ViewRequirementAgentConnector_ms": 0.08245229721069336}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.943089008331299, "policy_loss": -0.017348311841487885, "vf_loss": 5.951987266540527, "vf_explained_var": 0.07043643295764923, "kl": 0.012517686933279037, "entropy": 2.060535430908203, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 20.33, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 32.0, 21.0, 54.0, 21.0, 10.0, -23.0, -56.0, 10.0, -67.0, -122.0, -45.0, -12.0, -45.0, 54.0, 54.0, 10.0, -1.0, 54.0, -1.0, 21.0, 43.0, 32.0, 10.0, 76.0, 43.0, -67.0, 26.0, 76.0, -1.0, 43.0, 10.0, 10.0, 10.0, 21.0, 21.0, -23.0, 43.0, 32.0, 10.0, -23.0, -1.0, 65.0, 65.0, 54.0, -1.0, 32.0, 65.0, 76.0, 76.0, 43.0, 43.0, 21.0, -1.0, 32.0, 65.0, 21.0, 54.0, 54.0, 32.0, 43.0, 43.0, -67.0, 10.0, -111.0, 32.0, 10.0, -12.0, -12.0, 21.0, 54.0, 32.0, 10.0, 76.0, 76.0, -1.0, 76.0, -1.0, 32.0, 21.0, 76.0, 54.0, 32.0, 54.0, 21.0, 32.0, 26.0, 21.0, 54.0, -34.0, 21.0, 43.0, 54.0, 65.0, 54.0, 21.0, 10.0, -78.0, -34.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2034102110791421, "mean_inference_ms": 10.219447854870571, "mean_action_processing_ms": 0.08715644079227752, "mean_env_wait_ms": 0.044711658126930905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004635334014892578, "StateBufferConnector_ms": 0.0026772022247314453, "ViewRequirementAgentConnector_ms": 0.08727049827575684}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 20.33, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 32.0, 21.0, 54.0, 21.0, 10.0, -23.0, -56.0, 10.0, -67.0, -122.0, -45.0, -12.0, -45.0, 54.0, 54.0, 10.0, -1.0, 54.0, -1.0, 21.0, 43.0, 32.0, 10.0, 76.0, 43.0, -67.0, 26.0, 76.0, -1.0, 43.0, 10.0, 10.0, 10.0, 21.0, 21.0, -23.0, 43.0, 32.0, 10.0, -23.0, -1.0, 65.0, 65.0, 54.0, -1.0, 32.0, 65.0, 76.0, 76.0, 43.0, 43.0, 21.0, -1.0, 32.0, 65.0, 21.0, 54.0, 54.0, 32.0, 43.0, 43.0, -67.0, 10.0, -111.0, 32.0, 10.0, -12.0, -12.0, 21.0, 54.0, 32.0, 10.0, 76.0, 76.0, -1.0, 76.0, -1.0, 32.0, 21.0, 76.0, 54.0, 32.0, 54.0, 21.0, 32.0, 26.0, 21.0, 54.0, -34.0, 21.0, 43.0, 54.0, 65.0, 54.0, 21.0, 10.0, -78.0, -34.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2034102110791421, "mean_inference_ms": 10.219447854870571, "mean_action_processing_ms": 0.08715644079227752, "mean_env_wait_ms": 0.044711658126930905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004635334014892578, "StateBufferConnector_ms": 0.0026772022247314453, "ViewRequirementAgentConnector_ms": 0.08727049827575684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 74107.483, "sample_time_ms": 40934.523, "learn_time_ms": 33165.414, "learn_throughput": 120.608, "synch_weights_time_ms": 7.104}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 5052, "training_iteration": 96, "trial_id": "38794_00003", "date": "2023-06-02_00-59-03", "timestamp": 1685656743, "time_this_iter_s": 84.46164202690125, "time_total_s": 8145.151347875595, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8145.151347875595, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 45.15811965811966, "ram_util_percent": 63.96666666666666}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 19.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -34.0, 10.0, -1.0, -12.0, 65.0, 43.0, 65.0, 65.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1901784422270806, "mean_inference_ms": 10.210610809219578, "mean_action_processing_ms": 0.08596924233185298, "mean_env_wait_ms": 0.04238118326034459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004465579986572266, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.0844430923461914}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.569289207458496, "policy_loss": -0.022529752925038338, "vf_loss": 6.581894874572754, "vf_explained_var": 0.031062999740242958, "kl": 0.014701489359140396, "entropy": 1.9943832159042358, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 16.43, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, 65.0, 21.0, 54.0, 54.0, 32.0, 43.0, 43.0, -67.0, 10.0, -111.0, 32.0, 10.0, -12.0, -12.0, 21.0, 54.0, 32.0, 10.0, 76.0, 76.0, -1.0, 76.0, -1.0, 32.0, 21.0, 76.0, 54.0, 32.0, 54.0, 21.0, 32.0, 26.0, 21.0, 54.0, -34.0, 21.0, 43.0, 54.0, 65.0, 54.0, 21.0, 10.0, -78.0, -34.0, 21.0, -67.0, 10.0, 21.0, 21.0, -34.0, -45.0, 21.0, 43.0, 32.0, 76.0, 76.0, 54.0, -23.0, 10.0, -34.0, -100.0, -67.0, -67.0, -1.0, -12.0, -56.0, 32.0, -56.0, -45.0, 32.0, 21.0, 32.0, 32.0, 43.0, 43.0, -12.0, 10.0, 43.0, 65.0, 76.0, 54.0, 32.0, 54.0, 10.0, -67.0, -1.0, 32.0, 54.0, 43.0, 43.0, 21.0, -34.0, 32.0, 32.0, 76.0, 43.0, 32.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20327391023866517, "mean_inference_ms": 10.221275505607975, "mean_action_processing_ms": 0.08709317644606994, "mean_env_wait_ms": 0.04467883167603921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004553079605102539, "StateBufferConnector_ms": 0.002658843994140625, "ViewRequirementAgentConnector_ms": 0.08685421943664551}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 16.43, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, 65.0, 21.0, 54.0, 54.0, 32.0, 43.0, 43.0, -67.0, 10.0, -111.0, 32.0, 10.0, -12.0, -12.0, 21.0, 54.0, 32.0, 10.0, 76.0, 76.0, -1.0, 76.0, -1.0, 32.0, 21.0, 76.0, 54.0, 32.0, 54.0, 21.0, 32.0, 26.0, 21.0, 54.0, -34.0, 21.0, 43.0, 54.0, 65.0, 54.0, 21.0, 10.0, -78.0, -34.0, 21.0, -67.0, 10.0, 21.0, 21.0, -34.0, -45.0, 21.0, 43.0, 32.0, 76.0, 76.0, 54.0, -23.0, 10.0, -34.0, -100.0, -67.0, -67.0, -1.0, -12.0, -56.0, 32.0, -56.0, -45.0, 32.0, 21.0, 32.0, 32.0, 43.0, 43.0, -12.0, 10.0, 43.0, 65.0, 76.0, 54.0, 32.0, 54.0, 10.0, -67.0, -1.0, 32.0, 54.0, 43.0, 43.0, 21.0, -34.0, 32.0, 32.0, 76.0, 43.0, 32.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20327391023866517, "mean_inference_ms": 10.221275505607975, "mean_action_processing_ms": 0.08709317644606994, "mean_env_wait_ms": 0.04467883167603921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004553079605102539, "StateBufferConnector_ms": 0.002658843994140625, "ViewRequirementAgentConnector_ms": 0.08685421943664551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 74328.577, "sample_time_ms": 41180.096, "learn_time_ms": 33140.986, "learn_throughput": 120.696, "synch_weights_time_ms": 7.047}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 5105, "training_iteration": 97, "trial_id": "38794_00003", "date": "2023-06-02_01-00-28", "timestamp": 1685656828, "time_this_iter_s": 85.37308692932129, "time_total_s": 8230.524434804916, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8230.524434804916, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 44.15882352941176, "ram_util_percent": 64.17899159663868}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 27.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 10.0, 21.0, -23.0, 65.0, -34.0, 32.0, 54.0, 65.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.190057271283714, "mean_inference_ms": 10.215026294104248, "mean_action_processing_ms": 0.08590579188149639, "mean_env_wait_ms": 0.04234931898578659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046634674072265625, "StateBufferConnector_ms": 0.002720355987548828, "ViewRequirementAgentConnector_ms": 0.08504629135131836}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.113842964172363, "policy_loss": -0.015419851057231426, "vf_loss": 6.120786666870117, "vf_explained_var": -0.0004188160237390548, "kl": 0.012556863017380238, "entropy": 1.8323571681976318, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 19.02, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, 21.0, 43.0, 32.0, 76.0, 76.0, 54.0, -23.0, 10.0, -34.0, -100.0, -67.0, -67.0, -1.0, -12.0, -56.0, 32.0, -56.0, -45.0, 32.0, 21.0, 32.0, 32.0, 43.0, 43.0, -12.0, 10.0, 43.0, 65.0, 76.0, 54.0, 32.0, 54.0, 10.0, -67.0, -1.0, 32.0, 54.0, 43.0, 43.0, 21.0, -34.0, 32.0, 32.0, 76.0, 43.0, 32.0, -89.0, -23.0, 32.0, 43.0, -12.0, -12.0, 21.0, 21.0, -34.0, 32.0, -1.0, 21.0, -1.0, -67.0, -78.0, 21.0, 10.0, 32.0, 43.0, 10.0, 43.0, 65.0, 76.0, -12.0, 43.0, 43.0, 65.0, -34.0, -12.0, 21.0, 32.0, 65.0, 43.0, 65.0, 43.0, 32.0, 43.0, -12.0, 43.0, 43.0, 54.0, 10.0, 32.0, 21.0, 43.0, 76.0, 54.0, 54.0, 43.0, 43.0, 54.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20315271860320588, "mean_inference_ms": 10.22345175504082, "mean_action_processing_ms": 0.08704199539666106, "mean_env_wait_ms": 0.044649199287674135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004739046096801758, "StateBufferConnector_ms": 0.0026979446411132812, "ViewRequirementAgentConnector_ms": 0.08687591552734375}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 19.02, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, 21.0, 43.0, 32.0, 76.0, 76.0, 54.0, -23.0, 10.0, -34.0, -100.0, -67.0, -67.0, -1.0, -12.0, -56.0, 32.0, -56.0, -45.0, 32.0, 21.0, 32.0, 32.0, 43.0, 43.0, -12.0, 10.0, 43.0, 65.0, 76.0, 54.0, 32.0, 54.0, 10.0, -67.0, -1.0, 32.0, 54.0, 43.0, 43.0, 21.0, -34.0, 32.0, 32.0, 76.0, 43.0, 32.0, -89.0, -23.0, 32.0, 43.0, -12.0, -12.0, 21.0, 21.0, -34.0, 32.0, -1.0, 21.0, -1.0, -67.0, -78.0, 21.0, 10.0, 32.0, 43.0, 10.0, 43.0, 65.0, 76.0, -12.0, 43.0, 43.0, 65.0, -34.0, -12.0, 21.0, 32.0, 65.0, 43.0, 65.0, 43.0, 32.0, 43.0, -12.0, 43.0, 43.0, 54.0, 10.0, 32.0, 21.0, 43.0, 76.0, 54.0, 54.0, 43.0, 43.0, 54.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20315271860320588, "mean_inference_ms": 10.22345175504082, "mean_action_processing_ms": 0.08704199539666106, "mean_env_wait_ms": 0.044649199287674135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004739046096801758, "StateBufferConnector_ms": 0.0026979446411132812, "ViewRequirementAgentConnector_ms": 0.08687591552734375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 74912.088, "sample_time_ms": 41588.298, "learn_time_ms": 33316.143, "learn_throughput": 120.062, "synch_weights_time_ms": 7.202}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 5157, "training_iteration": 98, "trial_id": "38794_00003", "date": "2023-06-02_01-01-52", "timestamp": 1685656912, "time_this_iter_s": 84.27488684654236, "time_total_s": 8314.799321651459, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8314.799321651459, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 39.56923076923077, "ram_util_percent": 63.368376068376065}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 23.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 32.0, 43.0, -1.0, 10.0, 43.0, 32.0, 21.0, 32.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18993416901776522, "mean_inference_ms": 10.214393474549299, "mean_action_processing_ms": 0.085834608198288, "mean_env_wait_ms": 0.04231611796776942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004193782806396484, "StateBufferConnector_ms": 0.0028896331787109375, "ViewRequirementAgentConnector_ms": 0.08319616317749023}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 5.980521202087402, "policy_loss": -0.0176533255726099, "vf_loss": 5.988762378692627, "vf_explained_var": 0.019478201866149902, "kl": 0.013943190686404705, "entropy": 1.8524894714355469, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 24.52, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 21.0, -34.0, 32.0, -1.0, 21.0, -1.0, -67.0, -78.0, 21.0, 10.0, 32.0, 43.0, 10.0, 43.0, 65.0, 76.0, -12.0, 43.0, 43.0, 65.0, -34.0, -12.0, 21.0, 32.0, 65.0, 43.0, 65.0, 43.0, 32.0, 43.0, -12.0, 43.0, 43.0, 54.0, 10.0, 32.0, 21.0, 43.0, 76.0, 54.0, 54.0, 43.0, 43.0, 54.0, 43.0, 32.0, -45.0, 43.0, 54.0, 54.0, 65.0, 43.0, 54.0, 32.0, 10.0, 21.0, -34.0, -23.0, 65.0, 65.0, 54.0, 43.0, -1.0, 43.0, 54.0, 21.0, 43.0, 65.0, 76.0, 43.0, 76.0, 10.0, -34.0, 10.0, 43.0, 32.0, 43.0, 32.0, 76.0, 65.0, 21.0, -12.0, 21.0, -1.0, 32.0, -1.0, 43.0, 21.0, -166.0, -45.0, 10.0, -45.0, -34.0, -34.0, 10.0, 54.0, 43.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2030270319901858, "mean_inference_ms": 10.227258551300794, "mean_action_processing_ms": 0.08698397371504317, "mean_env_wait_ms": 0.04461792013398089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004757881164550781, "StateBufferConnector_ms": 0.0027430057525634766, "ViewRequirementAgentConnector_ms": 0.08737659454345703}}, "episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 24.52, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 21.0, -34.0, 32.0, -1.0, 21.0, -1.0, -67.0, -78.0, 21.0, 10.0, 32.0, 43.0, 10.0, 43.0, 65.0, 76.0, -12.0, 43.0, 43.0, 65.0, -34.0, -12.0, 21.0, 32.0, 65.0, 43.0, 65.0, 43.0, 32.0, 43.0, -12.0, 43.0, 43.0, 54.0, 10.0, 32.0, 21.0, 43.0, 76.0, 54.0, 54.0, 43.0, 43.0, 54.0, 43.0, 32.0, -45.0, 43.0, 54.0, 54.0, 65.0, 43.0, 54.0, 32.0, 10.0, 21.0, -34.0, -23.0, 65.0, 65.0, 54.0, 43.0, -1.0, 43.0, 54.0, 21.0, 43.0, 65.0, 76.0, 43.0, 76.0, 10.0, -34.0, 10.0, 43.0, 32.0, 43.0, 32.0, 76.0, 65.0, 21.0, -12.0, 21.0, -1.0, 32.0, -1.0, 43.0, 21.0, -166.0, -45.0, 10.0, -45.0, -34.0, -34.0, 10.0, 54.0, 43.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2030270319901858, "mean_inference_ms": 10.227258551300794, "mean_action_processing_ms": 0.08698397371504317, "mean_env_wait_ms": 0.04461792013398089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004757881164550781, "StateBufferConnector_ms": 0.0027430057525634766, "ViewRequirementAgentConnector_ms": 0.08737659454345703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 75709.811, "sample_time_ms": 42179.703, "learn_time_ms": 33521.723, "learn_throughput": 119.326, "synch_weights_time_ms": 7.9}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 5210, "training_iteration": 99, "trial_id": "38794_00003", "date": "2023-06-02_01-03-20", "timestamp": 1685657000, "time_this_iter_s": 87.51453495025635, "time_total_s": 8402.313856601715, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8402.313856601715, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 36.50573770491804, "ram_util_percent": 63.91147540983607}}
{"evaluation": {"episode_reward_max": 10.0, "episode_reward_min": -67.0, "episode_reward_mean": -14.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -12.0, 10.0, -56.0, -67.0, -12.0, -1.0, 10.0, -12.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18981543922532235, "mean_inference_ms": 10.214041967777574, "mean_action_processing_ms": 0.08579200243404358, "mean_env_wait_ms": 0.04229016248239448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005192756652832031, "StateBufferConnector_ms": 0.0031757354736328125, "ViewRequirementAgentConnector_ms": 0.08736371994018555}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.263242721557617, "policy_loss": -0.01571795716881752, "vf_loss": 6.265679836273193, "vf_explained_var": 0.047878459095954895, "kl": 0.019674479961395264, "entropy": 2.1273303031921387, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 19.62, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 10.0, 21.0, -34.0, -23.0, 65.0, 65.0, 54.0, 43.0, -1.0, 43.0, 54.0, 21.0, 43.0, 65.0, 76.0, 43.0, 76.0, 10.0, -34.0, 10.0, 43.0, 32.0, 43.0, 32.0, 76.0, 65.0, 21.0, -12.0, 21.0, -1.0, 32.0, -1.0, 43.0, 21.0, -166.0, -45.0, 10.0, -45.0, -34.0, -34.0, 10.0, 54.0, 43.0, 32.0, 21.0, -78.0, 32.0, 43.0, -12.0, 54.0, 65.0, 32.0, 43.0, 43.0, 10.0, 10.0, 76.0, -45.0, -1.0, -12.0, 76.0, 65.0, 43.0, 21.0, 54.0, 65.0, 76.0, 65.0, 32.0, 21.0, 32.0, -29.0, 21.0, -45.0, 32.0, -45.0, 21.0, 43.0, 32.0, 21.0, -12.0, 21.0, 21.0, 54.0, -45.0, -34.0, -23.0, 21.0, -12.0, 43.0, 10.0, 21.0, 32.0, -1.0, -23.0, -1.0, 65.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2029027867045835, "mean_inference_ms": 10.23043279042306, "mean_action_processing_ms": 0.08692335152518307, "mean_env_wait_ms": 0.04458646414628405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004682779312133789, "StateBufferConnector_ms": 0.0027637481689453125, "ViewRequirementAgentConnector_ms": 0.08685493469238281}}, "episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 19.62, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 10.0, 21.0, -34.0, -23.0, 65.0, 65.0, 54.0, 43.0, -1.0, 43.0, 54.0, 21.0, 43.0, 65.0, 76.0, 43.0, 76.0, 10.0, -34.0, 10.0, 43.0, 32.0, 43.0, 32.0, 76.0, 65.0, 21.0, -12.0, 21.0, -1.0, 32.0, -1.0, 43.0, 21.0, -166.0, -45.0, 10.0, -45.0, -34.0, -34.0, 10.0, 54.0, 43.0, 32.0, 21.0, -78.0, 32.0, 43.0, -12.0, 54.0, 65.0, 32.0, 43.0, 43.0, 10.0, 10.0, 76.0, -45.0, -1.0, -12.0, 76.0, 65.0, 43.0, 21.0, 54.0, 65.0, 76.0, 65.0, 32.0, 21.0, 32.0, -29.0, 21.0, -45.0, 32.0, -45.0, 21.0, 43.0, 32.0, 21.0, -12.0, 21.0, 21.0, 54.0, -45.0, -34.0, -23.0, 21.0, -12.0, 43.0, 10.0, 21.0, 32.0, -1.0, -23.0, -1.0, 65.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2029027867045835, "mean_inference_ms": 10.23043279042306, "mean_action_processing_ms": 0.08692335152518307, "mean_env_wait_ms": 0.04458646414628405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004682779312133789, "StateBufferConnector_ms": 0.0027637481689453125, "ViewRequirementAgentConnector_ms": 0.08685493469238281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 76263.031, "sample_time_ms": 42561.575, "learn_time_ms": 33693.007, "learn_throughput": 118.719, "synch_weights_time_ms": 7.964}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "episodes_total": 5263, "training_iteration": 100, "trial_id": "38794_00003", "date": "2023-06-02_01-04-44", "timestamp": 1685657084, "time_this_iter_s": 84.06856894493103, "time_total_s": 8486.382425546646, "pid": 82395, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8486.382425546646, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 35.97327586206896, "ram_util_percent": 63.8741379310345}}
