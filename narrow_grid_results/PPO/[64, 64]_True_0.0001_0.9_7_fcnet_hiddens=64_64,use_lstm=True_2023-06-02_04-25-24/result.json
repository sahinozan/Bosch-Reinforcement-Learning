{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -89.0, "episode_reward_mean": -31.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -89.0, -45.0, 10.0, 21.0, -23.0, -12.0, -34.0, -45.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2229166720135923, "mean_inference_ms": 24.430110482756, "mean_action_processing_ms": 0.08973968796598455, "mean_env_wait_ms": 0.0447481283220449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004978179931640625, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.11503458023071289}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 7.362342834472656, "policy_loss": -0.02741236612200737, "vf_loss": 7.38460111618042, "vf_explained_var": -0.053159601986408234, "kl": 0.025770369917154312, "entropy": 2.949021577835083, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 510.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -19.403846153846153, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.0, -34.0, -89.0, -89.0, -23.0, -89.0, -12.0, -78.0, 10.0, -34.0, -111.0, -56.0, 10.0, 21.0, 10.0, 10.0, -67.0, 21.0, -56.0, 32.0, 32.0, -1.0, -111.0, -67.0, -23.0, -34.0, 10.0, 10.0, 10.0, 21.0, -1.0, 54.0, -12.0, -1.0, -23.0, -45.0, -67.0, 32.0, -23.0, -45.0, -23.0, -34.0, -45.0, 10.0, 43.0, 43.0, -12.0, -12.0, -45.0, 32.0, 21.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24855521225208224, "mean_inference_ms": 24.48847001268101, "mean_action_processing_ms": 0.09383406826210927, "mean_env_wait_ms": 0.04434150566133491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006168163739717924, "StateBufferConnector_ms": 0.005610172565166767, "ViewRequirementAgentConnector_ms": 0.12137568913973294}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -19.403846153846153, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155.0, -34.0, -89.0, -89.0, -23.0, -89.0, -12.0, -78.0, 10.0, -34.0, -111.0, -56.0, 10.0, 21.0, 10.0, 10.0, -67.0, 21.0, -56.0, 32.0, 32.0, -1.0, -111.0, -67.0, -23.0, -34.0, 10.0, 10.0, 10.0, 21.0, -1.0, 54.0, -12.0, -1.0, -23.0, -45.0, -67.0, 32.0, -23.0, -45.0, -23.0, -34.0, -45.0, 10.0, 43.0, 43.0, -12.0, -12.0, -45.0, 32.0, 21.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24855521225208224, "mean_inference_ms": 24.48847001268101, "mean_action_processing_ms": 0.09383406826210927, "mean_env_wait_ms": 0.04434150566133491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006168163739717924, "StateBufferConnector_ms": 0.005610172565166767, "ViewRequirementAgentConnector_ms": 0.12137568913973294}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 179729.309, "sample_time_ms": 99575.7, "learn_time_ms": 80140.866, "learn_throughput": 49.912, "synch_weights_time_ms": 10.476}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 52, "training_iteration": 1, "trial_id": "38794_00007", "date": "2023-06-02_04-29-03", "timestamp": 1685669343, "time_this_iter_s": 198.6573131084442, "time_total_s": 198.6573131084442, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 198.6573131084442, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.290942028985505, "ram_util_percent": 58.36304347826087}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 12.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -12.0, -45.0, 32.0, 21.0, -23.0, 21.0, 43.0, 10.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22090664825339132, "mean_inference_ms": 24.36945173475477, "mean_action_processing_ms": 0.08847555151744393, "mean_env_wait_ms": 0.04339531642053567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005271434783935547, "StateBufferConnector_ms": 0.005621910095214844, "ViewRequirementAgentConnector_ms": 0.11255979537963867}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 6.214634895324707, "policy_loss": -0.06102008745074272, "vf_loss": 6.264132499694824, "vf_explained_var": -0.10805856436491013, "kl": 0.03841031342744827, "entropy": 2.8959908485412598, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1530.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -0.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -12.0, -78.0, 10.0, -34.0, -111.0, -56.0, 10.0, 21.0, 10.0, 10.0, -67.0, 21.0, -56.0, 32.0, 32.0, -1.0, -111.0, -67.0, -23.0, -34.0, 10.0, 10.0, 10.0, 21.0, -1.0, 54.0, -12.0, -1.0, -23.0, -45.0, -67.0, 32.0, -23.0, -45.0, -23.0, -34.0, -45.0, 10.0, 43.0, 43.0, -12.0, -12.0, -45.0, 32.0, 21.0, 76.0, -23.0, -67.0, 21.0, 32.0, -12.0, 10.0, -34.0, 43.0, -45.0, 21.0, 54.0, 32.0, -12.0, 43.0, 54.0, 21.0, 43.0, -12.0, 10.0, 10.0, 65.0, 10.0, 54.0, 21.0, 54.0, -45.0, 32.0, -78.0, 32.0, -1.0, -12.0, 32.0, 21.0, -34.0, 21.0, -12.0, 32.0, 65.0, 21.0, -1.0, -29.0, -67.0, -23.0, 10.0, -34.0, 43.0, 32.0, 54.0, 54.0, 32.0, 65.0, 43.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2449163435049032, "mean_inference_ms": 24.518583000839147, "mean_action_processing_ms": 0.09220426052974329, "mean_env_wait_ms": 0.04338266517190025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058879852294921875, "StateBufferConnector_ms": 0.005112409591674805, "ViewRequirementAgentConnector_ms": 0.11695528030395508}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -0.4, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.0, -12.0, -78.0, 10.0, -34.0, -111.0, -56.0, 10.0, 21.0, 10.0, 10.0, -67.0, 21.0, -56.0, 32.0, 32.0, -1.0, -111.0, -67.0, -23.0, -34.0, 10.0, 10.0, 10.0, 21.0, -1.0, 54.0, -12.0, -1.0, -23.0, -45.0, -67.0, 32.0, -23.0, -45.0, -23.0, -34.0, -45.0, 10.0, 43.0, 43.0, -12.0, -12.0, -45.0, 32.0, 21.0, 76.0, -23.0, -67.0, 21.0, 32.0, -12.0, 10.0, -34.0, 43.0, -45.0, 21.0, 54.0, 32.0, -12.0, 43.0, 54.0, 21.0, 43.0, -12.0, 10.0, 10.0, 65.0, 10.0, 54.0, 21.0, 54.0, -45.0, 32.0, -78.0, 32.0, -1.0, -12.0, 32.0, 21.0, -34.0, 21.0, -12.0, 32.0, 65.0, 21.0, -1.0, -29.0, -67.0, -23.0, 10.0, -34.0, 43.0, 32.0, 54.0, 54.0, 32.0, 65.0, 43.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2449163435049032, "mean_inference_ms": 24.518583000839147, "mean_action_processing_ms": 0.09220426052974329, "mean_env_wait_ms": 0.04338266517190025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058879852294921875, "StateBufferConnector_ms": 0.005112409591674805, "ViewRequirementAgentConnector_ms": 0.11695528030395508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 179876.039, "sample_time_ms": 99741.175, "learn_time_ms": 80122.988, "learn_throughput": 49.923, "synch_weights_time_ms": 10.203}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 105, "training_iteration": 2, "trial_id": "38794_00007", "date": "2023-06-02_04-32-22", "timestamp": 1685669542, "time_this_iter_s": 198.81965970993042, "time_total_s": 397.47697281837463, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 397.47697281837463, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.927636363636363, "ram_util_percent": 56.580363636363636}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -45.0, "episode_reward_mean": 17.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -1.0, -12.0, 32.0, 43.0, 43.0, 10.0, -45.0, 21.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21976391927341993, "mean_inference_ms": 24.28392818338878, "mean_action_processing_ms": 0.08775193876260626, "mean_env_wait_ms": 0.042267297245545746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005469322204589844, "StateBufferConnector_ms": 0.005347728729248047, "ViewRequirementAgentConnector_ms": 0.11336565017700195}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 5.936447620391846, "policy_loss": -0.0532863549888134, "vf_loss": 5.972710132598877, "vf_explained_var": -0.09801018238067627, "kl": 0.03783026337623596, "entropy": 2.867403030395508, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2550.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 11.26, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -34.0, 43.0, -45.0, 21.0, 54.0, 32.0, -12.0, 43.0, 54.0, 21.0, 43.0, -12.0, 10.0, 10.0, 65.0, 10.0, 54.0, 21.0, 54.0, -45.0, 32.0, -78.0, 32.0, -1.0, -12.0, 32.0, 21.0, -34.0, 21.0, -12.0, 32.0, 65.0, 21.0, -1.0, -29.0, -67.0, -23.0, 10.0, -34.0, 43.0, 32.0, 54.0, 54.0, 32.0, 65.0, 43.0, -67.0, 54.0, -56.0, -23.0, -45.0, -45.0, -56.0, 10.0, 32.0, -23.0, 10.0, 43.0, -1.0, -1.0, -23.0, -1.0, 43.0, 54.0, -1.0, 43.0, 43.0, 21.0, 43.0, 54.0, 65.0, 54.0, 76.0, 54.0, 43.0, 65.0, 21.0, 54.0, 10.0, -45.0, 10.0, -45.0, -34.0, -23.0, -12.0, 21.0, -12.0, 21.0, -45.0, 32.0, -12.0, 21.0, -1.0, 21.0, -12.0, -45.0, 21.0, -1.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24065877182110718, "mean_inference_ms": 24.5677940119987, "mean_action_processing_ms": 0.09031691595789292, "mean_env_wait_ms": 0.04226496683343971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057146549224853516, "StateBufferConnector_ms": 0.004726886749267578, "ViewRequirementAgentConnector_ms": 0.11380457878112793}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 11.26, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -34.0, 43.0, -45.0, 21.0, 54.0, 32.0, -12.0, 43.0, 54.0, 21.0, 43.0, -12.0, 10.0, 10.0, 65.0, 10.0, 54.0, 21.0, 54.0, -45.0, 32.0, -78.0, 32.0, -1.0, -12.0, 32.0, 21.0, -34.0, 21.0, -12.0, 32.0, 65.0, 21.0, -1.0, -29.0, -67.0, -23.0, 10.0, -34.0, 43.0, 32.0, 54.0, 54.0, 32.0, 65.0, 43.0, -67.0, 54.0, -56.0, -23.0, -45.0, -45.0, -56.0, 10.0, 32.0, -23.0, 10.0, 43.0, -1.0, -1.0, -23.0, -1.0, 43.0, 54.0, -1.0, 43.0, 43.0, 21.0, 43.0, 54.0, 65.0, 54.0, 76.0, 54.0, 43.0, 65.0, 21.0, 54.0, 10.0, -45.0, 10.0, -45.0, -34.0, -23.0, -12.0, 21.0, -12.0, 21.0, -45.0, 32.0, -12.0, 21.0, -1.0, 21.0, -12.0, -45.0, 21.0, -1.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24065877182110718, "mean_inference_ms": 24.5677940119987, "mean_action_processing_ms": 0.09031691595789292, "mean_env_wait_ms": 0.04226496683343971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057146549224853516, "StateBufferConnector_ms": 0.004726886749267578, "ViewRequirementAgentConnector_ms": 0.11380457878112793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 180012.383, "sample_time_ms": 99896.026, "learn_time_ms": 80104.892, "learn_throughput": 49.935, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 157, "training_iteration": 3, "trial_id": "38794_00007", "date": "2023-06-02_04-35-41", "timestamp": 1685669741, "time_this_iter_s": 198.93019914627075, "time_total_s": 596.4071719646454, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 596.4071719646454, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.684671532846718, "ram_util_percent": 56.67262773722627}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -67.0, "episode_reward_mean": -16.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, 10.0, -34.0, -23.0, 54.0, 32.0, -23.0, -12.0, -67.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2195109900813556, "mean_inference_ms": 24.26081823306976, "mean_action_processing_ms": 0.0873827220812631, "mean_env_wait_ms": 0.04183246445710704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005047321319580078, "StateBufferConnector_ms": 0.0055694580078125, "ViewRequirementAgentConnector_ms": 0.1155400276184082}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.654323577880859, "policy_loss": -0.024407152086496353, "vf_loss": 6.653822898864746, "vf_explained_var": -0.14849752187728882, "kl": 0.03690112382173538, "entropy": 2.8590192794799805, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3570.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 7.68, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 10.0, 32.0, -23.0, 10.0, 43.0, -1.0, -1.0, -23.0, -1.0, 43.0, 54.0, -1.0, 43.0, 43.0, 21.0, 43.0, 54.0, 65.0, 54.0, 76.0, 54.0, 43.0, 65.0, 21.0, 54.0, 10.0, -45.0, 10.0, -45.0, -34.0, -23.0, -12.0, 21.0, -12.0, 21.0, -45.0, 32.0, -12.0, 21.0, -1.0, 21.0, -12.0, -45.0, 21.0, -1.0, 21.0, 10.0, -34.0, -34.0, -23.0, -12.0, 32.0, 54.0, 54.0, 10.0, -1.0, 65.0, -34.0, -1.0, 4.0, -111.0, -1.0, -23.0, 65.0, -34.0, 10.0, 10.0, 21.0, -23.0, 21.0, 10.0, -67.0, -34.0, -1.0, -67.0, -1.0, 43.0, 21.0, 21.0, -34.0, 26.0, -12.0, 54.0, 43.0, -23.0, 10.0, -67.0, 21.0, 10.0, -23.0, 43.0, 21.0, -1.0, -12.0, 32.0, 32.0, 54.0, 43.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23914511247181858, "mean_inference_ms": 24.579810454040572, "mean_action_processing_ms": 0.08959495244013066, "mean_env_wait_ms": 0.04188131893548865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005792140960693359, "StateBufferConnector_ms": 0.004881858825683594, "ViewRequirementAgentConnector_ms": 0.11416935920715332}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 7.68, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, 10.0, 32.0, -23.0, 10.0, 43.0, -1.0, -1.0, -23.0, -1.0, 43.0, 54.0, -1.0, 43.0, 43.0, 21.0, 43.0, 54.0, 65.0, 54.0, 76.0, 54.0, 43.0, 65.0, 21.0, 54.0, 10.0, -45.0, 10.0, -45.0, -34.0, -23.0, -12.0, 21.0, -12.0, 21.0, -45.0, 32.0, -12.0, 21.0, -1.0, 21.0, -12.0, -45.0, 21.0, -1.0, 21.0, 10.0, -34.0, -34.0, -23.0, -12.0, 32.0, 54.0, 54.0, 10.0, -1.0, 65.0, -34.0, -1.0, 4.0, -111.0, -1.0, -23.0, 65.0, -34.0, 10.0, 10.0, 21.0, -23.0, 21.0, 10.0, -67.0, -34.0, -1.0, -67.0, -1.0, 43.0, 21.0, 21.0, -34.0, 26.0, -12.0, 54.0, 43.0, -23.0, 10.0, -67.0, 21.0, 10.0, -23.0, 43.0, 21.0, -1.0, -12.0, 32.0, 32.0, 54.0, 43.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23914511247181858, "mean_inference_ms": 24.579810454040572, "mean_action_processing_ms": 0.08959495244013066, "mean_env_wait_ms": 0.04188131893548865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005792140960693359, "StateBufferConnector_ms": 0.004881858825683594, "ViewRequirementAgentConnector_ms": 0.11416935920715332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 179967.23, "sample_time_ms": 99819.62, "learn_time_ms": 80131.317, "learn_throughput": 49.918, "synch_weights_time_ms": 10.237}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 210, "training_iteration": 4, "trial_id": "38794_00007", "date": "2023-06-02_04-38-59", "timestamp": 1685669939, "time_this_iter_s": 198.54115676879883, "time_total_s": 794.9483287334442, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 794.9483287334442, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.526373626373626, "ram_util_percent": 56.9018315018315}}
{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -144.0, "episode_reward_mean": -34.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -12.0, -144.0, -45.0, -78.0, 21.0, 10.0, -34.0, 10.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21990366089943053, "mean_inference_ms": 24.208846452266915, "mean_action_processing_ms": 0.08742227832821285, "mean_env_wait_ms": 0.041712650779798396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005056858062744141, "StateBufferConnector_ms": 0.005304813385009766, "ViewRequirementAgentConnector_ms": 0.11291265487670898}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0125000476837158, "cur_lr": 9.999999747378752e-05, "total_loss": 5.922115325927734, "policy_loss": -0.02107001654803753, "vf_loss": 5.90238618850708, "vf_explained_var": -0.06329265236854553, "kl": 0.04029521346092224, "entropy": 2.847700834274292, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4590.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 8.89, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 10.0, -1.0, 65.0, -34.0, -1.0, 4.0, -111.0, -1.0, -23.0, 65.0, -34.0, 10.0, 10.0, 21.0, -23.0, 21.0, 10.0, -67.0, -34.0, -1.0, -67.0, -1.0, 43.0, 21.0, 21.0, -34.0, 26.0, -12.0, 54.0, 43.0, -23.0, 10.0, -67.0, 21.0, 10.0, -23.0, 43.0, 21.0, -1.0, -12.0, 32.0, 32.0, 54.0, 43.0, -12.0, 10.0, 10.0, 21.0, -100.0, -1.0, 10.0, 32.0, 10.0, -12.0, 10.0, -12.0, 43.0, 21.0, -23.0, 10.0, 21.0, -1.0, -56.0, -12.0, 21.0, 10.0, 21.0, 21.0, 54.0, 32.0, -1.0, 43.0, 21.0, 43.0, 76.0, 43.0, -1.0, -78.0, 43.0, -56.0, 10.0, -23.0, -12.0, 21.0, 32.0, 65.0, 54.0, 54.0, 32.0, 54.0, 32.0, 43.0, -23.0, 10.0, 21.0, 10.0, 10.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23834995005173043, "mean_inference_ms": 24.566288765659657, "mean_action_processing_ms": 0.08913560521872327, "mean_env_wait_ms": 0.041685284687699525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057833194732666016, "StateBufferConnector_ms": 0.005013704299926758, "ViewRequirementAgentConnector_ms": 0.11454510688781738}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 8.89, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 10.0, -1.0, 65.0, -34.0, -1.0, 4.0, -111.0, -1.0, -23.0, 65.0, -34.0, 10.0, 10.0, 21.0, -23.0, 21.0, 10.0, -67.0, -34.0, -1.0, -67.0, -1.0, 43.0, 21.0, 21.0, -34.0, 26.0, -12.0, 54.0, 43.0, -23.0, 10.0, -67.0, 21.0, 10.0, -23.0, 43.0, 21.0, -1.0, -12.0, 32.0, 32.0, 54.0, 43.0, -12.0, 10.0, 10.0, 21.0, -100.0, -1.0, 10.0, 32.0, 10.0, -12.0, 10.0, -12.0, 43.0, 21.0, -23.0, 10.0, 21.0, -1.0, -56.0, -12.0, 21.0, 10.0, 21.0, 21.0, 54.0, 32.0, -1.0, 43.0, 21.0, 43.0, 76.0, 43.0, -1.0, -78.0, 43.0, -56.0, 10.0, -23.0, -12.0, 21.0, 32.0, 65.0, 54.0, 54.0, 32.0, 54.0, 32.0, 43.0, -23.0, 10.0, 21.0, 10.0, 10.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23834995005173043, "mean_inference_ms": 24.566288765659657, "mean_action_processing_ms": 0.08913560521872327, "mean_env_wait_ms": 0.041685284687699525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057833194732666016, "StateBufferConnector_ms": 0.005013704299926758, "ViewRequirementAgentConnector_ms": 0.11454510688781738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 179908.62, "sample_time_ms": 99770.534, "learn_time_ms": 80122.293, "learn_throughput": 49.924, "synch_weights_time_ms": 10.675}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 263, "training_iteration": 5, "trial_id": "38794_00007", "date": "2023-06-02_04-42-18", "timestamp": 1685670138, "time_this_iter_s": 198.238694190979, "time_total_s": 993.1870229244232, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 993.1870229244232, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 26.922344322344326, "ram_util_percent": 57.005494505494504}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -155.0, "episode_reward_mean": -49.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -12.0, -12.0, -155.0, -34.0, 32.0, -23.0, -100.0, -144.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21937901815336228, "mean_inference_ms": 24.224133795746788, "mean_action_processing_ms": 0.0871244529652193, "mean_env_wait_ms": 0.04142487527403594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004711151123046875, "StateBufferConnector_ms": 0.005419254302978516, "ViewRequirementAgentConnector_ms": 0.1125478744506836}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5187499523162842, "cur_lr": 9.999999747378752e-05, "total_loss": 5.806393623352051, "policy_loss": -0.02956286445260048, "vf_loss": 5.779962062835693, "vf_explained_var": -0.07620313763618469, "kl": 0.03686867654323578, "entropy": 2.802340507507324, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5610.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 12.14, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 10.0, -12.0, 10.0, -12.0, 43.0, 21.0, -23.0, 10.0, 21.0, -1.0, -56.0, -12.0, 21.0, 10.0, 21.0, 21.0, 54.0, 32.0, -1.0, 43.0, 21.0, 43.0, 76.0, 43.0, -1.0, -78.0, 43.0, -56.0, 10.0, -23.0, -12.0, 21.0, 32.0, 65.0, 54.0, 54.0, 32.0, 54.0, 32.0, 43.0, -23.0, 10.0, 21.0, 10.0, 10.0, 10.0, 54.0, 65.0, 54.0, 54.0, 32.0, 65.0, 65.0, 15.0, 32.0, -12.0, -12.0, 43.0, 54.0, 43.0, 65.0, -12.0, -56.0, -1.0, 54.0, -1.0, 32.0, 76.0, 10.0, 43.0, -45.0, -45.0, -78.0, -12.0, -34.0, -34.0, 32.0, -100.0, -34.0, 65.0, 10.0, 32.0, 32.0, 43.0, -56.0, -78.0, -67.0, 10.0, 10.0, -1.0, 10.0, -34.0, 10.0, 21.0, 21.0, 54.0, -56.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23792633897185003, "mean_inference_ms": 24.55627408593469, "mean_action_processing_ms": 0.08885175099597667, "mean_env_wait_ms": 0.041586853325953584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005817890167236328, "StateBufferConnector_ms": 0.005129098892211914, "ViewRequirementAgentConnector_ms": 0.11574602127075195}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 12.14, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 10.0, -12.0, 10.0, -12.0, 43.0, 21.0, -23.0, 10.0, 21.0, -1.0, -56.0, -12.0, 21.0, 10.0, 21.0, 21.0, 54.0, 32.0, -1.0, 43.0, 21.0, 43.0, 76.0, 43.0, -1.0, -78.0, 43.0, -56.0, 10.0, -23.0, -12.0, 21.0, 32.0, 65.0, 54.0, 54.0, 32.0, 54.0, 32.0, 43.0, -23.0, 10.0, 21.0, 10.0, 10.0, 10.0, 54.0, 65.0, 54.0, 54.0, 32.0, 65.0, 65.0, 15.0, 32.0, -12.0, -12.0, 43.0, 54.0, 43.0, 65.0, -12.0, -56.0, -1.0, 54.0, -1.0, 32.0, 76.0, 10.0, 43.0, -45.0, -45.0, -78.0, -12.0, -34.0, -34.0, 32.0, -100.0, -34.0, 65.0, 10.0, 32.0, 32.0, 43.0, -56.0, -78.0, -67.0, 10.0, 10.0, -1.0, 10.0, -34.0, 10.0, 21.0, 21.0, 54.0, -56.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23792633897185003, "mean_inference_ms": 24.55627408593469, "mean_action_processing_ms": 0.08885175099597667, "mean_env_wait_ms": 0.041586853325953584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005817890167236328, "StateBufferConnector_ms": 0.005129098892211914, "ViewRequirementAgentConnector_ms": 0.11574602127075195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 179956.067, "sample_time_ms": 99729.339, "learn_time_ms": 80211.689, "learn_throughput": 49.868, "synch_weights_time_ms": 10.596}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 315, "training_iteration": 6, "trial_id": "38794_00007", "date": "2023-06-02_04-45-37", "timestamp": 1685670337, "time_this_iter_s": 198.9799039363861, "time_total_s": 1192.1669268608093, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1192.1669268608093, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.87773722627737, "ram_util_percent": 57.19306569343065}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -133.0, "episode_reward_mean": -39.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -133.0, -78.0, 21.0, -34.0, -45.0, -100.0, -45.0, 21.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192592423698369, "mean_inference_ms": 24.2312135070904, "mean_action_processing_ms": 0.0869302099034697, "mean_env_wait_ms": 0.041246190149070314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005168914794921875, "StateBufferConnector_ms": 0.00522613525390625, "ViewRequirementAgentConnector_ms": 0.11391401290893555}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 9.999999747378752e-05, "total_loss": 5.5631818771362305, "policy_loss": -0.010812796652317047, "vf_loss": 5.499690532684326, "vf_explained_var": -0.06907553225755692, "kl": 0.03261621668934822, "entropy": 2.803373336791992, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6630.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 12.03, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 15.0, 32.0, -12.0, -12.0, 43.0, 54.0, 43.0, 65.0, -12.0, -56.0, -1.0, 54.0, -1.0, 32.0, 76.0, 10.0, 43.0, -45.0, -45.0, -78.0, -12.0, -34.0, -34.0, 32.0, -100.0, -34.0, 65.0, 10.0, 32.0, 32.0, 43.0, -56.0, -78.0, -67.0, 10.0, 10.0, -1.0, 10.0, -34.0, 10.0, 21.0, 21.0, 54.0, -56.0, 43.0, 32.0, 21.0, 10.0, 65.0, 32.0, -12.0, 10.0, -89.0, -100.0, -1.0, -34.0, -12.0, 21.0, 32.0, 54.0, -78.0, 43.0, -34.0, 65.0, 65.0, -23.0, 10.0, 32.0, -23.0, 10.0, -1.0, 43.0, 10.0, 10.0, 21.0, 65.0, 65.0, 32.0, 32.0, 32.0, 65.0, 21.0, -12.0, -1.0, 32.0, 32.0, 65.0, -1.0, 54.0, 65.0, 43.0, 65.0, 10.0, 54.0, 21.0, -1.0, 10.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23760828075597104, "mean_inference_ms": 24.539946513230625, "mean_action_processing_ms": 0.08868510782038147, "mean_env_wait_ms": 0.04152233281833714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059185028076171875, "StateBufferConnector_ms": 0.00518488883972168, "ViewRequirementAgentConnector_ms": 0.11620616912841797}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 12.03, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 15.0, 32.0, -12.0, -12.0, 43.0, 54.0, 43.0, 65.0, -12.0, -56.0, -1.0, 54.0, -1.0, 32.0, 76.0, 10.0, 43.0, -45.0, -45.0, -78.0, -12.0, -34.0, -34.0, 32.0, -100.0, -34.0, 65.0, 10.0, 32.0, 32.0, 43.0, -56.0, -78.0, -67.0, 10.0, 10.0, -1.0, 10.0, -34.0, 10.0, 21.0, 21.0, 54.0, -56.0, 43.0, 32.0, 21.0, 10.0, 65.0, 32.0, -12.0, 10.0, -89.0, -100.0, -1.0, -34.0, -12.0, 21.0, 32.0, 54.0, -78.0, 43.0, -34.0, 65.0, 65.0, -23.0, 10.0, 32.0, -23.0, 10.0, -1.0, 43.0, 10.0, 10.0, 21.0, 65.0, 65.0, 32.0, 32.0, 32.0, 65.0, 21.0, -12.0, -1.0, 32.0, 32.0, 65.0, -1.0, 54.0, 65.0, 43.0, 65.0, 10.0, 54.0, 21.0, -1.0, 10.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23760828075597104, "mean_inference_ms": 24.539946513230625, "mean_action_processing_ms": 0.08868510782038147, "mean_env_wait_ms": 0.04152233281833714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059185028076171875, "StateBufferConnector_ms": 0.00518488883972168, "ViewRequirementAgentConnector_ms": 0.11620616912841797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 179807.544, "sample_time_ms": 99637.687, "learn_time_ms": 80155.321, "learn_throughput": 49.903, "synch_weights_time_ms": 10.57}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 368, "training_iteration": 7, "trial_id": "38794_00007", "date": "2023-06-02_04-48-54", "timestamp": 1685670534, "time_this_iter_s": 197.68406510353088, "time_total_s": 1389.8509919643402, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1389.8509919643402, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.329411764705885, "ram_util_percent": 57.356617647058826}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -45.0, "episode_reward_mean": 3.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -45.0, -1.0, 32.0, -34.0, 10.0, 43.0, -1.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21900720569652626, "mean_inference_ms": 24.280483168689965, "mean_action_processing_ms": 0.08680247648866765, "mean_env_wait_ms": 0.041129772962266886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005133152008056641, "StateBufferConnector_ms": 0.005648136138916016, "ViewRequirementAgentConnector_ms": 0.1166534423828125}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 9.999999747378752e-05, "total_loss": 5.703317165374756, "policy_loss": -0.0072790090925991535, "vf_loss": 5.62976598739624, "vf_explained_var": -0.056763384491205215, "kl": 0.023653842508792877, "entropy": 2.8536038398742676, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7650.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": 11.92, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -89.0, -100.0, -1.0, -34.0, -12.0, 21.0, 32.0, 54.0, -78.0, 43.0, -34.0, 65.0, 65.0, -23.0, 10.0, 32.0, -23.0, 10.0, -1.0, 43.0, 10.0, 10.0, 21.0, 65.0, 65.0, 32.0, 32.0, 32.0, 65.0, 21.0, -12.0, -1.0, 32.0, 32.0, 65.0, -1.0, 54.0, 65.0, 43.0, 65.0, 10.0, 54.0, 21.0, -1.0, 10.0, 54.0, 10.0, 54.0, -89.0, -122.0, -45.0, 10.0, 10.0, 65.0, 65.0, 10.0, 21.0, 54.0, 65.0, -1.0, -67.0, -34.0, 21.0, 10.0, -1.0, 43.0, 43.0, 59.0, 65.0, 43.0, 32.0, 21.0, 65.0, 65.0, 32.0, -23.0, 65.0, 32.0, -78.0, -67.0, 43.0, -34.0, 10.0, 10.0, 43.0, 10.0, -34.0, 32.0, -56.0, -1.0, 21.0, -1.0, 10.0, -67.0, -67.0, -67.0, 43.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23738240751439285, "mean_inference_ms": 24.528249171177514, "mean_action_processing_ms": 0.08860304185172563, "mean_env_wait_ms": 0.04146279705838678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917787551879883, "StateBufferConnector_ms": 0.00519251823425293, "ViewRequirementAgentConnector_ms": 0.11643338203430176}}, "episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": 11.92, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -89.0, -100.0, -1.0, -34.0, -12.0, 21.0, 32.0, 54.0, -78.0, 43.0, -34.0, 65.0, 65.0, -23.0, 10.0, 32.0, -23.0, 10.0, -1.0, 43.0, 10.0, 10.0, 21.0, 65.0, 65.0, 32.0, 32.0, 32.0, 65.0, 21.0, -12.0, -1.0, 32.0, 32.0, 65.0, -1.0, 54.0, 65.0, 43.0, 65.0, 10.0, 54.0, 21.0, -1.0, 10.0, 54.0, 10.0, 54.0, -89.0, -122.0, -45.0, 10.0, 10.0, 65.0, 65.0, 10.0, 21.0, 54.0, 65.0, -1.0, -67.0, -34.0, 21.0, 10.0, -1.0, 43.0, 43.0, 59.0, 65.0, 43.0, 32.0, 21.0, 65.0, 65.0, 32.0, -23.0, 65.0, 32.0, -78.0, -67.0, 43.0, -34.0, 10.0, 10.0, 43.0, 10.0, -34.0, 32.0, -56.0, -1.0, 21.0, -1.0, 10.0, -67.0, -67.0, -67.0, 43.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23738240751439285, "mean_inference_ms": 24.528249171177514, "mean_action_processing_ms": 0.08860304185172563, "mean_env_wait_ms": 0.04146279705838678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917787551879883, "StateBufferConnector_ms": 0.00519251823425293, "ViewRequirementAgentConnector_ms": 0.11643338203430176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 179809.295, "sample_time_ms": 99626.807, "learn_time_ms": 80168.329, "learn_throughput": 49.895, "synch_weights_time_ms": 10.52}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 421, "training_iteration": 8, "trial_id": "38794_00007", "date": "2023-06-02_04-52-13", "timestamp": 1685670733, "time_this_iter_s": 198.854238986969, "time_total_s": 1588.7052309513092, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1588.7052309513092, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.583882783882785, "ram_util_percent": 57.44139194139194}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 12.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -1.0, 10.0, 21.0, 54.0, 21.0, 43.0, 21.0, -45.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21896001940982207, "mean_inference_ms": 24.293244782464402, "mean_action_processing_ms": 0.08668332852008241, "mean_env_wait_ms": 0.04107247073649314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047206878662109375, "StateBufferConnector_ms": 0.005428791046142578, "ViewRequirementAgentConnector_ms": 0.11461019515991211}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 9.999999747378752e-05, "total_loss": 6.941038131713867, "policy_loss": -0.004487928468734026, "vf_loss": 6.851923942565918, "vf_explained_var": -0.22655296325683594, "kl": 0.01826106570661068, "entropy": 2.850600481033325, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8685.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": -1.78, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 65.0, 65.0, 10.0, 21.0, 54.0, 65.0, -1.0, -67.0, -34.0, 21.0, 10.0, -1.0, 43.0, 43.0, 59.0, 65.0, 43.0, 32.0, 21.0, 65.0, 65.0, 32.0, -23.0, 65.0, 32.0, -78.0, -67.0, 43.0, -34.0, 10.0, 10.0, 43.0, 10.0, -34.0, 32.0, -56.0, -1.0, 21.0, -1.0, 10.0, -67.0, -67.0, -67.0, 43.0, 10.0, 21.0, -1.0, -45.0, 10.0, -23.0, -23.0, -1.0, -12.0, 10.0, 21.0, 10.0, 65.0, -1.0, -1.0, -45.0, -34.0, -45.0, -56.0, -23.0, -34.0, -45.0, -89.0, -45.0, -100.0, -56.0, -67.0, -34.0, 21.0, 10.0, -12.0, -122.0, -67.0, 32.0, 43.0, -23.0, -12.0, -12.0, 15.0, 21.0, 43.0, -12.0, 32.0, -12.0, -45.0, -56.0, 10.0, 10.0, 10.0, -34.0, -12.0, 21.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23732352714109933, "mean_inference_ms": 24.521751601958773, "mean_action_processing_ms": 0.08856947556391553, "mean_env_wait_ms": 0.04143332513160287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058405399322509766, "StateBufferConnector_ms": 0.00510096549987793, "ViewRequirementAgentConnector_ms": 0.11626172065734863}}, "episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": -1.78, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 65.0, 65.0, 10.0, 21.0, 54.0, 65.0, -1.0, -67.0, -34.0, 21.0, 10.0, -1.0, 43.0, 43.0, 59.0, 65.0, 43.0, 32.0, 21.0, 65.0, 65.0, 32.0, -23.0, 65.0, 32.0, -78.0, -67.0, 43.0, -34.0, 10.0, 10.0, 43.0, 10.0, -34.0, 32.0, -56.0, -1.0, 21.0, -1.0, 10.0, -67.0, -67.0, -67.0, 43.0, 10.0, 21.0, -1.0, -45.0, 10.0, -23.0, -23.0, -1.0, -12.0, 10.0, 21.0, 10.0, 65.0, -1.0, -1.0, -45.0, -34.0, -45.0, -56.0, -23.0, -34.0, -45.0, -89.0, -45.0, -100.0, -56.0, -67.0, -34.0, 21.0, 10.0, -12.0, -122.0, -67.0, 32.0, 43.0, -23.0, -12.0, -12.0, 15.0, 21.0, 43.0, -12.0, 32.0, -12.0, -45.0, -56.0, 10.0, 10.0, 10.0, -34.0, -12.0, 21.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23732352714109933, "mean_inference_ms": 24.521751601958773, "mean_action_processing_ms": 0.08856947556391553, "mean_env_wait_ms": 0.04143332513160287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058405399322509766, "StateBufferConnector_ms": 0.00510096549987793, "ViewRequirementAgentConnector_ms": 0.11626172065734863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 180078.885, "sample_time_ms": 99584.918, "learn_time_ms": 80480.092, "learn_throughput": 49.702, "synch_weights_time_ms": 10.559}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 473, "training_iteration": 9, "trial_id": "38794_00007", "date": "2023-06-02_04-55-34", "timestamp": 1685670934, "time_this_iter_s": 201.09531092643738, "time_total_s": 1789.8005418777466, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1789.8005418777466, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.779710144927538, "ram_util_percent": 57.89891304347826}}
{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -78.0, "episode_reward_mean": -12.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -78.0, 10.0, 10.0, 21.0, 10.0, -34.0, -1.0, 10.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21890125342410358, "mean_inference_ms": 24.285215685954455, "mean_action_processing_ms": 0.08658562313803024, "mean_env_wait_ms": 0.041017625194178675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051021575927734375, "StateBufferConnector_ms": 0.005688667297363281, "ViewRequirementAgentConnector_ms": 0.11668920516967773}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 9.999999747378752e-05, "total_loss": 6.025554656982422, "policy_loss": -0.03171225264668465, "vf_loss": 5.956806659698486, "vf_explained_var": -0.136588916182518, "kl": 0.01959906332194805, "entropy": 2.8098690509796143, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9720.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -4.31, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -12.0, 10.0, 21.0, 10.0, 65.0, -1.0, -1.0, -45.0, -34.0, -45.0, -56.0, -23.0, -34.0, -45.0, -89.0, -45.0, -100.0, -56.0, -67.0, -34.0, 21.0, 10.0, -12.0, -122.0, -67.0, 32.0, 43.0, -23.0, -12.0, -12.0, 15.0, 21.0, 43.0, -12.0, 32.0, -12.0, -45.0, -56.0, 10.0, 10.0, 10.0, -34.0, -12.0, 21.0, 65.0, 21.0, -1.0, 43.0, 10.0, 65.0, 32.0, 32.0, 32.0, 43.0, 10.0, -45.0, -56.0, -45.0, 21.0, -23.0, -1.0, 21.0, 65.0, -45.0, -111.0, -23.0, -56.0, -1.0, -56.0, -23.0, 10.0, 10.0, -67.0, 32.0, 43.0, -34.0, -45.0, -23.0, -12.0, -45.0, -1.0, 65.0, 76.0, 54.0, 21.0, 65.0, 54.0, 76.0, 54.0, 21.0, -23.0, -45.0, -45.0, -34.0, -40.0, 32.0, 43.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23722126039634608, "mean_inference_ms": 24.51683367924024, "mean_action_processing_ms": 0.08853288984989127, "mean_env_wait_ms": 0.04140710150081341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057604312896728516, "StateBufferConnector_ms": 0.004905223846435547, "ViewRequirementAgentConnector_ms": 0.11473894119262695}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -4.31, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -12.0, 10.0, 21.0, 10.0, 65.0, -1.0, -1.0, -45.0, -34.0, -45.0, -56.0, -23.0, -34.0, -45.0, -89.0, -45.0, -100.0, -56.0, -67.0, -34.0, 21.0, 10.0, -12.0, -122.0, -67.0, 32.0, 43.0, -23.0, -12.0, -12.0, 15.0, 21.0, 43.0, -12.0, 32.0, -12.0, -45.0, -56.0, 10.0, 10.0, 10.0, -34.0, -12.0, 21.0, 65.0, 21.0, -1.0, 43.0, 10.0, 65.0, 32.0, 32.0, 32.0, 43.0, 10.0, -45.0, -56.0, -45.0, 21.0, -23.0, -1.0, 21.0, 65.0, -45.0, -111.0, -23.0, -56.0, -1.0, -56.0, -23.0, 10.0, 10.0, -67.0, 32.0, 43.0, -34.0, -45.0, -23.0, -12.0, -45.0, -1.0, 65.0, 76.0, 54.0, 21.0, 65.0, 54.0, 76.0, 54.0, 21.0, -23.0, -45.0, -45.0, -34.0, -40.0, 32.0, 43.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23722126039634608, "mean_inference_ms": 24.51683367924024, "mean_action_processing_ms": 0.08853288984989127, "mean_env_wait_ms": 0.04140710150081341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057604312896728516, "StateBufferConnector_ms": 0.004905223846435547, "ViewRequirementAgentConnector_ms": 0.11473894119262695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 180076.339, "sample_time_ms": 99583.762, "learn_time_ms": 80479.029, "learn_throughput": 49.702, "synch_weights_time_ms": 10.488}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 526, "training_iteration": 10, "trial_id": "38794_00007", "date": "2023-06-02_04-58-53", "timestamp": 1685671133, "time_this_iter_s": 198.77400398254395, "time_total_s": 1988.5745458602905, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1988.5745458602905, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.158241758241758, "ram_util_percent": 58.054212454212454}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -45.0, "episode_reward_mean": -2.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -34.0, -1.0, 32.0, 10.0, -34.0, 21.0, -45.0, -12.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21905169619882012, "mean_inference_ms": 24.271311906518697, "mean_action_processing_ms": 0.0866021198628123, "mean_env_wait_ms": 0.04100272022726832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004811286926269531, "StateBufferConnector_ms": 0.005829334259033203, "ViewRequirementAgentConnector_ms": 0.11581659317016602}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 9.999999747378752e-05, "total_loss": 6.507230281829834, "policy_loss": -0.030821368098258972, "vf_loss": 6.442262172698975, "vf_explained_var": -0.08781690150499344, "kl": 0.018687868490815163, "entropy": 2.8196258544921875, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10740.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": -4.91, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 32.0, 43.0, 10.0, -45.0, -56.0, -45.0, 21.0, -23.0, -1.0, 21.0, 65.0, -45.0, -111.0, -23.0, -56.0, -1.0, -56.0, -23.0, 10.0, 10.0, -67.0, 32.0, 43.0, -34.0, -45.0, -23.0, -12.0, -45.0, -1.0, 65.0, 76.0, 54.0, 21.0, 65.0, 54.0, 76.0, 54.0, 21.0, -23.0, -45.0, -45.0, -34.0, -40.0, 32.0, 43.0, 54.0, 32.0, 32.0, 21.0, -34.0, 10.0, -56.0, 10.0, -1.0, -45.0, -78.0, -188.0, -23.0, 32.0, 21.0, -12.0, 10.0, -111.0, -23.0, -34.0, 10.0, 10.0, 54.0, -1.0, -45.0, 54.0, 32.0, -45.0, 21.0, 32.0, -1.0, -12.0, -12.0, 32.0, 21.0, -34.0, -12.0, -45.0, -1.0, -78.0, -78.0, 21.0, -1.0, 10.0, -34.0, -23.0, -78.0, -67.0, 43.0, 65.0, 54.0, -12.0, -1.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23704698114782172, "mean_inference_ms": 24.516306795153127, "mean_action_processing_ms": 0.0884637560532612, "mean_env_wait_ms": 0.041369189439610814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005791664123535156, "StateBufferConnector_ms": 0.004900455474853516, "ViewRequirementAgentConnector_ms": 0.11492538452148438}}, "episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": -4.91, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 32.0, 43.0, 10.0, -45.0, -56.0, -45.0, 21.0, -23.0, -1.0, 21.0, 65.0, -45.0, -111.0, -23.0, -56.0, -1.0, -56.0, -23.0, 10.0, 10.0, -67.0, 32.0, 43.0, -34.0, -45.0, -23.0, -12.0, -45.0, -1.0, 65.0, 76.0, 54.0, 21.0, 65.0, 54.0, 76.0, 54.0, 21.0, -23.0, -45.0, -45.0, -34.0, -40.0, 32.0, 43.0, 54.0, 32.0, 32.0, 21.0, -34.0, 10.0, -56.0, 10.0, -1.0, -45.0, -78.0, -188.0, -23.0, 32.0, 21.0, -12.0, 10.0, -111.0, -23.0, -34.0, 10.0, 10.0, 54.0, -1.0, -45.0, 54.0, 32.0, -45.0, 21.0, 32.0, -1.0, -12.0, -12.0, 32.0, 21.0, -34.0, -12.0, -45.0, -1.0, -78.0, -78.0, 21.0, -1.0, 10.0, -34.0, -23.0, -78.0, -67.0, 43.0, 65.0, 54.0, -12.0, -1.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23704698114782172, "mean_inference_ms": 24.516306795153127, "mean_action_processing_ms": 0.0884637560532612, "mean_env_wait_ms": 0.041369189439610814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005791664123535156, "StateBufferConnector_ms": 0.004900455474853516, "ViewRequirementAgentConnector_ms": 0.11492538452148438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 180135.624, "sample_time_ms": 99578.193, "learn_time_ms": 80544.044, "learn_throughput": 49.662, "synch_weights_time_ms": 10.473}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 578, "training_iteration": 11, "trial_id": "38794_00007", "date": "2023-06-02_05-02-12", "timestamp": 1685671332, "time_this_iter_s": 198.9852910041809, "time_total_s": 2187.5598368644714, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2187.5598368644714, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 27.33369963369963, "ram_util_percent": 58.27216117216117}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 4.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -1.0, 54.0, -1.0, -12.0, 10.0, 10.0, -12.0, -45.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21902043991164147, "mean_inference_ms": 24.268007581660836, "mean_action_processing_ms": 0.08649178312452407, "mean_env_wait_ms": 0.0409262573205383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005054473876953125, "StateBufferConnector_ms": 0.005366802215576172, "ViewRequirementAgentConnector_ms": 0.1122736930847168}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 9.999999747378752e-05, "total_loss": 5.684458255767822, "policy_loss": 0.006631593685597181, "vf_loss": 5.558990001678467, "vf_explained_var": -0.152427539229393, "kl": 0.02318415604531765, "entropy": 2.8249549865722656, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11760.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": -188.0, "episode_reward_mean": 2.57, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -1.0, -45.0, -78.0, -188.0, -23.0, 32.0, 21.0, -12.0, 10.0, -111.0, -23.0, -34.0, 10.0, 10.0, 54.0, -1.0, -45.0, 54.0, 32.0, -45.0, 21.0, 32.0, -1.0, -12.0, -12.0, 32.0, 21.0, -34.0, -12.0, -45.0, -1.0, -78.0, -78.0, 21.0, -1.0, 10.0, -34.0, -23.0, -78.0, -67.0, 43.0, 65.0, 54.0, -12.0, -1.0, 32.0, -89.0, 65.0, 65.0, 65.0, -1.0, 10.0, 10.0, -34.0, 65.0, 54.0, 43.0, 21.0, 10.0, 10.0, 10.0, 32.0, 54.0, 54.0, 54.0, 54.0, 21.0, -1.0, 32.0, 32.0, -7.0, 10.0, 43.0, 32.0, 21.0, 54.0, 32.0, 21.0, 54.0, -1.0, -23.0, 10.0, 54.0, 43.0, -67.0, -100.0, -89.0, -56.0, -23.0, -23.0, 43.0, -12.0, 43.0, -1.0, 10.0, -1.0, 21.0, 32.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23689119948284698, "mean_inference_ms": 24.519971036287625, "mean_action_processing_ms": 0.08839828480710377, "mean_env_wait_ms": 0.041340057759672415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005820274353027344, "StateBufferConnector_ms": 0.004908084869384766, "ViewRequirementAgentConnector_ms": 0.11515998840332031}}, "episode_reward_max": 65.0, "episode_reward_min": -188.0, "episode_reward_mean": 2.57, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -1.0, -45.0, -78.0, -188.0, -23.0, 32.0, 21.0, -12.0, 10.0, -111.0, -23.0, -34.0, 10.0, 10.0, 54.0, -1.0, -45.0, 54.0, 32.0, -45.0, 21.0, 32.0, -1.0, -12.0, -12.0, 32.0, 21.0, -34.0, -12.0, -45.0, -1.0, -78.0, -78.0, 21.0, -1.0, 10.0, -34.0, -23.0, -78.0, -67.0, 43.0, 65.0, 54.0, -12.0, -1.0, 32.0, -89.0, 65.0, 65.0, 65.0, -1.0, 10.0, 10.0, -34.0, 65.0, 54.0, 43.0, 21.0, 10.0, 10.0, 10.0, 32.0, 54.0, 54.0, 54.0, 54.0, 21.0, -1.0, 32.0, 32.0, -7.0, 10.0, 43.0, 32.0, 21.0, 54.0, 32.0, 21.0, 54.0, -1.0, -23.0, 10.0, 54.0, 43.0, -67.0, -100.0, -89.0, -56.0, -23.0, -23.0, 43.0, -12.0, 43.0, -1.0, 10.0, -1.0, 21.0, 32.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23689119948284698, "mean_inference_ms": 24.519971036287625, "mean_action_processing_ms": 0.08839828480710377, "mean_env_wait_ms": 0.041340057759672415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005820274353027344, "StateBufferConnector_ms": 0.004908084869384766, "ViewRequirementAgentConnector_ms": 0.11515998840332031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 180262.072, "sample_time_ms": 99581.973, "learn_time_ms": 80666.069, "learn_throughput": 49.587, "synch_weights_time_ms": 11.077}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 631, "training_iteration": 12, "trial_id": "38794_00007", "date": "2023-06-02_05-05-32", "timestamp": 1685671532, "time_this_iter_s": 200.027357339859, "time_total_s": 2387.5871942043304, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2387.5871942043304, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.566788321167884, "ram_util_percent": 58.316423357664235}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 1.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 54.0, -1.0, -23.0, -45.0, -45.0, -23.0, 54.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21905112925262035, "mean_inference_ms": 24.263144601104397, "mean_action_processing_ms": 0.08647073414291692, "mean_env_wait_ms": 0.04088324871204146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005214214324951172, "StateBufferConnector_ms": 0.005509853363037109, "ViewRequirementAgentConnector_ms": 0.11609315872192383}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.276310920715332, "policy_loss": -0.017908606678247452, "vf_loss": 6.169939994812012, "vf_explained_var": -0.20342428982257843, "kl": 0.016163911670446396, "entropy": 2.805306911468506, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12780.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 8.95, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -34.0, 65.0, 54.0, 43.0, 21.0, 10.0, 10.0, 10.0, 32.0, 54.0, 54.0, 54.0, 54.0, 21.0, -1.0, 32.0, 32.0, -7.0, 10.0, 43.0, 32.0, 21.0, 54.0, 32.0, 21.0, 54.0, -1.0, -23.0, 10.0, 54.0, 43.0, -67.0, -100.0, -89.0, -56.0, -23.0, -23.0, 43.0, -12.0, 43.0, -1.0, 10.0, -1.0, 21.0, 32.0, 32.0, 10.0, -12.0, -34.0, 21.0, -12.0, -89.0, -23.0, -23.0, 32.0, 21.0, -1.0, -12.0, 10.0, -34.0, 10.0, 65.0, 43.0, -23.0, -23.0, -56.0, -23.0, -34.0, 76.0, 54.0, 32.0, -1.0, 32.0, 10.0, 54.0, -45.0, 54.0, 32.0, 21.0, 65.0, 54.0, -23.0, 10.0, 10.0, -12.0, -23.0, -78.0, -34.0, -23.0, -12.0, -12.0, 21.0, -12.0, 10.0, 54.0, 65.0, 10.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680983628582497, "mean_inference_ms": 24.523008731480214, "mean_action_processing_ms": 0.08835530372484822, "mean_env_wait_ms": 0.04131841200419954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005819559097290039, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.11586642265319824}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 8.95, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -34.0, 65.0, 54.0, 43.0, 21.0, 10.0, 10.0, 10.0, 32.0, 54.0, 54.0, 54.0, 54.0, 21.0, -1.0, 32.0, 32.0, -7.0, 10.0, 43.0, 32.0, 21.0, 54.0, 32.0, 21.0, 54.0, -1.0, -23.0, 10.0, 54.0, 43.0, -67.0, -100.0, -89.0, -56.0, -23.0, -23.0, 43.0, -12.0, 43.0, -1.0, 10.0, -1.0, 21.0, 32.0, 32.0, 10.0, -12.0, -34.0, 21.0, -12.0, -89.0, -23.0, -23.0, 32.0, 21.0, -1.0, -12.0, 10.0, -34.0, 10.0, 65.0, 43.0, -23.0, -23.0, -56.0, -23.0, -34.0, 76.0, 54.0, 32.0, -1.0, 32.0, 10.0, 54.0, -45.0, 54.0, 32.0, 21.0, 65.0, 54.0, -23.0, 10.0, 10.0, -12.0, -23.0, -78.0, -34.0, -23.0, -12.0, -12.0, 21.0, -12.0, 10.0, 54.0, 65.0, 10.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680983628582497, "mean_inference_ms": 24.523008731480214, "mean_action_processing_ms": 0.08835530372484822, "mean_env_wait_ms": 0.04131841200419954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005819559097290039, "StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.11586642265319824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 180280.232, "sample_time_ms": 99514.874, "learn_time_ms": 80751.313, "learn_throughput": 49.535, "synch_weights_time_ms": 11.115}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 684, "training_iteration": 13, "trial_id": "38794_00007", "date": "2023-06-02_05-08-51", "timestamp": 1685671731, "time_this_iter_s": 199.1838676929474, "time_total_s": 2586.771061897278, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2586.771061897278, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.62673992673993, "ram_util_percent": 58.47179487179488}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 54.0, 76.0, 43.0, 54.0, -56.0, 43.0, 21.0, -34.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21890045254204288, "mean_inference_ms": 24.19878844759561, "mean_action_processing_ms": 0.08638751382454032, "mean_env_wait_ms": 0.04083439658743672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004913806915283203, "StateBufferConnector_ms": 0.005519390106201172, "ViewRequirementAgentConnector_ms": 0.11227607727050781}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.3025898933410645, "policy_loss": -0.02890815958380699, "vf_loss": 6.2235541343688965, "vf_explained_var": -0.1075364500284195, "kl": 0.014039303176105022, "entropy": 2.857288360595703, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13800.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -1.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -23.0, -23.0, 32.0, 21.0, -1.0, -12.0, 10.0, -34.0, 10.0, 65.0, 43.0, -23.0, -23.0, -56.0, -23.0, -34.0, 76.0, 54.0, 32.0, -1.0, 32.0, 10.0, 54.0, -45.0, 54.0, 32.0, 21.0, 65.0, 54.0, -23.0, 10.0, 10.0, -12.0, -23.0, -78.0, -34.0, -23.0, -12.0, -12.0, 21.0, -12.0, 10.0, 54.0, 65.0, 10.0, 21.0, -1.0, 32.0, -1.0, -12.0, 21.0, 21.0, 43.0, 65.0, 65.0, 43.0, 10.0, 54.0, 65.0, -12.0, 32.0, 32.0, -1.0, 65.0, 32.0, -67.0, 21.0, 21.0, 43.0, 65.0, -34.0, -56.0, -56.0, 21.0, 10.0, -89.0, -89.0, 32.0, 21.0, -23.0, -45.0, 10.0, -1.0, -56.0, -78.0, -45.0, -34.0, 10.0, -89.0, -155.0, -67.0, 21.0, -23.0, -23.0, -23.0, -34.0, -1.0, -45.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23674199922636682, "mean_inference_ms": 24.521165474038735, "mean_action_processing_ms": 0.08831647787993743, "mean_env_wait_ms": 0.04129469401277747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005806446075439453, "StateBufferConnector_ms": 0.005186796188354492, "ViewRequirementAgentConnector_ms": 0.1171114444732666}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -1.0, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.0, -23.0, -23.0, 32.0, 21.0, -1.0, -12.0, 10.0, -34.0, 10.0, 65.0, 43.0, -23.0, -23.0, -56.0, -23.0, -34.0, 76.0, 54.0, 32.0, -1.0, 32.0, 10.0, 54.0, -45.0, 54.0, 32.0, 21.0, 65.0, 54.0, -23.0, 10.0, 10.0, -12.0, -23.0, -78.0, -34.0, -23.0, -12.0, -12.0, 21.0, -12.0, 10.0, 54.0, 65.0, 10.0, 21.0, -1.0, 32.0, -1.0, -12.0, 21.0, 21.0, 43.0, 65.0, 65.0, 43.0, 10.0, 54.0, 65.0, -12.0, 32.0, 32.0, -1.0, 65.0, 32.0, -67.0, 21.0, 21.0, 43.0, 65.0, -34.0, -56.0, -56.0, 21.0, 10.0, -89.0, -89.0, 32.0, 21.0, -23.0, -45.0, 10.0, -1.0, -56.0, -78.0, -45.0, -34.0, 10.0, -89.0, -155.0, -67.0, 21.0, -23.0, -23.0, -23.0, -34.0, -1.0, -45.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23674199922636682, "mean_inference_ms": 24.521165474038735, "mean_action_processing_ms": 0.08831647787993743, "mean_env_wait_ms": 0.04129469401277747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005806446075439453, "StateBufferConnector_ms": 0.005186796188354492, "ViewRequirementAgentConnector_ms": 0.1171114444732666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 180283.56, "sample_time_ms": 99501.591, "learn_time_ms": 80769.756, "learn_throughput": 49.523, "synch_weights_time_ms": 11.186}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 736, "training_iteration": 14, "trial_id": "38794_00007", "date": "2023-06-02_05-12-09", "timestamp": 1685671929, "time_this_iter_s": 197.9367959499359, "time_total_s": 2784.7078578472137, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2784.7078578472137, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.925735294117647, "ram_util_percent": 58.71029411764706}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 19.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 54.0, -23.0, -12.0, 43.0, 65.0, -12.0, 21.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21883078117494406, "mean_inference_ms": 24.20282250966391, "mean_action_processing_ms": 0.08632168311025477, "mean_env_wait_ms": 0.040784529160746416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004370212554931641, "StateBufferConnector_ms": 0.005247592926025391, "ViewRequirementAgentConnector_ms": 0.11385917663574219}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.942748546600342, "policy_loss": -0.016363153234124184, "vf_loss": 5.865729331970215, "vf_explained_var": 0.009259278886020184, "kl": 0.012145484797656536, "entropy": 2.8438260555267334, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14820.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 1.86, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 65.0, 65.0, 43.0, 10.0, 54.0, 65.0, -12.0, 32.0, 32.0, -1.0, 65.0, 32.0, -67.0, 21.0, 21.0, 43.0, 65.0, -34.0, -56.0, -56.0, 21.0, 10.0, -89.0, -89.0, 32.0, 21.0, -23.0, -45.0, 10.0, -1.0, -56.0, -78.0, -45.0, -34.0, 10.0, -89.0, -155.0, -67.0, 21.0, -23.0, -23.0, -23.0, -34.0, -1.0, -45.0, -45.0, -56.0, -12.0, 21.0, 32.0, -45.0, 43.0, 43.0, 10.0, 32.0, -67.0, -34.0, 32.0, -34.0, -1.0, 10.0, 65.0, 43.0, -23.0, 10.0, 76.0, 21.0, 65.0, 54.0, 32.0, -23.0, 21.0, 21.0, 10.0, -67.0, 54.0, -56.0, 10.0, 21.0, -1.0, 10.0, -45.0, -34.0, 43.0, 43.0, 21.0, 54.0, -78.0, 54.0, 21.0, 43.0, 65.0, 32.0, 32.0, 32.0, -34.0, 54.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23665607609434558, "mean_inference_ms": 24.513028902863518, "mean_action_processing_ms": 0.08828574668285816, "mean_env_wait_ms": 0.04127909081101853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005789518356323242, "StateBufferConnector_ms": 0.005254030227661133, "ViewRequirementAgentConnector_ms": 0.11744236946105957}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 1.86, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 65.0, 65.0, 43.0, 10.0, 54.0, 65.0, -12.0, 32.0, 32.0, -1.0, 65.0, 32.0, -67.0, 21.0, 21.0, 43.0, 65.0, -34.0, -56.0, -56.0, 21.0, 10.0, -89.0, -89.0, 32.0, 21.0, -23.0, -45.0, 10.0, -1.0, -56.0, -78.0, -45.0, -34.0, 10.0, -89.0, -155.0, -67.0, 21.0, -23.0, -23.0, -23.0, -34.0, -1.0, -45.0, -45.0, -56.0, -12.0, 21.0, 32.0, -45.0, 43.0, 43.0, 10.0, 32.0, -67.0, -34.0, 32.0, -34.0, -1.0, 10.0, 65.0, 43.0, -23.0, 10.0, 76.0, 21.0, 65.0, 54.0, 32.0, -23.0, 21.0, 21.0, 10.0, -67.0, 54.0, -56.0, 10.0, 21.0, -1.0, 10.0, -45.0, -34.0, 43.0, 43.0, 21.0, 54.0, -78.0, 54.0, 21.0, 43.0, 65.0, 32.0, 32.0, 32.0, -34.0, 54.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23665607609434558, "mean_inference_ms": 24.513028902863518, "mean_action_processing_ms": 0.08828574668285816, "mean_env_wait_ms": 0.04127909081101853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005789518356323242, "StateBufferConnector_ms": 0.005254030227661133, "ViewRequirementAgentConnector_ms": 0.11744236946105957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 180294.238, "sample_time_ms": 99423.542, "learn_time_ms": 80858.809, "learn_throughput": 49.469, "synch_weights_time_ms": 10.917}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 789, "training_iteration": 15, "trial_id": "38794_00007", "date": "2023-06-02_05-15-28", "timestamp": 1685672128, "time_this_iter_s": 198.54437708854675, "time_total_s": 2983.2522349357605, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2983.2522349357605, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 27.081918819188193, "ram_util_percent": 58.7678966789668}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 24.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 76.0, 32.0, 10.0, -67.0, 10.0, 21.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21880024525005853, "mean_inference_ms": 24.21114237113823, "mean_action_processing_ms": 0.08630748642440808, "mean_env_wait_ms": 0.04075401051441861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049591064453125, "StateBufferConnector_ms": 0.005638599395751953, "ViewRequirementAgentConnector_ms": 0.11425971984863281}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.760404109954834, "policy_loss": -0.001385033130645752, "vf_loss": 5.650145530700684, "vf_explained_var": -0.13310948014259338, "kl": 0.014520538970828056, "entropy": 2.8436920642852783, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 12.14, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 10.0, 32.0, -67.0, -34.0, 32.0, -34.0, -1.0, 10.0, 65.0, 43.0, -23.0, 10.0, 76.0, 21.0, 65.0, 54.0, 32.0, -23.0, 21.0, 21.0, 10.0, -67.0, 54.0, -56.0, 10.0, 21.0, -1.0, 10.0, -45.0, -34.0, 43.0, 43.0, 21.0, 54.0, -78.0, 54.0, 21.0, 43.0, 65.0, 32.0, 32.0, 32.0, -34.0, 54.0, -12.0, -12.0, -34.0, -45.0, 32.0, 43.0, 21.0, 10.0, 32.0, 10.0, 43.0, 65.0, 65.0, 65.0, 65.0, 65.0, 21.0, -1.0, -34.0, -18.0, -45.0, -23.0, -23.0, -67.0, 21.0, -23.0, -1.0, -12.0, -67.0, 10.0, -12.0, 43.0, 54.0, 10.0, -1.0, -56.0, -89.0, -34.0, 21.0, 32.0, 10.0, 65.0, 76.0, 65.0, 43.0, 10.0, 10.0, 21.0, 21.0, 65.0, 21.0, 10.0, -1.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23661618072325197, "mean_inference_ms": 24.506078469894543, "mean_action_processing_ms": 0.08826081687820052, "mean_env_wait_ms": 0.04127486746249783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005827426910400391, "StateBufferConnector_ms": 0.005353450775146484, "ViewRequirementAgentConnector_ms": 0.11750578880310059}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 12.14, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 10.0, 32.0, -67.0, -34.0, 32.0, -34.0, -1.0, 10.0, 65.0, 43.0, -23.0, 10.0, 76.0, 21.0, 65.0, 54.0, 32.0, -23.0, 21.0, 21.0, 10.0, -67.0, 54.0, -56.0, 10.0, 21.0, -1.0, 10.0, -45.0, -34.0, 43.0, 43.0, 21.0, 54.0, -78.0, 54.0, 21.0, 43.0, 65.0, 32.0, 32.0, 32.0, -34.0, 54.0, -12.0, -12.0, -34.0, -45.0, 32.0, 43.0, 21.0, 10.0, 32.0, 10.0, 43.0, 65.0, 65.0, 65.0, 65.0, 65.0, 21.0, -1.0, -34.0, -18.0, -45.0, -23.0, -23.0, -67.0, 21.0, -23.0, -1.0, -12.0, -67.0, 10.0, -12.0, 43.0, 54.0, 10.0, -1.0, -56.0, -89.0, -34.0, 21.0, 32.0, 10.0, 65.0, 76.0, 65.0, 43.0, 10.0, 10.0, 21.0, 21.0, 65.0, 21.0, 10.0, -1.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23661618072325197, "mean_inference_ms": 24.506078469894543, "mean_action_processing_ms": 0.08826081687820052, "mean_env_wait_ms": 0.04127486746249783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005827426910400391, "StateBufferConnector_ms": 0.005353450775146484, "ViewRequirementAgentConnector_ms": 0.11750578880310059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 180275.986, "sample_time_ms": 99415.514, "learn_time_ms": 80848.667, "learn_throughput": 49.475, "synch_weights_time_ms": 10.871}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 842, "training_iteration": 16, "trial_id": "38794_00007", "date": "2023-06-02_05-18-47", "timestamp": 1685672327, "time_this_iter_s": 198.82737040519714, "time_total_s": 3182.0796053409576, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3182.0796053409576, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.846153846153847, "ram_util_percent": 58.962637362637366}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -89.0, "episode_reward_mean": -15.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 21.0, 10.0, -78.0, -89.0, -34.0, -1.0, 32.0, -23.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21883247714415024, "mean_inference_ms": 24.20273335317129, "mean_action_processing_ms": 0.0863099243976542, "mean_env_wait_ms": 0.04075963138639073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004723072052001953, "StateBufferConnector_ms": 0.0054168701171875, "ViewRequirementAgentConnector_ms": 0.11335611343383789}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.022531032562256, "policy_loss": 0.020451031625270844, "vf_loss": 5.916936874389648, "vf_explained_var": -0.06690619885921478, "kl": 0.011073790490627289, "entropy": 2.838527202606201, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16860.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 11.03, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 10.0, 43.0, 65.0, 65.0, 65.0, 65.0, 65.0, 21.0, -1.0, -34.0, -18.0, -45.0, -23.0, -23.0, -67.0, 21.0, -23.0, -1.0, -12.0, -67.0, 10.0, -12.0, 43.0, 54.0, 10.0, -1.0, -56.0, -89.0, -34.0, 21.0, 32.0, 10.0, 65.0, 76.0, 65.0, 43.0, 10.0, 10.0, 21.0, 21.0, 65.0, 21.0, 10.0, -1.0, 21.0, 21.0, -1.0, -45.0, -78.0, -89.0, 43.0, -12.0, -56.0, -23.0, 32.0, -23.0, 4.0, 21.0, 43.0, 10.0, 43.0, 54.0, 43.0, 76.0, 43.0, 43.0, 21.0, -23.0, 43.0, 21.0, 54.0, 10.0, 76.0, -7.0, 21.0, 54.0, 54.0, 54.0, 21.0, -100.0, -45.0, -78.0, -1.0, 65.0, 76.0, 32.0, -1.0, 21.0, 32.0, -12.0, -23.0, -45.0, 10.0, 43.0, -12.0, -67.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23658045305254233, "mean_inference_ms": 24.504573454170036, "mean_action_processing_ms": 0.08823238934737, "mean_env_wait_ms": 0.041269586715516046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005881309509277344, "StateBufferConnector_ms": 0.005272865295410156, "ViewRequirementAgentConnector_ms": 0.11733436584472656}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 11.03, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 10.0, 43.0, 65.0, 65.0, 65.0, 65.0, 65.0, 21.0, -1.0, -34.0, -18.0, -45.0, -23.0, -23.0, -67.0, 21.0, -23.0, -1.0, -12.0, -67.0, 10.0, -12.0, 43.0, 54.0, 10.0, -1.0, -56.0, -89.0, -34.0, 21.0, 32.0, 10.0, 65.0, 76.0, 65.0, 43.0, 10.0, 10.0, 21.0, 21.0, 65.0, 21.0, 10.0, -1.0, 21.0, 21.0, -1.0, -45.0, -78.0, -89.0, 43.0, -12.0, -56.0, -23.0, 32.0, -23.0, 4.0, 21.0, 43.0, 10.0, 43.0, 54.0, 43.0, 76.0, 43.0, 43.0, 21.0, -23.0, 43.0, 21.0, 54.0, 10.0, 76.0, -7.0, 21.0, 54.0, 54.0, 54.0, 21.0, -100.0, -45.0, -78.0, -1.0, 65.0, 76.0, 32.0, -1.0, 21.0, 32.0, -12.0, -23.0, -45.0, 10.0, 43.0, -12.0, -67.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23658045305254233, "mean_inference_ms": 24.504573454170036, "mean_action_processing_ms": 0.08823238934737, "mean_env_wait_ms": 0.041269586715516046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005881309509277344, "StateBufferConnector_ms": 0.005272865295410156, "ViewRequirementAgentConnector_ms": 0.11733436584472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 180383.598, "sample_time_ms": 99448.283, "learn_time_ms": 80923.474, "learn_throughput": 49.429, "synch_weights_time_ms": 10.94}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 894, "training_iteration": 17, "trial_id": "38794_00007", "date": "2023-06-02_05-22-05", "timestamp": 1685672525, "time_this_iter_s": 198.60634970664978, "time_total_s": 3380.6859550476074, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3380.6859550476074, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.53911439114391, "ram_util_percent": 59.006273062730614}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 12.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, 32.0, 21.0, 76.0, -1.0, -12.0, 21.0, -12.0, 32.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21881562612112676, "mean_inference_ms": 24.214985234531238, "mean_action_processing_ms": 0.08628983724518971, "mean_env_wait_ms": 0.04073817359975064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004684925079345703, "StateBufferConnector_ms": 0.005645751953125, "ViewRequirementAgentConnector_ms": 0.11454105377197266}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.210090160369873, "policy_loss": 0.012239081785082817, "vf_loss": 6.117389678955078, "vf_explained_var": -0.10334167629480362, "kl": 0.010464956052601337, "entropy": 2.849487781524658, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17880.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 10.15, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -56.0, -23.0, 32.0, -23.0, 4.0, 21.0, 43.0, 10.0, 43.0, 54.0, 43.0, 76.0, 43.0, 43.0, 21.0, -23.0, 43.0, 21.0, 54.0, 10.0, 76.0, -7.0, 21.0, 54.0, 54.0, 54.0, 21.0, -100.0, -45.0, -78.0, -1.0, 65.0, 76.0, 32.0, -1.0, 21.0, 32.0, -12.0, -23.0, -45.0, 10.0, 43.0, -12.0, -67.0, 43.0, 54.0, 43.0, 32.0, 32.0, -12.0, -12.0, -56.0, -23.0, 21.0, 10.0, 21.0, -1.0, 43.0, 54.0, 65.0, 76.0, 21.0, 21.0, -1.0, -45.0, -34.0, 32.0, 21.0, 21.0, 32.0, 43.0, -23.0, 32.0, -1.0, -100.0, -34.0, -12.0, 54.0, 10.0, -18.0, 10.0, 10.0, 10.0, 32.0, -12.0, -12.0, -45.0, -45.0, -23.0, 10.0, 43.0, -1.0, 21.0, -23.0, 10.0, -23.0, 10.0, -12.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2365207030199558, "mean_inference_ms": 24.504609433843196, "mean_action_processing_ms": 0.08820510869230422, "mean_env_wait_ms": 0.04126053781162389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058553218841552734, "StateBufferConnector_ms": 0.005125999450683594, "ViewRequirementAgentConnector_ms": 0.11705422401428223}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 10.15, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -56.0, -23.0, 32.0, -23.0, 4.0, 21.0, 43.0, 10.0, 43.0, 54.0, 43.0, 76.0, 43.0, 43.0, 21.0, -23.0, 43.0, 21.0, 54.0, 10.0, 76.0, -7.0, 21.0, 54.0, 54.0, 54.0, 21.0, -100.0, -45.0, -78.0, -1.0, 65.0, 76.0, 32.0, -1.0, 21.0, 32.0, -12.0, -23.0, -45.0, 10.0, 43.0, -12.0, -67.0, 43.0, 54.0, 43.0, 32.0, 32.0, -12.0, -12.0, -56.0, -23.0, 21.0, 10.0, 21.0, -1.0, 43.0, 54.0, 65.0, 76.0, 21.0, 21.0, -1.0, -45.0, -34.0, 32.0, 21.0, 21.0, 32.0, 43.0, -23.0, 32.0, -1.0, -100.0, -34.0, -12.0, 54.0, 10.0, -18.0, 10.0, 10.0, 10.0, 32.0, -12.0, -12.0, -45.0, -45.0, -23.0, 10.0, 43.0, -1.0, 21.0, -23.0, 10.0, -23.0, 10.0, -12.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2365207030199558, "mean_inference_ms": 24.504609433843196, "mean_action_processing_ms": 0.08820510869230422, "mean_env_wait_ms": 0.04126053781162389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058553218841552734, "StateBufferConnector_ms": 0.005125999450683594, "ViewRequirementAgentConnector_ms": 0.11705422401428223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 180436.041, "sample_time_ms": 99455.925, "learn_time_ms": 80968.244, "learn_throughput": 49.402, "synch_weights_time_ms": 10.989}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 947, "training_iteration": 18, "trial_id": "38794_00007", "date": "2023-06-02_05-25-25", "timestamp": 1685672725, "time_this_iter_s": 199.23282122612, "time_total_s": 3579.9187762737274, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3579.9187762737274, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.444688644688643, "ram_util_percent": 59.139560439560434}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 32.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 10.0, 65.0, -34.0, -1.0, 43.0, 21.0, 43.0, 76.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21876921309352326, "mean_inference_ms": 24.22728808283946, "mean_action_processing_ms": 0.08626426985765558, "mean_env_wait_ms": 0.040704676850863535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.11550664901733398}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 4.9920525550842285, "policy_loss": 0.02263515628874302, "vf_loss": 4.853364944458008, "vf_explained_var": -0.044904518872499466, "kl": 0.015093974769115448, "entropy": 2.85512375831604, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18900.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 19.51, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, 10.0, 21.0, -1.0, 43.0, 54.0, 65.0, 76.0, 21.0, 21.0, -1.0, -45.0, -34.0, 32.0, 21.0, 21.0, 32.0, 43.0, -23.0, 32.0, -1.0, -100.0, -34.0, -12.0, 54.0, 10.0, -18.0, 10.0, 10.0, 10.0, 32.0, -12.0, -12.0, -45.0, -45.0, -23.0, 10.0, 43.0, -1.0, 21.0, -23.0, 10.0, -23.0, 10.0, -12.0, 54.0, 76.0, 76.0, 54.0, -1.0, 32.0, -1.0, 43.0, 76.0, 65.0, 54.0, 10.0, 76.0, 32.0, 32.0, 32.0, 65.0, 32.0, 21.0, 54.0, 32.0, 21.0, 32.0, -1.0, -78.0, -12.0, -45.0, -34.0, -1.0, -1.0, 32.0, 21.0, 54.0, 54.0, 65.0, 65.0, 21.0, -1.0, 10.0, -23.0, 21.0, 10.0, 32.0, 76.0, 32.0, 65.0, 54.0, 54.0, 43.0, 65.0, 21.0, 21.0, 65.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23635181809801345, "mean_inference_ms": 24.506422000228483, "mean_action_processing_ms": 0.0881734873538673, "mean_env_wait_ms": 0.04124535345588986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057909488677978516, "StateBufferConnector_ms": 0.004966020584106445, "ViewRequirementAgentConnector_ms": 0.11563706398010254}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 19.51, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, 10.0, 21.0, -1.0, 43.0, 54.0, 65.0, 76.0, 21.0, 21.0, -1.0, -45.0, -34.0, 32.0, 21.0, 21.0, 32.0, 43.0, -23.0, 32.0, -1.0, -100.0, -34.0, -12.0, 54.0, 10.0, -18.0, 10.0, 10.0, 10.0, 32.0, -12.0, -12.0, -45.0, -45.0, -23.0, 10.0, 43.0, -1.0, 21.0, -23.0, 10.0, -23.0, 10.0, -12.0, 54.0, 76.0, 76.0, 54.0, -1.0, 32.0, -1.0, 43.0, 76.0, 65.0, 54.0, 10.0, 76.0, 32.0, 32.0, 32.0, 65.0, 32.0, 21.0, 54.0, 32.0, 21.0, 32.0, -1.0, -78.0, -12.0, -45.0, -34.0, -1.0, -1.0, 32.0, 21.0, 54.0, 54.0, 65.0, 65.0, 21.0, -1.0, 10.0, -23.0, 21.0, 10.0, 32.0, 76.0, 32.0, 65.0, 54.0, 54.0, 43.0, 65.0, 21.0, 21.0, 65.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23635181809801345, "mean_inference_ms": 24.506422000228483, "mean_action_processing_ms": 0.0881734873538673, "mean_env_wait_ms": 0.04124535345588986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057909488677978516, "StateBufferConnector_ms": 0.004966020584106445, "ViewRequirementAgentConnector_ms": 0.11563706398010254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 180233.179, "sample_time_ms": 99497.24, "learn_time_ms": 80724.158, "learn_throughput": 49.551, "synch_weights_time_ms": 10.883}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 1000, "training_iteration": 19, "trial_id": "38794_00007", "date": "2023-06-02_05-28-44", "timestamp": 1685672924, "time_this_iter_s": 199.10811686515808, "time_total_s": 3779.0268931388855, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3779.0268931388855, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.466176470588238, "ram_util_percent": 59.30110294117647}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 37.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 21.0, 43.0, 76.0, 21.0, 43.0, -34.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2187076002961279, "mean_inference_ms": 24.244218882381368, "mean_action_processing_ms": 0.08622993490318118, "mean_env_wait_ms": 0.04066475817470376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004899501800537109, "StateBufferConnector_ms": 0.005404949188232422, "ViewRequirementAgentConnector_ms": 0.11501312255859375}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.826114654541016, "policy_loss": 0.03281022608280182, "vf_loss": 5.707452297210693, "vf_explained_var": -0.08893045037984848, "kl": 0.01116595696657896, "entropy": 2.8421926498413086, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19920.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 25.51, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 43.0, 76.0, 65.0, 54.0, 10.0, 76.0, 32.0, 32.0, 32.0, 65.0, 32.0, 21.0, 54.0, 32.0, 21.0, 32.0, -1.0, -78.0, -12.0, -45.0, -34.0, -1.0, -1.0, 32.0, 21.0, 54.0, 54.0, 65.0, 65.0, 21.0, -1.0, 10.0, -23.0, 21.0, 10.0, 32.0, 76.0, 32.0, 65.0, 54.0, 54.0, 43.0, 65.0, 21.0, 21.0, 65.0, 54.0, 43.0, -12.0, 54.0, 32.0, 43.0, 21.0, 43.0, 54.0, 65.0, 43.0, 32.0, -1.0, 32.0, -23.0, 10.0, -1.0, -23.0, 10.0, -1.0, -12.0, 10.0, 32.0, 76.0, 21.0, 65.0, 43.0, 10.0, 65.0, 43.0, 65.0, 43.0, 10.0, -12.0, 10.0, 43.0, 10.0, -1.0, -67.0, -1.0, -1.0, 54.0, 32.0, 10.0, 32.0, 21.0, 32.0, 21.0, 10.0, -23.0, 43.0, -1.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23620364713558628, "mean_inference_ms": 24.507560346036275, "mean_action_processing_ms": 0.08814633887334321, "mean_env_wait_ms": 0.04123229798279041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005774974822998047, "StateBufferConnector_ms": 0.004912137985229492, "ViewRequirementAgentConnector_ms": 0.11493039131164551}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 25.51, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 43.0, 76.0, 65.0, 54.0, 10.0, 76.0, 32.0, 32.0, 32.0, 65.0, 32.0, 21.0, 54.0, 32.0, 21.0, 32.0, -1.0, -78.0, -12.0, -45.0, -34.0, -1.0, -1.0, 32.0, 21.0, 54.0, 54.0, 65.0, 65.0, 21.0, -1.0, 10.0, -23.0, 21.0, 10.0, 32.0, 76.0, 32.0, 65.0, 54.0, 54.0, 43.0, 65.0, 21.0, 21.0, 65.0, 54.0, 43.0, -12.0, 54.0, 32.0, 43.0, 21.0, 43.0, 54.0, 65.0, 43.0, 32.0, -1.0, 32.0, -23.0, 10.0, -1.0, -23.0, 10.0, -1.0, -12.0, 10.0, 32.0, 76.0, 21.0, 65.0, 43.0, 10.0, 65.0, 43.0, 65.0, 43.0, 10.0, -12.0, 10.0, 43.0, 10.0, -1.0, -67.0, -1.0, -1.0, 54.0, 32.0, 10.0, 32.0, 21.0, 32.0, 21.0, 10.0, -23.0, 43.0, -1.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23620364713558628, "mean_inference_ms": 24.507560346036275, "mean_action_processing_ms": 0.08814633887334321, "mean_env_wait_ms": 0.04123229798279041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005774974822998047, "StateBufferConnector_ms": 0.004912137985229492, "ViewRequirementAgentConnector_ms": 0.11493039131164551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 180249.295, "sample_time_ms": 99495.611, "learn_time_ms": 80741.919, "learn_throughput": 49.541, "synch_weights_time_ms": 10.87}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 1052, "training_iteration": 20, "trial_id": "38794_00007", "date": "2023-06-02_05-32-03", "timestamp": 1685673123, "time_this_iter_s": 199.2315330505371, "time_total_s": 3978.2584261894226, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3978.2584261894226, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 26.625367647058823, "ram_util_percent": 59.464338235294115}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": 37.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, -23.0, 65.0, 32.0, 76.0, 65.0, 65.0, 65.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21859934945265141, "mean_inference_ms": 24.257648693993158, "mean_action_processing_ms": 0.0861831852893962, "mean_env_wait_ms": 0.04062553402415702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004916191101074219, "StateBufferConnector_ms": 0.0052738189697265625, "ViewRequirementAgentConnector_ms": 0.11307239532470703}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.649419784545898, "policy_loss": -0.017827097326517105, "vf_loss": 5.559971332550049, "vf_explained_var": -0.11064707487821579, "kl": 0.01395245362073183, "entropy": 2.8440277576446533, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20940.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 16.54, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 54.0, 65.0, 43.0, 32.0, -1.0, 32.0, -23.0, 10.0, -1.0, -23.0, 10.0, -1.0, -12.0, 10.0, 32.0, 76.0, 21.0, 65.0, 43.0, 10.0, 65.0, 43.0, 65.0, 43.0, 10.0, -12.0, 10.0, 43.0, 10.0, -1.0, -67.0, -1.0, -1.0, 54.0, 32.0, 10.0, 32.0, 21.0, 32.0, 21.0, 10.0, -23.0, 43.0, -1.0, 32.0, 65.0, 76.0, 76.0, -100.0, -34.0, -34.0, 10.0, -45.0, 43.0, -12.0, 32.0, 43.0, 10.0, -12.0, -89.0, -56.0, 48.0, -45.0, 43.0, 10.0, 21.0, 65.0, 21.0, 43.0, 10.0, 54.0, 65.0, 21.0, -12.0, 54.0, 32.0, -23.0, 21.0, 43.0, -1.0, -12.0, 10.0, 21.0, 43.0, 21.0, 32.0, 10.0, -1.0, 54.0, 65.0, 21.0, -23.0, -23.0, -67.0, -12.0, -12.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23615717000189776, "mean_inference_ms": 24.50762999247073, "mean_action_processing_ms": 0.0881273989100438, "mean_env_wait_ms": 0.04122868633450558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005851268768310547, "StateBufferConnector_ms": 0.005027294158935547, "ViewRequirementAgentConnector_ms": 0.11523246765136719}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 16.54, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 54.0, 65.0, 43.0, 32.0, -1.0, 32.0, -23.0, 10.0, -1.0, -23.0, 10.0, -1.0, -12.0, 10.0, 32.0, 76.0, 21.0, 65.0, 43.0, 10.0, 65.0, 43.0, 65.0, 43.0, 10.0, -12.0, 10.0, 43.0, 10.0, -1.0, -67.0, -1.0, -1.0, 54.0, 32.0, 10.0, 32.0, 21.0, 32.0, 21.0, 10.0, -23.0, 43.0, -1.0, 32.0, 65.0, 76.0, 76.0, -100.0, -34.0, -34.0, 10.0, -45.0, 43.0, -12.0, 32.0, 43.0, 10.0, -12.0, -89.0, -56.0, 48.0, -45.0, 43.0, 10.0, 21.0, 65.0, 21.0, 43.0, 10.0, 54.0, 65.0, 21.0, -12.0, 54.0, 32.0, -23.0, 21.0, 43.0, -1.0, -12.0, 10.0, 21.0, 43.0, 21.0, 32.0, 10.0, -1.0, 54.0, 65.0, 21.0, -23.0, -23.0, -67.0, -12.0, -12.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23615717000189776, "mean_inference_ms": 24.50762999247073, "mean_action_processing_ms": 0.0881273989100438, "mean_env_wait_ms": 0.04122868633450558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005851268768310547, "StateBufferConnector_ms": 0.005027294158935547, "ViewRequirementAgentConnector_ms": 0.11523246765136719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 180283.11, "sample_time_ms": 99495.521, "learn_time_ms": 80775.58, "learn_throughput": 49.52, "synch_weights_time_ms": 11.095}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 1105, "training_iteration": 21, "trial_id": "38794_00007", "date": "2023-06-02_05-35-23", "timestamp": 1685673323, "time_this_iter_s": 199.61879014968872, "time_total_s": 4177.877216339111, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4177.877216339111, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 26.399264705882352, "ram_util_percent": 59.642279411764704}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -84.0, "episode_reward_mean": -25.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -12.0, -1.0, -56.0, -23.0, 43.0, 21.0, -84.0, -56.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21854417117743763, "mean_inference_ms": 24.270692900260748, "mean_action_processing_ms": 0.08614530518297216, "mean_env_wait_ms": 0.04061039366310603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005161762237548828, "StateBufferConnector_ms": 0.005180835723876953, "ViewRequirementAgentConnector_ms": 0.112762451171875}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.716381549835205, "policy_loss": -0.015019869431853294, "vf_loss": 5.648137092590332, "vf_explained_var": -0.04990469664335251, "kl": 0.010829444974660873, "entropy": 2.864377737045288, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21960.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 12.52, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 10.0, -45.0, 43.0, -12.0, 32.0, 43.0, 10.0, -12.0, -89.0, -56.0, 48.0, -45.0, 43.0, 10.0, 21.0, 65.0, 21.0, 43.0, 10.0, 54.0, 65.0, 21.0, -12.0, 54.0, 32.0, -23.0, 21.0, 43.0, -1.0, -12.0, 10.0, 21.0, 43.0, 21.0, 32.0, 10.0, -1.0, 54.0, 65.0, 21.0, -23.0, -23.0, -67.0, -12.0, -12.0, 65.0, 43.0, 65.0, 65.0, 26.0, 21.0, 21.0, -45.0, 21.0, 10.0, -1.0, 65.0, 43.0, 43.0, 21.0, 32.0, -56.0, -23.0, 32.0, -34.0, 43.0, 54.0, 76.0, 32.0, -1.0, -1.0, 43.0, 43.0, 32.0, 43.0, 54.0, 21.0, -1.0, 21.0, 32.0, 21.0, -1.0, -23.0, 21.0, 43.0, 43.0, -78.0, 32.0, 32.0, 21.0, 10.0, 10.0, 10.0, -78.0, -144.0, -34.0, -34.0, -23.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2361165093905214, "mean_inference_ms": 24.50692832322456, "mean_action_processing_ms": 0.08812283708137869, "mean_env_wait_ms": 0.04122424439277453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005888700485229492, "StateBufferConnector_ms": 0.00503849983215332, "ViewRequirementAgentConnector_ms": 0.11523771286010742}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 12.52, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, 10.0, -45.0, 43.0, -12.0, 32.0, 43.0, 10.0, -12.0, -89.0, -56.0, 48.0, -45.0, 43.0, 10.0, 21.0, 65.0, 21.0, 43.0, 10.0, 54.0, 65.0, 21.0, -12.0, 54.0, 32.0, -23.0, 21.0, 43.0, -1.0, -12.0, 10.0, 21.0, 43.0, 21.0, 32.0, 10.0, -1.0, 54.0, 65.0, 21.0, -23.0, -23.0, -67.0, -12.0, -12.0, 65.0, 43.0, 65.0, 65.0, 26.0, 21.0, 21.0, -45.0, 21.0, 10.0, -1.0, 65.0, 43.0, 43.0, 21.0, 32.0, -56.0, -23.0, 32.0, -34.0, 43.0, 54.0, 76.0, 32.0, -1.0, -1.0, 43.0, 43.0, 32.0, 43.0, 54.0, 21.0, -1.0, 21.0, 32.0, 21.0, -1.0, -23.0, 21.0, 43.0, 43.0, -78.0, 32.0, 32.0, 21.0, 10.0, 10.0, 10.0, -78.0, -144.0, -34.0, -34.0, -23.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2361165093905214, "mean_inference_ms": 24.50692832322456, "mean_action_processing_ms": 0.08812283708137869, "mean_env_wait_ms": 0.04122424439277453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005888700485229492, "StateBufferConnector_ms": 0.00503849983215332, "ViewRequirementAgentConnector_ms": 0.11523771286010742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 180163.304, "sample_time_ms": 99443.96, "learn_time_ms": 80708.012, "learn_throughput": 49.561, "synch_weights_time_ms": 10.495}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 1157, "training_iteration": 22, "trial_id": "38794_00007", "date": "2023-06-02_05-38-42", "timestamp": 1685673522, "time_this_iter_s": 199.06195497512817, "time_total_s": 4376.9391713142395, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4376.9391713142395, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 26.965073529411764, "ram_util_percent": 59.82573529411764}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -67.0, "episode_reward_mean": -4.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -23.0, 32.0, -56.0, -67.0, -56.0, 32.0, 21.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21858218332551096, "mean_inference_ms": 24.27478096017466, "mean_action_processing_ms": 0.08613071318356302, "mean_env_wait_ms": 0.04059700621912664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052738189697265625, "StateBufferConnector_ms": 0.005359649658203125, "ViewRequirementAgentConnector_ms": 0.11570453643798828}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.296769618988037, "policy_loss": -0.005373120773583651, "vf_loss": 6.218459606170654, "vf_explained_var": -0.13242553174495697, "kl": 0.010884002782404423, "entropy": 2.826488733291626, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22980.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 3.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, 21.0, 10.0, -1.0, 65.0, 43.0, 43.0, 21.0, 32.0, -56.0, -23.0, 32.0, -34.0, 43.0, 54.0, 76.0, 32.0, -1.0, -1.0, 43.0, 43.0, 32.0, 43.0, 54.0, 21.0, -1.0, 21.0, 32.0, 21.0, -1.0, -23.0, 21.0, 43.0, 43.0, -78.0, 32.0, 32.0, 21.0, 10.0, 10.0, 10.0, -78.0, -144.0, -34.0, -34.0, -23.0, 32.0, 10.0, 21.0, 54.0, 43.0, -23.0, -45.0, -67.0, -12.0, -67.0, -56.0, -67.0, -78.0, -1.0, -23.0, -1.0, 54.0, 10.0, 32.0, 21.0, 32.0, 32.0, 76.0, 10.0, 43.0, -34.0, -12.0, 10.0, 32.0, 43.0, 10.0, 21.0, 21.0, -1.0, -67.0, -23.0, -23.0, -12.0, 43.0, 10.0, -34.0, 32.0, -12.0, 10.0, 10.0, 54.0, -12.0, -78.0, -78.0, -12.0, -34.0, 65.0, -1.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23609105331410532, "mean_inference_ms": 24.505568613588313, "mean_action_processing_ms": 0.088130997094898, "mean_env_wait_ms": 0.041225281734982334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005879640579223633, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.11500072479248047}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 3.4, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, 21.0, 10.0, -1.0, 65.0, 43.0, 43.0, 21.0, 32.0, -56.0, -23.0, 32.0, -34.0, 43.0, 54.0, 76.0, 32.0, -1.0, -1.0, 43.0, 43.0, 32.0, 43.0, 54.0, 21.0, -1.0, 21.0, 32.0, 21.0, -1.0, -23.0, 21.0, 43.0, 43.0, -78.0, 32.0, 32.0, 21.0, 10.0, 10.0, 10.0, -78.0, -144.0, -34.0, -34.0, -23.0, 32.0, 10.0, 21.0, 54.0, 43.0, -23.0, -45.0, -67.0, -12.0, -67.0, -56.0, -67.0, -78.0, -1.0, -23.0, -1.0, 54.0, 10.0, 32.0, 21.0, 32.0, 32.0, 76.0, 10.0, 43.0, -34.0, -12.0, 10.0, 32.0, 43.0, 10.0, 21.0, 21.0, -1.0, -67.0, -23.0, -23.0, -12.0, 43.0, 10.0, -34.0, 32.0, -12.0, 10.0, 10.0, 54.0, -12.0, -78.0, -78.0, -12.0, -34.0, 65.0, -1.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23609105331410532, "mean_inference_ms": 24.505568613588313, "mean_action_processing_ms": 0.088130997094898, "mean_env_wait_ms": 0.041225281734982334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005879640579223633, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.11500072479248047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 180095.865, "sample_time_ms": 99430.161, "learn_time_ms": 80654.435, "learn_throughput": 49.594, "synch_weights_time_ms": 10.433}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 1210, "training_iteration": 23, "trial_id": "38794_00007", "date": "2023-06-02_05-42-00", "timestamp": 1685673720, "time_this_iter_s": 198.63025879859924, "time_total_s": 4575.569430112839, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4575.569430112839, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 27.929151291512916, "ram_util_percent": 59.90073800738007}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -1.0, "episode_reward_mean": 33.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 21.0, -1.0, 32.0, 43.0, 32.0, 54.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218534148070747, "mean_inference_ms": 24.280275458614064, "mean_action_processing_ms": 0.08610112972540798, "mean_env_wait_ms": 0.04057981983479893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048065185546875, "StateBufferConnector_ms": 0.005533695220947266, "ViewRequirementAgentConnector_ms": 0.11431217193603516}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.423013210296631, "policy_loss": -0.015314974822103977, "vf_loss": 6.354562282562256, "vf_explained_var": -0.22616522014141083, "kl": 0.01089482381939888, "entropy": 2.853337526321411, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24000.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 3.99, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -12.0, -67.0, -56.0, -67.0, -78.0, -1.0, -23.0, -1.0, 54.0, 10.0, 32.0, 21.0, 32.0, 32.0, 76.0, 10.0, 43.0, -34.0, -12.0, 10.0, 32.0, 43.0, 10.0, 21.0, 21.0, -1.0, -67.0, -23.0, -23.0, -12.0, 43.0, 10.0, -34.0, 32.0, -12.0, 10.0, 10.0, 54.0, -12.0, -78.0, -78.0, -12.0, -34.0, 65.0, -1.0, -45.0, 21.0, 43.0, 32.0, -12.0, 21.0, -12.0, -45.0, 43.0, 76.0, -12.0, -23.0, -23.0, -1.0, -45.0, -56.0, -12.0, -1.0, 20.0, 32.0, -1.0, 10.0, 21.0, -45.0, 21.0, -12.0, -12.0, -12.0, 32.0, 43.0, 10.0, 21.0, -34.0, 32.0, -23.0, 43.0, 21.0, 76.0, 76.0, 21.0, 32.0, -1.0, 37.0, 32.0, 10.0, -34.0, 54.0, -12.0, -23.0, -1.0, 76.0, 32.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2360675034803167, "mean_inference_ms": 24.506130851232438, "mean_action_processing_ms": 0.08813248892988838, "mean_env_wait_ms": 0.04122658183883729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005859375, "StateBufferConnector_ms": 0.005018472671508789, "ViewRequirementAgentConnector_ms": 0.11514449119567871}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 3.99, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -12.0, -67.0, -56.0, -67.0, -78.0, -1.0, -23.0, -1.0, 54.0, 10.0, 32.0, 21.0, 32.0, 32.0, 76.0, 10.0, 43.0, -34.0, -12.0, 10.0, 32.0, 43.0, 10.0, 21.0, 21.0, -1.0, -67.0, -23.0, -23.0, -12.0, 43.0, 10.0, -34.0, 32.0, -12.0, 10.0, 10.0, 54.0, -12.0, -78.0, -78.0, -12.0, -34.0, 65.0, -1.0, -45.0, 21.0, 43.0, 32.0, -12.0, 21.0, -12.0, -45.0, 43.0, 76.0, -12.0, -23.0, -23.0, -1.0, -45.0, -56.0, -12.0, -1.0, 20.0, 32.0, -1.0, 10.0, 21.0, -45.0, 21.0, -12.0, -12.0, -12.0, 32.0, 43.0, 10.0, 21.0, -34.0, 32.0, -23.0, 43.0, 21.0, 76.0, 76.0, 21.0, 32.0, -1.0, 37.0, 32.0, 10.0, -34.0, 54.0, -12.0, -23.0, -1.0, 76.0, 32.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2360675034803167, "mean_inference_ms": 24.506130851232438, "mean_action_processing_ms": 0.08813248892988838, "mean_env_wait_ms": 0.04122658183883729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005859375, "StateBufferConnector_ms": 0.005018472671508789, "ViewRequirementAgentConnector_ms": 0.11514449119567871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 180198.335, "sample_time_ms": 99459.399, "learn_time_ms": 80727.761, "learn_throughput": 49.549, "synch_weights_time_ms": 10.342}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 1263, "training_iteration": 24, "trial_id": "38794_00007", "date": "2023-06-02_05-45-20", "timestamp": 1685673920, "time_this_iter_s": 199.76884508132935, "time_total_s": 4775.338275194168, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4775.338275194168, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 26.575824175824177, "ram_util_percent": 60.0010989010989}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 10.0, "episode_reward_mean": 48.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 21.0, 10.0, 65.0, 32.0, 54.0, 76.0, 65.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21857501619659306, "mean_inference_ms": 24.279705844837192, "mean_action_processing_ms": 0.08610937257960159, "mean_env_wait_ms": 0.04058410968161164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004508495330810547, "StateBufferConnector_ms": 0.0057315826416015625, "ViewRequirementAgentConnector_ms": 0.11685848236083984}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.045003414154053, "policy_loss": 0.0030137873254716396, "vf_loss": 5.966396331787109, "vf_explained_var": -0.09136732667684555, "kl": 0.009831724688410759, "entropy": 2.872119188308716, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25020.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 7.67, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, 43.0, 76.0, -12.0, -23.0, -23.0, -1.0, -45.0, -56.0, -12.0, -1.0, 20.0, 32.0, -1.0, 10.0, 21.0, -45.0, 21.0, -12.0, -12.0, -12.0, 32.0, 43.0, 10.0, 21.0, -34.0, 32.0, -23.0, 43.0, 21.0, 76.0, 76.0, 21.0, 32.0, -1.0, 37.0, 32.0, 10.0, -34.0, 54.0, -12.0, -23.0, -1.0, 76.0, 32.0, 21.0, 21.0, 65.0, 21.0, 76.0, 10.0, -12.0, -1.0, 21.0, 43.0, 10.0, -34.0, -1.0, -23.0, -67.0, -122.0, -1.0, 21.0, 10.0, -23.0, -23.0, -34.0, -78.0, 10.0, 43.0, 10.0, -12.0, 21.0, -34.0, -56.0, -23.0, -34.0, -12.0, 54.0, 32.0, -23.0, 21.0, 43.0, 32.0, 65.0, 26.0, 32.0, 21.0, 65.0, 10.0, 10.0, 32.0, 10.0, -12.0, 32.0, 10.0, -12.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23603165729087908, "mean_inference_ms": 24.509747078878494, "mean_action_processing_ms": 0.08811210550831407, "mean_env_wait_ms": 0.041216528528387156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00585484504699707, "StateBufferConnector_ms": 0.004951953887939453, "ViewRequirementAgentConnector_ms": 0.11455082893371582}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 7.67, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, 43.0, 76.0, -12.0, -23.0, -23.0, -1.0, -45.0, -56.0, -12.0, -1.0, 20.0, 32.0, -1.0, 10.0, 21.0, -45.0, 21.0, -12.0, -12.0, -12.0, 32.0, 43.0, 10.0, 21.0, -34.0, 32.0, -23.0, 43.0, 21.0, 76.0, 76.0, 21.0, 32.0, -1.0, 37.0, 32.0, 10.0, -34.0, 54.0, -12.0, -23.0, -1.0, 76.0, 32.0, 21.0, 21.0, 65.0, 21.0, 76.0, 10.0, -12.0, -1.0, 21.0, 43.0, 10.0, -34.0, -1.0, -23.0, -67.0, -122.0, -1.0, 21.0, 10.0, -23.0, -23.0, -34.0, -78.0, 10.0, 43.0, 10.0, -12.0, 21.0, -34.0, -56.0, -23.0, -34.0, -12.0, 54.0, 32.0, -23.0, 21.0, 43.0, 32.0, 65.0, 26.0, 32.0, 21.0, 65.0, 10.0, 10.0, 32.0, 10.0, -12.0, 32.0, 10.0, -12.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23603165729087908, "mean_inference_ms": 24.509747078878494, "mean_action_processing_ms": 0.08811210550831407, "mean_env_wait_ms": 0.041216528528387156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00585484504699707, "StateBufferConnector_ms": 0.004951953887939453, "ViewRequirementAgentConnector_ms": 0.11455082893371582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 180298.772, "sample_time_ms": 99580.777, "learn_time_ms": 80706.839, "learn_throughput": 49.562, "synch_weights_time_ms": 10.324}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 1315, "training_iteration": 25, "trial_id": "38794_00007", "date": "2023-06-02_05-48-40", "timestamp": 1685674120, "time_this_iter_s": 199.56263995170593, "time_total_s": 4974.900915145874, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4974.900915145874, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.79151291512915, "ram_util_percent": 60.092619926199255}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -12.0, "episode_reward_mean": 22.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 32.0, 32.0, 21.0, -1.0, 43.0, 65.0, -12.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21851480830615183, "mean_inference_ms": 24.29764473838221, "mean_action_processing_ms": 0.08609925775801588, "mean_env_wait_ms": 0.04056672638265307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046443939208984375, "StateBufferConnector_ms": 0.005402565002441406, "ViewRequirementAgentConnector_ms": 0.1145315170288086}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.910330772399902, "policy_loss": 0.0015687388367950916, "vf_loss": 5.822240829467773, "vf_explained_var": -0.10578341782093048, "kl": 0.011253195814788342, "entropy": 2.855685234069824, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26040.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 1.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 21.0, 43.0, 10.0, -34.0, -1.0, -23.0, -67.0, -122.0, -1.0, 21.0, 10.0, -23.0, -23.0, -34.0, -78.0, 10.0, 43.0, 10.0, -12.0, 21.0, -34.0, -56.0, -23.0, -34.0, -12.0, 54.0, 32.0, -23.0, 21.0, 43.0, 32.0, 65.0, 26.0, 32.0, 21.0, 65.0, 10.0, 10.0, 32.0, 10.0, -12.0, 32.0, 10.0, -12.0, 21.0, 54.0, 21.0, 43.0, -45.0, 10.0, 10.0, -23.0, 10.0, 10.0, -78.0, -12.0, -67.0, -12.0, 32.0, 21.0, -34.0, -67.0, 10.0, -1.0, -34.0, -23.0, -45.0, -45.0, -1.0, -1.0, -12.0, 32.0, -67.0, -34.0, -56.0, -45.0, -45.0, 32.0, -56.0, -12.0, 10.0, -1.0, 10.0, 65.0, 76.0, 54.0, 10.0, 76.0, 54.0, 21.0, 32.0, 32.0, 21.0, 10.0, 10.0, 43.0, 10.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2360122604534587, "mean_inference_ms": 24.511746827123055, "mean_action_processing_ms": 0.08809395100833806, "mean_env_wait_ms": 0.04120863581189056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005927085876464844, "StateBufferConnector_ms": 0.0050144195556640625, "ViewRequirementAgentConnector_ms": 0.11449027061462402}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 1.8, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 21.0, 43.0, 10.0, -34.0, -1.0, -23.0, -67.0, -122.0, -1.0, 21.0, 10.0, -23.0, -23.0, -34.0, -78.0, 10.0, 43.0, 10.0, -12.0, 21.0, -34.0, -56.0, -23.0, -34.0, -12.0, 54.0, 32.0, -23.0, 21.0, 43.0, 32.0, 65.0, 26.0, 32.0, 21.0, 65.0, 10.0, 10.0, 32.0, 10.0, -12.0, 32.0, 10.0, -12.0, 21.0, 54.0, 21.0, 43.0, -45.0, 10.0, 10.0, -23.0, 10.0, 10.0, -78.0, -12.0, -67.0, -12.0, 32.0, 21.0, -34.0, -67.0, 10.0, -1.0, -34.0, -23.0, -45.0, -45.0, -1.0, -1.0, -12.0, 32.0, -67.0, -34.0, -56.0, -45.0, -45.0, 32.0, -56.0, -12.0, 10.0, -1.0, 10.0, 65.0, 76.0, 54.0, 10.0, 76.0, 54.0, 21.0, 32.0, 32.0, 21.0, 10.0, 10.0, 43.0, 10.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2360122604534587, "mean_inference_ms": 24.511746827123055, "mean_action_processing_ms": 0.08809395100833806, "mean_env_wait_ms": 0.04120863581189056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005927085876464844, "StateBufferConnector_ms": 0.0050144195556640625, "ViewRequirementAgentConnector_ms": 0.11449027061462402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 180363.306, "sample_time_ms": 99585.797, "learn_time_ms": 80766.328, "learn_throughput": 49.526, "synch_weights_time_ms": 10.343}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 1368, "training_iteration": 26, "trial_id": "38794_00007", "date": "2023-06-02_05-52-00", "timestamp": 1685674320, "time_this_iter_s": 199.7829601764679, "time_total_s": 5174.683875322342, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5174.683875322342, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 26.127838827838826, "ram_util_percent": 60.24945054945056}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -45.0, "episode_reward_mean": 5.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 43.0, 10.0, 32.0, 65.0, -23.0, -1.0, -34.0, -34.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2186099000797594, "mean_inference_ms": 24.305614426635486, "mean_action_processing_ms": 0.0861309046494578, "mean_env_wait_ms": 0.04056474687434923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004765987396240234, "StateBufferConnector_ms": 0.005462169647216797, "ViewRequirementAgentConnector_ms": 0.11493921279907227}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.826054096221924, "policy_loss": 0.011178347282111645, "vf_loss": 5.731966972351074, "vf_explained_var": -0.08953281491994858, "kl": 0.01078321784734726, "entropy": 2.8922832012176514, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27060.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 6.47, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, -78.0, -12.0, -67.0, -12.0, 32.0, 21.0, -34.0, -67.0, 10.0, -1.0, -34.0, -23.0, -45.0, -45.0, -1.0, -1.0, -12.0, 32.0, -67.0, -34.0, -56.0, -45.0, -45.0, 32.0, -56.0, -12.0, 10.0, -1.0, 10.0, 65.0, 76.0, 54.0, 10.0, 76.0, 54.0, 21.0, 32.0, 32.0, 21.0, 10.0, 10.0, 43.0, 10.0, 43.0, 54.0, 43.0, -23.0, 32.0, -45.0, -78.0, 21.0, -1.0, -45.0, -1.0, -12.0, -67.0, -12.0, -34.0, 65.0, 76.0, 21.0, 65.0, 43.0, 32.0, 43.0, 32.0, 21.0, 43.0, -34.0, -1.0, 43.0, 43.0, 10.0, -12.0, 32.0, 43.0, 10.0, 76.0, 43.0, -12.0, -12.0, 21.0, 21.0, -56.0, -12.0, -23.0, 43.0, -12.0, 54.0, -12.0, -12.0, 21.0, 48.0, -18.0, -1.0, 32.0, 10.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2359987951912917, "mean_inference_ms": 24.51040700222934, "mean_action_processing_ms": 0.08808750619504281, "mean_env_wait_ms": 0.04120639354087099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005883216857910156, "StateBufferConnector_ms": 0.0050542354583740234, "ViewRequirementAgentConnector_ms": 0.1150522232055664}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 6.47, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 10.0, -78.0, -12.0, -67.0, -12.0, 32.0, 21.0, -34.0, -67.0, 10.0, -1.0, -34.0, -23.0, -45.0, -45.0, -1.0, -1.0, -12.0, 32.0, -67.0, -34.0, -56.0, -45.0, -45.0, 32.0, -56.0, -12.0, 10.0, -1.0, 10.0, 65.0, 76.0, 54.0, 10.0, 76.0, 54.0, 21.0, 32.0, 32.0, 21.0, 10.0, 10.0, 43.0, 10.0, 43.0, 54.0, 43.0, -23.0, 32.0, -45.0, -78.0, 21.0, -1.0, -45.0, -1.0, -12.0, -67.0, -12.0, -34.0, 65.0, 76.0, 21.0, 65.0, 43.0, 32.0, 43.0, 32.0, 21.0, 43.0, -34.0, -1.0, 43.0, 43.0, 10.0, -12.0, 32.0, 43.0, 10.0, 76.0, 43.0, -12.0, -12.0, 21.0, 21.0, -56.0, -12.0, -23.0, 43.0, -12.0, 54.0, -12.0, -12.0, 21.0, 48.0, -18.0, -1.0, 32.0, 10.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2359987951912917, "mean_inference_ms": 24.51040700222934, "mean_action_processing_ms": 0.08808750619504281, "mean_env_wait_ms": 0.04120639354087099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005883216857910156, "StateBufferConnector_ms": 0.0050542354583740234, "ViewRequirementAgentConnector_ms": 0.1150522232055664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 180411.533, "sample_time_ms": 99577.347, "learn_time_ms": 80822.937, "learn_throughput": 49.491, "synch_weights_time_ms": 10.397}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1421, "training_iteration": 27, "trial_id": "38794_00007", "date": "2023-06-02_05-55-19", "timestamp": 1685674519, "time_this_iter_s": 199.42691087722778, "time_total_s": 5374.11078619957, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5374.11078619957, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 26.85239852398524, "ram_util_percent": 60.40295202952029}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 5.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, 32.0, -12.0, 65.0, 10.0, -34.0, -34.0, 21.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21863819473830892, "mean_inference_ms": 24.31078107502333, "mean_action_processing_ms": 0.08616528785081404, "mean_env_wait_ms": 0.04056975400222097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004773139953613281, "StateBufferConnector_ms": 0.0053691864013671875, "ViewRequirementAgentConnector_ms": 0.11486291885375977}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.193810939788818, "policy_loss": -0.02060321345925331, "vf_loss": 5.125022888183594, "vf_explained_var": 0.01200802344828844, "kl": 0.011626385152339935, "entropy": 2.8772757053375244, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28095.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 19.99, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -1.0, -45.0, -1.0, -12.0, -67.0, -12.0, -34.0, 65.0, 76.0, 21.0, 65.0, 43.0, 32.0, 43.0, 32.0, 21.0, 43.0, -34.0, -1.0, 43.0, 43.0, 10.0, -12.0, 32.0, 43.0, 10.0, 76.0, 43.0, -12.0, -12.0, 21.0, 21.0, -56.0, -12.0, -23.0, 43.0, -12.0, 54.0, -12.0, -12.0, 21.0, 48.0, -18.0, -1.0, 32.0, 10.0, 65.0, 54.0, -1.0, 10.0, 65.0, 65.0, 21.0, -1.0, 21.0, -1.0, -12.0, -1.0, -1.0, -23.0, -56.0, 43.0, 21.0, 43.0, 65.0, 21.0, 54.0, 10.0, -29.0, -12.0, -1.0, 43.0, 43.0, -1.0, 43.0, 76.0, 54.0, 65.0, 65.0, 21.0, 65.0, 65.0, 21.0, 43.0, 21.0, 65.0, 43.0, -23.0, 21.0, 43.0, 65.0, 32.0, 21.0, 26.0, 54.0, -23.0, 32.0, -1.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23597789334005476, "mean_inference_ms": 24.50849425659768, "mean_action_processing_ms": 0.08808298000908737, "mean_env_wait_ms": 0.04120253518549998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005787372589111328, "StateBufferConnector_ms": 0.0050106048583984375, "ViewRequirementAgentConnector_ms": 0.11522030830383301}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 19.99, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -1.0, -45.0, -1.0, -12.0, -67.0, -12.0, -34.0, 65.0, 76.0, 21.0, 65.0, 43.0, 32.0, 43.0, 32.0, 21.0, 43.0, -34.0, -1.0, 43.0, 43.0, 10.0, -12.0, 32.0, 43.0, 10.0, 76.0, 43.0, -12.0, -12.0, 21.0, 21.0, -56.0, -12.0, -23.0, 43.0, -12.0, 54.0, -12.0, -12.0, 21.0, 48.0, -18.0, -1.0, 32.0, 10.0, 65.0, 54.0, -1.0, 10.0, 65.0, 65.0, 21.0, -1.0, 21.0, -1.0, -12.0, -1.0, -1.0, -23.0, -56.0, 43.0, 21.0, 43.0, 65.0, 21.0, 54.0, 10.0, -29.0, -12.0, -1.0, 43.0, 43.0, -1.0, 43.0, 76.0, 54.0, 65.0, 65.0, 21.0, 65.0, 65.0, 21.0, 43.0, 21.0, 65.0, 43.0, -23.0, 21.0, 43.0, 65.0, 32.0, 21.0, 26.0, 54.0, -23.0, 32.0, -1.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23597789334005476, "mean_inference_ms": 24.50849425659768, "mean_action_processing_ms": 0.08808298000908737, "mean_env_wait_ms": 0.04120253518549998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005787372589111328, "StateBufferConnector_ms": 0.0050106048583984375, "ViewRequirementAgentConnector_ms": 0.11522030830383301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 180634.051, "sample_time_ms": 99547.896, "learn_time_ms": 81074.954, "learn_throughput": 49.337, "synch_weights_time_ms": 10.393}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1473, "training_iteration": 28, "trial_id": "38794_00007", "date": "2023-06-02_05-58-41", "timestamp": 1685674721, "time_this_iter_s": 201.49350714683533, "time_total_s": 5575.604293346405, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5575.604293346405, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 27.511999999999997, "ram_util_percent": 60.48981818181819}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -67.0, "episode_reward_mean": 1.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, 54.0, -56.0, -67.0, -1.0, -23.0, 54.0, 43.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21865405640905639, "mean_inference_ms": 24.31336325832409, "mean_action_processing_ms": 0.08619323269402848, "mean_env_wait_ms": 0.040570370250234786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004479885101318359, "StateBufferConnector_ms": 0.005667209625244141, "ViewRequirementAgentConnector_ms": 0.11499404907226562}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.104230880737305, "policy_loss": -0.03606194257736206, "vf_loss": 6.066555023193359, "vf_explained_var": -0.2030528038740158, "kl": 0.009590416215360165, "entropy": 2.903202533721924, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29130.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 14.66, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -1.0, 21.0, -1.0, -12.0, -1.0, -1.0, -23.0, -56.0, 43.0, 21.0, 43.0, 65.0, 21.0, 54.0, 10.0, -29.0, -12.0, -1.0, 43.0, 43.0, -1.0, 43.0, 76.0, 54.0, 65.0, 65.0, 21.0, 65.0, 65.0, 21.0, 43.0, 21.0, 65.0, 43.0, -23.0, 21.0, 43.0, 65.0, 32.0, 21.0, 26.0, 54.0, -23.0, 32.0, -1.0, -23.0, -34.0, 43.0, 4.0, -1.0, 10.0, -12.0, -12.0, -12.0, -12.0, 21.0, -45.0, -12.0, 54.0, -23.0, -56.0, -23.0, 54.0, -23.0, 21.0, 10.0, 10.0, 54.0, 43.0, 76.0, 54.0, 54.0, 32.0, -45.0, 32.0, 10.0, 21.0, -12.0, -23.0, -45.0, 10.0, 43.0, -34.0, -1.0, 10.0, 21.0, 54.0, 32.0, 10.0, 21.0, -1.0, 32.0, -34.0, -45.0, 21.0, -23.0, -23.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.235952027344239, "mean_inference_ms": 24.508116467569163, "mean_action_processing_ms": 0.08807959960433369, "mean_env_wait_ms": 0.04119909392343671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005796909332275391, "StateBufferConnector_ms": 0.005164146423339844, "ViewRequirementAgentConnector_ms": 0.11597323417663574}}, "episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 14.66, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -1.0, 21.0, -1.0, -12.0, -1.0, -1.0, -23.0, -56.0, 43.0, 21.0, 43.0, 65.0, 21.0, 54.0, 10.0, -29.0, -12.0, -1.0, 43.0, 43.0, -1.0, 43.0, 76.0, 54.0, 65.0, 65.0, 21.0, 65.0, 65.0, 21.0, 43.0, 21.0, 65.0, 43.0, -23.0, 21.0, 43.0, 65.0, 32.0, 21.0, 26.0, 54.0, -23.0, 32.0, -1.0, -23.0, -34.0, 43.0, 4.0, -1.0, 10.0, -12.0, -12.0, -12.0, -12.0, 21.0, -45.0, -12.0, 54.0, -23.0, -56.0, -23.0, 54.0, -23.0, 21.0, 10.0, 10.0, 54.0, 43.0, 76.0, 54.0, 54.0, 32.0, -45.0, 32.0, 10.0, 21.0, -12.0, -23.0, -45.0, 10.0, 43.0, -34.0, -1.0, 10.0, 21.0, 54.0, 32.0, 10.0, 21.0, -1.0, 32.0, -34.0, -45.0, 21.0, -23.0, -23.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.235952027344239, "mean_inference_ms": 24.508116467569163, "mean_action_processing_ms": 0.08807959960433369, "mean_env_wait_ms": 0.04119909392343671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005796909332275391, "StateBufferConnector_ms": 0.005164146423339844, "ViewRequirementAgentConnector_ms": 0.11597323417663574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 180688.627, "sample_time_ms": 99546.13, "learn_time_ms": 81131.333, "learn_throughput": 49.303, "synch_weights_time_ms": 10.364}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1526, "training_iteration": 29, "trial_id": "38794_00007", "date": "2023-06-02_06-02-00", "timestamp": 1685674920, "time_this_iter_s": 199.60879683494568, "time_total_s": 5775.213090181351, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5775.213090181351, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 26.360885608856087, "ram_util_percent": 60.56900369003689}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -100.0, "episode_reward_mean": 13.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 43.0, -1.0, 10.0, 43.0, 43.0, 32.0, -1.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21867694355334052, "mean_inference_ms": 24.32457499690006, "mean_action_processing_ms": 0.08619478368836533, "mean_env_wait_ms": 0.040573831409912595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047397613525390625, "StateBufferConnector_ms": 0.005819797515869141, "ViewRequirementAgentConnector_ms": 0.1187896728515625}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.558882713317871, "policy_loss": -0.01133692730218172, "vf_loss": 5.502152919769287, "vf_explained_var": -0.005845627281814814, "kl": 0.008852879516780376, "entropy": 2.8794515132904053, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30150.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 8.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, -12.0, -12.0, 21.0, -45.0, -12.0, 54.0, -23.0, -56.0, -23.0, 54.0, -23.0, 21.0, 10.0, 10.0, 54.0, 43.0, 76.0, 54.0, 54.0, 32.0, -45.0, 32.0, 10.0, 21.0, -12.0, -23.0, -45.0, 10.0, 43.0, -34.0, -1.0, 10.0, 21.0, 54.0, 32.0, 10.0, 21.0, -1.0, 32.0, -34.0, -45.0, 21.0, -23.0, -23.0, 21.0, 21.0, -1.0, 54.0, 43.0, 10.0, 21.0, -12.0, -1.0, 21.0, 37.0, 76.0, 65.0, 65.0, 10.0, 32.0, 21.0, 43.0, 32.0, 32.0, 32.0, 21.0, -67.0, -45.0, -1.0, 43.0, 65.0, 32.0, 32.0, 32.0, 10.0, -1.0, 10.0, -34.0, -34.0, -34.0, 21.0, -1.0, 32.0, -111.0, -133.0, -56.0, -34.0, 10.0, 21.0, 43.0, 43.0, 76.0, -1.0, -23.0, -23.0, 10.0, 32.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23590389764354966, "mean_inference_ms": 24.511566224873672, "mean_action_processing_ms": 0.08806960264484495, "mean_env_wait_ms": 0.041196413175695855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005836009979248047, "StateBufferConnector_ms": 0.00504755973815918, "ViewRequirementAgentConnector_ms": 0.115264892578125}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 8.4, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, -12.0, -12.0, 21.0, -45.0, -12.0, 54.0, -23.0, -56.0, -23.0, 54.0, -23.0, 21.0, 10.0, 10.0, 54.0, 43.0, 76.0, 54.0, 54.0, 32.0, -45.0, 32.0, 10.0, 21.0, -12.0, -23.0, -45.0, 10.0, 43.0, -34.0, -1.0, 10.0, 21.0, 54.0, 32.0, 10.0, 21.0, -1.0, 32.0, -34.0, -45.0, 21.0, -23.0, -23.0, 21.0, 21.0, -1.0, 54.0, 43.0, 10.0, 21.0, -12.0, -1.0, 21.0, 37.0, 76.0, 65.0, 65.0, 10.0, 32.0, 21.0, 43.0, 32.0, 32.0, 32.0, 21.0, -67.0, -45.0, -1.0, 43.0, 65.0, 32.0, 32.0, 32.0, 10.0, -1.0, 10.0, -34.0, -34.0, -34.0, 21.0, -1.0, 32.0, -111.0, -133.0, -56.0, -34.0, 10.0, 21.0, 43.0, 43.0, 76.0, -1.0, -23.0, -23.0, 10.0, 32.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23590389764354966, "mean_inference_ms": 24.511566224873672, "mean_action_processing_ms": 0.08806960264484495, "mean_env_wait_ms": 0.041196413175695855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005836009979248047, "StateBufferConnector_ms": 0.00504755973815918, "ViewRequirementAgentConnector_ms": 0.115264892578125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 180806.488, "sample_time_ms": 99612.531, "learn_time_ms": 81182.703, "learn_throughput": 49.272, "synch_weights_time_ms": 10.452}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1578, "training_iteration": 30, "trial_id": "38794_00007", "date": "2023-06-02_06-05-21", "timestamp": 1685675121, "time_this_iter_s": 200.44757103919983, "time_total_s": 5975.6606612205505, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5975.6606612205505, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 26.84065934065934, "ram_util_percent": 60.70805860805862}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -155.0, "episode_reward_mean": -12.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 65.0, -62.0, 21.0, -34.0, -155.0, 10.0, 10.0, -34.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21868969213122152, "mean_inference_ms": 24.3295130647305, "mean_action_processing_ms": 0.08619936145701355, "mean_env_wait_ms": 0.04057259659001937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004861354827880859, "StateBufferConnector_ms": 0.0056171417236328125, "ViewRequirementAgentConnector_ms": 0.11605024337768555}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.256297588348389, "policy_loss": -0.0014962509740144014, "vf_loss": 5.183322429656982, "vf_explained_var": -0.12369832396507263, "kl": 0.009685864672064781, "entropy": 2.884974241256714, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31170.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 14.67, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -1.0, 21.0, 37.0, 76.0, 65.0, 65.0, 10.0, 32.0, 21.0, 43.0, 32.0, 32.0, 32.0, 21.0, -67.0, -45.0, -1.0, 43.0, 65.0, 32.0, 32.0, 32.0, 10.0, -1.0, 10.0, -34.0, -34.0, -34.0, 21.0, -1.0, 32.0, -111.0, -133.0, -56.0, -34.0, 10.0, 21.0, 43.0, 43.0, 76.0, -1.0, -23.0, -23.0, 10.0, 32.0, -1.0, 32.0, -56.0, -45.0, -12.0, 10.0, -12.0, -34.0, 43.0, -34.0, 43.0, 32.0, 21.0, 54.0, 21.0, 32.0, 32.0, 32.0, 10.0, -12.0, 21.0, 54.0, 76.0, 54.0, 65.0, 32.0, 43.0, 43.0, -1.0, -67.0, 32.0, -45.0, 10.0, -34.0, -67.0, 21.0, -34.0, 32.0, -67.0, 54.0, 10.0, 43.0, 54.0, 43.0, 43.0, 54.0, 54.0, 65.0, 65.0, 32.0, 54.0, 43.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2358551622822678, "mean_inference_ms": 24.51484571819903, "mean_action_processing_ms": 0.08805913751457842, "mean_env_wait_ms": 0.04119034358299644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005808115005493164, "StateBufferConnector_ms": 0.00485539436340332, "ViewRequirementAgentConnector_ms": 0.11393022537231445}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 14.67, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -1.0, 21.0, 37.0, 76.0, 65.0, 65.0, 10.0, 32.0, 21.0, 43.0, 32.0, 32.0, 32.0, 21.0, -67.0, -45.0, -1.0, 43.0, 65.0, 32.0, 32.0, 32.0, 10.0, -1.0, 10.0, -34.0, -34.0, -34.0, 21.0, -1.0, 32.0, -111.0, -133.0, -56.0, -34.0, 10.0, 21.0, 43.0, 43.0, 76.0, -1.0, -23.0, -23.0, 10.0, 32.0, -1.0, 32.0, -56.0, -45.0, -12.0, 10.0, -12.0, -34.0, 43.0, -34.0, 43.0, 32.0, 21.0, 54.0, 21.0, 32.0, 32.0, 32.0, 10.0, -12.0, 21.0, 54.0, 76.0, 54.0, 65.0, 32.0, 43.0, 43.0, -1.0, -67.0, 32.0, -45.0, 10.0, -34.0, -67.0, 21.0, -34.0, 32.0, -67.0, 54.0, 10.0, 43.0, 54.0, 43.0, 43.0, 54.0, 54.0, 65.0, 65.0, 32.0, 54.0, 43.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2358551622822678, "mean_inference_ms": 24.51484571819903, "mean_action_processing_ms": 0.08805913751457842, "mean_env_wait_ms": 0.04119034358299644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005808115005493164, "StateBufferConnector_ms": 0.00485539436340332, "ViewRequirementAgentConnector_ms": 0.11393022537231445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 180823.478, "sample_time_ms": 99628.37, "learn_time_ms": 81184.084, "learn_throughput": 49.271, "synch_weights_time_ms": 10.235}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1631, "training_iteration": 31, "trial_id": "38794_00007", "date": "2023-06-02_06-08-40", "timestamp": 1685675320, "time_this_iter_s": 199.769944190979, "time_total_s": 6175.4306054115295, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6175.4306054115295, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 26.765441176470585, "ram_util_percent": 60.8172794117647}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 13.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 10.0, 32.0, 43.0, -12.0, -45.0, 54.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21864800198112172, "mean_inference_ms": 24.3158223210312, "mean_action_processing_ms": 0.08617203847627039, "mean_env_wait_ms": 0.040578222613963814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050449371337890625, "StateBufferConnector_ms": 0.005514621734619141, "ViewRequirementAgentConnector_ms": 0.11492013931274414}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.849191188812256, "policy_loss": -0.028804929926991463, "vf_loss": 5.818852424621582, "vf_explained_var": -0.1853882372379303, "kl": 0.007692380342632532, "entropy": 2.885725259780884, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32190.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 17.81, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 43.0, -34.0, 43.0, 32.0, 21.0, 54.0, 21.0, 32.0, 32.0, 32.0, 10.0, -12.0, 21.0, 54.0, 76.0, 54.0, 65.0, 32.0, 43.0, 43.0, -1.0, -67.0, 32.0, -45.0, 10.0, -34.0, -67.0, 21.0, -34.0, 32.0, -67.0, 54.0, 10.0, 43.0, 54.0, 43.0, 43.0, 54.0, 54.0, 65.0, 65.0, 32.0, 54.0, 43.0, 65.0, 76.0, 65.0, 65.0, 21.0, 21.0, -1.0, 32.0, 76.0, 76.0, 65.0, 32.0, -12.0, 32.0, -12.0, 65.0, 65.0, -1.0, 21.0, 43.0, 54.0, 43.0, 10.0, -1.0, 10.0, -23.0, -56.0, 10.0, 32.0, -34.0, -12.0, 21.0, 10.0, -78.0, -56.0, -23.0, -45.0, -12.0, 21.0, -34.0, -1.0, 32.0, 32.0, 65.0, 65.0, 65.0, 10.0, -12.0, -56.0, -23.0, -34.0, 21.0, 21.0, -12.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23583124332355973, "mean_inference_ms": 24.514945891248836, "mean_action_processing_ms": 0.08805010660504486, "mean_env_wait_ms": 0.04118580060553951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005880832672119141, "StateBufferConnector_ms": 0.0048732757568359375, "ViewRequirementAgentConnector_ms": 0.11448788642883301}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 17.81, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, 43.0, -34.0, 43.0, 32.0, 21.0, 54.0, 21.0, 32.0, 32.0, 32.0, 10.0, -12.0, 21.0, 54.0, 76.0, 54.0, 65.0, 32.0, 43.0, 43.0, -1.0, -67.0, 32.0, -45.0, 10.0, -34.0, -67.0, 21.0, -34.0, 32.0, -67.0, 54.0, 10.0, 43.0, 54.0, 43.0, 43.0, 54.0, 54.0, 65.0, 65.0, 32.0, 54.0, 43.0, 65.0, 76.0, 65.0, 65.0, 21.0, 21.0, -1.0, 32.0, 76.0, 76.0, 65.0, 32.0, -12.0, 32.0, -12.0, 65.0, 65.0, -1.0, 21.0, 43.0, 54.0, 43.0, 10.0, -1.0, 10.0, -23.0, -56.0, 10.0, 32.0, -34.0, -12.0, 21.0, 10.0, -78.0, -56.0, -23.0, -45.0, -12.0, 21.0, -34.0, -1.0, 32.0, 32.0, 65.0, 65.0, 65.0, 10.0, -12.0, -56.0, -23.0, -34.0, 21.0, 21.0, -12.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23583124332355973, "mean_inference_ms": 24.514945891248836, "mean_action_processing_ms": 0.08805010660504486, "mean_env_wait_ms": 0.04118580060553951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005880832672119141, "StateBufferConnector_ms": 0.0048732757568359375, "ViewRequirementAgentConnector_ms": 0.11448788642883301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 180843.73, "sample_time_ms": 99633.127, "learn_time_ms": 81199.568, "learn_throughput": 49.261, "synch_weights_time_ms": 10.243}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1684, "training_iteration": 32, "trial_id": "38794_00007", "date": "2023-06-02_06-11-59", "timestamp": 1685675519, "time_this_iter_s": 198.76782393455505, "time_total_s": 6374.198429346085, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6374.198429346085, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 28.80888888888889, "ram_util_percent": 60.83703703703702}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 21.0, "episode_reward_mean": 51.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 21.0, 43.0, 32.0, 43.0, 76.0, 65.0, 54.0, 54.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21870598915276224, "mean_inference_ms": 24.321448170327425, "mean_action_processing_ms": 0.08617219901732254, "mean_env_wait_ms": 0.04058307040693525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005125999450683594, "StateBufferConnector_ms": 0.005970001220703125, "ViewRequirementAgentConnector_ms": 0.11563539505004883}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.866978645324707, "policy_loss": -0.03017462231218815, "vf_loss": 5.840256214141846, "vf_explained_var": -0.08529756963253021, "kl": 0.007400010712444782, "entropy": 2.8983287811279297, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33210.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 10.44, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 76.0, 76.0, 65.0, 32.0, -12.0, 32.0, -12.0, 65.0, 65.0, -1.0, 21.0, 43.0, 54.0, 43.0, 10.0, -1.0, 10.0, -23.0, -56.0, 10.0, 32.0, -34.0, -12.0, 21.0, 10.0, -78.0, -56.0, -23.0, -45.0, -12.0, 21.0, -34.0, -1.0, 32.0, 32.0, 65.0, 65.0, 65.0, 10.0, -12.0, -56.0, -23.0, -34.0, 21.0, 21.0, -12.0, -45.0, 32.0, 10.0, 10.0, -34.0, -1.0, 21.0, -23.0, 10.0, -1.0, 65.0, 43.0, 43.0, 43.0, 76.0, 10.0, 43.0, 43.0, -12.0, 21.0, 32.0, -12.0, -1.0, 10.0, -45.0, 10.0, -78.0, -1.0, -34.0, -23.0, 43.0, 10.0, 21.0, -67.0, 10.0, -34.0, -45.0, 32.0, 10.0, -12.0, 10.0, 76.0, 32.0, 65.0, 10.0, 32.0, 43.0, 21.0, 54.0, -12.0, 21.0, 43.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2358169177904706, "mean_inference_ms": 24.51452296411662, "mean_action_processing_ms": 0.08804343978515922, "mean_env_wait_ms": 0.04118583912728958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059664249420166016, "StateBufferConnector_ms": 0.0049550533294677734, "ViewRequirementAgentConnector_ms": 0.11543107032775879}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 10.44, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 76.0, 76.0, 65.0, 32.0, -12.0, 32.0, -12.0, 65.0, 65.0, -1.0, 21.0, 43.0, 54.0, 43.0, 10.0, -1.0, 10.0, -23.0, -56.0, 10.0, 32.0, -34.0, -12.0, 21.0, 10.0, -78.0, -56.0, -23.0, -45.0, -12.0, 21.0, -34.0, -1.0, 32.0, 32.0, 65.0, 65.0, 65.0, 10.0, -12.0, -56.0, -23.0, -34.0, 21.0, 21.0, -12.0, -45.0, 32.0, 10.0, 10.0, -34.0, -1.0, 21.0, -23.0, 10.0, -1.0, 65.0, 43.0, 43.0, 43.0, 76.0, 10.0, 43.0, 43.0, -12.0, 21.0, 32.0, -12.0, -1.0, 10.0, -45.0, 10.0, -78.0, -1.0, -34.0, -23.0, 43.0, 10.0, 21.0, -67.0, 10.0, -34.0, -45.0, 32.0, 10.0, -12.0, 10.0, 76.0, 32.0, 65.0, 10.0, 32.0, 43.0, 21.0, 54.0, -12.0, 21.0, 43.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2358169177904706, "mean_inference_ms": 24.51452296411662, "mean_action_processing_ms": 0.08804343978515922, "mean_env_wait_ms": 0.04118583912728958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059664249420166016, "StateBufferConnector_ms": 0.0049550533294677734, "ViewRequirementAgentConnector_ms": 0.11543107032775879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 180955.305, "sample_time_ms": 99646.966, "learn_time_ms": 81297.218, "learn_throughput": 49.202, "synch_weights_time_ms": 10.326}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1736, "training_iteration": 33, "trial_id": "38794_00007", "date": "2023-06-02_06-15-19", "timestamp": 1685675719, "time_this_iter_s": 199.85068106651306, "time_total_s": 6574.049110412598, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6574.049110412598, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 26.81139705882353, "ram_util_percent": 60.45073529411764}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 43.0, "episode_reward_mean": 57.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 65.0, 43.0, 76.0, 65.0, 54.0, 65.0, 43.0, 76.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2187267139016011, "mean_inference_ms": 24.331739925802143, "mean_action_processing_ms": 0.08617763682409298, "mean_env_wait_ms": 0.040580556422286314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004975795745849609, "StateBufferConnector_ms": 0.005588531494140625, "ViewRequirementAgentConnector_ms": 0.11444091796875}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.144415855407715, "policy_loss": -0.010893980041146278, "vf_loss": 5.103641033172607, "vf_explained_var": 0.037240296602249146, "kl": 0.006720071658492088, "entropy": 2.8816537857055664, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34230.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 18.08, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -23.0, 10.0, -1.0, 65.0, 43.0, 43.0, 43.0, 76.0, 10.0, 43.0, 43.0, -12.0, 21.0, 32.0, -12.0, -1.0, 10.0, -45.0, 10.0, -78.0, -1.0, -34.0, -23.0, 43.0, 10.0, 21.0, -67.0, 10.0, -34.0, -45.0, 32.0, 10.0, -12.0, 10.0, 76.0, 32.0, 65.0, 10.0, 32.0, 43.0, 21.0, 54.0, -12.0, 21.0, 43.0, -23.0, -12.0, 54.0, -12.0, -34.0, 65.0, 32.0, -23.0, 21.0, -12.0, 10.0, 43.0, -23.0, 54.0, 10.0, -12.0, -1.0, -23.0, 10.0, 54.0, -23.0, 43.0, 32.0, 21.0, 76.0, 65.0, 76.0, 43.0, 76.0, 54.0, 76.0, 54.0, 65.0, 54.0, 54.0, 32.0, -67.0, 54.0, 65.0, 76.0, 65.0, -34.0, 21.0, -12.0, -1.0, -12.0, -12.0, 32.0, -1.0, -67.0, -1.0, 32.0, 43.0, 48.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23578216726830342, "mean_inference_ms": 24.514464243681967, "mean_action_processing_ms": 0.08803953141188689, "mean_env_wait_ms": 0.0411848403346346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005925416946411133, "StateBufferConnector_ms": 0.004933595657348633, "ViewRequirementAgentConnector_ms": 0.11491894721984863}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 18.08, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -23.0, 10.0, -1.0, 65.0, 43.0, 43.0, 43.0, 76.0, 10.0, 43.0, 43.0, -12.0, 21.0, 32.0, -12.0, -1.0, 10.0, -45.0, 10.0, -78.0, -1.0, -34.0, -23.0, 43.0, 10.0, 21.0, -67.0, 10.0, -34.0, -45.0, 32.0, 10.0, -12.0, 10.0, 76.0, 32.0, 65.0, 10.0, 32.0, 43.0, 21.0, 54.0, -12.0, 21.0, 43.0, -23.0, -12.0, 54.0, -12.0, -34.0, 65.0, 32.0, -23.0, 21.0, -12.0, 10.0, 43.0, -23.0, 54.0, 10.0, -12.0, -1.0, -23.0, 10.0, 54.0, -23.0, 43.0, 32.0, 21.0, 76.0, 65.0, 76.0, 43.0, 76.0, 54.0, 76.0, 54.0, 65.0, 54.0, 54.0, 32.0, -67.0, 54.0, 65.0, 76.0, 65.0, -34.0, 21.0, -12.0, -1.0, -12.0, -12.0, 32.0, -1.0, -67.0, -1.0, 32.0, 43.0, 48.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23578216726830342, "mean_inference_ms": 24.514464243681967, "mean_action_processing_ms": 0.08803953141188689, "mean_env_wait_ms": 0.0411848403346346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005925416946411133, "StateBufferConnector_ms": 0.004933595657348633, "ViewRequirementAgentConnector_ms": 0.11491894721984863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 180968.603, "sample_time_ms": 99628.398, "learn_time_ms": 81329.158, "learn_throughput": 49.183, "synch_weights_time_ms": 10.246}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1789, "training_iteration": 34, "trial_id": "38794_00007", "date": "2023-06-02_06-18-39", "timestamp": 1685675919, "time_this_iter_s": 200.09328317642212, "time_total_s": 6774.14239358902, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6774.14239358902, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 26.38450184501845, "ram_util_percent": 60.62583025830258}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -1.0, "episode_reward_mean": 46.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 76.0, 65.0, 65.0, 43.0, 10.0, 32.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21875844378744028, "mean_inference_ms": 24.33893045201919, "mean_action_processing_ms": 0.0861826025809136, "mean_env_wait_ms": 0.04058696960068337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004849433898925781, "StateBufferConnector_ms": 0.005514621734619141, "ViewRequirementAgentConnector_ms": 0.11589288711547852}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.613137722015381, "policy_loss": 0.006303740665316582, "vf_loss": 5.555555820465088, "vf_explained_var": -0.007101947907358408, "kl": 0.006669214460998774, "entropy": 2.9065680503845215, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35250.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 20.83, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, -12.0, 10.0, 43.0, -23.0, 54.0, 10.0, -12.0, -1.0, -23.0, 10.0, 54.0, -23.0, 43.0, 32.0, 21.0, 76.0, 65.0, 76.0, 43.0, 76.0, 54.0, 76.0, 54.0, 65.0, 54.0, 54.0, 32.0, -67.0, 54.0, 65.0, 76.0, 65.0, -34.0, 21.0, -12.0, -1.0, -12.0, -12.0, 32.0, -1.0, -67.0, -1.0, 32.0, 43.0, 48.0, 21.0, -12.0, 10.0, 10.0, -1.0, -12.0, -23.0, 10.0, -23.0, 21.0, 32.0, 54.0, -56.0, -1.0, -12.0, -67.0, -23.0, 32.0, -1.0, -12.0, 32.0, 32.0, 54.0, 54.0, 54.0, -12.0, -1.0, 10.0, 10.0, 54.0, 21.0, 43.0, 65.0, 10.0, 43.0, 76.0, 21.0, 10.0, 10.0, 65.0, 10.0, -1.0, -23.0, 54.0, 54.0, 32.0, 43.0, 32.0, -12.0, -1.0, 43.0, 65.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23574612463102698, "mean_inference_ms": 24.51451189863464, "mean_action_processing_ms": 0.08803533070097336, "mean_env_wait_ms": 0.0411819869401169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00580143928527832, "StateBufferConnector_ms": 0.004871368408203125, "ViewRequirementAgentConnector_ms": 0.11425399780273438}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 20.83, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, -12.0, 10.0, 43.0, -23.0, 54.0, 10.0, -12.0, -1.0, -23.0, 10.0, 54.0, -23.0, 43.0, 32.0, 21.0, 76.0, 65.0, 76.0, 43.0, 76.0, 54.0, 76.0, 54.0, 65.0, 54.0, 54.0, 32.0, -67.0, 54.0, 65.0, 76.0, 65.0, -34.0, 21.0, -12.0, -1.0, -12.0, -12.0, 32.0, -1.0, -67.0, -1.0, 32.0, 43.0, 48.0, 21.0, -12.0, 10.0, 10.0, -1.0, -12.0, -23.0, 10.0, -23.0, 21.0, 32.0, 54.0, -56.0, -1.0, -12.0, -67.0, -23.0, 32.0, -1.0, -12.0, 32.0, 32.0, 54.0, 54.0, 54.0, -12.0, -1.0, 10.0, 10.0, 54.0, 21.0, 43.0, 65.0, 10.0, 43.0, 76.0, 21.0, 10.0, 10.0, 65.0, 10.0, -1.0, -23.0, 54.0, 54.0, 32.0, 43.0, 32.0, -12.0, -1.0, 43.0, 65.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23574612463102698, "mean_inference_ms": 24.51451189863464, "mean_action_processing_ms": 0.08803533070097336, "mean_env_wait_ms": 0.0411819869401169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00580143928527832, "StateBufferConnector_ms": 0.004871368408203125, "ViewRequirementAgentConnector_ms": 0.11425399780273438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 180970.339, "sample_time_ms": 99586.553, "learn_time_ms": 81372.088, "learn_throughput": 49.157, "synch_weights_time_ms": 10.827}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1842, "training_iteration": 35, "trial_id": "38794_00007", "date": "2023-06-02_06-21-59", "timestamp": 1685676119, "time_this_iter_s": 199.80920505523682, "time_total_s": 6973.951598644257, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6973.951598644257, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 26.712546125461255, "ram_util_percent": 60.7819188191882}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 13.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, -34.0, 21.0, 43.0, 32.0, 65.0, -23.0, 10.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21879526002161084, "mean_inference_ms": 24.344136877796426, "mean_action_processing_ms": 0.08618881738933966, "mean_env_wait_ms": 0.04058798992173295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004689693450927734, "StateBufferConnector_ms": 0.005705356597900391, "ViewRequirementAgentConnector_ms": 0.11492729187011719}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.297119140625, "policy_loss": 0.000309939932776615, "vf_loss": 6.246013641357422, "vf_explained_var": -0.1264791190624237, "kl": 0.006606524810194969, "entropy": 2.8800599575042725, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36270.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 11.42, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -23.0, 10.0, -23.0, 21.0, 32.0, 54.0, -56.0, -1.0, -12.0, -67.0, -23.0, 32.0, -1.0, -12.0, 32.0, 32.0, 54.0, 54.0, 54.0, -12.0, -1.0, 10.0, 10.0, 54.0, 21.0, 43.0, 65.0, 10.0, 43.0, 76.0, 21.0, 10.0, 10.0, 65.0, 10.0, -1.0, -23.0, 54.0, 54.0, 32.0, 43.0, 32.0, -12.0, -1.0, 43.0, 65.0, 54.0, 10.0, -45.0, -100.0, -12.0, 54.0, 65.0, 65.0, 32.0, -29.0, -34.0, -1.0, -12.0, -12.0, -23.0, 32.0, -12.0, -23.0, -56.0, 54.0, 10.0, -23.0, -89.0, -45.0, -45.0, 10.0, -12.0, -1.0, 21.0, 65.0, 37.0, 10.0, 21.0, -1.0, -89.0, -1.0, 65.0, 54.0, -34.0, -1.0, 54.0, 21.0, -1.0, -1.0, 21.0, 21.0, 32.0, -45.0, 43.0, 54.0, 54.0, 32.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23572946981978504, "mean_inference_ms": 24.514459021036206, "mean_action_processing_ms": 0.08802738775186329, "mean_env_wait_ms": 0.041178867891093034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00573420524597168, "StateBufferConnector_ms": 0.0048978328704833984, "ViewRequirementAgentConnector_ms": 0.1147465705871582}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 11.42, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -23.0, 10.0, -23.0, 21.0, 32.0, 54.0, -56.0, -1.0, -12.0, -67.0, -23.0, 32.0, -1.0, -12.0, 32.0, 32.0, 54.0, 54.0, 54.0, -12.0, -1.0, 10.0, 10.0, 54.0, 21.0, 43.0, 65.0, 10.0, 43.0, 76.0, 21.0, 10.0, 10.0, 65.0, 10.0, -1.0, -23.0, 54.0, 54.0, 32.0, 43.0, 32.0, -12.0, -1.0, 43.0, 65.0, 54.0, 10.0, -45.0, -100.0, -12.0, 54.0, 65.0, 65.0, 32.0, -29.0, -34.0, -1.0, -12.0, -12.0, -23.0, 32.0, -12.0, -23.0, -56.0, 54.0, 10.0, -23.0, -89.0, -45.0, -45.0, 10.0, -12.0, -1.0, 21.0, 65.0, 37.0, 10.0, 21.0, -1.0, -89.0, -1.0, 65.0, 54.0, -34.0, -1.0, 54.0, 21.0, -1.0, -1.0, 21.0, 21.0, 32.0, -45.0, 43.0, 54.0, 54.0, 32.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23572946981978504, "mean_inference_ms": 24.514459021036206, "mean_action_processing_ms": 0.08802738775186329, "mean_env_wait_ms": 0.041178867891093034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00573420524597168, "StateBufferConnector_ms": 0.0048978328704833984, "ViewRequirementAgentConnector_ms": 0.1147465705871582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 180998.327, "sample_time_ms": 99591.324, "learn_time_ms": 81395.209, "learn_throughput": 49.143, "synch_weights_time_ms": 10.92}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1894, "training_iteration": 36, "trial_id": "38794_00007", "date": "2023-06-02_06-25-19", "timestamp": 1685676319, "time_this_iter_s": 199.89800310134888, "time_total_s": 7173.8496017456055, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7173.8496017456055, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 27.187084870848707, "ram_util_percent": 60.89889298892989}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -12.0, "episode_reward_mean": 48.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 76.0, 76.0, 21.0, 54.0, 76.0, 65.0, 10.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21887658131647822, "mean_inference_ms": 24.354120978021736, "mean_action_processing_ms": 0.08619585780270608, "mean_env_wait_ms": 0.04059056597131401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005016326904296875, "StateBufferConnector_ms": 0.005471706390380859, "ViewRequirementAgentConnector_ms": 0.1153874397277832}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.474776744842529, "policy_loss": -0.04241281375288963, "vf_loss": 5.467742919921875, "vf_explained_var": -0.12650804221630096, "kl": 0.006431184243410826, "entropy": 2.888397693634033, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37290.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 12.85, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 32.0, -29.0, -34.0, -1.0, -12.0, -12.0, -23.0, 32.0, -12.0, -23.0, -56.0, 54.0, 10.0, -23.0, -89.0, -45.0, -45.0, 10.0, -12.0, -1.0, 21.0, 65.0, 37.0, 10.0, 21.0, -1.0, -89.0, -1.0, 65.0, 54.0, -34.0, -1.0, 54.0, 21.0, -1.0, -1.0, 21.0, 21.0, 32.0, -45.0, 43.0, 54.0, 54.0, 32.0, 32.0, 54.0, 76.0, 54.0, -1.0, 32.0, -12.0, -12.0, -23.0, 32.0, -12.0, -1.0, -12.0, -12.0, 10.0, 32.0, 43.0, 43.0, 10.0, 43.0, 10.0, -34.0, -45.0, -1.0, -1.0, 32.0, 32.0, -1.0, -12.0, -12.0, 65.0, 76.0, 54.0, 21.0, 21.0, 54.0, 32.0, -1.0, -1.0, -23.0, 21.0, 43.0, -23.0, 54.0, 43.0, 43.0, 65.0, -1.0, 65.0, 54.0, 32.0, -45.0, 21.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23571790407246734, "mean_inference_ms": 24.513578611317588, "mean_action_processing_ms": 0.0880305368023588, "mean_env_wait_ms": 0.04117589699901982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005737781524658203, "StateBufferConnector_ms": 0.004926443099975586, "ViewRequirementAgentConnector_ms": 0.11494994163513184}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 12.85, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 32.0, -29.0, -34.0, -1.0, -12.0, -12.0, -23.0, 32.0, -12.0, -23.0, -56.0, 54.0, 10.0, -23.0, -89.0, -45.0, -45.0, 10.0, -12.0, -1.0, 21.0, 65.0, 37.0, 10.0, 21.0, -1.0, -89.0, -1.0, 65.0, 54.0, -34.0, -1.0, 54.0, 21.0, -1.0, -1.0, 21.0, 21.0, 32.0, -45.0, 43.0, 54.0, 54.0, 32.0, 32.0, 54.0, 76.0, 54.0, -1.0, 32.0, -12.0, -12.0, -23.0, 32.0, -12.0, -1.0, -12.0, -12.0, 10.0, 32.0, 43.0, 43.0, 10.0, 43.0, 10.0, -34.0, -45.0, -1.0, -1.0, 32.0, 32.0, -1.0, -12.0, -12.0, 65.0, 76.0, 54.0, 21.0, 21.0, 54.0, 32.0, -1.0, -1.0, -23.0, 21.0, 43.0, -23.0, 54.0, 43.0, 43.0, 65.0, -1.0, 65.0, 54.0, 32.0, -45.0, 21.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23571790407246734, "mean_inference_ms": 24.513578611317588, "mean_action_processing_ms": 0.0880305368023588, "mean_env_wait_ms": 0.04117589699901982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005737781524658203, "StateBufferConnector_ms": 0.004926443099975586, "ViewRequirementAgentConnector_ms": 0.11494994163513184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 181024.444, "sample_time_ms": 99592.311, "learn_time_ms": 81420.469, "learn_throughput": 49.128, "synch_weights_time_ms": 10.793}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1947, "training_iteration": 37, "trial_id": "38794_00007", "date": "2023-06-02_06-28-39", "timestamp": 1685676519, "time_this_iter_s": 199.8433768749237, "time_total_s": 7373.692978620529, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7373.692978620529, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 26.834926470588236, "ram_util_percent": 61.23455882352941}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -67.0, "episode_reward_mean": 38.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 54.0, 54.0, 21.0, 54.0, 65.0, 54.0, 32.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2189705706275049, "mean_inference_ms": 24.358724756116363, "mean_action_processing_ms": 0.08623156123724156, "mean_env_wait_ms": 0.040601377222025434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048732757568359375, "StateBufferConnector_ms": 0.006392002105712891, "ViewRequirementAgentConnector_ms": 0.11760473251342773}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.195858001708984, "policy_loss": -0.012933951802551746, "vf_loss": 5.160089015960693, "vf_explained_var": 0.04123460873961449, "kl": 0.006334300152957439, "entropy": 2.9163215160369873, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38310.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -23.0, 32.0, -12.0, -1.0, -12.0, -12.0, 10.0, 32.0, 43.0, 43.0, 10.0, 43.0, 10.0, -34.0, -45.0, -1.0, -1.0, 32.0, 32.0, -1.0, -12.0, -12.0, 65.0, 76.0, 54.0, 21.0, 21.0, 54.0, 32.0, -1.0, -1.0, -23.0, 21.0, 43.0, -23.0, 54.0, 43.0, 43.0, 65.0, -1.0, 65.0, 54.0, 32.0, -45.0, 21.0, -12.0, 10.0, -12.0, -23.0, 43.0, 21.0, -34.0, -89.0, -12.0, -1.0, 10.0, 65.0, 76.0, 43.0, 21.0, -12.0, -34.0, 32.0, -23.0, 21.0, 32.0, 43.0, 65.0, -1.0, 10.0, 76.0, 65.0, -12.0, 76.0, 76.0, 21.0, 54.0, 10.0, 54.0, 32.0, 54.0, 76.0, 54.0, 43.0, 54.0, 21.0, 43.0, 43.0, 76.0, 54.0, 21.0, -1.0, 43.0, 65.0, 21.0, 21.0, -1.0, -34.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23566652125570683, "mean_inference_ms": 24.51289490035304, "mean_action_processing_ms": 0.08803968942499357, "mean_env_wait_ms": 0.04117408329808017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058536529541015625, "StateBufferConnector_ms": 0.005052804946899414, "ViewRequirementAgentConnector_ms": 0.11579108238220215}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -23.0, 32.0, -12.0, -1.0, -12.0, -12.0, 10.0, 32.0, 43.0, 43.0, 10.0, 43.0, 10.0, -34.0, -45.0, -1.0, -1.0, 32.0, 32.0, -1.0, -12.0, -12.0, 65.0, 76.0, 54.0, 21.0, 21.0, 54.0, 32.0, -1.0, -1.0, -23.0, 21.0, 43.0, -23.0, 54.0, 43.0, 43.0, 65.0, -1.0, 65.0, 54.0, 32.0, -45.0, 21.0, -12.0, 10.0, -12.0, -23.0, 43.0, 21.0, -34.0, -89.0, -12.0, -1.0, 10.0, 65.0, 76.0, 43.0, 21.0, -12.0, -34.0, 32.0, -23.0, 21.0, 32.0, 43.0, 65.0, -1.0, 10.0, 76.0, 65.0, -12.0, 76.0, 76.0, 21.0, 54.0, 10.0, 54.0, 32.0, 54.0, 76.0, 54.0, 43.0, 54.0, 21.0, 43.0, 43.0, 76.0, 54.0, 21.0, -1.0, 43.0, 65.0, 21.0, 21.0, -1.0, -34.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23566652125570683, "mean_inference_ms": 24.51289490035304, "mean_action_processing_ms": 0.08803968942499357, "mean_env_wait_ms": 0.04117408329808017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058536529541015625, "StateBufferConnector_ms": 0.005052804946899414, "ViewRequirementAgentConnector_ms": 0.11579108238220215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 180855.343, "sample_time_ms": 99614.626, "learn_time_ms": 81229.204, "learn_throughput": 49.243, "synch_weights_time_ms": 10.642}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2000, "training_iteration": 38, "trial_id": "38794_00007", "date": "2023-06-02_06-31-59", "timestamp": 1685676719, "time_this_iter_s": 199.84777283668518, "time_total_s": 7573.540751457214, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7573.540751457214, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 26.75940959409594, "ram_util_percent": 61.22509225092252}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -12.0, "episode_reward_mean": 30.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -1.0, 4.0, 21.0, 54.0, 65.0, 32.0, 43.0, 76.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21898798371313685, "mean_inference_ms": 24.366256634976146, "mean_action_processing_ms": 0.0862291895954326, "mean_env_wait_ms": 0.04060153942520627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004410743713378906, "StateBufferConnector_ms": 0.005381107330322266, "ViewRequirementAgentConnector_ms": 0.11371374130249023}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.313401699066162, "policy_loss": -0.003181290114298463, "vf_loss": 6.26726770401001, "vf_explained_var": -0.10702777653932571, "kl": 0.006414005998522043, "entropy": 2.907855272293091, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39330.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 11.21, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -89.0, -12.0, -1.0, 10.0, 65.0, 76.0, 43.0, 21.0, -12.0, -34.0, 32.0, -23.0, 21.0, 32.0, 43.0, 65.0, -1.0, 10.0, 76.0, 65.0, -12.0, 76.0, 76.0, 21.0, 54.0, 10.0, 54.0, 32.0, 54.0, 76.0, 54.0, 43.0, 54.0, 21.0, 43.0, 43.0, 76.0, 54.0, 21.0, -1.0, 43.0, 65.0, 21.0, 21.0, -1.0, -34.0, -23.0, 32.0, 21.0, 65.0, 76.0, -34.0, -23.0, 10.0, -45.0, -23.0, -34.0, 10.0, -34.0, -78.0, 21.0, 21.0, 21.0, 21.0, 54.0, 21.0, -23.0, 10.0, -1.0, 54.0, 43.0, 54.0, 21.0, -34.0, 10.0, 10.0, -78.0, 54.0, -34.0, -1.0, 21.0, -45.0, -155.0, -23.0, -12.0, -56.0, -56.0, 21.0, -56.0, 65.0, -45.0, -56.0, -1.0, 65.0, -1.0, 10.0, -1.0, -34.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23562444651832162, "mean_inference_ms": 24.51242152857127, "mean_action_processing_ms": 0.08804157014044899, "mean_env_wait_ms": 0.04117224394263823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059359073638916016, "StateBufferConnector_ms": 0.005189418792724609, "ViewRequirementAgentConnector_ms": 0.11724090576171875}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 11.21, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -89.0, -12.0, -1.0, 10.0, 65.0, 76.0, 43.0, 21.0, -12.0, -34.0, 32.0, -23.0, 21.0, 32.0, 43.0, 65.0, -1.0, 10.0, 76.0, 65.0, -12.0, 76.0, 76.0, 21.0, 54.0, 10.0, 54.0, 32.0, 54.0, 76.0, 54.0, 43.0, 54.0, 21.0, 43.0, 43.0, 76.0, 54.0, 21.0, -1.0, 43.0, 65.0, 21.0, 21.0, -1.0, -34.0, -23.0, 32.0, 21.0, 65.0, 76.0, -34.0, -23.0, 10.0, -45.0, -23.0, -34.0, 10.0, -34.0, -78.0, 21.0, 21.0, 21.0, 21.0, 54.0, 21.0, -23.0, 10.0, -1.0, 54.0, 43.0, 54.0, 21.0, -34.0, 10.0, 10.0, -78.0, 54.0, -34.0, -1.0, 21.0, -45.0, -155.0, -23.0, -12.0, -56.0, -56.0, 21.0, -56.0, 65.0, -45.0, -56.0, -1.0, 65.0, -1.0, 10.0, -1.0, -34.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23562444651832162, "mean_inference_ms": 24.51242152857127, "mean_action_processing_ms": 0.08804157014044899, "mean_env_wait_ms": 0.04117224394263823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059359073638916016, "StateBufferConnector_ms": 0.005189418792724609, "ViewRequirementAgentConnector_ms": 0.11724090576171875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 180886.992, "sample_time_ms": 99590.319, "learn_time_ms": 81285.058, "learn_throughput": 49.21, "synch_weights_time_ms": 10.75}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 2052, "training_iteration": 39, "trial_id": "38794_00007", "date": "2023-06-02_06-35-19", "timestamp": 1685676919, "time_this_iter_s": 200.16629099845886, "time_total_s": 7773.707042455673, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7773.707042455673, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 26.814760147601472, "ram_util_percent": 61.35756457564576}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": 10.0, "episode_reward_mean": 41.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 32.0, 32.0, 54.0, 65.0, 65.0, 65.0, 43.0, 21.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21905311804563404, "mean_inference_ms": 24.3705416003331, "mean_action_processing_ms": 0.08625640849063931, "mean_env_wait_ms": 0.04061078292782937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004951953887939453, "StateBufferConnector_ms": 0.005958080291748047, "ViewRequirementAgentConnector_ms": 0.11679410934448242}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 6.089524269104004, "policy_loss": -0.04746294394135475, "vf_loss": 6.090887069702148, "vf_explained_var": -0.30242598056793213, "kl": 0.005995882675051689, "entropy": 2.887075185775757, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40350.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -0.29, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 10.0, -45.0, -23.0, -34.0, 10.0, -34.0, -78.0, 21.0, 21.0, 21.0, 21.0, 54.0, 21.0, -23.0, 10.0, -1.0, 54.0, 43.0, 54.0, 21.0, -34.0, 10.0, 10.0, -78.0, 54.0, -34.0, -1.0, 21.0, -45.0, -155.0, -23.0, -12.0, -56.0, -56.0, 21.0, -56.0, 65.0, -45.0, -56.0, -1.0, 65.0, -1.0, 10.0, -1.0, -34.0, -1.0, -34.0, -100.0, 43.0, 10.0, -1.0, -23.0, 54.0, -67.0, 32.0, -45.0, 32.0, 54.0, 32.0, -34.0, -23.0, -1.0, 10.0, 10.0, 54.0, 21.0, 32.0, 10.0, 10.0, 65.0, 76.0, 54.0, 54.0, 43.0, 65.0, 76.0, -12.0, -1.0, -1.0, 10.0, -56.0, -56.0, 54.0, -18.0, 32.0, 32.0, 32.0, 32.0, -12.0, 10.0, 10.0, 43.0, -23.0, -56.0, -67.0, -67.0, -1.0, -56.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2356165095871586, "mean_inference_ms": 24.51249765719716, "mean_action_processing_ms": 0.08803939807584615, "mean_env_wait_ms": 0.04116859759724106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058057308197021484, "StateBufferConnector_ms": 0.0052318572998046875, "ViewRequirementAgentConnector_ms": 0.11721420288085938}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": -0.29, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 10.0, -45.0, -23.0, -34.0, 10.0, -34.0, -78.0, 21.0, 21.0, 21.0, 21.0, 54.0, 21.0, -23.0, 10.0, -1.0, 54.0, 43.0, 54.0, 21.0, -34.0, 10.0, 10.0, -78.0, 54.0, -34.0, -1.0, 21.0, -45.0, -155.0, -23.0, -12.0, -56.0, -56.0, 21.0, -56.0, 65.0, -45.0, -56.0, -1.0, 65.0, -1.0, 10.0, -1.0, -34.0, -1.0, -34.0, -100.0, 43.0, 10.0, -1.0, -23.0, 54.0, -67.0, 32.0, -45.0, 32.0, 54.0, 32.0, -34.0, -23.0, -1.0, 10.0, 10.0, 54.0, 21.0, 32.0, 10.0, 10.0, 65.0, 76.0, 54.0, 54.0, 43.0, 65.0, 76.0, -12.0, -1.0, -1.0, 10.0, -56.0, -56.0, 54.0, -18.0, 32.0, 32.0, 32.0, 32.0, -12.0, 10.0, 10.0, 43.0, -23.0, -56.0, -67.0, -67.0, -1.0, -56.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2356165095871586, "mean_inference_ms": 24.51249765719716, "mean_action_processing_ms": 0.08803939807584615, "mean_env_wait_ms": 0.04116859759724106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058057308197021484, "StateBufferConnector_ms": 0.0052318572998046875, "ViewRequirementAgentConnector_ms": 0.11721420288085938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 180885.177, "sample_time_ms": 99539.603, "learn_time_ms": 81334.066, "learn_throughput": 49.18, "synch_weights_time_ms": 10.64}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2105, "training_iteration": 40, "trial_id": "38794_00007", "date": "2023-06-02_06-38-39", "timestamp": 1685677119, "time_this_iter_s": 200.3633050918579, "time_total_s": 7974.070347547531, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7974.070347547531, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 27.303676470588236, "ram_util_percent": 61.57426470588236}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -78.0, "episode_reward_mean": -2.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -45.0, -23.0, 43.0, 54.0, 21.0, 54.0, 10.0, -23.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21905835696038883, "mean_inference_ms": 24.37773394625207, "mean_action_processing_ms": 0.08626260552700575, "mean_env_wait_ms": 0.04061113628518318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004804134368896484, "StateBufferConnector_ms": 0.005528926849365234, "ViewRequirementAgentConnector_ms": 0.11500120162963867}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.722968578338623, "policy_loss": -0.027729757130146027, "vf_loss": 5.706961631774902, "vf_explained_var": -0.110125333070755, "kl": 0.0056883804500103, "entropy": 2.8945629596710205, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41370.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 5.87, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 54.0, -67.0, 32.0, -45.0, 32.0, 54.0, 32.0, -34.0, -23.0, -1.0, 10.0, 10.0, 54.0, 21.0, 32.0, 10.0, 10.0, 65.0, 76.0, 54.0, 54.0, 43.0, 65.0, 76.0, -12.0, -1.0, -1.0, 10.0, -56.0, -56.0, 54.0, -18.0, 32.0, 32.0, 32.0, 32.0, -12.0, 10.0, 10.0, 43.0, -23.0, -56.0, -67.0, -67.0, -1.0, -56.0, -34.0, -34.0, 21.0, 32.0, 43.0, 65.0, 21.0, -56.0, -23.0, -1.0, 32.0, -12.0, -45.0, 21.0, -1.0, 43.0, 54.0, 10.0, 43.0, -12.0, -23.0, 21.0, 21.0, -1.0, -23.0, -34.0, 32.0, 10.0, 10.0, -45.0, 32.0, 32.0, 43.0, 43.0, -12.0, -34.0, -78.0, -1.0, 54.0, -56.0, -56.0, 54.0, 32.0, -67.0, 10.0, 32.0, -12.0, -12.0, -1.0, 76.0, 10.0, -45.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23560494712881866, "mean_inference_ms": 24.513312271381828, "mean_action_processing_ms": 0.08803370786414588, "mean_env_wait_ms": 0.04116584825217809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057773590087890625, "StateBufferConnector_ms": 0.00510096549987793, "ViewRequirementAgentConnector_ms": 0.11570310592651367}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 5.87, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 54.0, -67.0, 32.0, -45.0, 32.0, 54.0, 32.0, -34.0, -23.0, -1.0, 10.0, 10.0, 54.0, 21.0, 32.0, 10.0, 10.0, 65.0, 76.0, 54.0, 54.0, 43.0, 65.0, 76.0, -12.0, -1.0, -1.0, 10.0, -56.0, -56.0, 54.0, -18.0, 32.0, 32.0, 32.0, 32.0, -12.0, 10.0, 10.0, 43.0, -23.0, -56.0, -67.0, -67.0, -1.0, -56.0, -34.0, -34.0, 21.0, 32.0, 43.0, 65.0, 21.0, -56.0, -23.0, -1.0, 32.0, -12.0, -45.0, 21.0, -1.0, 43.0, 54.0, 10.0, 43.0, -12.0, -23.0, 21.0, 21.0, -1.0, -23.0, -34.0, 32.0, 10.0, 10.0, -45.0, 32.0, 32.0, 43.0, 43.0, -12.0, -34.0, -78.0, -1.0, 54.0, -56.0, -56.0, 54.0, 32.0, -67.0, 10.0, 32.0, -12.0, -12.0, -1.0, 76.0, 10.0, -45.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23560494712881866, "mean_inference_ms": 24.513312271381828, "mean_action_processing_ms": 0.08803370786414588, "mean_env_wait_ms": 0.04116584825217809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057773590087890625, "StateBufferConnector_ms": 0.00510096549987793, "ViewRequirementAgentConnector_ms": 0.11570310592651367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 180934.987, "sample_time_ms": 99537.502, "learn_time_ms": 81386.056, "learn_throughput": 49.148, "synch_weights_time_ms": 10.565}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2157, "training_iteration": 41, "trial_id": "38794_00007", "date": "2023-06-02_06-42-00", "timestamp": 1685677320, "time_this_iter_s": 200.3956241607666, "time_total_s": 8174.465971708298, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8174.465971708298, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.66420664206642, "ram_util_percent": 61.695202952029526}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 8.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -34.0, 10.0, 10.0, -56.0, 10.0, 65.0, 76.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21908010689112287, "mean_inference_ms": 24.38253675359058, "mean_action_processing_ms": 0.086262315658283, "mean_env_wait_ms": 0.04061790364251907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051116943359375, "StateBufferConnector_ms": 0.0054073333740234375, "ViewRequirementAgentConnector_ms": 0.11608123779296875}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.579904079437256, "policy_loss": -0.02533206157386303, "vf_loss": 5.557648181915283, "vf_explained_var": -0.1230030432343483, "kl": 0.006189287640154362, "entropy": 2.863259792327881, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42390.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 6.03, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -56.0, -23.0, -1.0, 32.0, -12.0, -45.0, 21.0, -1.0, 43.0, 54.0, 10.0, 43.0, -12.0, -23.0, 21.0, 21.0, -1.0, -23.0, -34.0, 32.0, 10.0, 10.0, -45.0, 32.0, 32.0, 43.0, 43.0, -12.0, -34.0, -78.0, -1.0, 54.0, -56.0, -56.0, 54.0, 32.0, -67.0, 10.0, 32.0, -12.0, -12.0, -1.0, 76.0, 10.0, -45.0, -12.0, 32.0, 54.0, -34.0, -1.0, -100.0, -12.0, 21.0, -23.0, 10.0, 32.0, 10.0, 65.0, 10.0, 10.0, 32.0, 54.0, 10.0, 43.0, -12.0, -45.0, 32.0, 65.0, 43.0, 65.0, 10.0, -12.0, -1.0, -23.0, 43.0, 21.0, 43.0, 65.0, -89.0, 21.0, 32.0, -12.0, 43.0, 43.0, 32.0, 21.0, 65.0, 54.0, 76.0, 32.0, 10.0, -12.0, -133.0, -84.0, -1.0, -23.0, -12.0, 21.0, -62.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23560371955917006, "mean_inference_ms": 24.513939166595982, "mean_action_processing_ms": 0.08802996146871896, "mean_env_wait_ms": 0.04116504599658428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005857229232788086, "StateBufferConnector_ms": 0.0050182342529296875, "ViewRequirementAgentConnector_ms": 0.11583685874938965}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 6.03, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -56.0, -23.0, -1.0, 32.0, -12.0, -45.0, 21.0, -1.0, 43.0, 54.0, 10.0, 43.0, -12.0, -23.0, 21.0, 21.0, -1.0, -23.0, -34.0, 32.0, 10.0, 10.0, -45.0, 32.0, 32.0, 43.0, 43.0, -12.0, -34.0, -78.0, -1.0, 54.0, -56.0, -56.0, 54.0, 32.0, -67.0, 10.0, 32.0, -12.0, -12.0, -1.0, 76.0, 10.0, -45.0, -12.0, 32.0, 54.0, -34.0, -1.0, -100.0, -12.0, 21.0, -23.0, 10.0, 32.0, 10.0, 65.0, 10.0, 10.0, 32.0, 54.0, 10.0, 43.0, -12.0, -45.0, 32.0, 65.0, 43.0, 65.0, 10.0, -12.0, -1.0, -23.0, 43.0, 21.0, 43.0, 65.0, -89.0, 21.0, 32.0, -12.0, 43.0, 43.0, 32.0, 21.0, 65.0, 54.0, 76.0, 32.0, 10.0, -12.0, -133.0, -84.0, -1.0, -23.0, -12.0, 21.0, -62.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23560371955917006, "mean_inference_ms": 24.513939166595982, "mean_action_processing_ms": 0.08802996146871896, "mean_env_wait_ms": 0.04116504599658428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005857229232788086, "StateBufferConnector_ms": 0.0050182342529296875, "ViewRequirementAgentConnector_ms": 0.11583685874938965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 181037.441, "sample_time_ms": 99556.142, "learn_time_ms": 81469.847, "learn_throughput": 49.098, "synch_weights_time_ms": 10.588}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2210, "training_iteration": 42, "trial_id": "38794_00007", "date": "2023-06-02_06-45-20", "timestamp": 1685677520, "time_this_iter_s": 200.3483109474182, "time_total_s": 8374.814282655716, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8374.814282655716, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 28.74485294117647, "ram_util_percent": 61.6154411764706}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -1.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 10.0, 32.0, 10.0, 10.0, 43.0, 32.0, 43.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218437459265229, "mean_inference_ms": 24.30687034288041, "mean_action_processing_ms": 0.08598789547638074, "mean_env_wait_ms": 0.04049897146489066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004532337188720703, "StateBufferConnector_ms": 0.005214214324951172, "ViewRequirementAgentConnector_ms": 0.09902715682983398}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.860727787017822, "policy_loss": -0.015321984887123108, "vf_loss": 5.834927558898926, "vf_explained_var": 0.0031307500321418047, "kl": 0.005348479375243187, "entropy": 2.8635149002075195, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43410.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 10.69, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -23.0, 10.0, 32.0, 10.0, 65.0, 10.0, 10.0, 32.0, 54.0, 10.0, 43.0, -12.0, -45.0, 32.0, 65.0, 43.0, 65.0, 10.0, -12.0, -1.0, -23.0, 43.0, 21.0, 43.0, 65.0, -89.0, 21.0, 32.0, -12.0, 43.0, 43.0, 32.0, 21.0, 65.0, 54.0, 76.0, 32.0, 10.0, -12.0, -133.0, -84.0, -1.0, -23.0, -12.0, 21.0, -62.0, -45.0, -12.0, 21.0, 10.0, 43.0, 21.0, -12.0, -1.0, 32.0, 10.0, 65.0, 43.0, 10.0, 21.0, -23.0, 32.0, 21.0, 43.0, 10.0, -1.0, 21.0, 15.0, -23.0, 54.0, 21.0, 65.0, 43.0, 54.0, -1.0, 10.0, 43.0, 76.0, 54.0, 54.0, 32.0, 21.0, -12.0, -23.0, 43.0, -1.0, 21.0, -45.0, -23.0, -56.0, -56.0, -12.0, -89.0, -12.0, -1.0, -12.0, -56.0, -18.0, 4.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2352872076808201, "mean_inference_ms": 24.47655199031947, "mean_action_processing_ms": 0.08789475202655801, "mean_env_wait_ms": 0.041099948980830324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005347013473510742, "StateBufferConnector_ms": 0.004804372787475586, "ViewRequirementAgentConnector_ms": 0.10775089263916016}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 10.69, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -23.0, 10.0, 32.0, 10.0, 65.0, 10.0, 10.0, 32.0, 54.0, 10.0, 43.0, -12.0, -45.0, 32.0, 65.0, 43.0, 65.0, 10.0, -12.0, -1.0, -23.0, 43.0, 21.0, 43.0, 65.0, -89.0, 21.0, 32.0, -12.0, 43.0, 43.0, 32.0, 21.0, 65.0, 54.0, 76.0, 32.0, 10.0, -12.0, -133.0, -84.0, -1.0, -23.0, -12.0, 21.0, -62.0, -45.0, -12.0, 21.0, 10.0, 43.0, 21.0, -12.0, -1.0, 32.0, 10.0, 65.0, 43.0, 10.0, 21.0, -23.0, 32.0, 21.0, 43.0, 10.0, -1.0, 21.0, 15.0, -23.0, 54.0, 21.0, 65.0, 43.0, 54.0, -1.0, 10.0, 43.0, 76.0, 54.0, 54.0, 32.0, 21.0, -12.0, -23.0, 43.0, -1.0, 21.0, -45.0, -23.0, -56.0, -56.0, -12.0, -89.0, -12.0, -1.0, -12.0, -56.0, -18.0, 4.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2352872076808201, "mean_inference_ms": 24.47655199031947, "mean_action_processing_ms": 0.08789475202655801, "mean_env_wait_ms": 0.041099948980830324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005347013473510742, "StateBufferConnector_ms": 0.004804372787475586, "ViewRequirementAgentConnector_ms": 0.10775089263916016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 179082.422, "sample_time_ms": 98318.693, "learn_time_ms": 80752.384, "learn_throughput": 49.534, "synch_weights_time_ms": 10.488}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2263, "training_iteration": 43, "trial_id": "38794_00007", "date": "2023-06-02_06-48-18", "timestamp": 1685677698, "time_this_iter_s": 177.71809792518616, "time_total_s": 8552.532380580902, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8552.532380580902, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.548132780082987, "ram_util_percent": 49.90082987551867}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -56.0, "episode_reward_mean": 2.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, -23.0, 43.0, -56.0, -23.0, -18.0, 10.0, -23.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178076526229702, "mean_inference_ms": 24.23407430373033, "mean_action_processing_ms": 0.08572305397733412, "mean_env_wait_ms": 0.04037897865088026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041294097900390625, "StateBufferConnector_ms": 0.005135536193847656, "ViewRequirementAgentConnector_ms": 0.09704828262329102}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.510280609130859, "policy_loss": -0.03961697593331337, "vf_loss": 5.494682312011719, "vf_explained_var": -0.13321669399738312, "kl": 0.007181273307651281, "entropy": 2.889528274536133, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44430.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 14.66, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -12.0, -1.0, 32.0, 10.0, 65.0, 43.0, 10.0, 21.0, -23.0, 32.0, 21.0, 43.0, 10.0, -1.0, 21.0, 15.0, -23.0, 54.0, 21.0, 65.0, 43.0, 54.0, -1.0, 10.0, 43.0, 76.0, 54.0, 54.0, 32.0, 21.0, -12.0, -23.0, 43.0, -1.0, 21.0, -45.0, -23.0, -56.0, -56.0, -12.0, -89.0, -12.0, -1.0, -12.0, -56.0, -18.0, 4.0, 65.0, 43.0, 21.0, 65.0, 43.0, 54.0, 32.0, 65.0, -12.0, 65.0, -34.0, 32.0, 54.0, 10.0, 54.0, -1.0, 10.0, 76.0, 76.0, 65.0, 65.0, -12.0, 54.0, 10.0, 54.0, -34.0, 65.0, -1.0, -23.0, 10.0, 32.0, 43.0, 32.0, -1.0, -1.0, -23.0, 10.0, -23.0, -45.0, -1.0, -56.0, 10.0, -45.0, -1.0, -12.0, 21.0, 32.0, -23.0, 21.0, 43.0, 43.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2346647958753075, "mean_inference_ms": 24.405078608872063, "mean_action_processing_ms": 0.08763457842734855, "mean_env_wait_ms": 0.040974682727608014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004741668701171875, "StateBufferConnector_ms": 0.004560232162475586, "ViewRequirementAgentConnector_ms": 0.09853339195251465}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 14.66, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -12.0, -1.0, 32.0, 10.0, 65.0, 43.0, 10.0, 21.0, -23.0, 32.0, 21.0, 43.0, 10.0, -1.0, 21.0, 15.0, -23.0, 54.0, 21.0, 65.0, 43.0, 54.0, -1.0, 10.0, 43.0, 76.0, 54.0, 54.0, 32.0, 21.0, -12.0, -23.0, 43.0, -1.0, 21.0, -45.0, -23.0, -56.0, -56.0, -12.0, -89.0, -12.0, -1.0, -12.0, -56.0, -18.0, 4.0, 65.0, 43.0, 21.0, 65.0, 43.0, 54.0, 32.0, 65.0, -12.0, 65.0, -34.0, 32.0, 54.0, 10.0, 54.0, -1.0, 10.0, 76.0, 76.0, 65.0, 65.0, -12.0, 54.0, 10.0, 54.0, -34.0, 65.0, -1.0, -23.0, 10.0, 32.0, 43.0, 32.0, -1.0, -1.0, -23.0, 10.0, -23.0, -45.0, -1.0, -56.0, 10.0, -45.0, -1.0, -12.0, 21.0, 32.0, -23.0, 21.0, 43.0, 43.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2346647958753075, "mean_inference_ms": 24.405078608872063, "mean_action_processing_ms": 0.08763457842734855, "mean_env_wait_ms": 0.040974682727608014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004741668701171875, "StateBufferConnector_ms": 0.004560232162475586, "ViewRequirementAgentConnector_ms": 0.09853339195251465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 177043.402, "sample_time_ms": 96982.094, "learn_time_ms": 80049.903, "learn_throughput": 49.969, "synch_weights_time_ms": 10.552}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 2315, "training_iteration": 44, "trial_id": "38794_00007", "date": "2023-06-02_06-51-15", "timestamp": 1685677875, "time_this_iter_s": 176.95452213287354, "time_total_s": 8729.486902713776, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8729.486902713776, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 16.315481171548118, "ram_util_percent": 49.8581589958159}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -12.0, "episode_reward_mean": 34.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, -12.0, 21.0, 32.0, 32.0, 65.0, 54.0, 48.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21723867741904307, "mean_inference_ms": 24.16581196560643, "mean_action_processing_ms": 0.08546551439253992, "mean_env_wait_ms": 0.04026629848719472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003859996795654297, "StateBufferConnector_ms": 0.005261898040771484, "ViewRequirementAgentConnector_ms": 0.09742259979248047}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.676520347595215, "policy_loss": -0.0388793870806694, "vf_loss": 5.674294471740723, "vf_explained_var": -0.09457559883594513, "kl": 0.0053462740033864975, "entropy": 2.904414176940918, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45450.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 10.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 65.0, -12.0, 65.0, -34.0, 32.0, 54.0, 10.0, 54.0, -1.0, 10.0, 76.0, 76.0, 65.0, 65.0, -12.0, 54.0, 10.0, 54.0, -34.0, 65.0, -1.0, -23.0, 10.0, 32.0, 43.0, 32.0, -1.0, -1.0, -23.0, 10.0, -23.0, -45.0, -1.0, -56.0, 10.0, -45.0, -1.0, -12.0, 21.0, 32.0, -23.0, 21.0, 43.0, 43.0, -23.0, -23.0, -34.0, 54.0, -12.0, 21.0, 65.0, 32.0, -12.0, -34.0, -1.0, 43.0, 21.0, 43.0, 54.0, 65.0, 21.0, 43.0, 10.0, 32.0, 32.0, 32.0, 32.0, 43.0, 32.0, -23.0, -34.0, 43.0, 43.0, 43.0, 65.0, 54.0, 32.0, 32.0, 43.0, 21.0, -45.0, -12.0, -1.0, -34.0, -23.0, -122.0, -78.0, -78.0, 10.0, -34.0, -12.0, -45.0, -56.0, -23.0, -34.0, 43.0, -56.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23403569843206248, "mean_inference_ms": 24.333465261233396, "mean_action_processing_ms": 0.08737099090605337, "mean_env_wait_ms": 0.0408485238482718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004780292510986328, "StateBufferConnector_ms": 0.0045964717864990234, "ViewRequirementAgentConnector_ms": 0.098968505859375}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 10.0, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 65.0, -12.0, 65.0, -34.0, 32.0, 54.0, 10.0, 54.0, -1.0, 10.0, 76.0, 76.0, 65.0, 65.0, -12.0, 54.0, 10.0, 54.0, -34.0, 65.0, -1.0, -23.0, 10.0, 32.0, 43.0, 32.0, -1.0, -1.0, -23.0, 10.0, -23.0, -45.0, -1.0, -56.0, 10.0, -45.0, -1.0, -12.0, 21.0, 32.0, -23.0, 21.0, 43.0, 43.0, -23.0, -23.0, -34.0, 54.0, -12.0, 21.0, 65.0, 32.0, -12.0, -34.0, -1.0, 43.0, 21.0, 43.0, 54.0, 65.0, 21.0, 43.0, 10.0, 32.0, 32.0, 32.0, 32.0, 43.0, 32.0, -23.0, -34.0, 43.0, 43.0, 43.0, 65.0, 54.0, 32.0, 32.0, 43.0, 21.0, -45.0, -12.0, -1.0, -34.0, -23.0, -122.0, -78.0, -78.0, 10.0, -34.0, -12.0, -45.0, -56.0, -23.0, -34.0, 43.0, -56.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23403569843206248, "mean_inference_ms": 24.333465261233396, "mean_action_processing_ms": 0.08737099090605337, "mean_env_wait_ms": 0.0408485238482718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004780292510986328, "StateBufferConnector_ms": 0.0045964717864990234, "ViewRequirementAgentConnector_ms": 0.098968505859375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 175039.197, "sample_time_ms": 95663.854, "learn_time_ms": 79364.599, "learn_throughput": 50.4, "synch_weights_time_ms": 9.97}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 2368, "training_iteration": 45, "trial_id": "38794_00007", "date": "2023-06-02_06-54-12", "timestamp": 1685678052, "time_this_iter_s": 177.1504430770874, "time_total_s": 8906.637345790863, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8906.637345790863, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.05850622406639, "ram_util_percent": 49.97551867219918}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -34.0, "episode_reward_mean": 13.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -34.0, 10.0, 21.0, 54.0, -12.0, -12.0, 10.0, 21.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21667424684762784, "mean_inference_ms": 24.099794979045814, "mean_action_processing_ms": 0.08522140185629277, "mean_env_wait_ms": 0.0401606791209228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004124641418457031, "StateBufferConnector_ms": 0.005154609680175781, "ViewRequirementAgentConnector_ms": 0.09771585464477539}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.666795253753662, "policy_loss": -0.03968339413404465, "vf_loss": 5.656512260437012, "vf_explained_var": -0.1238364428281784, "kl": 0.006498671602457762, "entropy": 2.928427219390869, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46470.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 10.05, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -12.0, -34.0, -1.0, 43.0, 21.0, 43.0, 54.0, 65.0, 21.0, 43.0, 10.0, 32.0, 32.0, 32.0, 32.0, 43.0, 32.0, -23.0, -34.0, 43.0, 43.0, 43.0, 65.0, 54.0, 32.0, 32.0, 43.0, 21.0, -45.0, -12.0, -1.0, -34.0, -23.0, -122.0, -78.0, -78.0, 10.0, -34.0, -12.0, -45.0, -56.0, -23.0, -34.0, 43.0, -56.0, -45.0, -67.0, -67.0, 21.0, -1.0, 32.0, 54.0, 43.0, 32.0, 48.0, -1.0, 54.0, 32.0, -12.0, 10.0, 10.0, 54.0, -67.0, 32.0, 54.0, -1.0, 10.0, 43.0, 32.0, 21.0, -12.0, -34.0, 32.0, 10.0, 43.0, 43.0, -1.0, 21.0, 32.0, 10.0, -34.0, -12.0, -45.0, 76.0, 10.0, 43.0, 21.0, 32.0, 32.0, 54.0, 65.0, 65.0, 32.0, -1.0, 32.0, 43.0, 10.0, -45.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23344180911999288, "mean_inference_ms": 24.267072969588597, "mean_action_processing_ms": 0.08712506331688889, "mean_env_wait_ms": 0.04072877481699546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004858255386352539, "StateBufferConnector_ms": 0.004568338394165039, "ViewRequirementAgentConnector_ms": 0.09907007217407227}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 10.05, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -12.0, -34.0, -1.0, 43.0, 21.0, 43.0, 54.0, 65.0, 21.0, 43.0, 10.0, 32.0, 32.0, 32.0, 32.0, 43.0, 32.0, -23.0, -34.0, 43.0, 43.0, 43.0, 65.0, 54.0, 32.0, 32.0, 43.0, 21.0, -45.0, -12.0, -1.0, -34.0, -23.0, -122.0, -78.0, -78.0, 10.0, -34.0, -12.0, -45.0, -56.0, -23.0, -34.0, 43.0, -56.0, -45.0, -67.0, -67.0, 21.0, -1.0, 32.0, 54.0, 43.0, 32.0, 48.0, -1.0, 54.0, 32.0, -12.0, 10.0, 10.0, 54.0, -67.0, 32.0, 54.0, -1.0, 10.0, 43.0, 32.0, 21.0, -12.0, -34.0, 32.0, 10.0, 43.0, 43.0, -1.0, 21.0, 32.0, 10.0, -34.0, -12.0, -45.0, 76.0, 10.0, 43.0, 21.0, 32.0, 32.0, 54.0, 65.0, 65.0, 32.0, -1.0, 32.0, 43.0, 10.0, -45.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23344180911999288, "mean_inference_ms": 24.267072969588597, "mean_action_processing_ms": 0.08712506331688889, "mean_env_wait_ms": 0.04072877481699546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004858255386352539, "StateBufferConnector_ms": 0.004568338394165039, "ViewRequirementAgentConnector_ms": 0.09907007217407227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 173065.799, "sample_time_ms": 94379.406, "learn_time_ms": 78675.778, "learn_throughput": 50.842, "synch_weights_time_ms": 9.845}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 2421, "training_iteration": 46, "trial_id": "38794_00007", "date": "2023-06-02_06-57-10", "timestamp": 1685678230, "time_this_iter_s": 177.5683078765869, "time_total_s": 9084.20565366745, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9084.20565366745, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 16.6275, "ram_util_percent": 50.10791666666667}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -56.0, "episode_reward_mean": 25.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 21.0, -12.0, 43.0, 21.0, 32.0, 65.0, 32.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21614072864878792, "mean_inference_ms": 24.03699507728936, "mean_action_processing_ms": 0.08499264259901171, "mean_env_wait_ms": 0.04005644376906458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00431060791015625, "StateBufferConnector_ms": 0.005078315734863281, "ViewRequirementAgentConnector_ms": 0.09691715240478516}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.440886974334717, "policy_loss": -0.02032194659113884, "vf_loss": 5.420374870300293, "vf_explained_var": -0.02915162965655327, "kl": 0.005310934968292713, "entropy": 2.9260103702545166, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47505.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 14.34, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 32.0, 48.0, -1.0, 54.0, 32.0, -12.0, 10.0, 10.0, 54.0, -67.0, 32.0, 54.0, -1.0, 10.0, 43.0, 32.0, 21.0, -12.0, -34.0, 32.0, 10.0, 43.0, 43.0, -1.0, 21.0, 32.0, 10.0, -34.0, -12.0, -45.0, 76.0, 10.0, 43.0, 21.0, 32.0, 32.0, 54.0, 65.0, 65.0, 32.0, -1.0, 32.0, 43.0, 10.0, -45.0, -45.0, -1.0, -34.0, -67.0, -1.0, -1.0, -12.0, -144.0, 43.0, 32.0, -1.0, 10.0, -23.0, -1.0, -56.0, 54.0, -23.0, -56.0, -23.0, 43.0, 65.0, 65.0, 43.0, 32.0, 65.0, 43.0, 65.0, 54.0, -34.0, 65.0, 54.0, 32.0, 10.0, 32.0, 21.0, 21.0, 10.0, 43.0, -78.0, 10.0, -12.0, 43.0, 10.0, 10.0, 10.0, -1.0, -100.0, -67.0, 32.0, 43.0, 76.0, 76.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23288143315724763, "mean_inference_ms": 24.203809908264017, "mean_action_processing_ms": 0.08689383331491811, "mean_env_wait_ms": 0.04061557236004228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004847288131713867, "StateBufferConnector_ms": 0.0045430660247802734, "ViewRequirementAgentConnector_ms": 0.09886789321899414}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 14.34, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 32.0, 48.0, -1.0, 54.0, 32.0, -12.0, 10.0, 10.0, 54.0, -67.0, 32.0, 54.0, -1.0, 10.0, 43.0, 32.0, 21.0, -12.0, -34.0, 32.0, 10.0, 43.0, 43.0, -1.0, 21.0, 32.0, 10.0, -34.0, -12.0, -45.0, 76.0, 10.0, 43.0, 21.0, 32.0, 32.0, 54.0, 65.0, 65.0, 32.0, -1.0, 32.0, 43.0, 10.0, -45.0, -45.0, -1.0, -34.0, -67.0, -1.0, -1.0, -12.0, -144.0, 43.0, 32.0, -1.0, 10.0, -23.0, -1.0, -56.0, 54.0, -23.0, -56.0, -23.0, 43.0, 65.0, 65.0, 43.0, 32.0, 65.0, 43.0, 65.0, 54.0, -34.0, 65.0, 54.0, 32.0, 10.0, 32.0, 21.0, 21.0, 10.0, 43.0, -78.0, 10.0, -12.0, 43.0, 10.0, 10.0, 10.0, -1.0, -100.0, -67.0, 32.0, 43.0, 76.0, 76.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23288143315724763, "mean_inference_ms": 24.203809908264017, "mean_action_processing_ms": 0.08689383331491811, "mean_env_wait_ms": 0.04061557236004228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004847288131713867, "StateBufferConnector_ms": 0.0045430660247802734, "ViewRequirementAgentConnector_ms": 0.09886789321899414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 171258.054, "sample_time_ms": 93076.065, "learn_time_ms": 78171.469, "learn_throughput": 51.17, "synch_weights_time_ms": 9.76}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 2473, "training_iteration": 47, "trial_id": "38794_00007", "date": "2023-06-02_07-00-09", "timestamp": 1685678409, "time_this_iter_s": 179.01244711875916, "time_total_s": 9263.21810078621, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9263.21810078621, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 16.443801652892564, "ram_util_percent": 50.15702479338844}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 12.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 54.0, -34.0, -45.0, 32.0, 43.0, 32.0, 32.0, -12.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2156344851081346, "mean_inference_ms": 23.97583870147816, "mean_action_processing_ms": 0.08477607463124467, "mean_env_wait_ms": 0.03995710694833347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004124641418457031, "StateBufferConnector_ms": 0.005097389221191406, "ViewRequirementAgentConnector_ms": 0.0966954231262207}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.321201801300049, "policy_loss": -0.0338570736348629, "vf_loss": 5.315468788146973, "vf_explained_var": 0.01265751849859953, "kl": 0.0051492201164364815, "entropy": 2.9233157634735107, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48540.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 17.48, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -144.0, 43.0, 32.0, -1.0, 10.0, -23.0, -1.0, -56.0, 54.0, -23.0, -56.0, -23.0, 43.0, 65.0, 65.0, 43.0, 32.0, 65.0, 43.0, 65.0, 54.0, -34.0, 65.0, 54.0, 32.0, 10.0, 32.0, 21.0, 21.0, 10.0, 43.0, -78.0, 10.0, -12.0, 43.0, 10.0, 10.0, 10.0, -1.0, -100.0, -67.0, 32.0, 43.0, 76.0, 76.0, 32.0, 21.0, -1.0, 10.0, 10.0, -34.0, 65.0, 54.0, 54.0, 54.0, 43.0, 10.0, -56.0, 10.0, -12.0, 32.0, 65.0, 10.0, 54.0, 54.0, 21.0, -12.0, -23.0, 32.0, 43.0, 32.0, 21.0, 21.0, 10.0, -56.0, 32.0, -1.0, -12.0, -12.0, -45.0, -56.0, -23.0, -23.0, 76.0, 54.0, 76.0, 65.0, 54.0, 43.0, 76.0, 65.0, 54.0, 65.0, 65.0, 65.0, 76.0, -23.0, -89.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23233344198029016, "mean_inference_ms": 24.140484848565055, "mean_action_processing_ms": 0.08666976275624112, "mean_env_wait_ms": 0.04050638345700875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048427581787109375, "StateBufferConnector_ms": 0.0045087337493896484, "ViewRequirementAgentConnector_ms": 0.09883403778076172}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 17.48, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -144.0, 43.0, 32.0, -1.0, 10.0, -23.0, -1.0, -56.0, 54.0, -23.0, -56.0, -23.0, 43.0, 65.0, 65.0, 43.0, 32.0, 65.0, 43.0, 65.0, 54.0, -34.0, 65.0, 54.0, 32.0, 10.0, 32.0, 21.0, 21.0, 10.0, 43.0, -78.0, 10.0, -12.0, 43.0, 10.0, 10.0, 10.0, -1.0, -100.0, -67.0, 32.0, 43.0, 76.0, 76.0, 32.0, 21.0, -1.0, 10.0, 10.0, -34.0, 65.0, 54.0, 54.0, 54.0, 43.0, 10.0, -56.0, 10.0, -12.0, 32.0, 65.0, 10.0, 54.0, 54.0, 21.0, -12.0, -23.0, 32.0, 43.0, 32.0, 21.0, 21.0, 10.0, -56.0, 32.0, -1.0, -12.0, -12.0, -45.0, -56.0, -23.0, -23.0, 76.0, 54.0, 76.0, 65.0, 54.0, 43.0, 76.0, 65.0, 54.0, 65.0, 65.0, 65.0, 76.0, -23.0, -89.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23233344198029016, "mean_inference_ms": 24.140484848565055, "mean_action_processing_ms": 0.08666976275624112, "mean_env_wait_ms": 0.04050638345700875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048427581787109375, "StateBufferConnector_ms": 0.0045087337493896484, "ViewRequirementAgentConnector_ms": 0.09883403778076172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 169202.185, "sample_time_ms": 91733.0, "learn_time_ms": 77458.639, "learn_throughput": 51.64, "synch_weights_time_ms": 9.774}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 2526, "training_iteration": 48, "trial_id": "38794_00007", "date": "2023-06-02_07-03-05", "timestamp": 1685678585, "time_this_iter_s": 176.67034006118774, "time_total_s": 9439.888440847397, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9439.888440847397, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.087083333333332, "ram_util_percent": 50.389583333333334}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -45.0, "episode_reward_mean": -4.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, -1.0, 32.0, 43.0, 10.0, -45.0, -1.0, -1.0, -45.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21512341747087776, "mean_inference_ms": 23.917455997929522, "mean_action_processing_ms": 0.08455664299570308, "mean_env_wait_ms": 0.03985786811867743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037932395935058594, "StateBufferConnector_ms": 0.004956722259521484, "ViewRequirementAgentConnector_ms": 0.09680747985839844}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 9.999999747378752e-05, "total_loss": 5.916599750518799, "policy_loss": 0.02145116776227951, "vf_loss": 5.863469123840332, "vf_explained_var": -0.023913349956274033, "kl": 0.004120178055018187, "entropy": 2.895228147506714, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49560.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 13.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 54.0, 54.0, 43.0, 10.0, -56.0, 10.0, -12.0, 32.0, 65.0, 10.0, 54.0, 54.0, 21.0, -12.0, -23.0, 32.0, 43.0, 32.0, 21.0, 21.0, 10.0, -56.0, 32.0, -1.0, -12.0, -12.0, -45.0, -56.0, -23.0, -23.0, 76.0, 54.0, 76.0, 65.0, 54.0, 43.0, 76.0, 65.0, 54.0, 65.0, 65.0, 65.0, 76.0, -23.0, -89.0, 21.0, 43.0, 65.0, 54.0, -12.0, -23.0, -12.0, -12.0, 10.0, 10.0, -12.0, -12.0, -51.0, -1.0, 21.0, -12.0, -67.0, -1.0, -45.0, -67.0, 32.0, -1.0, -12.0, -56.0, -67.0, -100.0, -12.0, -34.0, -56.0, -12.0, 32.0, 32.0, 43.0, 43.0, 65.0, 65.0, 43.0, 65.0, 43.0, -1.0, 21.0, 43.0, 10.0, -1.0, -1.0, -23.0, 43.0, -12.0, -23.0, 65.0, 43.0, 43.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23184205299721897, "mean_inference_ms": 24.083211163666302, "mean_action_processing_ms": 0.08646368724240962, "mean_env_wait_ms": 0.04040741419569008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00491023063659668, "StateBufferConnector_ms": 0.004569053649902344, "ViewRequirementAgentConnector_ms": 0.0994265079498291}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 13.9, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 54.0, 54.0, 43.0, 10.0, -56.0, 10.0, -12.0, 32.0, 65.0, 10.0, 54.0, 54.0, 21.0, -12.0, -23.0, 32.0, 43.0, 32.0, 21.0, 21.0, 10.0, -56.0, 32.0, -1.0, -12.0, -12.0, -45.0, -56.0, -23.0, -23.0, 76.0, 54.0, 76.0, 65.0, 54.0, 43.0, 76.0, 65.0, 54.0, 65.0, 65.0, 65.0, 76.0, -23.0, -89.0, 21.0, 43.0, 65.0, 54.0, -12.0, -23.0, -12.0, -12.0, 10.0, 10.0, -12.0, -12.0, -51.0, -1.0, 21.0, -12.0, -67.0, -1.0, -45.0, -67.0, 32.0, -1.0, -12.0, -56.0, -67.0, -100.0, -12.0, -34.0, -56.0, -12.0, 32.0, 32.0, 43.0, 43.0, 65.0, 65.0, 43.0, 65.0, 43.0, -1.0, 21.0, 43.0, 10.0, -1.0, -1.0, -23.0, 43.0, -12.0, -23.0, 65.0, 43.0, 43.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23184205299721897, "mean_inference_ms": 24.083211163666302, "mean_action_processing_ms": 0.08646368724240962, "mean_env_wait_ms": 0.04040741419569008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00491023063659668, "StateBufferConnector_ms": 0.004569053649902344, "ViewRequirementAgentConnector_ms": 0.0994265079498291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 167251.423, "sample_time_ms": 90507.703, "learn_time_ms": 76733.316, "learn_throughput": 52.129, "synch_weights_time_ms": 9.589}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 2578, "training_iteration": 49, "trial_id": "38794_00007", "date": "2023-06-02_07-06-03", "timestamp": 1685678763, "time_this_iter_s": 177.8913369178772, "time_total_s": 9617.779777765274, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9617.779777765274, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 16.391666666666666, "ram_util_percent": 50.42291666666666}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 19.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -1.0, -1.0, 10.0, 65.0, 54.0, 32.0, -34.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21465172695739027, "mean_inference_ms": 23.861697615988895, "mean_action_processing_ms": 0.08435145305560164, "mean_env_wait_ms": 0.039764863654646834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004458427429199219, "StateBufferConnector_ms": 0.005183219909667969, "ViewRequirementAgentConnector_ms": 0.0989675521850586}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.228976726531982, "policy_loss": -0.00611620768904686, "vf_loss": 6.208080768585205, "vf_explained_var": -0.12432803958654404, "kl": 0.007026601117104292, "entropy": 2.9090561866760254, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50580.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 2.79, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, 10.0, 10.0, -12.0, -12.0, -51.0, -1.0, 21.0, -12.0, -67.0, -1.0, -45.0, -67.0, 32.0, -1.0, -12.0, -56.0, -67.0, -100.0, -12.0, -34.0, -56.0, -12.0, 32.0, 32.0, 43.0, 43.0, 65.0, 65.0, 43.0, 65.0, 43.0, -1.0, 21.0, 43.0, 10.0, -1.0, -1.0, -23.0, 43.0, -12.0, -23.0, 65.0, 43.0, 43.0, 65.0, 32.0, 54.0, 43.0, 43.0, 32.0, 76.0, 54.0, -12.0, -34.0, 43.0, 21.0, 43.0, 65.0, 43.0, -1.0, 32.0, -12.0, -45.0, 21.0, -1.0, -1.0, 21.0, -34.0, 32.0, 21.0, 43.0, -34.0, 32.0, -56.0, -56.0, -56.0, -34.0, -23.0, 32.0, 43.0, 10.0, 21.0, -67.0, -12.0, -12.0, 54.0, -78.0, -23.0, -56.0, -1.0, -34.0, 32.0, 21.0, -12.0, -45.0, -1.0, -45.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2313687386601372, "mean_inference_ms": 24.027085906473932, "mean_action_processing_ms": 0.08626268966821474, "mean_env_wait_ms": 0.04031309489156071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004877328872680664, "StateBufferConnector_ms": 0.004672050476074219, "ViewRequirementAgentConnector_ms": 0.09981942176818848}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 2.79, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, 10.0, 10.0, -12.0, -12.0, -51.0, -1.0, 21.0, -12.0, -67.0, -1.0, -45.0, -67.0, 32.0, -1.0, -12.0, -56.0, -67.0, -100.0, -12.0, -34.0, -56.0, -12.0, 32.0, 32.0, 43.0, 43.0, 65.0, 65.0, 43.0, 65.0, 43.0, -1.0, 21.0, 43.0, 10.0, -1.0, -1.0, -23.0, 43.0, -12.0, -23.0, 65.0, 43.0, 43.0, 65.0, 32.0, 54.0, 43.0, 43.0, 32.0, 76.0, 54.0, -12.0, -34.0, 43.0, 21.0, 43.0, 65.0, 43.0, -1.0, 32.0, -12.0, -45.0, 21.0, -1.0, -1.0, 21.0, -34.0, 32.0, 21.0, 43.0, -34.0, 32.0, -56.0, -56.0, -56.0, -34.0, -23.0, 32.0, 43.0, 10.0, 21.0, -67.0, -12.0, -12.0, 54.0, -78.0, -23.0, -56.0, -1.0, -34.0, 32.0, 21.0, -12.0, -45.0, -1.0, -45.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2313687386601372, "mean_inference_ms": 24.027085906473932, "mean_action_processing_ms": 0.08626268966821474, "mean_env_wait_ms": 0.04031309489156071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004877328872680664, "StateBufferConnector_ms": 0.004672050476074219, "ViewRequirementAgentConnector_ms": 0.09981942176818848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 165176.613, "sample_time_ms": 89155.025, "learn_time_ms": 76011.237, "learn_throughput": 52.624, "synch_weights_time_ms": 9.55}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 2631, "training_iteration": 50, "trial_id": "38794_00007", "date": "2023-06-02_07-09-00", "timestamp": 1685678940, "time_this_iter_s": 176.9678430557251, "time_total_s": 9794.747620821, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9794.747620821, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 16.543933054393307, "ram_util_percent": 50.504602510460245}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -45.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 10.0, 10.0, -12.0, 43.0, 43.0, 21.0, -45.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21418988533991384, "mean_inference_ms": 23.80910990872419, "mean_action_processing_ms": 0.08415721899117082, "mean_env_wait_ms": 0.03968032255669975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004208087921142578, "StateBufferConnector_ms": 0.0050830841064453125, "ViewRequirementAgentConnector_ms": 0.0978994369506836}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.9737067222595215, "policy_loss": -0.01960587687790394, "vf_loss": 5.969905376434326, "vf_explained_var": -0.07653714716434479, "kl": 0.00608868058770895, "entropy": 2.918226957321167, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51600.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 2.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, -12.0, -34.0, 43.0, 21.0, 43.0, 65.0, 43.0, -1.0, 32.0, -12.0, -45.0, 21.0, -1.0, -1.0, 21.0, -34.0, 32.0, 21.0, 43.0, -34.0, 32.0, -56.0, -56.0, -56.0, -34.0, -23.0, 32.0, 43.0, 10.0, 21.0, -67.0, -12.0, -12.0, 54.0, -78.0, -23.0, -56.0, -1.0, -34.0, 32.0, 21.0, -12.0, -45.0, -1.0, -45.0, -34.0, -45.0, -34.0, 10.0, 32.0, -78.0, -23.0, 10.0, -45.0, 43.0, 54.0, 54.0, 65.0, 32.0, 21.0, -23.0, 43.0, 54.0, 76.0, 65.0, 54.0, 76.0, 76.0, 21.0, 10.0, 10.0, 54.0, -67.0, -73.0, -23.0, -78.0, -12.0, -1.0, 32.0, 21.0, 54.0, -12.0, 10.0, 10.0, 54.0, -89.0, 10.0, 10.0, -1.0, -1.0, -56.0, -56.0, 10.0, 43.0, 43.0, -1.0, 32.0, -45.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2308956839965566, "mean_inference_ms": 23.972098020510575, "mean_action_processing_ms": 0.08606603834477954, "mean_env_wait_ms": 0.040220125378917476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004852771759033203, "StateBufferConnector_ms": 0.004683256149291992, "ViewRequirementAgentConnector_ms": 0.09948253631591797}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 2.9, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -12.0, -34.0, 43.0, 21.0, 43.0, 65.0, 43.0, -1.0, 32.0, -12.0, -45.0, 21.0, -1.0, -1.0, 21.0, -34.0, 32.0, 21.0, 43.0, -34.0, 32.0, -56.0, -56.0, -56.0, -34.0, -23.0, 32.0, 43.0, 10.0, 21.0, -67.0, -12.0, -12.0, 54.0, -78.0, -23.0, -56.0, -1.0, -34.0, 32.0, 21.0, -12.0, -45.0, -1.0, -45.0, -34.0, -45.0, -34.0, 10.0, 32.0, -78.0, -23.0, 10.0, -45.0, 43.0, 54.0, 54.0, 65.0, 32.0, 21.0, -23.0, 43.0, 54.0, 76.0, 65.0, 54.0, 76.0, 76.0, 21.0, 10.0, 10.0, 54.0, -67.0, -73.0, -23.0, -78.0, -12.0, -1.0, 32.0, 21.0, 54.0, -12.0, 10.0, 10.0, 54.0, -89.0, 10.0, 10.0, -1.0, -1.0, -56.0, -56.0, 10.0, 43.0, 43.0, -1.0, 32.0, -45.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2308956839965566, "mean_inference_ms": 23.972098020510575, "mean_action_processing_ms": 0.08606603834477954, "mean_env_wait_ms": 0.040220125378917476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004852771759033203, "StateBufferConnector_ms": 0.004683256149291992, "ViewRequirementAgentConnector_ms": 0.09948253631591797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 163134.085, "sample_time_ms": 87832.107, "learn_time_ms": 75291.762, "learn_throughput": 53.127, "synch_weights_time_ms": 9.427}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 2684, "training_iteration": 51, "trial_id": "38794_00007", "date": "2023-06-02_07-11-57", "timestamp": 1685679117, "time_this_iter_s": 177.28407382965088, "time_total_s": 9972.03169465065, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9972.03169465065, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 16.313333333333333, "ram_util_percent": 50.59083333333333}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -89.0, "episode_reward_mean": -5.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -89.0, -67.0, 32.0, 43.0, 32.0, 65.0, 10.0, -1.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21374651827143412, "mean_inference_ms": 23.757508540605354, "mean_action_processing_ms": 0.08397224699237418, "mean_env_wait_ms": 0.0396003842833421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004425048828125, "StateBufferConnector_ms": 0.005097389221191406, "ViewRequirementAgentConnector_ms": 0.0974583625793457}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.077580451965332, "policy_loss": -0.032858312129974365, "vf_loss": 6.08985710144043, "vf_explained_var": -0.166536346077919, "kl": 0.005353872664272785, "entropy": 2.9170291423797607, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52620.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 6.09, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 10.0, -45.0, 43.0, 54.0, 54.0, 65.0, 32.0, 21.0, -23.0, 43.0, 54.0, 76.0, 65.0, 54.0, 76.0, 76.0, 21.0, 10.0, 10.0, 54.0, -67.0, -73.0, -23.0, -78.0, -12.0, -1.0, 32.0, 21.0, 54.0, -12.0, 10.0, 10.0, 54.0, -89.0, 10.0, 10.0, -1.0, -1.0, -56.0, -56.0, 10.0, 43.0, 43.0, -1.0, 32.0, -45.0, -1.0, 32.0, 65.0, 65.0, 21.0, 32.0, 10.0, 10.0, 10.0, -12.0, -23.0, -45.0, -67.0, 10.0, 21.0, 10.0, 43.0, 43.0, 54.0, 32.0, 43.0, 32.0, -12.0, -45.0, -12.0, -122.0, -45.0, -122.0, -56.0, 21.0, -23.0, 21.0, -23.0, -23.0, 21.0, 43.0, 21.0, -12.0, 43.0, 21.0, -34.0, 43.0, -12.0, 21.0, 10.0, -45.0, -1.0, 21.0, -34.0, 43.0, 10.0, -23.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23044573164125995, "mean_inference_ms": 23.918104968428207, "mean_action_processing_ms": 0.0858785501386132, "mean_env_wait_ms": 0.040130945210443046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004876375198364258, "StateBufferConnector_ms": 0.004638195037841797, "ViewRequirementAgentConnector_ms": 0.09952354431152344}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 6.09, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 10.0, -45.0, 43.0, 54.0, 54.0, 65.0, 32.0, 21.0, -23.0, 43.0, 54.0, 76.0, 65.0, 54.0, 76.0, 76.0, 21.0, 10.0, 10.0, 54.0, -67.0, -73.0, -23.0, -78.0, -12.0, -1.0, 32.0, 21.0, 54.0, -12.0, 10.0, 10.0, 54.0, -89.0, 10.0, 10.0, -1.0, -1.0, -56.0, -56.0, 10.0, 43.0, 43.0, -1.0, 32.0, -45.0, -1.0, 32.0, 65.0, 65.0, 21.0, 32.0, 10.0, 10.0, 10.0, -12.0, -23.0, -45.0, -67.0, 10.0, 21.0, 10.0, 43.0, 43.0, 54.0, 32.0, 43.0, 32.0, -12.0, -45.0, -12.0, -122.0, -45.0, -122.0, -56.0, 21.0, -23.0, 21.0, -23.0, -23.0, 21.0, 43.0, 21.0, -12.0, 43.0, 21.0, -34.0, 43.0, -12.0, 21.0, 10.0, -45.0, -1.0, 21.0, -34.0, 43.0, 10.0, -23.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23044573164125995, "mean_inference_ms": 23.918104968428207, "mean_action_processing_ms": 0.0858785501386132, "mean_env_wait_ms": 0.040130945210443046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004876375198364258, "StateBufferConnector_ms": 0.004638195037841797, "ViewRequirementAgentConnector_ms": 0.09952354431152344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 161001.029, "sample_time_ms": 86420.283, "learn_time_ms": 74570.685, "learn_throughput": 53.64, "synch_weights_time_ms": 9.274}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 2736, "training_iteration": 52, "trial_id": "38794_00007", "date": "2023-06-02_07-14-54", "timestamp": 1685679294, "time_this_iter_s": 176.3382909297943, "time_total_s": 10148.369985580444, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10148.369985580444, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.008403361344538, "ram_util_percent": 50.63109243697478}}
{"evaluation": {"episode_reward_max": -12.0, "episode_reward_min": -100.0, "episode_reward_mean": -58.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -100.0, -100.0, -12.0, -78.0, -45.0, -78.0, -67.0, -34.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21331947321735645, "mean_inference_ms": 23.708480528031266, "mean_action_processing_ms": 0.08378521675936991, "mean_env_wait_ms": 0.039518271612169864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298686981201172, "StateBufferConnector_ms": 0.0051403045654296875, "ViewRequirementAgentConnector_ms": 0.09761333465576172}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.21115779876709, "policy_loss": -0.034211184829473495, "vf_loss": 5.221071243286133, "vf_explained_var": -0.09786564856767654, "kl": 0.006320455577224493, "entropy": 2.9329724311828613, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53640.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 8.95, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, -12.0, -23.0, -45.0, -67.0, 10.0, 21.0, 10.0, 43.0, 43.0, 54.0, 32.0, 43.0, 32.0, -12.0, -45.0, -12.0, -122.0, -45.0, -122.0, -56.0, 21.0, -23.0, 21.0, -23.0, -23.0, 21.0, 43.0, 21.0, -12.0, 43.0, 21.0, -34.0, 43.0, -12.0, 21.0, 10.0, -45.0, -1.0, 21.0, -34.0, 43.0, 10.0, -23.0, -12.0, -7.0, -23.0, 32.0, 21.0, -1.0, 76.0, 43.0, -1.0, 21.0, -12.0, -23.0, -12.0, -67.0, -12.0, 32.0, 54.0, 76.0, 76.0, 76.0, 65.0, 32.0, 43.0, 54.0, 54.0, 10.0, 32.0, 32.0, 65.0, -23.0, -1.0, 54.0, 32.0, 54.0, 54.0, 21.0, -12.0, -34.0, -23.0, -12.0, -67.0, -12.0, -67.0, 54.0, 21.0, 54.0, 21.0, 54.0, 21.0, 21.0, 21.0, 21.0, -1.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23000585927896808, "mean_inference_ms": 23.865513610426323, "mean_action_processing_ms": 0.08569411060390902, "mean_env_wait_ms": 0.04004270116472581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048923492431640625, "StateBufferConnector_ms": 0.004618167877197266, "ViewRequirementAgentConnector_ms": 0.09957599639892578}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 8.95, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, -12.0, -23.0, -45.0, -67.0, 10.0, 21.0, 10.0, 43.0, 43.0, 54.0, 32.0, 43.0, 32.0, -12.0, -45.0, -12.0, -122.0, -45.0, -122.0, -56.0, 21.0, -23.0, 21.0, -23.0, -23.0, 21.0, 43.0, 21.0, -12.0, 43.0, 21.0, -34.0, 43.0, -12.0, 21.0, 10.0, -45.0, -1.0, 21.0, -34.0, 43.0, 10.0, -23.0, -12.0, -7.0, -23.0, 32.0, 21.0, -1.0, 76.0, 43.0, -1.0, 21.0, -12.0, -23.0, -12.0, -67.0, -12.0, 32.0, 54.0, 76.0, 76.0, 76.0, 65.0, 32.0, 43.0, 54.0, 54.0, 10.0, 32.0, 32.0, 65.0, -23.0, -1.0, 54.0, 32.0, 54.0, 54.0, 21.0, -12.0, -34.0, -23.0, -12.0, -67.0, -12.0, -67.0, 54.0, 21.0, 54.0, 21.0, 54.0, 21.0, 21.0, 21.0, 21.0, -1.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23000585927896808, "mean_inference_ms": 23.865513610426323, "mean_action_processing_ms": 0.08569411060390902, "mean_env_wait_ms": 0.04004270116472581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048923492431640625, "StateBufferConnector_ms": 0.004618167877197266, "ViewRequirementAgentConnector_ms": 0.09957599639892578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 160983.011, "sample_time_ms": 86355.932, "learn_time_ms": 74617.041, "learn_throughput": 53.607, "synch_weights_time_ms": 9.259}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 2789, "training_iteration": 53, "trial_id": "38794_00007", "date": "2023-06-02_07-17-51", "timestamp": 1685679471, "time_this_iter_s": 177.56628394126892, "time_total_s": 10325.936269521713, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10325.936269521713, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 16.149166666666666, "ram_util_percent": 50.74125}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -111.0, "episode_reward_mean": -27.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -1.0, -23.0, -1.0, -67.0, -23.0, 32.0, -56.0, -111.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21292308696671441, "mean_inference_ms": 23.6604449861751, "mean_action_processing_ms": 0.08361762077881983, "mean_env_wait_ms": 0.03944505001990257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004267692565917969, "StateBufferConnector_ms": 0.005173683166503906, "ViewRequirementAgentConnector_ms": 0.09909629821777344}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.705377578735352, "policy_loss": 0.027783602476119995, "vf_loss": 5.6491899490356445, "vf_explained_var": -0.06840501725673676, "kl": 0.0073885852470994, "entropy": 2.924021005630493, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54660.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 14.89, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -1.0, 21.0, -12.0, -23.0, -12.0, -67.0, -12.0, 32.0, 54.0, 76.0, 76.0, 76.0, 65.0, 32.0, 43.0, 54.0, 54.0, 10.0, 32.0, 32.0, 65.0, -23.0, -1.0, 54.0, 32.0, 54.0, 54.0, 21.0, -12.0, -34.0, -23.0, -12.0, -67.0, -12.0, -67.0, 54.0, 21.0, 54.0, 21.0, 54.0, 21.0, 21.0, 21.0, 21.0, -1.0, 54.0, 32.0, 43.0, 65.0, 65.0, -34.0, -34.0, 43.0, -45.0, 32.0, 32.0, 10.0, -34.0, -12.0, -56.0, 54.0, -56.0, -78.0, -40.0, -1.0, 54.0, 10.0, -12.0, -34.0, 10.0, -1.0, -67.0, 21.0, 76.0, 21.0, -23.0, -12.0, 32.0, 43.0, 43.0, 54.0, 10.0, 65.0, 54.0, 76.0, -12.0, -12.0, 21.0, -56.0, -12.0, -23.0, -1.0, 43.0, 10.0, 43.0, -1.0, 21.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2295882923157884, "mean_inference_ms": 23.81794225911504, "mean_action_processing_ms": 0.08552020118063534, "mean_env_wait_ms": 0.03995792038355498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00490117073059082, "StateBufferConnector_ms": 0.004633903503417969, "ViewRequirementAgentConnector_ms": 0.09924554824829102}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 14.89, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, -1.0, 21.0, -12.0, -23.0, -12.0, -67.0, -12.0, 32.0, 54.0, 76.0, 76.0, 76.0, 65.0, 32.0, 43.0, 54.0, 54.0, 10.0, 32.0, 32.0, 65.0, -23.0, -1.0, 54.0, 32.0, 54.0, 54.0, 21.0, -12.0, -34.0, -23.0, -12.0, -67.0, -12.0, -67.0, 54.0, 21.0, 54.0, 21.0, 54.0, 21.0, 21.0, 21.0, 21.0, -1.0, 54.0, 32.0, 43.0, 65.0, 65.0, -34.0, -34.0, 43.0, -45.0, 32.0, 32.0, 10.0, -34.0, -12.0, -56.0, 54.0, -56.0, -78.0, -40.0, -1.0, 54.0, 10.0, -12.0, -34.0, 10.0, -1.0, -67.0, 21.0, 76.0, 21.0, -23.0, -12.0, 32.0, 43.0, 43.0, 54.0, 10.0, 65.0, 54.0, 76.0, -12.0, -12.0, 21.0, -56.0, -12.0, -23.0, -1.0, 43.0, 10.0, 43.0, -1.0, 21.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2295882923157884, "mean_inference_ms": 23.81794225911504, "mean_action_processing_ms": 0.08552020118063534, "mean_env_wait_ms": 0.03995792038355498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00490117073059082, "StateBufferConnector_ms": 0.004633903503417969, "ViewRequirementAgentConnector_ms": 0.09924554824829102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 161029.959, "sample_time_ms": 86402.675, "learn_time_ms": 74617.334, "learn_throughput": 53.607, "synch_weights_time_ms": 9.18}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 2842, "training_iteration": 54, "trial_id": "38794_00007", "date": "2023-06-02_07-20-49", "timestamp": 1685679649, "time_this_iter_s": 177.43198013305664, "time_total_s": 10503.36824965477, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10503.36824965477, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 16.4071129707113, "ram_util_percent": 50.80041841004185}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 24.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, 43.0, -1.0, 43.0, 21.0, 32.0, 54.0, 54.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21251620654526407, "mean_inference_ms": 23.615497575559438, "mean_action_processing_ms": 0.08344584676495655, "mean_env_wait_ms": 0.03936658569826544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038909912109375, "StateBufferConnector_ms": 0.005037784576416016, "ViewRequirementAgentConnector_ms": 0.09713888168334961}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.13191556930542, "policy_loss": 0.0010917889885604382, "vf_loss": 5.110016345977783, "vf_explained_var": 0.05386941879987717, "kl": 0.005412391386926174, "entropy": 2.9209883213043213, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55680.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 16.21, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 43.0, -45.0, 32.0, 32.0, 10.0, -34.0, -12.0, -56.0, 54.0, -56.0, -78.0, -40.0, -1.0, 54.0, 10.0, -12.0, -34.0, 10.0, -1.0, -67.0, 21.0, 76.0, 21.0, -23.0, -12.0, 32.0, 43.0, 43.0, 54.0, 10.0, 65.0, 54.0, 76.0, -12.0, -12.0, 21.0, -56.0, -12.0, -23.0, -1.0, 43.0, 10.0, 43.0, -1.0, 21.0, 43.0, 76.0, 76.0, 54.0, 76.0, 43.0, 65.0, 76.0, 76.0, 65.0, 32.0, 43.0, 65.0, 21.0, 21.0, 43.0, 54.0, 65.0, -1.0, -23.0, -12.0, 10.0, -1.0, -45.0, 54.0, 21.0, -23.0, 43.0, 21.0, -1.0, -23.0, 65.0, 43.0, -1.0, 21.0, -34.0, 43.0, 43.0, 54.0, -1.0, 65.0, 65.0, -1.0, 10.0, -34.0, 43.0, 32.0, -12.0, -89.0, -23.0, -56.0, 32.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22918990717007703, "mean_inference_ms": 23.772595738013855, "mean_action_processing_ms": 0.08535591980092055, "mean_env_wait_ms": 0.03987807900234848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004912853240966797, "StateBufferConnector_ms": 0.004658699035644531, "ViewRequirementAgentConnector_ms": 0.09948420524597168}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 16.21, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, 43.0, -45.0, 32.0, 32.0, 10.0, -34.0, -12.0, -56.0, 54.0, -56.0, -78.0, -40.0, -1.0, 54.0, 10.0, -12.0, -34.0, 10.0, -1.0, -67.0, 21.0, 76.0, 21.0, -23.0, -12.0, 32.0, 43.0, 43.0, 54.0, 10.0, 65.0, 54.0, 76.0, -12.0, -12.0, 21.0, -56.0, -12.0, -23.0, -1.0, 43.0, 10.0, 43.0, -1.0, 21.0, 43.0, 76.0, 76.0, 54.0, 76.0, 43.0, 65.0, 76.0, 76.0, 65.0, 32.0, 43.0, 65.0, 21.0, 21.0, 43.0, 54.0, 65.0, -1.0, -23.0, -12.0, 10.0, -1.0, -45.0, 54.0, 21.0, -23.0, 43.0, 21.0, -1.0, -23.0, 65.0, 43.0, -1.0, 21.0, -34.0, 43.0, 43.0, 54.0, -1.0, 65.0, 65.0, -1.0, 10.0, -34.0, 43.0, 32.0, -12.0, -89.0, -23.0, -56.0, 32.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22918990717007703, "mean_inference_ms": 23.772595738013855, "mean_action_processing_ms": 0.08535591980092055, "mean_env_wait_ms": 0.03987807900234848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004912853240966797, "StateBufferConnector_ms": 0.004658699035644531, "ViewRequirementAgentConnector_ms": 0.09948420524597168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 161059.501, "sample_time_ms": 86416.354, "learn_time_ms": 74633.156, "learn_throughput": 53.595, "synch_weights_time_ms": 9.207}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 2894, "training_iteration": 55, "trial_id": "38794_00007", "date": "2023-06-02_07-23-46", "timestamp": 1685679826, "time_this_iter_s": 177.44004702568054, "time_total_s": 10680.80829668045, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10680.80829668045, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 16.27, "ram_util_percent": 50.87250000000001}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -45.0, "episode_reward_mean": 0.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -45.0, 32.0, 21.0, 32.0, -1.0, 43.0, -1.0, -12.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21213083707962221, "mean_inference_ms": 23.571648433808367, "mean_action_processing_ms": 0.08327935591824273, "mean_env_wait_ms": 0.039288145110883944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004067420959472656, "StateBufferConnector_ms": 0.0049877166748046875, "ViewRequirementAgentConnector_ms": 0.0954294204711914}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.095985412597656, "policy_loss": -0.049907658249139786, "vf_loss": 5.12296724319458, "vf_explained_var": 0.034369975328445435, "kl": 0.0059635816141963005, "entropy": 2.92165470123291, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56700.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 16.93, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 65.0, 32.0, 43.0, 65.0, 21.0, 21.0, 43.0, 54.0, 65.0, -1.0, -23.0, -12.0, 10.0, -1.0, -45.0, 54.0, 21.0, -23.0, 43.0, 21.0, -1.0, -23.0, 65.0, 43.0, -1.0, 21.0, -34.0, 43.0, 43.0, 54.0, -1.0, 65.0, 65.0, -1.0, 10.0, -34.0, 43.0, 32.0, -12.0, -89.0, -23.0, -56.0, 32.0, 32.0, 54.0, 76.0, 54.0, 43.0, 65.0, 76.0, 32.0, -23.0, -56.0, -12.0, -12.0, 21.0, 76.0, 54.0, 65.0, 32.0, -23.0, 54.0, 54.0, -12.0, 54.0, 43.0, 43.0, -1.0, 65.0, 10.0, 21.0, -1.0, -89.0, 54.0, 32.0, -45.0, 10.0, 21.0, 54.0, 32.0, 76.0, 54.0, 21.0, 21.0, -78.0, -45.0, 54.0, -1.0, -67.0, -1.0, -12.0, -23.0, -1.0, 21.0, -23.0, -34.0, 10.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22879402929610101, "mean_inference_ms": 23.727943982095283, "mean_action_processing_ms": 0.08519182942223569, "mean_env_wait_ms": 0.039799291505714235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004872560501098633, "StateBufferConnector_ms": 0.0046389102935791016, "ViewRequirementAgentConnector_ms": 0.09936904907226562}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 16.93, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 65.0, 32.0, 43.0, 65.0, 21.0, 21.0, 43.0, 54.0, 65.0, -1.0, -23.0, -12.0, 10.0, -1.0, -45.0, 54.0, 21.0, -23.0, 43.0, 21.0, -1.0, -23.0, 65.0, 43.0, -1.0, 21.0, -34.0, 43.0, 43.0, 54.0, -1.0, 65.0, 65.0, -1.0, 10.0, -34.0, 43.0, 32.0, -12.0, -89.0, -23.0, -56.0, 32.0, 32.0, 54.0, 76.0, 54.0, 43.0, 65.0, 76.0, 32.0, -23.0, -56.0, -12.0, -12.0, 21.0, 76.0, 54.0, 65.0, 32.0, -23.0, 54.0, 54.0, -12.0, 54.0, 43.0, 43.0, -1.0, 65.0, 10.0, 21.0, -1.0, -89.0, 54.0, 32.0, -45.0, 10.0, 21.0, 54.0, 32.0, 76.0, 54.0, 21.0, 21.0, -78.0, -45.0, 54.0, -1.0, -67.0, -1.0, -12.0, -23.0, -1.0, 21.0, -23.0, -34.0, 10.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22879402929610101, "mean_inference_ms": 23.727943982095283, "mean_action_processing_ms": 0.08519182942223569, "mean_env_wait_ms": 0.039799291505714235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004872560501098633, "StateBufferConnector_ms": 0.0046389102935791016, "ViewRequirementAgentConnector_ms": 0.09936904907226562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 161049.306, "sample_time_ms": 86409.709, "learn_time_ms": 74629.622, "learn_throughput": 53.598, "synch_weights_time_ms": 9.186}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 2947, "training_iteration": 56, "trial_id": "38794_00007", "date": "2023-06-02_07-26-44", "timestamp": 1685680004, "time_this_iter_s": 177.48762893676758, "time_total_s": 10858.295925617218, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10858.295925617218, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 16.47489539748954, "ram_util_percent": 50.91966527196651}}
{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -111.0, "episode_reward_mean": -54.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.0, -12.0, -23.0, -45.0, -100.0, -89.0, -111.0, -56.0, -23.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21174759672293525, "mean_inference_ms": 23.528727673666427, "mean_action_processing_ms": 0.08312074302820746, "mean_env_wait_ms": 0.03921523054221592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004017353057861328, "StateBufferConnector_ms": 0.0051212310791015625, "ViewRequirementAgentConnector_ms": 0.09736299514770508}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.508591175079346, "policy_loss": -0.013822098262608051, "vf_loss": 5.4962544441223145, "vf_explained_var": -0.14805150032043457, "kl": 0.006804399657994509, "entropy": 2.8980391025543213, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57720.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 10.21, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -56.0, -12.0, -12.0, 21.0, 76.0, 54.0, 65.0, 32.0, -23.0, 54.0, 54.0, -12.0, 54.0, 43.0, 43.0, -1.0, 65.0, 10.0, 21.0, -1.0, -89.0, 54.0, 32.0, -45.0, 10.0, 21.0, 54.0, 32.0, 76.0, 54.0, 21.0, 21.0, -78.0, -45.0, 54.0, -1.0, -67.0, -1.0, -12.0, -23.0, -1.0, 21.0, -23.0, -34.0, 10.0, -78.0, 54.0, 21.0, 32.0, -23.0, 32.0, -40.0, 10.0, -78.0, -23.0, 43.0, -12.0, -34.0, -1.0, 54.0, 32.0, 65.0, 43.0, 32.0, 10.0, 54.0, 43.0, 21.0, 21.0, 32.0, 43.0, 54.0, 54.0, -23.0, -23.0, 21.0, -12.0, -34.0, -7.0, 54.0, 32.0, 32.0, 10.0, 32.0, -1.0, -1.0, -12.0, -56.0, -111.0, -23.0, 43.0, 21.0, 10.0, -12.0, 32.0, 32.0, 10.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2283909233562086, "mean_inference_ms": 23.685119830584654, "mean_action_processing_ms": 0.08503638724251211, "mean_env_wait_ms": 0.03972777473810522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004893302917480469, "StateBufferConnector_ms": 0.004639863967895508, "ViewRequirementAgentConnector_ms": 0.09964632987976074}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 10.21, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, -56.0, -12.0, -12.0, 21.0, 76.0, 54.0, 65.0, 32.0, -23.0, 54.0, 54.0, -12.0, 54.0, 43.0, 43.0, -1.0, 65.0, 10.0, 21.0, -1.0, -89.0, 54.0, 32.0, -45.0, 10.0, 21.0, 54.0, 32.0, 76.0, 54.0, 21.0, 21.0, -78.0, -45.0, 54.0, -1.0, -67.0, -1.0, -12.0, -23.0, -1.0, 21.0, -23.0, -34.0, 10.0, -78.0, 54.0, 21.0, 32.0, -23.0, 32.0, -40.0, 10.0, -78.0, -23.0, 43.0, -12.0, -34.0, -1.0, 54.0, 32.0, 65.0, 43.0, 32.0, 10.0, 54.0, 43.0, 21.0, 21.0, 32.0, 43.0, 54.0, 54.0, -23.0, -23.0, 21.0, -12.0, -34.0, -7.0, 54.0, 32.0, 32.0, 10.0, 32.0, -1.0, -1.0, -12.0, -56.0, -111.0, -23.0, 43.0, 21.0, 10.0, -12.0, 32.0, 32.0, 10.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2283909233562086, "mean_inference_ms": 23.685119830584654, "mean_action_processing_ms": 0.08503638724251211, "mean_env_wait_ms": 0.03972777473810522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004893302917480469, "StateBufferConnector_ms": 0.004639863967895508, "ViewRequirementAgentConnector_ms": 0.09964632987976074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 160868.132, "sample_time_ms": 86425.193, "learn_time_ms": 74432.906, "learn_throughput": 53.74, "synch_weights_time_ms": 9.249}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 3000, "training_iteration": 57, "trial_id": "38794_00007", "date": "2023-06-02_07-29-41", "timestamp": 1685680181, "time_this_iter_s": 177.18326711654663, "time_total_s": 11035.479192733765, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11035.479192733765, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 16.487866108786612, "ram_util_percent": 51.04811715481173}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": 23.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 59.0, 65.0, 54.0, -1.0, -12.0, -45.0, -45.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2114150802197959, "mean_inference_ms": 23.488308837605736, "mean_action_processing_ms": 0.08297332718152699, "mean_env_wait_ms": 0.03915266734183569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039577484130859375, "StateBufferConnector_ms": 0.00522613525390625, "ViewRequirementAgentConnector_ms": 0.09963750839233398}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.564513683319092, "policy_loss": 0.009472563862800598, "vf_loss": 5.527259349822998, "vf_explained_var": -0.09890323877334595, "kl": 0.007226650603115559, "entropy": 2.9040279388427734, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58740.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 15.43, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.0, 10.0, -78.0, -23.0, 43.0, -12.0, -34.0, -1.0, 54.0, 32.0, 65.0, 43.0, 32.0, 10.0, 54.0, 43.0, 21.0, 21.0, 32.0, 43.0, 54.0, 54.0, -23.0, -23.0, 21.0, -12.0, -34.0, -7.0, 54.0, 32.0, 32.0, 10.0, 32.0, -1.0, -1.0, -12.0, -56.0, -111.0, -23.0, 43.0, 21.0, 10.0, -12.0, 32.0, 32.0, 10.0, 43.0, 10.0, 43.0, 76.0, 54.0, 65.0, 65.0, 21.0, 32.0, 32.0, 10.0, -56.0, 54.0, 32.0, 32.0, -12.0, 32.0, 32.0, 54.0, 43.0, -23.0, 65.0, 32.0, -56.0, -45.0, -12.0, 54.0, 32.0, -12.0, 54.0, -23.0, 10.0, 43.0, 54.0, 76.0, 76.0, 54.0, 76.0, 21.0, 10.0, 32.0, -12.0, -1.0, -12.0, -34.0, -12.0, 54.0, -111.0, -67.0, -56.0, 48.0, -1.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22801094978038405, "mean_inference_ms": 23.64410238610317, "mean_action_processing_ms": 0.08488451188917369, "mean_env_wait_ms": 0.03965822808568786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004953622817993164, "StateBufferConnector_ms": 0.004637002944946289, "ViewRequirementAgentConnector_ms": 0.09994792938232422}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 15.43, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.0, 10.0, -78.0, -23.0, 43.0, -12.0, -34.0, -1.0, 54.0, 32.0, 65.0, 43.0, 32.0, 10.0, 54.0, 43.0, 21.0, 21.0, 32.0, 43.0, 54.0, 54.0, -23.0, -23.0, 21.0, -12.0, -34.0, -7.0, 54.0, 32.0, 32.0, 10.0, 32.0, -1.0, -1.0, -12.0, -56.0, -111.0, -23.0, 43.0, 21.0, 10.0, -12.0, 32.0, 32.0, 10.0, 43.0, 10.0, 43.0, 76.0, 54.0, 65.0, 65.0, 21.0, 32.0, 32.0, 10.0, -56.0, 54.0, 32.0, 32.0, -12.0, 32.0, 32.0, 54.0, 43.0, -23.0, 65.0, 32.0, -56.0, -45.0, -12.0, 54.0, 32.0, -12.0, 54.0, -23.0, 10.0, 43.0, 54.0, 76.0, 76.0, 54.0, 76.0, 21.0, 10.0, 32.0, -12.0, -1.0, -12.0, -34.0, -12.0, 54.0, -111.0, -67.0, -56.0, 48.0, -1.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22801094978038405, "mean_inference_ms": 23.64410238610317, "mean_action_processing_ms": 0.08488451188917369, "mean_env_wait_ms": 0.03965822808568786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004953622817993164, "StateBufferConnector_ms": 0.004637002944946289, "ViewRequirementAgentConnector_ms": 0.09994792938232422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 160924.289, "sample_time_ms": 86470.242, "learn_time_ms": 74443.956, "learn_throughput": 53.732, "synch_weights_time_ms": 9.271}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 3052, "training_iteration": 58, "trial_id": "38794_00007", "date": "2023-06-02_07-32-38", "timestamp": 1685680358, "time_this_iter_s": 177.26542615890503, "time_total_s": 11212.74461889267, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11212.74461889267, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 16.323849372384938, "ram_util_percent": 51.06359832635982}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 26.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 10.0, -34.0, 21.0, 21.0, 65.0, 32.0, 54.0, 43.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2110684625954795, "mean_inference_ms": 23.448579410957837, "mean_action_processing_ms": 0.08282150795488406, "mean_env_wait_ms": 0.039087242872883385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003712177276611328, "StateBufferConnector_ms": 0.005021095275878906, "ViewRequirementAgentConnector_ms": 0.0982666015625}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.519260883331299, "policy_loss": -0.007304292172193527, "vf_loss": 6.506179332733154, "vf_explained_var": -0.08285175263881683, "kl": 0.005302923731505871, "entropy": 2.91194748878479, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59760.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 8.18, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 32.0, 32.0, 10.0, -56.0, 54.0, 32.0, 32.0, -12.0, 32.0, 32.0, 54.0, 43.0, -23.0, 65.0, 32.0, -56.0, -45.0, -12.0, 54.0, 32.0, -12.0, 54.0, -23.0, 10.0, 43.0, 54.0, 76.0, 76.0, 54.0, 76.0, 21.0, 10.0, 32.0, -12.0, -1.0, -12.0, -34.0, -12.0, 54.0, -111.0, -67.0, -56.0, 48.0, -1.0, 54.0, 76.0, 43.0, 43.0, 43.0, 21.0, 54.0, 32.0, -34.0, -1.0, -34.0, -12.0, 10.0, -12.0, -34.0, -23.0, 10.0, -1.0, -23.0, 21.0, 10.0, 21.0, -1.0, -1.0, 10.0, 21.0, 10.0, -1.0, 43.0, 21.0, 43.0, 43.0, 76.0, 65.0, 32.0, 10.0, 32.0, 10.0, -23.0, -89.0, 10.0, -1.0, -23.0, -100.0, -34.0, -23.0, 21.0, -34.0, -56.0, -23.0, -56.0, -56.0, -56.0, -12.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2276617906990574, "mean_inference_ms": 23.603439755431683, "mean_action_processing_ms": 0.08473131018636156, "mean_env_wait_ms": 0.03958662313002179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048902034759521484, "StateBufferConnector_ms": 0.004663228988647461, "ViewRequirementAgentConnector_ms": 0.09935498237609863}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 8.18, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 32.0, 32.0, 10.0, -56.0, 54.0, 32.0, 32.0, -12.0, 32.0, 32.0, 54.0, 43.0, -23.0, 65.0, 32.0, -56.0, -45.0, -12.0, 54.0, 32.0, -12.0, 54.0, -23.0, 10.0, 43.0, 54.0, 76.0, 76.0, 54.0, 76.0, 21.0, 10.0, 32.0, -12.0, -1.0, -12.0, -34.0, -12.0, 54.0, -111.0, -67.0, -56.0, 48.0, -1.0, 54.0, 76.0, 43.0, 43.0, 43.0, 21.0, 54.0, 32.0, -34.0, -1.0, -34.0, -12.0, 10.0, -12.0, -34.0, -23.0, 10.0, -1.0, -23.0, 21.0, 10.0, 21.0, -1.0, -1.0, 10.0, 21.0, 10.0, -1.0, 43.0, 21.0, 43.0, 43.0, 76.0, 65.0, 32.0, 10.0, 32.0, 10.0, -23.0, -89.0, 10.0, -1.0, -23.0, -100.0, -34.0, -23.0, 21.0, -34.0, -56.0, -23.0, -56.0, -56.0, -56.0, -12.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2276617906990574, "mean_inference_ms": 23.603439755431683, "mean_action_processing_ms": 0.08473131018636156, "mean_env_wait_ms": 0.03958662313002179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048902034759521484, "StateBufferConnector_ms": 0.004663228988647461, "ViewRequirementAgentConnector_ms": 0.09935498237609863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 160865.091, "sample_time_ms": 86392.311, "learn_time_ms": 74462.587, "learn_throughput": 53.718, "synch_weights_time_ms": 9.386}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 3105, "training_iteration": 59, "trial_id": "38794_00007", "date": "2023-06-02_07-35-36", "timestamp": 1685680536, "time_this_iter_s": 177.34735202789307, "time_total_s": 11390.091970920563, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11390.091970920563, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 16.555230125523014, "ram_util_percent": 51.105020920502085}}
{"evaluation": {"episode_reward_max": 59.0, "episode_reward_min": -45.0, "episode_reward_mean": 20.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 59.0, -1.0, 21.0, -45.0, 32.0, 43.0, 10.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21073508217147516, "mean_inference_ms": 23.409683237326558, "mean_action_processing_ms": 0.0826785032227542, "mean_env_wait_ms": 0.0390222372134232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.005173683166503906, "ViewRequirementAgentConnector_ms": 0.09841680526733398}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.062996864318848, "policy_loss": -0.0465661883354187, "vf_loss": 6.083675861358643, "vf_explained_var": -0.13989774882793427, "kl": 0.0067336708307266235, "entropy": 2.904951333999634, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60780.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -5.13, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -34.0, -1.0, -34.0, -12.0, 10.0, -12.0, -34.0, -23.0, 10.0, -1.0, -23.0, 21.0, 10.0, 21.0, -1.0, -1.0, 10.0, 21.0, 10.0, -1.0, 43.0, 21.0, 43.0, 43.0, 76.0, 65.0, 32.0, 10.0, 32.0, 10.0, -23.0, -89.0, 10.0, -1.0, -23.0, -100.0, -34.0, -23.0, 21.0, -34.0, -56.0, -23.0, -56.0, -56.0, -56.0, -12.0, 76.0, 76.0, 65.0, 32.0, -23.0, 54.0, 76.0, 65.0, -12.0, 54.0, 10.0, -34.0, -23.0, 43.0, -1.0, -34.0, 32.0, 26.0, -1.0, -12.0, 43.0, 21.0, -56.0, -34.0, 10.0, -23.0, 21.0, -67.0, -23.0, -34.0, -12.0, 21.0, 32.0, 10.0, -100.0, -78.0, 21.0, -45.0, -45.0, -23.0, 21.0, -34.0, -34.0, -89.0, -89.0, 32.0, -12.0, -12.0, -23.0, -1.0, -34.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22732972558049233, "mean_inference_ms": 23.565033482938414, "mean_action_processing_ms": 0.08458908431149231, "mean_env_wait_ms": 0.039520256981472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004884004592895508, "StateBufferConnector_ms": 0.0046389102935791016, "ViewRequirementAgentConnector_ms": 0.09925436973571777}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -5.13, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -34.0, -1.0, -34.0, -12.0, 10.0, -12.0, -34.0, -23.0, 10.0, -1.0, -23.0, 21.0, 10.0, 21.0, -1.0, -1.0, 10.0, 21.0, 10.0, -1.0, 43.0, 21.0, 43.0, 43.0, 76.0, 65.0, 32.0, 10.0, 32.0, 10.0, -23.0, -89.0, 10.0, -1.0, -23.0, -100.0, -34.0, -23.0, 21.0, -34.0, -56.0, -23.0, -56.0, -56.0, -56.0, -12.0, 76.0, 76.0, 65.0, 32.0, -23.0, 54.0, 76.0, 65.0, -12.0, 54.0, 10.0, -34.0, -23.0, 43.0, -1.0, -34.0, 32.0, 26.0, -1.0, -12.0, 43.0, 21.0, -56.0, -34.0, 10.0, -23.0, 21.0, -67.0, -23.0, -34.0, -12.0, 21.0, 32.0, 10.0, -100.0, -78.0, 21.0, -45.0, -45.0, -23.0, 21.0, -34.0, -34.0, -89.0, -89.0, 32.0, -12.0, -12.0, -23.0, -1.0, -34.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22732972558049233, "mean_inference_ms": 23.565033482938414, "mean_action_processing_ms": 0.08458908431149231, "mean_env_wait_ms": 0.039520256981472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004884004592895508, "StateBufferConnector_ms": 0.0046389102935791016, "ViewRequirementAgentConnector_ms": 0.09925436973571777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 160904.335, "sample_time_ms": 86434.735, "learn_time_ms": 74459.35, "learn_throughput": 53.721, "synch_weights_time_ms": 9.444}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 3157, "training_iteration": 60, "trial_id": "38794_00007", "date": "2023-06-02_07-38-33", "timestamp": 1685680713, "time_this_iter_s": 177.34842801094055, "time_total_s": 11567.440398931503, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11567.440398931503, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 16.151882845188286, "ram_util_percent": 51.206694560669455}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -100.0, "episode_reward_mean": 18.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 54.0, 43.0, 10.0, 32.0, 21.0, 21.0, 65.0, -1.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21039795488307472, "mean_inference_ms": 23.37164915975176, "mean_action_processing_ms": 0.08253397988593211, "mean_env_wait_ms": 0.03895778918898328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038504600524902344, "StateBufferConnector_ms": 0.004944801330566406, "ViewRequirementAgentConnector_ms": 0.09615182876586914}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.298888206481934, "policy_loss": -0.03554985672235489, "vf_loss": 5.303048610687256, "vf_explained_var": -0.19849994778633118, "kl": 0.008165081031620502, "entropy": 2.9243102073669434, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61800.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 3.22, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 65.0, -12.0, 54.0, 10.0, -34.0, -23.0, 43.0, -1.0, -34.0, 32.0, 26.0, -1.0, -12.0, 43.0, 21.0, -56.0, -34.0, 10.0, -23.0, 21.0, -67.0, -23.0, -34.0, -12.0, 21.0, 32.0, 10.0, -100.0, -78.0, 21.0, -45.0, -45.0, -23.0, 21.0, -34.0, -34.0, -89.0, -89.0, 32.0, -12.0, -12.0, -23.0, -1.0, -34.0, -67.0, -67.0, -111.0, -23.0, -45.0, 10.0, 32.0, -56.0, -56.0, 21.0, -67.0, 21.0, -23.0, 43.0, -1.0, -23.0, 10.0, 43.0, 32.0, 54.0, 32.0, 43.0, 43.0, -45.0, -89.0, 21.0, 43.0, 65.0, 65.0, 65.0, 54.0, 65.0, 43.0, 54.0, 54.0, 65.0, 43.0, 21.0, -23.0, 32.0, -1.0, -23.0, -89.0, 43.0, 21.0, 54.0, 65.0, 65.0, 76.0, 37.0, 76.0, 43.0, 54.0, -7.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22700147142475302, "mean_inference_ms": 23.526950774509423, "mean_action_processing_ms": 0.08444935588861685, "mean_env_wait_ms": 0.039454907493716856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004941463470458984, "StateBufferConnector_ms": 0.004603147506713867, "ViewRequirementAgentConnector_ms": 0.09979438781738281}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 3.22, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 65.0, -12.0, 54.0, 10.0, -34.0, -23.0, 43.0, -1.0, -34.0, 32.0, 26.0, -1.0, -12.0, 43.0, 21.0, -56.0, -34.0, 10.0, -23.0, 21.0, -67.0, -23.0, -34.0, -12.0, 21.0, 32.0, 10.0, -100.0, -78.0, 21.0, -45.0, -45.0, -23.0, 21.0, -34.0, -34.0, -89.0, -89.0, 32.0, -12.0, -12.0, -23.0, -1.0, -34.0, -67.0, -67.0, -111.0, -23.0, -45.0, 10.0, 32.0, -56.0, -56.0, 21.0, -67.0, 21.0, -23.0, 43.0, -1.0, -23.0, 10.0, 43.0, 32.0, 54.0, 32.0, 43.0, 43.0, -45.0, -89.0, 21.0, 43.0, 65.0, 65.0, 65.0, 54.0, 65.0, 43.0, 54.0, 54.0, 65.0, 43.0, 21.0, -23.0, 32.0, -1.0, -23.0, -89.0, 43.0, 21.0, 54.0, 65.0, 65.0, 76.0, 37.0, 76.0, 43.0, 54.0, -7.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22700147142475302, "mean_inference_ms": 23.526950774509423, "mean_action_processing_ms": 0.08444935588861685, "mean_env_wait_ms": 0.039454907493716856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004941463470458984, "StateBufferConnector_ms": 0.004603147506713867, "ViewRequirementAgentConnector_ms": 0.09979438781738281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 160898.599, "sample_time_ms": 86421.947, "learn_time_ms": 74466.219, "learn_throughput": 53.716, "synch_weights_time_ms": 9.612}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 3210, "training_iteration": 61, "trial_id": "38794_00007", "date": "2023-06-02_07-41-30", "timestamp": 1685680890, "time_this_iter_s": 177.1543002128601, "time_total_s": 11744.594699144363, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11744.594699144363, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 16.199581589958157, "ram_util_percent": 51.20669456066946}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -45.0, "episode_reward_mean": 1.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 21.0, 32.0, 32.0, -23.0, 26.0, -45.0, 10.0, -34.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21008850067378945, "mean_inference_ms": 23.3358515763343, "mean_action_processing_ms": 0.08240005859244177, "mean_env_wait_ms": 0.03889677103143432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004439353942871094, "StateBufferConnector_ms": 0.005085468292236328, "ViewRequirementAgentConnector_ms": 0.09821176528930664}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 4.87570858001709, "policy_loss": -0.059769634157419205, "vf_loss": 4.910953044891357, "vf_explained_var": 0.07159093022346497, "kl": 0.006379676051437855, "entropy": 2.919081211090088, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62820.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 24.12, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 21.0, -67.0, 21.0, -23.0, 43.0, -1.0, -23.0, 10.0, 43.0, 32.0, 54.0, 32.0, 43.0, 43.0, -45.0, -89.0, 21.0, 43.0, 65.0, 65.0, 65.0, 54.0, 65.0, 43.0, 54.0, 54.0, 65.0, 43.0, 21.0, -23.0, 32.0, -1.0, -23.0, -89.0, 43.0, 21.0, 54.0, 65.0, 65.0, 76.0, 37.0, 76.0, 43.0, 54.0, -7.0, -23.0, 21.0, -45.0, -45.0, 10.0, -23.0, -45.0, 10.0, 21.0, 43.0, 43.0, 54.0, -12.0, -23.0, 10.0, 32.0, 32.0, 65.0, 32.0, 54.0, 76.0, -1.0, -12.0, -12.0, -1.0, -23.0, 21.0, 54.0, 21.0, 21.0, 32.0, 54.0, -1.0, 54.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -1.0, 32.0, 65.0, 43.0, -67.0, 21.0, -12.0, 54.0, 54.0, 54.0, 65.0, 37.0, 54.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2266888449970851, "mean_inference_ms": 23.488970985592204, "mean_action_processing_ms": 0.0843159611064862, "mean_env_wait_ms": 0.0393935356066435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004923105239868164, "StateBufferConnector_ms": 0.004594564437866211, "ViewRequirementAgentConnector_ms": 0.09943175315856934}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 24.12, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, 21.0, -67.0, 21.0, -23.0, 43.0, -1.0, -23.0, 10.0, 43.0, 32.0, 54.0, 32.0, 43.0, 43.0, -45.0, -89.0, 21.0, 43.0, 65.0, 65.0, 65.0, 54.0, 65.0, 43.0, 54.0, 54.0, 65.0, 43.0, 21.0, -23.0, 32.0, -1.0, -23.0, -89.0, 43.0, 21.0, 54.0, 65.0, 65.0, 76.0, 37.0, 76.0, 43.0, 54.0, -7.0, -23.0, 21.0, -45.0, -45.0, 10.0, -23.0, -45.0, 10.0, 21.0, 43.0, 43.0, 54.0, -12.0, -23.0, 10.0, 32.0, 32.0, 65.0, 32.0, 54.0, 76.0, -1.0, -12.0, -12.0, -1.0, -23.0, 21.0, 54.0, 21.0, 21.0, 32.0, 54.0, -1.0, 54.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -1.0, 32.0, 65.0, 43.0, -67.0, 21.0, -12.0, 54.0, 54.0, 54.0, 65.0, 37.0, 54.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2266888449970851, "mean_inference_ms": 23.488970985592204, "mean_action_processing_ms": 0.0843159611064862, "mean_env_wait_ms": 0.0393935356066435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004923105239868164, "StateBufferConnector_ms": 0.004594564437866211, "ViewRequirementAgentConnector_ms": 0.09943175315856934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 160938.327, "sample_time_ms": 86455.591, "learn_time_ms": 74472.273, "learn_throughput": 53.711, "synch_weights_time_ms": 9.647}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 3263, "training_iteration": 62, "trial_id": "38794_00007", "date": "2023-06-02_07-44-27", "timestamp": 1685681067, "time_this_iter_s": 176.74130010604858, "time_total_s": 11921.335999250412, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11921.335999250412, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.962869198312237, "ram_util_percent": 51.30759493670887}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -111.0, "episode_reward_mean": -32.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -89.0, -23.0, 10.0, -34.0, -111.0, -34.0, -23.0, -45.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20977424570911674, "mean_inference_ms": 23.300866296333627, "mean_action_processing_ms": 0.08226264571514161, "mean_env_wait_ms": 0.038836136345466885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004608631134033203, "StateBufferConnector_ms": 0.004982948303222656, "ViewRequirementAgentConnector_ms": 0.0977325439453125}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.322449684143066, "policy_loss": -0.019826723262667656, "vf_loss": 5.320545196533203, "vf_explained_var": -0.023607539013028145, "kl": 0.005652794148772955, "entropy": 2.933812141418457, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 23.74, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, 10.0, 21.0, 43.0, 43.0, 54.0, -12.0, -23.0, 10.0, 32.0, 32.0, 65.0, 32.0, 54.0, 76.0, -1.0, -12.0, -12.0, -1.0, -23.0, 21.0, 54.0, 21.0, 21.0, 32.0, 54.0, -1.0, 54.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -1.0, 32.0, 65.0, 43.0, -67.0, 21.0, -12.0, 54.0, 54.0, 54.0, 65.0, 37.0, 54.0, -45.0, -34.0, -18.0, -78.0, 10.0, -144.0, -45.0, -34.0, -12.0, 10.0, -56.0, 43.0, 54.0, 76.0, 65.0, 21.0, -1.0, -12.0, 10.0, 10.0, 21.0, 10.0, 43.0, 32.0, 76.0, 76.0, 76.0, 21.0, 32.0, 54.0, 21.0, 21.0, 21.0, 65.0, 54.0, 32.0, -1.0, 76.0, 43.0, 10.0, -1.0, 21.0, 65.0, 76.0, 21.0, 65.0, 54.0, 54.0, -45.0, 32.0, -23.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22638550352863868, "mean_inference_ms": 23.45377961758067, "mean_action_processing_ms": 0.08419020432565338, "mean_env_wait_ms": 0.039335177948175454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004887819290161133, "StateBufferConnector_ms": 0.004580020904541016, "ViewRequirementAgentConnector_ms": 0.09909749031066895}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 23.74, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, 10.0, 21.0, 43.0, 43.0, 54.0, -12.0, -23.0, 10.0, 32.0, 32.0, 65.0, 32.0, 54.0, 76.0, -1.0, -12.0, -12.0, -1.0, -23.0, 21.0, 54.0, 21.0, 21.0, 32.0, 54.0, -1.0, 54.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -1.0, 32.0, 65.0, 43.0, -67.0, 21.0, -12.0, 54.0, 54.0, 54.0, 65.0, 37.0, 54.0, -45.0, -34.0, -18.0, -78.0, 10.0, -144.0, -45.0, -34.0, -12.0, 10.0, -56.0, 43.0, 54.0, 76.0, 65.0, 21.0, -1.0, -12.0, 10.0, 10.0, 21.0, 10.0, 43.0, 32.0, 76.0, 76.0, 76.0, 21.0, 32.0, 54.0, 21.0, 21.0, 21.0, 65.0, 54.0, 32.0, -1.0, 76.0, 43.0, 10.0, -1.0, 21.0, 65.0, 76.0, 21.0, 65.0, 54.0, 54.0, -45.0, 32.0, -23.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22638550352863868, "mean_inference_ms": 23.45377961758067, "mean_action_processing_ms": 0.08419020432565338, "mean_env_wait_ms": 0.039335177948175454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004887819290161133, "StateBufferConnector_ms": 0.004580020904541016, "ViewRequirementAgentConnector_ms": 0.09909749031066895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 160987.621, "sample_time_ms": 86488.716, "learn_time_ms": 74488.339, "learn_throughput": 53.7, "synch_weights_time_ms": 9.722}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 3315, "training_iteration": 63, "trial_id": "38794_00007", "date": "2023-06-02_07-47-25", "timestamp": 1685681245, "time_this_iter_s": 178.01287817955017, "time_total_s": 12099.348877429962, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12099.348877429962, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 16.337083333333332, "ram_util_percent": 51.386250000000004}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -67.0, "episode_reward_mean": -14.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -1.0, 43.0, -56.0, 10.0, -45.0, -12.0, -1.0, -67.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20946982571498401, "mean_inference_ms": 23.266800992796338, "mean_action_processing_ms": 0.08213888405062489, "mean_env_wait_ms": 0.03877712686664608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040435791015625, "StateBufferConnector_ms": 0.004889965057373047, "ViewRequirementAgentConnector_ms": 0.09592533111572266}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.685092926025391, "policy_loss": -0.028349516913294792, "vf_loss": 5.689134120941162, "vf_explained_var": -0.016400018706917763, "kl": 0.006323212757706642, "entropy": 2.912409543991089, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64860.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 16.98, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -34.0, -12.0, 10.0, -56.0, 43.0, 54.0, 76.0, 65.0, 21.0, -1.0, -12.0, 10.0, 10.0, 21.0, 10.0, 43.0, 32.0, 76.0, 76.0, 76.0, 21.0, 32.0, 54.0, 21.0, 21.0, 21.0, 65.0, 54.0, 32.0, -1.0, 76.0, 43.0, 10.0, -1.0, 21.0, 65.0, 76.0, 21.0, 65.0, 54.0, 54.0, -45.0, 32.0, -23.0, -1.0, 10.0, 32.0, -56.0, -45.0, -23.0, -12.0, 43.0, -100.0, 43.0, 65.0, -23.0, 43.0, -78.0, 54.0, 10.0, 21.0, -78.0, -56.0, 10.0, 32.0, 10.0, 32.0, 32.0, -12.0, 15.0, -23.0, 10.0, -56.0, 32.0, 54.0, 65.0, 32.0, 10.0, 32.0, 32.0, -1.0, -1.0, -34.0, 21.0, 43.0, 32.0, 32.0, -1.0, -1.0, 43.0, 32.0, 32.0, 21.0, -45.0, 32.0, 32.0, -1.0, 10.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22609039154146365, "mean_inference_ms": 23.419809707631792, "mean_action_processing_ms": 0.08406652629265857, "mean_env_wait_ms": 0.03927767195200527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004941225051879883, "StateBufferConnector_ms": 0.004588127136230469, "ViewRequirementAgentConnector_ms": 0.09921836853027344}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 16.98, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -34.0, -12.0, 10.0, -56.0, 43.0, 54.0, 76.0, 65.0, 21.0, -1.0, -12.0, 10.0, 10.0, 21.0, 10.0, 43.0, 32.0, 76.0, 76.0, 76.0, 21.0, 32.0, 54.0, 21.0, 21.0, 21.0, 65.0, 54.0, 32.0, -1.0, 76.0, 43.0, 10.0, -1.0, 21.0, 65.0, 76.0, 21.0, 65.0, 54.0, 54.0, -45.0, 32.0, -23.0, -1.0, 10.0, 32.0, -56.0, -45.0, -23.0, -12.0, 43.0, -100.0, 43.0, 65.0, -23.0, 43.0, -78.0, 54.0, 10.0, 21.0, -78.0, -56.0, 10.0, 32.0, 10.0, 32.0, 32.0, -12.0, 15.0, -23.0, 10.0, -56.0, 32.0, 54.0, 65.0, 32.0, 10.0, 32.0, 32.0, -1.0, -1.0, -34.0, 21.0, 43.0, 32.0, 32.0, -1.0, -1.0, 43.0, 32.0, 32.0, 21.0, -45.0, 32.0, 32.0, -1.0, 10.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22609039154146365, "mean_inference_ms": 23.419809707631792, "mean_action_processing_ms": 0.08406652629265857, "mean_env_wait_ms": 0.03927767195200527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004941225051879883, "StateBufferConnector_ms": 0.004588127136230469, "ViewRequirementAgentConnector_ms": 0.09921836853027344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 160981.671, "sample_time_ms": 86457.079, "learn_time_ms": 74514.038, "learn_throughput": 53.681, "synch_weights_time_ms": 9.716}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 3368, "training_iteration": 64, "trial_id": "38794_00007", "date": "2023-06-02_07-50-22", "timestamp": 1685681422, "time_this_iter_s": 177.42884302139282, "time_total_s": 12276.777720451355, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12276.777720451355, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 16.700418410041838, "ram_util_percent": 51.413389121338895}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -111.0, "episode_reward_mean": -19.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -12.0, 10.0, 10.0, -12.0, -89.0, -78.0, -111.0, -1.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20917554449058756, "mean_inference_ms": 23.23402821015029, "mean_action_processing_ms": 0.08201822573659738, "mean_env_wait_ms": 0.03872390980735095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038290023803710938, "StateBufferConnector_ms": 0.005128383636474609, "ViewRequirementAgentConnector_ms": 0.09928703308105469}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.347306251525879, "policy_loss": -0.027765637263655663, "vf_loss": 5.350480556488037, "vf_explained_var": -0.010111271403729916, "kl": 0.006396662909537554, "entropy": 2.9057109355926514, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65880.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 18.19, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.0, 43.0, 65.0, -23.0, 43.0, -78.0, 54.0, 10.0, 21.0, -78.0, -56.0, 10.0, 32.0, 10.0, 32.0, 32.0, -12.0, 15.0, -23.0, 10.0, -56.0, 32.0, 54.0, 65.0, 32.0, 10.0, 32.0, 32.0, -1.0, -1.0, -34.0, 21.0, 43.0, 32.0, 32.0, -1.0, -1.0, 43.0, 32.0, 32.0, 21.0, -45.0, 32.0, 32.0, -1.0, 10.0, 65.0, 21.0, 21.0, -45.0, -1.0, 43.0, 21.0, 32.0, -1.0, -34.0, 21.0, 10.0, -1.0, 21.0, 10.0, -12.0, -12.0, -1.0, 54.0, 21.0, -45.0, -56.0, 32.0, 43.0, 21.0, -12.0, 43.0, 65.0, -23.0, 32.0, 65.0, 76.0, 76.0, 54.0, 10.0, -12.0, 10.0, 43.0, 54.0, 43.0, 54.0, 65.0, 32.0, 65.0, 54.0, 54.0, 32.0, 43.0, 43.0, 54.0, 10.0, 21.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22580434859557713, "mean_inference_ms": 23.386655209451902, "mean_action_processing_ms": 0.08394552719827601, "mean_env_wait_ms": 0.03922158676855608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004954099655151367, "StateBufferConnector_ms": 0.004599809646606445, "ViewRequirementAgentConnector_ms": 0.09913110733032227}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 18.19, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.0, 43.0, 65.0, -23.0, 43.0, -78.0, 54.0, 10.0, 21.0, -78.0, -56.0, 10.0, 32.0, 10.0, 32.0, 32.0, -12.0, 15.0, -23.0, 10.0, -56.0, 32.0, 54.0, 65.0, 32.0, 10.0, 32.0, 32.0, -1.0, -1.0, -34.0, 21.0, 43.0, 32.0, 32.0, -1.0, -1.0, 43.0, 32.0, 32.0, 21.0, -45.0, 32.0, 32.0, -1.0, 10.0, 65.0, 21.0, 21.0, -45.0, -1.0, 43.0, 21.0, 32.0, -1.0, -34.0, 21.0, 10.0, -1.0, 21.0, 10.0, -12.0, -12.0, -1.0, 54.0, 21.0, -45.0, -56.0, 32.0, 43.0, 21.0, -12.0, 43.0, 65.0, -23.0, 32.0, 65.0, 76.0, 76.0, 54.0, 10.0, -12.0, 10.0, 43.0, 54.0, 43.0, 54.0, 65.0, 32.0, 65.0, 54.0, 54.0, 32.0, 43.0, 43.0, 54.0, 10.0, 21.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22580434859557713, "mean_inference_ms": 23.386655209451902, "mean_action_processing_ms": 0.08394552719827601, "mean_env_wait_ms": 0.03922158676855608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004954099655151367, "StateBufferConnector_ms": 0.004599809646606445, "ViewRequirementAgentConnector_ms": 0.09913110733032227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 160996.716, "sample_time_ms": 86454.85, "learn_time_ms": 74531.295, "learn_throughput": 53.669, "synch_weights_time_ms": 9.744}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 3421, "training_iteration": 65, "trial_id": "38794_00007", "date": "2023-06-02_07-53-20", "timestamp": 1685681600, "time_this_iter_s": 177.55242204666138, "time_total_s": 12454.330142498016, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12454.330142498016, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 16.228571428571428, "ram_util_percent": 51.46512605042015}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -34.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 10.0, 43.0, 10.0, 54.0, 43.0, 21.0, -12.0, -34.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20888095975185977, "mean_inference_ms": 23.20188064447433, "mean_action_processing_ms": 0.08189691263072117, "mean_env_wait_ms": 0.03866811790229796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004050731658935547, "StateBufferConnector_ms": 0.005049705505371094, "ViewRequirementAgentConnector_ms": 0.0970768928527832}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.7525811195373535, "policy_loss": -0.0222132820636034, "vf_loss": 5.753786563873291, "vf_explained_var": -0.025354163721203804, "kl": 0.005464680027216673, "entropy": 2.937140464782715, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66915.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 18.58, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 32.0, -1.0, -34.0, 21.0, 10.0, -1.0, 21.0, 10.0, -12.0, -12.0, -1.0, 54.0, 21.0, -45.0, -56.0, 32.0, 43.0, 21.0, -12.0, 43.0, 65.0, -23.0, 32.0, 65.0, 76.0, 76.0, 54.0, 10.0, -12.0, 10.0, 43.0, 54.0, 43.0, 54.0, 65.0, 32.0, 65.0, 54.0, 54.0, 32.0, 43.0, 43.0, 54.0, 10.0, 21.0, 54.0, 32.0, 65.0, 76.0, 65.0, 76.0, 32.0, 65.0, 10.0, 65.0, 54.0, 21.0, 43.0, 32.0, 10.0, 32.0, -12.0, -1.0, 10.0, -155.0, -12.0, -34.0, -12.0, 21.0, 32.0, -12.0, 65.0, 21.0, -12.0, -67.0, -45.0, -12.0, -1.0, -1.0, -34.0, 43.0, 21.0, -34.0, 43.0, -45.0, -12.0, 54.0, 10.0, 54.0, 43.0, 21.0, 21.0, -1.0, 21.0, -1.0, -34.0, 10.0, -12.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22552525630384232, "mean_inference_ms": 23.35498580744754, "mean_action_processing_ms": 0.08382813917818878, "mean_env_wait_ms": 0.03916642106438259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004921674728393555, "StateBufferConnector_ms": 0.0045430660247802734, "ViewRequirementAgentConnector_ms": 0.09897422790527344}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 18.58, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 32.0, -1.0, -34.0, 21.0, 10.0, -1.0, 21.0, 10.0, -12.0, -12.0, -1.0, 54.0, 21.0, -45.0, -56.0, 32.0, 43.0, 21.0, -12.0, 43.0, 65.0, -23.0, 32.0, 65.0, 76.0, 76.0, 54.0, 10.0, -12.0, 10.0, 43.0, 54.0, 43.0, 54.0, 65.0, 32.0, 65.0, 54.0, 54.0, 32.0, 43.0, 43.0, 54.0, 10.0, 21.0, 54.0, 32.0, 65.0, 76.0, 65.0, 76.0, 32.0, 65.0, 10.0, 65.0, 54.0, 21.0, 43.0, 32.0, 10.0, 32.0, -12.0, -1.0, 10.0, -155.0, -12.0, -34.0, -12.0, 21.0, 32.0, -12.0, 65.0, 21.0, -12.0, -67.0, -45.0, -12.0, -1.0, -1.0, -34.0, 43.0, 21.0, -34.0, 43.0, -45.0, -12.0, 54.0, 10.0, 54.0, 43.0, 21.0, 21.0, -1.0, 21.0, -1.0, -34.0, 10.0, -12.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22552525630384232, "mean_inference_ms": 23.35498580744754, "mean_action_processing_ms": 0.08382813917818878, "mean_env_wait_ms": 0.03916642106438259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004921674728393555, "StateBufferConnector_ms": 0.0045430660247802734, "ViewRequirementAgentConnector_ms": 0.09897422790527344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 161220.5, "sample_time_ms": 86435.985, "learn_time_ms": 74773.86, "learn_throughput": 53.495, "synch_weights_time_ms": 9.83}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 3473, "training_iteration": 66, "trial_id": "38794_00007", "date": "2023-06-02_07-56-20", "timestamp": 1685681780, "time_this_iter_s": 179.6630299091339, "time_total_s": 12633.99317240715, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12633.99317240715, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 16.116115702479338, "ram_util_percent": 51.51694214876032}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -78.0, -12.0, 65.0, 76.0, 76.0, 32.0, 65.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20859399788303018, "mean_inference_ms": 23.170804755484177, "mean_action_processing_ms": 0.08178305540232608, "mean_env_wait_ms": 0.03861525556877809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003988742828369141, "StateBufferConnector_ms": 0.005047321319580078, "ViewRequirementAgentConnector_ms": 0.09872198104858398}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.310840129852295, "policy_loss": -0.05785418674349785, "vf_loss": 6.348222255706787, "vf_explained_var": -0.1683180183172226, "kl": 0.00532540725544095, "entropy": 2.9368269443511963, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67950.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": -155.0, "episode_reward_mean": 3.84, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 10.0, 65.0, 54.0, 21.0, 43.0, 32.0, 10.0, 32.0, -12.0, -1.0, 10.0, -155.0, -12.0, -34.0, -12.0, 21.0, 32.0, -12.0, 65.0, 21.0, -12.0, -67.0, -45.0, -12.0, -1.0, -1.0, -34.0, 43.0, 21.0, -34.0, 43.0, -45.0, -12.0, 54.0, 10.0, 54.0, 43.0, 21.0, 21.0, -1.0, 21.0, -1.0, -34.0, 10.0, -12.0, 10.0, 43.0, 43.0, -1.0, 21.0, 65.0, 10.0, -12.0, 54.0, 54.0, -1.0, 10.0, -67.0, 32.0, 10.0, -23.0, -67.0, -56.0, 65.0, -23.0, -12.0, 32.0, 32.0, -12.0, -23.0, 21.0, -12.0, 10.0, 43.0, 54.0, 21.0, 21.0, 54.0, 21.0, -12.0, -78.0, -12.0, -23.0, 32.0, 21.0, -23.0, 54.0, -12.0, -56.0, 21.0, 65.0, -12.0, -67.0, -12.0, 43.0, -23.0, -67.0, -45.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22525708858597085, "mean_inference_ms": 23.32359533494123, "mean_action_processing_ms": 0.08371464973251434, "mean_env_wait_ms": 0.039112436058195935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004921913146972656, "StateBufferConnector_ms": 0.0045473575592041016, "ViewRequirementAgentConnector_ms": 0.09893298149108887}}, "episode_reward_max": 65.0, "episode_reward_min": -155.0, "episode_reward_mean": 3.84, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 10.0, 65.0, 54.0, 21.0, 43.0, 32.0, 10.0, 32.0, -12.0, -1.0, 10.0, -155.0, -12.0, -34.0, -12.0, 21.0, 32.0, -12.0, 65.0, 21.0, -12.0, -67.0, -45.0, -12.0, -1.0, -1.0, -34.0, 43.0, 21.0, -34.0, 43.0, -45.0, -12.0, 54.0, 10.0, 54.0, 43.0, 21.0, 21.0, -1.0, 21.0, -1.0, -34.0, 10.0, -12.0, 10.0, 43.0, 43.0, -1.0, 21.0, 65.0, 10.0, -12.0, 54.0, 54.0, -1.0, 10.0, -67.0, 32.0, 10.0, -23.0, -67.0, -56.0, 65.0, -23.0, -12.0, 32.0, 32.0, -12.0, -23.0, 21.0, -12.0, 10.0, 43.0, 54.0, 21.0, 21.0, 54.0, 21.0, -12.0, -78.0, -12.0, -23.0, 32.0, 21.0, -23.0, 54.0, -12.0, -56.0, 21.0, 65.0, -12.0, -67.0, -12.0, 43.0, -23.0, -67.0, -45.0, -100.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22525708858597085, "mean_inference_ms": 23.32359533494123, "mean_action_processing_ms": 0.08371464973251434, "mean_env_wait_ms": 0.039112436058195935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004921913146972656, "StateBufferConnector_ms": 0.0045473575592041016, "ViewRequirementAgentConnector_ms": 0.09893298149108887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 161266.724, "sample_time_ms": 86439.155, "learn_time_ms": 74816.867, "learn_throughput": 53.464, "synch_weights_time_ms": 9.872}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 3526, "training_iteration": 67, "trial_id": "38794_00007", "date": "2023-06-02_07-59-17", "timestamp": 1685681957, "time_this_iter_s": 177.65067195892334, "time_total_s": 12811.643844366074, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12811.643844366074, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 16.47405857740586, "ram_util_percent": 51.58702928870293}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -133.0, "episode_reward_mean": -18.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 10.0, -51.0, 10.0, -67.0, 21.0, -133.0, -56.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20834342772897782, "mean_inference_ms": 23.14172822420047, "mean_action_processing_ms": 0.08167492268691248, "mean_env_wait_ms": 0.038568035339862125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004060268402099609, "StateBufferConnector_ms": 0.005028247833251953, "ViewRequirementAgentConnector_ms": 0.09790420532226562}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.641613960266113, "policy_loss": -0.0082706892862916, "vf_loss": 5.627993106842041, "vf_explained_var": -0.04045024886727333, "kl": 0.0056944736279547215, "entropy": 2.929835081100464, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68970.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 4.39, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -12.0, 54.0, 54.0, -1.0, 10.0, -67.0, 32.0, 10.0, -23.0, -67.0, -56.0, 65.0, -23.0, -12.0, 32.0, 32.0, -12.0, -23.0, 21.0, -12.0, 10.0, 43.0, 54.0, 21.0, 21.0, 54.0, 21.0, -12.0, -78.0, -12.0, -23.0, 32.0, 21.0, -23.0, 54.0, -12.0, -56.0, 21.0, 65.0, -12.0, -67.0, -12.0, 43.0, -23.0, -67.0, -45.0, -100.0, 21.0, 21.0, 21.0, 10.0, -23.0, -78.0, 32.0, 43.0, 10.0, 21.0, 21.0, 21.0, -12.0, 21.0, 21.0, 21.0, 43.0, 43.0, 54.0, 54.0, -1.0, -12.0, -45.0, 32.0, 76.0, 32.0, 54.0, 32.0, 65.0, 43.0, -78.0, -34.0, 54.0, 43.0, -12.0, -1.0, -100.0, 21.0, -78.0, 21.0, -34.0, 54.0, 21.0, 32.0, -56.0, -12.0, 32.0, 10.0, -1.0, 10.0, -23.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22500285600765943, "mean_inference_ms": 23.293414923763425, "mean_action_processing_ms": 0.08360647381671281, "mean_env_wait_ms": 0.03906176592970758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049135684967041016, "StateBufferConnector_ms": 0.004588603973388672, "ViewRequirementAgentConnector_ms": 0.09952449798583984}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 4.39, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -12.0, 54.0, 54.0, -1.0, 10.0, -67.0, 32.0, 10.0, -23.0, -67.0, -56.0, 65.0, -23.0, -12.0, 32.0, 32.0, -12.0, -23.0, 21.0, -12.0, 10.0, 43.0, 54.0, 21.0, 21.0, 54.0, 21.0, -12.0, -78.0, -12.0, -23.0, 32.0, 21.0, -23.0, 54.0, -12.0, -56.0, 21.0, 65.0, -12.0, -67.0, -12.0, 43.0, -23.0, -67.0, -45.0, -100.0, 21.0, 21.0, 21.0, 10.0, -23.0, -78.0, 32.0, 43.0, 10.0, 21.0, 21.0, 21.0, -12.0, 21.0, 21.0, 21.0, 43.0, 43.0, 54.0, 54.0, -1.0, -12.0, -45.0, 32.0, 76.0, 32.0, 54.0, 32.0, 65.0, 43.0, -78.0, -34.0, 54.0, 43.0, -12.0, -1.0, -100.0, 21.0, -78.0, 21.0, -34.0, 54.0, 21.0, 32.0, -56.0, -12.0, 32.0, 10.0, -1.0, 10.0, -23.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22500285600765943, "mean_inference_ms": 23.293414923763425, "mean_action_processing_ms": 0.08360647381671281, "mean_env_wait_ms": 0.03906176592970758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049135684967041016, "StateBufferConnector_ms": 0.004588603973388672, "ViewRequirementAgentConnector_ms": 0.09952449798583984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 161274.724, "sample_time_ms": 86409.254, "learn_time_ms": 74854.664, "learn_throughput": 53.437, "synch_weights_time_ms": 10.023}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 3578, "training_iteration": 68, "trial_id": "38794_00007", "date": "2023-06-02_08-02-15", "timestamp": 1685682135, "time_this_iter_s": 177.38694095611572, "time_total_s": 12989.03078532219, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12989.03078532219, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 16.23739495798319, "ram_util_percent": 51.635294117647064}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -1.0, "episode_reward_mean": 34.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 43.0, 21.0, -1.0, 32.0, 54.0, 54.0, 21.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20808509443597364, "mean_inference_ms": 23.11299239144973, "mean_action_processing_ms": 0.08156801469879636, "mean_env_wait_ms": 0.03851708725527557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037479400634765625, "StateBufferConnector_ms": 0.005145072937011719, "ViewRequirementAgentConnector_ms": 0.09771108627319336}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.701136589050293, "policy_loss": -0.0014585305470973253, "vf_loss": 5.681235313415527, "vf_explained_var": -0.03971453383564949, "kl": 0.005556144751608372, "entropy": 2.94608473777771, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69990.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.92, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, 32.0, 43.0, 10.0, 21.0, 21.0, 21.0, -12.0, 21.0, 21.0, 21.0, 43.0, 43.0, 54.0, 54.0, -1.0, -12.0, -45.0, 32.0, 76.0, 32.0, 54.0, 32.0, 65.0, 43.0, -78.0, -34.0, 54.0, 43.0, -12.0, -1.0, -100.0, 21.0, -78.0, 21.0, -34.0, 54.0, 21.0, 32.0, -56.0, -12.0, 32.0, 10.0, -1.0, 10.0, -23.0, -1.0, 32.0, 10.0, 65.0, 21.0, 32.0, 43.0, 32.0, -12.0, -1.0, 10.0, -1.0, 54.0, 32.0, 43.0, -1.0, -56.0, 54.0, -23.0, 54.0, -12.0, -23.0, 10.0, 43.0, 54.0, 10.0, -1.0, -12.0, 21.0, 65.0, 32.0, -34.0, 10.0, 54.0, 54.0, 21.0, 10.0, 76.0, 43.0, 32.0, 43.0, 76.0, 21.0, 10.0, 65.0, 65.0, 43.0, 10.0, -23.0, 43.0, 54.0, -1.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22475391448794382, "mean_inference_ms": 23.2635578554226, "mean_action_processing_ms": 0.083501161448803, "mean_env_wait_ms": 0.03901255626938141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004911661148071289, "StateBufferConnector_ms": 0.00458979606628418, "ViewRequirementAgentConnector_ms": 0.09972667694091797}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.92, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.0, 32.0, 43.0, 10.0, 21.0, 21.0, 21.0, -12.0, 21.0, 21.0, 21.0, 43.0, 43.0, 54.0, 54.0, -1.0, -12.0, -45.0, 32.0, 76.0, 32.0, 54.0, 32.0, 65.0, 43.0, -78.0, -34.0, 54.0, 43.0, -12.0, -1.0, -100.0, 21.0, -78.0, 21.0, -34.0, 54.0, 21.0, 32.0, -56.0, -12.0, 32.0, 10.0, -1.0, 10.0, -23.0, -1.0, 32.0, 10.0, 65.0, 21.0, 32.0, 43.0, 32.0, -12.0, -1.0, 10.0, -1.0, 54.0, 32.0, 43.0, -1.0, -56.0, 54.0, -23.0, 54.0, -12.0, -23.0, 10.0, 43.0, 54.0, 10.0, -1.0, -12.0, 21.0, 65.0, 32.0, -34.0, 10.0, 54.0, 54.0, 21.0, 10.0, 76.0, 43.0, 32.0, 43.0, 76.0, 21.0, 10.0, 65.0, 65.0, 43.0, 10.0, -23.0, 43.0, 54.0, -1.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22475391448794382, "mean_inference_ms": 23.2635578554226, "mean_action_processing_ms": 0.083501161448803, "mean_env_wait_ms": 0.03901255626938141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004911661148071289, "StateBufferConnector_ms": 0.00458979606628418, "ViewRequirementAgentConnector_ms": 0.09972667694091797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 161337.114, "sample_time_ms": 86422.045, "learn_time_ms": 74904.302, "learn_throughput": 53.401, "synch_weights_time_ms": 10.006}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 3631, "training_iteration": 69, "trial_id": "38794_00007", "date": "2023-06-02_08-05-13", "timestamp": 1685682313, "time_this_iter_s": 178.0075340270996, "time_total_s": 13167.038319349289, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13167.038319349289, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 16.506276150627617, "ram_util_percent": 51.681589958159}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -45.0, "episode_reward_mean": 1.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 43.0, 21.0, -45.0, -34.0, 43.0, -34.0, 21.0, -45.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2078731486529386, "mean_inference_ms": 23.07853601303355, "mean_action_processing_ms": 0.08148054989569012, "mean_env_wait_ms": 0.03847355515532798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004086494445800781, "StateBufferConnector_ms": 0.005211830139160156, "ViewRequirementAgentConnector_ms": 0.09994268417358398}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.383270263671875, "policy_loss": -0.04250643774867058, "vf_loss": 5.39732027053833, "vf_explained_var": -0.07158040255308151, "kl": 0.007402070797979832, "entropy": 2.928715705871582, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71010.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.59, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -12.0, -1.0, 10.0, -1.0, 54.0, 32.0, 43.0, -1.0, -56.0, 54.0, -23.0, 54.0, -12.0, -23.0, 10.0, 43.0, 54.0, 10.0, -1.0, -12.0, 21.0, 65.0, 32.0, -34.0, 10.0, 54.0, 54.0, 21.0, 10.0, 76.0, 43.0, 32.0, 43.0, 76.0, 21.0, 10.0, 65.0, 65.0, 43.0, 10.0, -23.0, 43.0, 54.0, -1.0, 65.0, 21.0, 32.0, 10.0, 32.0, 43.0, -1.0, -23.0, -23.0, -12.0, -56.0, -45.0, -78.0, -100.0, 32.0, 65.0, 21.0, 21.0, -34.0, -1.0, 21.0, 10.0, 76.0, 54.0, 54.0, 54.0, 10.0, -12.0, -34.0, -34.0, -56.0, 54.0, 21.0, -1.0, 54.0, 21.0, 21.0, 43.0, -45.0, -1.0, -45.0, 54.0, 54.0, 43.0, 21.0, 65.0, 65.0, 32.0, 54.0, 43.0, -12.0, -12.0, 54.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22451215241457562, "mean_inference_ms": 23.235375555827957, "mean_action_processing_ms": 0.083399442247402, "mean_env_wait_ms": 0.038964610855368224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004878997802734375, "StateBufferConnector_ms": 0.004621744155883789, "ViewRequirementAgentConnector_ms": 0.09960770606994629}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.59, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -12.0, -1.0, 10.0, -1.0, 54.0, 32.0, 43.0, -1.0, -56.0, 54.0, -23.0, 54.0, -12.0, -23.0, 10.0, 43.0, 54.0, 10.0, -1.0, -12.0, 21.0, 65.0, 32.0, -34.0, 10.0, 54.0, 54.0, 21.0, 10.0, 76.0, 43.0, 32.0, 43.0, 76.0, 21.0, 10.0, 65.0, 65.0, 43.0, 10.0, -23.0, 43.0, 54.0, -1.0, 65.0, 21.0, 32.0, 10.0, 32.0, 43.0, -1.0, -23.0, -23.0, -12.0, -56.0, -45.0, -78.0, -100.0, 32.0, 65.0, 21.0, 21.0, -34.0, -1.0, 21.0, 10.0, 76.0, 54.0, 54.0, 54.0, 10.0, -12.0, -34.0, -34.0, -56.0, 54.0, 21.0, -1.0, 54.0, 21.0, 21.0, 43.0, -45.0, -1.0, -45.0, 54.0, 54.0, 43.0, 21.0, 65.0, 65.0, 32.0, 54.0, 43.0, -12.0, -12.0, 54.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22451215241457562, "mean_inference_ms": 23.235375555827957, "mean_action_processing_ms": 0.083399442247402, "mean_env_wait_ms": 0.038964610855368224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004878997802734375, "StateBufferConnector_ms": 0.004621744155883789, "ViewRequirementAgentConnector_ms": 0.09960770606994629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 161389.321, "sample_time_ms": 86418.029, "learn_time_ms": 74960.436, "learn_throughput": 53.361, "synch_weights_time_ms": 10.091}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 3684, "training_iteration": 70, "trial_id": "38794_00007", "date": "2023-06-02_08-08-10", "timestamp": 1685682490, "time_this_iter_s": 177.5600299835205, "time_total_s": 13344.59834933281, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13344.59834933281, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 16.735714285714288, "ram_util_percent": 51.71386554621851}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -78.0, "episode_reward_mean": -9.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, 43.0, -34.0, -34.0, -1.0, 10.0, 10.0, -23.0, -12.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20762490270949038, "mean_inference_ms": 23.050686164353046, "mean_action_processing_ms": 0.0813783570447241, "mean_env_wait_ms": 0.03842558054606686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039386749267578125, "StateBufferConnector_ms": 0.005087852478027344, "ViewRequirementAgentConnector_ms": 0.09843587875366211}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.318057537078857, "policy_loss": -0.03489868342876434, "vf_loss": 5.329284191131592, "vf_explained_var": -0.03710941970348358, "kl": 0.006157489027827978, "entropy": 2.92742657661438, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72030.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 15.94, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -23.0, -12.0, -56.0, -45.0, -78.0, -100.0, 32.0, 65.0, 21.0, 21.0, -34.0, -1.0, 21.0, 10.0, 76.0, 54.0, 54.0, 54.0, 10.0, -12.0, -34.0, -34.0, -56.0, 54.0, 21.0, -1.0, 54.0, 21.0, 21.0, 43.0, -45.0, -1.0, -45.0, 54.0, 54.0, 43.0, 21.0, 65.0, 65.0, 32.0, 54.0, 43.0, -12.0, -12.0, 54.0, 21.0, -1.0, -56.0, -12.0, -1.0, 10.0, -23.0, 10.0, -23.0, -1.0, 43.0, 65.0, 21.0, 32.0, -1.0, -1.0, -1.0, 10.0, 65.0, 10.0, 76.0, -23.0, 32.0, 32.0, 65.0, -12.0, 54.0, 10.0, -1.0, -1.0, 43.0, 65.0, 32.0, 54.0, 54.0, 21.0, -56.0, -1.0, 10.0, 54.0, 32.0, 43.0, -12.0, 21.0, 54.0, 21.0, 54.0, 32.0, 32.0, 54.0, 32.0, 21.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22427244673638455, "mean_inference_ms": 23.207755005060882, "mean_action_processing_ms": 0.08329695615849902, "mean_env_wait_ms": 0.03891678143390632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004838705062866211, "StateBufferConnector_ms": 0.004592418670654297, "ViewRequirementAgentConnector_ms": 0.09937763214111328}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 15.94, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, -23.0, -12.0, -56.0, -45.0, -78.0, -100.0, 32.0, 65.0, 21.0, 21.0, -34.0, -1.0, 21.0, 10.0, 76.0, 54.0, 54.0, 54.0, 10.0, -12.0, -34.0, -34.0, -56.0, 54.0, 21.0, -1.0, 54.0, 21.0, 21.0, 43.0, -45.0, -1.0, -45.0, 54.0, 54.0, 43.0, 21.0, 65.0, 65.0, 32.0, 54.0, 43.0, -12.0, -12.0, 54.0, 21.0, -1.0, -56.0, -12.0, -1.0, 10.0, -23.0, 10.0, -23.0, -1.0, 43.0, 65.0, 21.0, 32.0, -1.0, -1.0, -1.0, 10.0, 65.0, 10.0, 76.0, -23.0, 32.0, 32.0, 65.0, -12.0, 54.0, 10.0, -1.0, -1.0, 43.0, 65.0, 32.0, 54.0, 54.0, 21.0, -56.0, -1.0, 10.0, 54.0, 32.0, 43.0, -12.0, 21.0, 54.0, 21.0, 54.0, 32.0, 32.0, 54.0, 32.0, 21.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22427244673638455, "mean_inference_ms": 23.207755005060882, "mean_action_processing_ms": 0.08329695615849902, "mean_env_wait_ms": 0.03891678143390632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004838705062866211, "StateBufferConnector_ms": 0.004592418670654297, "ViewRequirementAgentConnector_ms": 0.09937763214111328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 161424.379, "sample_time_ms": 86410.046, "learn_time_ms": 74999.432, "learn_throughput": 53.334, "synch_weights_time_ms": 14.132}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 3736, "training_iteration": 71, "trial_id": "38794_00007", "date": "2023-06-02_08-11-08", "timestamp": 1685682668, "time_this_iter_s": 177.52082991600037, "time_total_s": 13522.11917924881, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13522.11917924881, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.169747899159663, "ram_util_percent": 51.79033613445379}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -56.0, "episode_reward_mean": 3.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, -12.0, 10.0, -23.0, -56.0, 32.0, 21.0, 10.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2074012504339641, "mean_inference_ms": 23.024512893595332, "mean_action_processing_ms": 0.08128427478410143, "mean_env_wait_ms": 0.03837851591293746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004367828369140625, "StateBufferConnector_ms": 0.005154609680175781, "ViewRequirementAgentConnector_ms": 0.09774446487426758}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.850865840911865, "policy_loss": -0.009210754185914993, "vf_loss": 5.8358540534973145, "vf_explained_var": -0.07541953772306442, "kl": 0.006300939247012138, "entropy": 2.9401142597198486, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73050.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 16.43, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -23.0, -1.0, 43.0, 65.0, 21.0, 32.0, -1.0, -1.0, -1.0, 10.0, 65.0, 10.0, 76.0, -23.0, 32.0, 32.0, 65.0, -12.0, 54.0, 10.0, -1.0, -1.0, 43.0, 65.0, 32.0, 54.0, 54.0, 21.0, -56.0, -1.0, 10.0, 54.0, 32.0, 43.0, -12.0, 21.0, 54.0, 21.0, 54.0, 32.0, 32.0, 54.0, 32.0, 21.0, 43.0, -1.0, 43.0, 65.0, 76.0, 76.0, 54.0, 32.0, 21.0, 10.0, 10.0, -1.0, -12.0, 10.0, 43.0, 76.0, 54.0, -1.0, 10.0, -1.0, -78.0, -23.0, 21.0, -12.0, 21.0, 43.0, 4.0, -45.0, -56.0, 21.0, -23.0, 54.0, 32.0, -45.0, -23.0, 32.0, -23.0, -12.0, 10.0, 43.0, -12.0, 32.0, 21.0, -23.0, -89.0, 21.0, -1.0, -12.0, -1.0, -67.0, 21.0, 10.0, -1.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2240360353849915, "mean_inference_ms": 23.180099983135268, "mean_action_processing_ms": 0.08319714605166856, "mean_env_wait_ms": 0.038868630713506824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004778861999511719, "StateBufferConnector_ms": 0.00455927848815918, "ViewRequirementAgentConnector_ms": 0.09927010536193848}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 16.43, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -23.0, -1.0, 43.0, 65.0, 21.0, 32.0, -1.0, -1.0, -1.0, 10.0, 65.0, 10.0, 76.0, -23.0, 32.0, 32.0, 65.0, -12.0, 54.0, 10.0, -1.0, -1.0, 43.0, 65.0, 32.0, 54.0, 54.0, 21.0, -56.0, -1.0, 10.0, 54.0, 32.0, 43.0, -12.0, 21.0, 54.0, 21.0, 54.0, 32.0, 32.0, 54.0, 32.0, 21.0, 43.0, -1.0, 43.0, 65.0, 76.0, 76.0, 54.0, 32.0, 21.0, 10.0, 10.0, -1.0, -12.0, 10.0, 43.0, 76.0, 54.0, -1.0, 10.0, -1.0, -78.0, -23.0, 21.0, -12.0, 21.0, 43.0, 4.0, -45.0, -56.0, 21.0, -23.0, 54.0, 32.0, -45.0, -23.0, 32.0, -23.0, -12.0, 10.0, 43.0, -12.0, 32.0, 21.0, -23.0, -89.0, 21.0, -1.0, -12.0, -1.0, -67.0, 21.0, 10.0, -1.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2240360353849915, "mean_inference_ms": 23.180099983135268, "mean_action_processing_ms": 0.08319714605166856, "mean_env_wait_ms": 0.038868630713506824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004778861999511719, "StateBufferConnector_ms": 0.00455927848815918, "ViewRequirementAgentConnector_ms": 0.09927010536193848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 161517.066, "sample_time_ms": 86462.044, "learn_time_ms": 75040.041, "learn_throughput": 53.305, "synch_weights_time_ms": 14.19}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 3789, "training_iteration": 72, "trial_id": "38794_00007", "date": "2023-06-02_08-14-06", "timestamp": 1685682846, "time_this_iter_s": 177.70381593704224, "time_total_s": 13699.822995185852, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13699.822995185852, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 16.28284518828452, "ram_util_percent": 51.80878661087867}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -1.0, "episode_reward_mean": 24.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 10.0, 43.0, 21.0, 10.0, 54.0, -1.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20716987530517908, "mean_inference_ms": 22.99756774823961, "mean_action_processing_ms": 0.081189478340327, "mean_env_wait_ms": 0.038335246025288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00438690185546875, "StateBufferConnector_ms": 0.005156993865966797, "ViewRequirementAgentConnector_ms": 0.09819746017456055}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.30107307434082, "policy_loss": -0.0014626014744862914, "vf_loss": 6.278470516204834, "vf_explained_var": -0.14183251559734344, "kl": 0.006259844172745943, "entropy": 2.9203176498413086, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74070.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 3.23, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 10.0, 10.0, -1.0, -12.0, 10.0, 43.0, 76.0, 54.0, -1.0, 10.0, -1.0, -78.0, -23.0, 21.0, -12.0, 21.0, 43.0, 4.0, -45.0, -56.0, 21.0, -23.0, 54.0, 32.0, -45.0, -23.0, 32.0, -23.0, -12.0, 10.0, 43.0, -12.0, 32.0, 21.0, -23.0, -89.0, 21.0, -1.0, -12.0, -1.0, -67.0, 21.0, 10.0, -1.0, 43.0, 32.0, -12.0, -12.0, -12.0, -23.0, -12.0, 10.0, -45.0, -12.0, -1.0, -34.0, 32.0, -1.0, -34.0, 32.0, 43.0, 76.0, 32.0, 10.0, -56.0, 10.0, -56.0, 10.0, -12.0, -56.0, -67.0, 32.0, 32.0, 10.0, -100.0, -1.0, 10.0, -1.0, -23.0, 32.0, 76.0, 43.0, 54.0, -12.0, -12.0, 10.0, 10.0, 76.0, 43.0, -12.0, 43.0, 43.0, -23.0, -12.0, 10.0, 54.0, 10.0, -45.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22381284594352857, "mean_inference_ms": 23.154038537500593, "mean_action_processing_ms": 0.08310467883566508, "mean_env_wait_ms": 0.0388231976960579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048389434814453125, "StateBufferConnector_ms": 0.004584550857543945, "ViewRequirementAgentConnector_ms": 0.09943318367004395}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 3.23, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 10.0, 10.0, -1.0, -12.0, 10.0, 43.0, 76.0, 54.0, -1.0, 10.0, -1.0, -78.0, -23.0, 21.0, -12.0, 21.0, 43.0, 4.0, -45.0, -56.0, 21.0, -23.0, 54.0, 32.0, -45.0, -23.0, 32.0, -23.0, -12.0, 10.0, 43.0, -12.0, 32.0, 21.0, -23.0, -89.0, 21.0, -1.0, -12.0, -1.0, -67.0, 21.0, 10.0, -1.0, 43.0, 32.0, -12.0, -12.0, -12.0, -23.0, -12.0, 10.0, -45.0, -12.0, -1.0, -34.0, 32.0, -1.0, -34.0, 32.0, 43.0, 76.0, 32.0, 10.0, -56.0, 10.0, -56.0, 10.0, -12.0, -56.0, -67.0, 32.0, 32.0, 10.0, -100.0, -1.0, 10.0, -1.0, -23.0, 32.0, 76.0, 43.0, 54.0, -12.0, -12.0, 10.0, 10.0, 76.0, 43.0, -12.0, 43.0, 43.0, -23.0, -12.0, 10.0, 54.0, 10.0, -45.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22381284594352857, "mean_inference_ms": 23.154038537500593, "mean_action_processing_ms": 0.08310467883566508, "mean_env_wait_ms": 0.0388231976960579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048389434814453125, "StateBufferConnector_ms": 0.004584550857543945, "ViewRequirementAgentConnector_ms": 0.09943318367004395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 161465.226, "sample_time_ms": 86432.196, "learn_time_ms": 75017.946, "learn_throughput": 53.321, "synch_weights_time_ms": 14.312}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 3842, "training_iteration": 73, "trial_id": "38794_00007", "date": "2023-06-02_08-17-03", "timestamp": 1685683023, "time_this_iter_s": 177.45245122909546, "time_total_s": 13877.275446414948, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13877.275446414948, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 16.735294117647058, "ram_util_percent": 51.88067226890754}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 23.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 10.0, -12.0, 43.0, 65.0, 43.0, 43.0, -23.0, 54.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2069750597080125, "mean_inference_ms": 22.96981619316713, "mean_action_processing_ms": 0.08111542173869131, "mean_env_wait_ms": 0.03829869896560838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004103183746337891, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.09931802749633789}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.682378768920898, "policy_loss": -0.00017867695714812726, "vf_loss": 5.663171291351318, "vf_explained_var": -0.07756232470273972, "kl": 0.005042727570980787, "entropy": 2.923401117324829, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75090.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 10.33, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -45.0, -12.0, -1.0, -34.0, 32.0, -1.0, -34.0, 32.0, 43.0, 76.0, 32.0, 10.0, -56.0, 10.0, -56.0, 10.0, -12.0, -56.0, -67.0, 32.0, 32.0, 10.0, -100.0, -1.0, 10.0, -1.0, -23.0, 32.0, 76.0, 43.0, 54.0, -12.0, -12.0, 10.0, 10.0, 76.0, 43.0, -12.0, 43.0, 43.0, -23.0, -12.0, 10.0, 54.0, 10.0, -45.0, 32.0, -23.0, -23.0, 32.0, 21.0, -23.0, 32.0, 21.0, -12.0, 32.0, -1.0, 76.0, 76.0, 43.0, 65.0, 21.0, 43.0, 21.0, -34.0, -12.0, 43.0, -34.0, -34.0, -89.0, 10.0, -23.0, 21.0, -67.0, 10.0, -12.0, -1.0, -34.0, -12.0, 10.0, 43.0, 32.0, 54.0, 43.0, 43.0, 65.0, -1.0, 32.0, 21.0, 54.0, -12.0, -1.0, 21.0, 10.0, 43.0, 21.0, 65.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22359958578807734, "mean_inference_ms": 23.128981037366575, "mean_action_processing_ms": 0.08301319724501281, "mean_env_wait_ms": 0.03877934075005321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004828453063964844, "StateBufferConnector_ms": 0.004598140716552734, "ViewRequirementAgentConnector_ms": 0.0995950698852539}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 10.33, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -45.0, -12.0, -1.0, -34.0, 32.0, -1.0, -34.0, 32.0, 43.0, 76.0, 32.0, 10.0, -56.0, 10.0, -56.0, 10.0, -12.0, -56.0, -67.0, 32.0, 32.0, 10.0, -100.0, -1.0, 10.0, -1.0, -23.0, 32.0, 76.0, 43.0, 54.0, -12.0, -12.0, 10.0, 10.0, 76.0, 43.0, -12.0, 43.0, 43.0, -23.0, -12.0, 10.0, 54.0, 10.0, -45.0, 32.0, -23.0, -23.0, 32.0, 21.0, -23.0, 32.0, 21.0, -12.0, 32.0, -1.0, 76.0, 76.0, 43.0, 65.0, 21.0, 43.0, 21.0, -34.0, -12.0, 43.0, -34.0, -34.0, -89.0, 10.0, -23.0, 21.0, -67.0, 10.0, -12.0, -1.0, -34.0, -12.0, 10.0, 43.0, 32.0, 54.0, 43.0, 43.0, 65.0, -1.0, 32.0, 21.0, 54.0, -12.0, -1.0, 21.0, 10.0, 43.0, 21.0, 65.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22359958578807734, "mean_inference_ms": 23.128981037366575, "mean_action_processing_ms": 0.08301319724501281, "mean_env_wait_ms": 0.03877934075005321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004828453063964844, "StateBufferConnector_ms": 0.004598140716552734, "ViewRequirementAgentConnector_ms": 0.0995950698852539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 161479.718, "sample_time_ms": 86441.17, "learn_time_ms": 75023.437, "learn_throughput": 53.317, "synch_weights_time_ms": 14.326}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 3894, "training_iteration": 74, "trial_id": "38794_00007", "date": "2023-06-02_08-20-00", "timestamp": 1685683200, "time_this_iter_s": 177.3891568183899, "time_total_s": 14054.664603233337, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14054.664603233337, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 16.45481171548117, "ram_util_percent": 51.94267782426777}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 22.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 32.0, 54.0, 32.0, -78.0, -12.0, 21.0, 76.0, 54.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2067818587036422, "mean_inference_ms": 22.94499575344107, "mean_action_processing_ms": 0.0810262075702495, "mean_env_wait_ms": 0.03825565197662677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037813186645507812, "StateBufferConnector_ms": 0.005059242248535156, "ViewRequirementAgentConnector_ms": 0.09898185729980469}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.4586896896362305, "policy_loss": -0.005897605326026678, "vf_loss": 5.443847179412842, "vf_explained_var": -0.10948384553194046, "kl": 0.005394884385168552, "entropy": 2.917874336242676, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 76110.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 19.29, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, -12.0, 32.0, -1.0, 76.0, 76.0, 43.0, 65.0, 21.0, 43.0, 21.0, -34.0, -12.0, 43.0, -34.0, -34.0, -89.0, 10.0, -23.0, 21.0, -67.0, 10.0, -12.0, -1.0, -34.0, -12.0, 10.0, 43.0, 32.0, 54.0, 43.0, 43.0, 65.0, -1.0, 32.0, 21.0, 54.0, -12.0, -1.0, 21.0, 10.0, 43.0, 21.0, 65.0, 43.0, 54.0, 32.0, 54.0, 32.0, 32.0, 65.0, 10.0, 54.0, 65.0, 10.0, 76.0, 65.0, 76.0, 32.0, -23.0, -12.0, 32.0, -12.0, 32.0, 43.0, 43.0, 43.0, -1.0, 43.0, 32.0, -1.0, -1.0, -1.0, -34.0, -1.0, 65.0, 10.0, 32.0, -34.0, -56.0, -45.0, 10.0, 21.0, 21.0, -40.0, -23.0, -1.0, -1.0, 10.0, 43.0, 21.0, 21.0, 43.0, 43.0, 32.0, 32.0, 54.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22338952315369695, "mean_inference_ms": 23.103987348558668, "mean_action_processing_ms": 0.08292042885197484, "mean_env_wait_ms": 0.0387348481905547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004767894744873047, "StateBufferConnector_ms": 0.004582643508911133, "ViewRequirementAgentConnector_ms": 0.09929060935974121}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 19.29, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 21.0, -12.0, 32.0, -1.0, 76.0, 76.0, 43.0, 65.0, 21.0, 43.0, 21.0, -34.0, -12.0, 43.0, -34.0, -34.0, -89.0, 10.0, -23.0, 21.0, -67.0, 10.0, -12.0, -1.0, -34.0, -12.0, 10.0, 43.0, 32.0, 54.0, 43.0, 43.0, 65.0, -1.0, 32.0, 21.0, 54.0, -12.0, -1.0, 21.0, 10.0, 43.0, 21.0, 65.0, 43.0, 54.0, 32.0, 54.0, 32.0, 32.0, 65.0, 10.0, 54.0, 65.0, 10.0, 76.0, 65.0, 76.0, 32.0, -23.0, -12.0, 32.0, -12.0, 32.0, 43.0, 43.0, 43.0, -1.0, 43.0, 32.0, -1.0, -1.0, -1.0, -34.0, -1.0, 65.0, 10.0, 32.0, -34.0, -56.0, -45.0, 10.0, 21.0, 21.0, -40.0, -23.0, -1.0, -1.0, 10.0, 43.0, 21.0, 21.0, 43.0, 43.0, 32.0, 32.0, 54.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22338952315369695, "mean_inference_ms": 23.103987348558668, "mean_action_processing_ms": 0.08292042885197484, "mean_env_wait_ms": 0.0387348481905547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004767894744873047, "StateBufferConnector_ms": 0.004582643508911133, "ViewRequirementAgentConnector_ms": 0.09929060935974121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 161475.065, "sample_time_ms": 86436.509, "learn_time_ms": 75020.107, "learn_throughput": 53.319, "synch_weights_time_ms": 14.312}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 3947, "training_iteration": 75, "trial_id": "38794_00007", "date": "2023-06-02_08-22-58", "timestamp": 1685683378, "time_this_iter_s": 177.5057828426361, "time_total_s": 14232.170386075974, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14232.170386075974, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 16.335564853556487, "ram_util_percent": 51.99832635983264}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -67.0, "episode_reward_mean": 2.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 54.0, 10.0, 32.0, 32.0, -12.0, -67.0, -67.0, -34.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20656300305977596, "mean_inference_ms": 22.919850444280222, "mean_action_processing_ms": 0.0809343218508277, "mean_env_wait_ms": 0.038218831333273924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004124641418457031, "StateBufferConnector_ms": 0.0052165985107421875, "ViewRequirementAgentConnector_ms": 0.09793758392333984}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.123830795288086, "policy_loss": -0.0023484688717871904, "vf_loss": 6.1037211418151855, "vf_explained_var": -0.13882362842559814, "kl": 0.005841969046741724, "entropy": 2.9116125106811523, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77130.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 12.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 10.0, 76.0, 65.0, 76.0, 32.0, -23.0, -12.0, 32.0, -12.0, 32.0, 43.0, 43.0, 43.0, -1.0, 43.0, 32.0, -1.0, -1.0, -1.0, -34.0, -1.0, 65.0, 10.0, 32.0, -34.0, -56.0, -45.0, 10.0, 21.0, 21.0, -40.0, -23.0, -1.0, -1.0, 10.0, 43.0, 21.0, 21.0, 43.0, 43.0, 32.0, 32.0, 54.0, 32.0, 65.0, 32.0, 65.0, 43.0, -12.0, 32.0, 21.0, -34.0, 21.0, 65.0, -1.0, 32.0, -1.0, -1.0, 65.0, 10.0, -12.0, 21.0, -1.0, 21.0, 32.0, 32.0, 54.0, -23.0, 21.0, -34.0, -45.0, -1.0, -45.0, 54.0, -34.0, -45.0, -12.0, 21.0, 43.0, -67.0, -23.0, 21.0, 10.0, 10.0, 10.0, -1.0, 43.0, 10.0, 21.0, -34.0, -23.0, 32.0, 21.0, 43.0, 54.0, -12.0, -56.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2231612308828687, "mean_inference_ms": 23.07922748862683, "mean_action_processing_ms": 0.08283036284688333, "mean_env_wait_ms": 0.038692140511842874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047795772552490234, "StateBufferConnector_ms": 0.004610300064086914, "ViewRequirementAgentConnector_ms": 0.09915399551391602}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 12.8, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 10.0, 76.0, 65.0, 76.0, 32.0, -23.0, -12.0, 32.0, -12.0, 32.0, 43.0, 43.0, 43.0, -1.0, 43.0, 32.0, -1.0, -1.0, -1.0, -34.0, -1.0, 65.0, 10.0, 32.0, -34.0, -56.0, -45.0, 10.0, 21.0, 21.0, -40.0, -23.0, -1.0, -1.0, 10.0, 43.0, 21.0, 21.0, 43.0, 43.0, 32.0, 32.0, 54.0, 32.0, 65.0, 32.0, 65.0, 43.0, -12.0, 32.0, 21.0, -34.0, 21.0, 65.0, -1.0, 32.0, -1.0, -1.0, 65.0, 10.0, -12.0, 21.0, -1.0, 21.0, 32.0, 32.0, 54.0, -23.0, 21.0, -34.0, -45.0, -1.0, -45.0, 54.0, -34.0, -45.0, -12.0, 21.0, 43.0, -67.0, -23.0, 21.0, 10.0, 10.0, 10.0, -1.0, 43.0, 10.0, 21.0, -34.0, -23.0, 32.0, 21.0, 43.0, 54.0, -12.0, -56.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2231612308828687, "mean_inference_ms": 23.07922748862683, "mean_action_processing_ms": 0.08283036284688333, "mean_env_wait_ms": 0.038692140511842874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047795772552490234, "StateBufferConnector_ms": 0.004610300064086914, "ViewRequirementAgentConnector_ms": 0.09915399551391602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 161211.357, "sample_time_ms": 86396.517, "learn_time_ms": 74796.242, "learn_throughput": 53.479, "synch_weights_time_ms": 14.456}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 4000, "training_iteration": 76, "trial_id": "38794_00007", "date": "2023-06-02_08-25-55", "timestamp": 1685683555, "time_this_iter_s": 176.9791088104248, "time_total_s": 14409.149494886398, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14409.149494886398, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.248101265822786, "ram_util_percent": 52.21097046413502}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 4.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 10.0, -45.0, -56.0, -12.0, 21.0, 10.0, 76.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20636370815921717, "mean_inference_ms": 22.896265218064023, "mean_action_processing_ms": 0.08084786606206516, "mean_env_wait_ms": 0.038181231500624926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004000663757324219, "StateBufferConnector_ms": 0.0049877166748046875, "ViewRequirementAgentConnector_ms": 0.0968480110168457}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.259415149688721, "policy_loss": -0.012846672907471657, "vf_loss": 5.244482040405273, "vf_explained_var": -0.08244431763887405, "kl": 0.0072261868044734, "entropy": 2.9221813678741455, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 78150.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 14.45, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -34.0, 21.0, 65.0, -1.0, 32.0, -1.0, -1.0, 65.0, 10.0, -12.0, 21.0, -1.0, 21.0, 32.0, 32.0, 54.0, -23.0, 21.0, -34.0, -45.0, -1.0, -45.0, 54.0, -34.0, -45.0, -12.0, 21.0, 43.0, -67.0, -23.0, 21.0, 10.0, 10.0, 10.0, -1.0, 43.0, 10.0, 21.0, -34.0, -23.0, 32.0, 21.0, 43.0, 54.0, -12.0, -56.0, -78.0, -12.0, -1.0, 32.0, 10.0, 26.0, -12.0, -12.0, 43.0, 76.0, 21.0, 54.0, 10.0, 43.0, 54.0, 54.0, 32.0, 21.0, 10.0, -1.0, 21.0, -12.0, 32.0, 43.0, 10.0, 21.0, 10.0, 65.0, -1.0, 10.0, -100.0, -67.0, 21.0, -1.0, 54.0, 10.0, 54.0, 76.0, 76.0, 65.0, 54.0, 32.0, 54.0, 32.0, -1.0, -23.0, 76.0, 54.0, -45.0, 21.0, 54.0, 65.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22293679103040195, "mean_inference_ms": 23.05527552851117, "mean_action_processing_ms": 0.08274341175520528, "mean_env_wait_ms": 0.03864986121204225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004843711853027344, "StateBufferConnector_ms": 0.004614830017089844, "ViewRequirementAgentConnector_ms": 0.0994424819946289}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 14.45, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -34.0, 21.0, 65.0, -1.0, 32.0, -1.0, -1.0, 65.0, 10.0, -12.0, 21.0, -1.0, 21.0, 32.0, 32.0, 54.0, -23.0, 21.0, -34.0, -45.0, -1.0, -45.0, 54.0, -34.0, -45.0, -12.0, 21.0, 43.0, -67.0, -23.0, 21.0, 10.0, 10.0, 10.0, -1.0, 43.0, 10.0, 21.0, -34.0, -23.0, 32.0, 21.0, 43.0, 54.0, -12.0, -56.0, -78.0, -12.0, -1.0, 32.0, 10.0, 26.0, -12.0, -12.0, 43.0, 76.0, 21.0, 54.0, 10.0, 43.0, 54.0, 54.0, 32.0, 21.0, 10.0, -1.0, 21.0, -12.0, 32.0, 43.0, 10.0, 21.0, 10.0, 65.0, -1.0, 10.0, -100.0, -67.0, 21.0, -1.0, 54.0, 10.0, 54.0, 76.0, 76.0, 65.0, 54.0, 32.0, 54.0, 32.0, -1.0, -23.0, 76.0, 54.0, -45.0, 21.0, 54.0, 65.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22293679103040195, "mean_inference_ms": 23.05527552851117, "mean_action_processing_ms": 0.08274341175520528, "mean_env_wait_ms": 0.03864986121204225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004843711853027344, "StateBufferConnector_ms": 0.004614830017089844, "ViewRequirementAgentConnector_ms": 0.0994424819946289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 161202.978, "sample_time_ms": 86385.6, "learn_time_ms": 74798.954, "learn_throughput": 53.477, "synch_weights_time_ms": 14.279}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 4052, "training_iteration": 77, "trial_id": "38794_00007", "date": "2023-06-02_08-28-53", "timestamp": 1685683733, "time_this_iter_s": 177.5481321811676, "time_total_s": 14586.697627067566, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14586.697627067566, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 16.428870292887026, "ram_util_percent": 52.31589958158996}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -78.0, "episode_reward_mean": -13.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 32.0, 21.0, 32.0, -23.0, -78.0, -56.0, 15.0, -45.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20617004211521534, "mean_inference_ms": 22.87313945018212, "mean_action_processing_ms": 0.08076177298368119, "mean_env_wait_ms": 0.03814273766082492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004096031188964844, "StateBufferConnector_ms": 0.005009174346923828, "ViewRequirementAgentConnector_ms": 0.0981450080871582}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.067265510559082, "policy_loss": -0.029722636565566063, "vf_loss": 6.077574729919434, "vf_explained_var": -0.1029042974114418, "kl": 0.005049924366176128, "entropy": 2.9143495559692383, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79170.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.86, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, 43.0, 76.0, 21.0, 54.0, 10.0, 43.0, 54.0, 54.0, 32.0, 21.0, 10.0, -1.0, 21.0, -12.0, 32.0, 43.0, 10.0, 21.0, 10.0, 65.0, -1.0, 10.0, -100.0, -67.0, 21.0, -1.0, 54.0, 10.0, 54.0, 76.0, 76.0, 65.0, 54.0, 32.0, 54.0, 32.0, -1.0, -23.0, 76.0, 54.0, -45.0, 21.0, 54.0, 65.0, 32.0, -23.0, 10.0, -1.0, 43.0, -23.0, 10.0, 21.0, 10.0, -23.0, 32.0, 32.0, 21.0, 32.0, 43.0, 32.0, 76.0, 43.0, 10.0, 43.0, 54.0, 76.0, -1.0, -1.0, 32.0, -12.0, -45.0, -45.0, 21.0, 65.0, 43.0, 54.0, -23.0, -34.0, -23.0, -34.0, -67.0, -56.0, -45.0, -23.0, 10.0, -1.0, 54.0, 43.0, 65.0, 26.0, -23.0, 10.0, 32.0, 32.0, -1.0, 10.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2227332631777249, "mean_inference_ms": 23.032285699730892, "mean_action_processing_ms": 0.08265922750206105, "mean_env_wait_ms": 0.038608351630010154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004876136779785156, "StateBufferConnector_ms": 0.004546165466308594, "ViewRequirementAgentConnector_ms": 0.0992281436920166}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.86, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, 43.0, 76.0, 21.0, 54.0, 10.0, 43.0, 54.0, 54.0, 32.0, 21.0, 10.0, -1.0, 21.0, -12.0, 32.0, 43.0, 10.0, 21.0, 10.0, 65.0, -1.0, 10.0, -100.0, -67.0, 21.0, -1.0, 54.0, 10.0, 54.0, 76.0, 76.0, 65.0, 54.0, 32.0, 54.0, 32.0, -1.0, -23.0, 76.0, 54.0, -45.0, 21.0, 54.0, 65.0, 32.0, -23.0, 10.0, -1.0, 43.0, -23.0, 10.0, 21.0, 10.0, -23.0, 32.0, 32.0, 21.0, 32.0, 43.0, 32.0, 76.0, 43.0, 10.0, 43.0, 54.0, 76.0, -1.0, -1.0, 32.0, -12.0, -45.0, -45.0, 21.0, 65.0, 43.0, 54.0, -23.0, -34.0, -23.0, -34.0, -67.0, -56.0, -45.0, -23.0, 10.0, -1.0, 54.0, 43.0, 65.0, 26.0, -23.0, 10.0, 32.0, 32.0, -1.0, 10.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2227332631777249, "mean_inference_ms": 23.032285699730892, "mean_action_processing_ms": 0.08265922750206105, "mean_env_wait_ms": 0.038608351630010154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004876136779785156, "StateBufferConnector_ms": 0.004546165466308594, "ViewRequirementAgentConnector_ms": 0.0992281436920166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 161266.039, "sample_time_ms": 86414.293, "learn_time_ms": 74833.553, "learn_throughput": 53.452, "synch_weights_time_ms": 14.059}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 4105, "training_iteration": 78, "trial_id": "38794_00007", "date": "2023-06-02_08-31-50", "timestamp": 1685683910, "time_this_iter_s": 177.9080798625946, "time_total_s": 14764.60570693016, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14764.60570693016, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 16.193723849372386, "ram_util_percent": 52.31004184100419}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -89.0, "episode_reward_mean": -5.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -78.0, -89.0, -34.0, 21.0, 43.0, 54.0, 10.0, 21.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2059797660032307, "mean_inference_ms": 22.85061306901888, "mean_action_processing_ms": 0.08067620356299213, "mean_env_wait_ms": 0.03810423751279318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.005218982696533203, "ViewRequirementAgentConnector_ms": 0.09772539138793945}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.967783451080322, "policy_loss": -0.0110562639310956, "vf_loss": 5.95945405960083, "vf_explained_var": -0.0801495909690857, "kl": 0.005042684264481068, "entropy": 2.9121241569519043, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80190.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 12.96, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 21.0, 10.0, -23.0, 32.0, 32.0, 21.0, 32.0, 43.0, 32.0, 76.0, 43.0, 10.0, 43.0, 54.0, 76.0, -1.0, -1.0, 32.0, -12.0, -45.0, -45.0, 21.0, 65.0, 43.0, 54.0, -23.0, -34.0, -23.0, -34.0, -67.0, -56.0, -45.0, -23.0, 10.0, -1.0, 54.0, 43.0, 65.0, 26.0, -23.0, 10.0, 32.0, 32.0, -1.0, 10.0, 21.0, -1.0, 65.0, -1.0, -34.0, 37.0, -1.0, -1.0, 32.0, -23.0, 43.0, 21.0, -23.0, 21.0, 43.0, 43.0, 32.0, 43.0, 65.0, 21.0, -34.0, 54.0, -12.0, -78.0, -23.0, -23.0, 10.0, 54.0, 76.0, -1.0, -12.0, 54.0, 54.0, 32.0, -12.0, 43.0, -1.0, 10.0, -23.0, 43.0, 43.0, 10.0, -1.0, -45.0, -12.0, 32.0, 43.0, 54.0, 65.0, 76.0, -34.0, -23.0, -56.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22254264265240306, "mean_inference_ms": 23.010392213947735, "mean_action_processing_ms": 0.08258004019541812, "mean_env_wait_ms": 0.03856970892684127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004870414733886719, "StateBufferConnector_ms": 0.004543781280517578, "ViewRequirementAgentConnector_ms": 0.09909462928771973}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 12.96, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 21.0, 10.0, -23.0, 32.0, 32.0, 21.0, 32.0, 43.0, 32.0, 76.0, 43.0, 10.0, 43.0, 54.0, 76.0, -1.0, -1.0, 32.0, -12.0, -45.0, -45.0, 21.0, 65.0, 43.0, 54.0, -23.0, -34.0, -23.0, -34.0, -67.0, -56.0, -45.0, -23.0, 10.0, -1.0, 54.0, 43.0, 65.0, 26.0, -23.0, 10.0, 32.0, 32.0, -1.0, 10.0, 21.0, -1.0, 65.0, -1.0, -34.0, 37.0, -1.0, -1.0, 32.0, -23.0, 43.0, 21.0, -23.0, 21.0, 43.0, 43.0, 32.0, 43.0, 65.0, 21.0, -34.0, 54.0, -12.0, -78.0, -23.0, -23.0, 10.0, 54.0, 76.0, -1.0, -12.0, 54.0, 54.0, 32.0, -12.0, 43.0, -1.0, 10.0, -23.0, 43.0, 43.0, 10.0, -1.0, -45.0, -12.0, 32.0, 43.0, 54.0, 65.0, 76.0, -34.0, -23.0, -56.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22254264265240306, "mean_inference_ms": 23.010392213947735, "mean_action_processing_ms": 0.08258004019541812, "mean_env_wait_ms": 0.03856970892684127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004870414733886719, "StateBufferConnector_ms": 0.004543781280517578, "ViewRequirementAgentConnector_ms": 0.09909462928771973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 161229.96, "sample_time_ms": 86408.943, "learn_time_ms": 74802.845, "learn_throughput": 53.474, "synch_weights_time_ms": 14.045}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 4157, "training_iteration": 79, "trial_id": "38794_00007", "date": "2023-06-02_08-34-48", "timestamp": 1685684088, "time_this_iter_s": 177.5646767616272, "time_total_s": 14942.170383691788, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14942.170383691788, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 16.426050420168067, "ram_util_percent": 52.37436974789915}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": 10.0, "episode_reward_mean": 32.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 10.0, 21.0, 32.0, 65.0, 21.0, 21.0, 54.0, 21.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20580019923966622, "mean_inference_ms": 22.82829559629084, "mean_action_processing_ms": 0.08059803571880017, "mean_env_wait_ms": 0.03806948397116873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039196014404296875, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.0990605354309082}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.5074992179870605, "policy_loss": -0.02263006381690502, "vf_loss": 5.509737968444824, "vf_explained_var": -0.1148553267121315, "kl": 0.005304343067109585, "entropy": 2.918104887008667, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81210.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 13.96, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, -23.0, 43.0, 21.0, -23.0, 21.0, 43.0, 43.0, 32.0, 43.0, 65.0, 21.0, -34.0, 54.0, -12.0, -78.0, -23.0, -23.0, 10.0, 54.0, 76.0, -1.0, -12.0, 54.0, 54.0, 32.0, -12.0, 43.0, -1.0, 10.0, -23.0, 43.0, 43.0, 10.0, -1.0, -45.0, -12.0, 32.0, 43.0, 54.0, 65.0, 76.0, -34.0, -23.0, -56.0, -45.0, 32.0, -12.0, -111.0, -56.0, 10.0, -12.0, 21.0, 43.0, 43.0, -23.0, 54.0, -12.0, -12.0, 10.0, -1.0, -1.0, 32.0, 32.0, -1.0, 43.0, -12.0, -12.0, 32.0, 65.0, 76.0, 54.0, -1.0, 32.0, 10.0, -1.0, -12.0, -1.0, -56.0, 21.0, -56.0, 10.0, -1.0, 76.0, 54.0, 43.0, 10.0, 32.0, 65.0, 10.0, 32.0, 10.0, 54.0, 43.0, 32.0, -12.0, 54.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2223582391794337, "mean_inference_ms": 22.98867850699371, "mean_action_processing_ms": 0.08250206641128142, "mean_env_wait_ms": 0.038532480959889724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004838705062866211, "StateBufferConnector_ms": 0.004587888717651367, "ViewRequirementAgentConnector_ms": 0.09924793243408203}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 13.96, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, -23.0, 43.0, 21.0, -23.0, 21.0, 43.0, 43.0, 32.0, 43.0, 65.0, 21.0, -34.0, 54.0, -12.0, -78.0, -23.0, -23.0, 10.0, 54.0, 76.0, -1.0, -12.0, 54.0, 54.0, 32.0, -12.0, 43.0, -1.0, 10.0, -23.0, 43.0, 43.0, 10.0, -1.0, -45.0, -12.0, 32.0, 43.0, 54.0, 65.0, 76.0, -34.0, -23.0, -56.0, -45.0, 32.0, -12.0, -111.0, -56.0, 10.0, -12.0, 21.0, 43.0, 43.0, -23.0, 54.0, -12.0, -12.0, 10.0, -1.0, -1.0, 32.0, 32.0, -1.0, 43.0, -12.0, -12.0, 32.0, 65.0, 76.0, 54.0, -1.0, 32.0, 10.0, -1.0, -12.0, -1.0, -56.0, 21.0, -56.0, 10.0, -1.0, 76.0, 54.0, 43.0, 10.0, 32.0, 65.0, 10.0, 32.0, 10.0, 54.0, 43.0, 32.0, -12.0, 54.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2223582391794337, "mean_inference_ms": 22.98867850699371, "mean_action_processing_ms": 0.08250206641128142, "mean_env_wait_ms": 0.038532480959889724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004838705062866211, "StateBufferConnector_ms": 0.004587888717651367, "ViewRequirementAgentConnector_ms": 0.09924793243408203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 161234.59, "sample_time_ms": 86411.242, "learn_time_ms": 74805.235, "learn_throughput": 53.472, "synch_weights_time_ms": 13.982}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 4210, "training_iteration": 80, "trial_id": "38794_00007", "date": "2023-06-02_08-37-46", "timestamp": 1685684266, "time_this_iter_s": 177.88139295578003, "time_total_s": 15120.051776647568, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15120.051776647568, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 16.533054393305438, "ram_util_percent": 52.43096234309622}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -1.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 54.0, 10.0, 21.0, 21.0, 10.0, 10.0, 54.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2056221576158447, "mean_inference_ms": 22.807296819171487, "mean_action_processing_ms": 0.08052467933878235, "mean_env_wait_ms": 0.038035940960139424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004117488861083984, "StateBufferConnector_ms": 0.005242824554443359, "ViewRequirementAgentConnector_ms": 0.09754657745361328}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.0373640060424805, "policy_loss": 0.0028527805116027594, "vf_loss": 6.0127177238464355, "vf_explained_var": -0.06120656430721283, "kl": 0.005668834317475557, "entropy": 2.911541223526001, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82230.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 13.29, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 43.0, -23.0, 54.0, -12.0, -12.0, 10.0, -1.0, -1.0, 32.0, 32.0, -1.0, 43.0, -12.0, -12.0, 32.0, 65.0, 76.0, 54.0, -1.0, 32.0, 10.0, -1.0, -12.0, -1.0, -56.0, 21.0, -56.0, 10.0, -1.0, 76.0, 54.0, 43.0, 10.0, 32.0, 65.0, 10.0, 32.0, 10.0, 54.0, 43.0, 32.0, -12.0, 54.0, 10.0, 21.0, -56.0, -23.0, -23.0, 10.0, -45.0, 43.0, 32.0, 21.0, 32.0, 21.0, 10.0, -12.0, 26.0, 32.0, 21.0, -1.0, 10.0, -1.0, 21.0, 54.0, -89.0, 10.0, 21.0, -12.0, 10.0, 32.0, 43.0, 54.0, 43.0, -1.0, -67.0, -34.0, -34.0, 21.0, -12.0, -56.0, -34.0, 21.0, 10.0, -56.0, -78.0, 43.0, 48.0, 43.0, 32.0, 21.0, 43.0, 76.0, 32.0, 43.0, 65.0, 21.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2221786078915115, "mean_inference_ms": 22.967723098452325, "mean_action_processing_ms": 0.08242642131691102, "mean_env_wait_ms": 0.03849727886592507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004790306091308594, "StateBufferConnector_ms": 0.004597663879394531, "ViewRequirementAgentConnector_ms": 0.09933590888977051}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 13.29, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 43.0, -23.0, 54.0, -12.0, -12.0, 10.0, -1.0, -1.0, 32.0, 32.0, -1.0, 43.0, -12.0, -12.0, 32.0, 65.0, 76.0, 54.0, -1.0, 32.0, 10.0, -1.0, -12.0, -1.0, -56.0, 21.0, -56.0, 10.0, -1.0, 76.0, 54.0, 43.0, 10.0, 32.0, 65.0, 10.0, 32.0, 10.0, 54.0, 43.0, 32.0, -12.0, 54.0, 10.0, 21.0, -56.0, -23.0, -23.0, 10.0, -45.0, 43.0, 32.0, 21.0, 32.0, 21.0, 10.0, -12.0, 26.0, 32.0, 21.0, -1.0, 10.0, -1.0, 21.0, 54.0, -89.0, 10.0, 21.0, -12.0, 10.0, 32.0, 43.0, 54.0, 43.0, -1.0, -67.0, -34.0, -34.0, 21.0, -12.0, -56.0, -34.0, 21.0, 10.0, -56.0, -78.0, 43.0, 48.0, 43.0, 32.0, 21.0, 43.0, 76.0, 32.0, 43.0, 65.0, 21.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2221786078915115, "mean_inference_ms": 22.967723098452325, "mean_action_processing_ms": 0.08242642131691102, "mean_env_wait_ms": 0.03849727886592507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004790306091308594, "StateBufferConnector_ms": 0.004597663879394531, "ViewRequirementAgentConnector_ms": 0.09933590888977051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 161239.555, "sample_time_ms": 86435.406, "learn_time_ms": 74790.137, "learn_throughput": 53.483, "synch_weights_time_ms": 9.847}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 4263, "training_iteration": 81, "trial_id": "38794_00007", "date": "2023-06-02_08-40-44", "timestamp": 1685684444, "time_this_iter_s": 177.58559107780457, "time_total_s": 15297.637367725372, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15297.637367725372, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 16.095378151260505, "ram_util_percent": 52.485294117647065}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -12.0, "episode_reward_mean": 24.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -1.0, 32.0, 21.0, 43.0, 21.0, -12.0, 54.0, -1.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20544632751172992, "mean_inference_ms": 22.78637858885221, "mean_action_processing_ms": 0.08044878912110534, "mean_env_wait_ms": 0.03800490317158968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004379749298095703, "StateBufferConnector_ms": 0.0051021575927734375, "ViewRequirementAgentConnector_ms": 0.09727239608764648}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.742632865905762, "policy_loss": -0.035288434475660324, "vf_loss": 5.754033088684082, "vf_explained_var": -0.09804738312959671, "kl": 0.0062138051725924015, "entropy": 2.9266669750213623, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83250.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 6.25, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 32.0, 21.0, 32.0, 21.0, 10.0, -12.0, 26.0, 32.0, 21.0, -1.0, 10.0, -1.0, 21.0, 54.0, -89.0, 10.0, 21.0, -12.0, 10.0, 32.0, 43.0, 54.0, 43.0, -1.0, -67.0, -34.0, -34.0, 21.0, -12.0, -56.0, -34.0, 21.0, 10.0, -56.0, -78.0, 43.0, 48.0, 43.0, 32.0, 21.0, 43.0, 76.0, 32.0, 43.0, 65.0, 21.0, -12.0, 54.0, 54.0, 32.0, 21.0, 65.0, 21.0, 32.0, 54.0, 65.0, -1.0, 21.0, 32.0, 54.0, 54.0, 43.0, 32.0, -23.0, -56.0, -78.0, -12.0, -23.0, -1.0, -34.0, -78.0, -78.0, -56.0, -45.0, 54.0, 65.0, 21.0, 65.0, -1.0, -23.0, 10.0, -1.0, -12.0, -1.0, -12.0, -89.0, -1.0, -56.0, -1.0, -78.0, -45.0, 10.0, 54.0, 76.0, -100.0, -34.0, -1.0, -45.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22199896538738229, "mean_inference_ms": 22.94627319198387, "mean_action_processing_ms": 0.08235213793931402, "mean_env_wait_ms": 0.038461840552217824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004786968231201172, "StateBufferConnector_ms": 0.00460362434387207, "ViewRequirementAgentConnector_ms": 0.09911990165710449}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 6.25, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 32.0, 21.0, 32.0, 21.0, 10.0, -12.0, 26.0, 32.0, 21.0, -1.0, 10.0, -1.0, 21.0, 54.0, -89.0, 10.0, 21.0, -12.0, 10.0, 32.0, 43.0, 54.0, 43.0, -1.0, -67.0, -34.0, -34.0, 21.0, -12.0, -56.0, -34.0, 21.0, 10.0, -56.0, -78.0, 43.0, 48.0, 43.0, 32.0, 21.0, 43.0, 76.0, 32.0, 43.0, 65.0, 21.0, -12.0, 54.0, 54.0, 32.0, 21.0, 65.0, 21.0, 32.0, 54.0, 65.0, -1.0, 21.0, 32.0, 54.0, 54.0, 43.0, 32.0, -23.0, -56.0, -78.0, -12.0, -23.0, -1.0, -34.0, -78.0, -78.0, -56.0, -45.0, 54.0, 65.0, 21.0, 65.0, -1.0, -23.0, 10.0, -1.0, -12.0, -1.0, -12.0, -89.0, -1.0, -56.0, -1.0, -78.0, -45.0, 10.0, 54.0, 76.0, -100.0, -34.0, -1.0, -45.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22199896538738229, "mean_inference_ms": 22.94627319198387, "mean_action_processing_ms": 0.08235213793931402, "mean_env_wait_ms": 0.038461840552217824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004786968231201172, "StateBufferConnector_ms": 0.00460362434387207, "ViewRequirementAgentConnector_ms": 0.09911990165710449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 161210.262, "sample_time_ms": 86376.594, "learn_time_ms": 74819.755, "learn_throughput": 53.462, "synch_weights_time_ms": 9.766}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 4315, "training_iteration": 82, "trial_id": "38794_00007", "date": "2023-06-02_08-43-41", "timestamp": 1685684621, "time_this_iter_s": 177.32848501205444, "time_total_s": 15474.965852737427, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15474.965852737427, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.889915966386553, "ram_util_percent": 52.55126050420167}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 4.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -12.0, -12.0, -12.0, -56.0, 43.0, -34.0, 54.0, 76.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20526320654494645, "mean_inference_ms": 22.76621659558965, "mean_action_processing_ms": 0.08037396408276745, "mean_env_wait_ms": 0.03797002488088503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298686981201172, "StateBufferConnector_ms": 0.005173683166503906, "ViewRequirementAgentConnector_ms": 0.09686470031738281}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.6338605880737305, "policy_loss": -0.06064062565565109, "vf_loss": 5.670860290527344, "vf_explained_var": -0.07660217583179474, "kl": 0.006149474531412125, "entropy": 2.912564277648926, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84270.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 3.07, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 32.0, 54.0, 65.0, -1.0, 21.0, 32.0, 54.0, 54.0, 43.0, 32.0, -23.0, -56.0, -78.0, -12.0, -23.0, -1.0, -34.0, -78.0, -78.0, -56.0, -45.0, 54.0, 65.0, 21.0, 65.0, -1.0, -23.0, 10.0, -1.0, -12.0, -1.0, -12.0, -89.0, -1.0, -56.0, -1.0, -78.0, -45.0, 10.0, 54.0, 76.0, -100.0, -34.0, -1.0, -45.0, 65.0, 21.0, 21.0, -78.0, -1.0, -12.0, -23.0, -12.0, 10.0, 32.0, 21.0, 54.0, 54.0, 32.0, -34.0, -23.0, 10.0, -56.0, 21.0, 32.0, -23.0, -23.0, 32.0, 21.0, 10.0, 10.0, -23.0, 10.0, 21.0, 32.0, -12.0, 65.0, 43.0, 65.0, 43.0, 21.0, -23.0, 32.0, 10.0, 10.0, 10.0, -1.0, 21.0, 10.0, -23.0, -1.0, -1.0, 43.0, 10.0, -1.0, 10.0, 21.0, 21.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22182292595555686, "mean_inference_ms": 22.9250764140265, "mean_action_processing_ms": 0.08227635959377261, "mean_env_wait_ms": 0.038426451299385135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004817008972167969, "StateBufferConnector_ms": 0.004593849182128906, "ViewRequirementAgentConnector_ms": 0.09926676750183105}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 3.07, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 32.0, 54.0, 65.0, -1.0, 21.0, 32.0, 54.0, 54.0, 43.0, 32.0, -23.0, -56.0, -78.0, -12.0, -23.0, -1.0, -34.0, -78.0, -78.0, -56.0, -45.0, 54.0, 65.0, 21.0, 65.0, -1.0, -23.0, 10.0, -1.0, -12.0, -1.0, -12.0, -89.0, -1.0, -56.0, -1.0, -78.0, -45.0, 10.0, 54.0, 76.0, -100.0, -34.0, -1.0, -45.0, 65.0, 21.0, 21.0, -78.0, -1.0, -12.0, -23.0, -12.0, 10.0, 32.0, 21.0, 54.0, 54.0, 32.0, -34.0, -23.0, 10.0, -56.0, 21.0, 32.0, -23.0, -23.0, 32.0, 21.0, 10.0, 10.0, -23.0, 10.0, 21.0, 32.0, -12.0, 65.0, 43.0, 65.0, 43.0, 21.0, -23.0, 32.0, 10.0, 10.0, 10.0, -1.0, 21.0, 10.0, -23.0, -1.0, -1.0, 43.0, 10.0, -1.0, 10.0, 21.0, 21.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22182292595555686, "mean_inference_ms": 22.9250764140265, "mean_action_processing_ms": 0.08227635959377261, "mean_env_wait_ms": 0.038426451299385135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004817008972167969, "StateBufferConnector_ms": 0.004593849182128906, "ViewRequirementAgentConnector_ms": 0.09926676750183105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 161246.716, "sample_time_ms": 86374.56, "learn_time_ms": 74858.409, "learn_throughput": 53.434, "synch_weights_time_ms": 9.588}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 4368, "training_iteration": 83, "trial_id": "38794_00007", "date": "2023-06-02_08-46-39", "timestamp": 1685684799, "time_this_iter_s": 177.84412693977356, "time_total_s": 15652.8099796772, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15652.8099796772, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 16.19453781512605, "ram_util_percent": 52.59747899159664}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -111.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 21.0, -12.0, 43.0, 21.0, 32.0, 21.0, 65.0, -111.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20509927550387097, "mean_inference_ms": 22.746759104763434, "mean_action_processing_ms": 0.08029859766353128, "mean_env_wait_ms": 0.03793485664215544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004074573516845703, "StateBufferConnector_ms": 0.005066394805908203, "ViewRequirementAgentConnector_ms": 0.09915828704833984}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.364603042602539, "policy_loss": -0.0450390987098217, "vf_loss": 5.387652397155762, "vf_explained_var": -0.03802107274532318, "kl": 0.00572005333378911, "entropy": 2.9044926166534424, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85290.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 14.45, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, 32.0, 21.0, 54.0, 54.0, 32.0, -34.0, -23.0, 10.0, -56.0, 21.0, 32.0, -23.0, -23.0, 32.0, 21.0, 10.0, 10.0, -23.0, 10.0, 21.0, 32.0, -12.0, 65.0, 43.0, 65.0, 43.0, 21.0, -23.0, 32.0, 10.0, 10.0, 10.0, -1.0, 21.0, 10.0, -23.0, -1.0, -1.0, 43.0, 10.0, -1.0, 10.0, 21.0, 21.0, -45.0, 59.0, -1.0, -1.0, 10.0, -67.0, 65.0, -1.0, 32.0, 43.0, 54.0, 43.0, 76.0, 54.0, 21.0, 10.0, 65.0, -1.0, 21.0, -23.0, 21.0, -34.0, -12.0, 10.0, 65.0, 43.0, 32.0, 76.0, 43.0, 43.0, 76.0, 54.0, 65.0, 43.0, 32.0, 65.0, 43.0, 21.0, -34.0, -78.0, 54.0, 21.0, 65.0, 21.0, 21.0, -78.0, -45.0, -111.0, -23.0, -12.0, -34.0, 43.0, 10.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22165939413442107, "mean_inference_ms": 22.905527773986133, "mean_action_processing_ms": 0.08220305991847227, "mean_env_wait_ms": 0.0383926996079721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004888772964477539, "StateBufferConnector_ms": 0.0046405792236328125, "ViewRequirementAgentConnector_ms": 0.09987664222717285}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 14.45, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, 32.0, 21.0, 54.0, 54.0, 32.0, -34.0, -23.0, 10.0, -56.0, 21.0, 32.0, -23.0, -23.0, 32.0, 21.0, 10.0, 10.0, -23.0, 10.0, 21.0, 32.0, -12.0, 65.0, 43.0, 65.0, 43.0, 21.0, -23.0, 32.0, 10.0, 10.0, 10.0, -1.0, 21.0, 10.0, -23.0, -1.0, -1.0, 43.0, 10.0, -1.0, 10.0, 21.0, 21.0, -45.0, 59.0, -1.0, -1.0, 10.0, -67.0, 65.0, -1.0, 32.0, 43.0, 54.0, 43.0, 76.0, 54.0, 21.0, 10.0, 65.0, -1.0, 21.0, -23.0, 21.0, -34.0, -12.0, 10.0, 65.0, 43.0, 32.0, 76.0, 43.0, 43.0, 76.0, 54.0, 65.0, 43.0, 32.0, 65.0, 43.0, 21.0, -34.0, -78.0, 54.0, 21.0, 65.0, 21.0, 21.0, -78.0, -45.0, -111.0, -23.0, -12.0, -34.0, 43.0, 10.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22165939413442107, "mean_inference_ms": 22.905527773986133, "mean_action_processing_ms": 0.08220305991847227, "mean_env_wait_ms": 0.0383926996079721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004888772964477539, "StateBufferConnector_ms": 0.0046405792236328125, "ViewRequirementAgentConnector_ms": 0.09987664222717285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 161304.832, "sample_time_ms": 86377.998, "learn_time_ms": 74913.165, "learn_throughput": 53.395, "synch_weights_time_ms": 9.516}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 4421, "training_iteration": 84, "trial_id": "38794_00007", "date": "2023-06-02_08-49-37", "timestamp": 1685684977, "time_this_iter_s": 178.1136691570282, "time_total_s": 15830.923648834229, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15830.923648834229, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 16.54937238493724, "ram_util_percent": 52.686192468619254}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -23.0, "episode_reward_mean": 18.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 43.0, -1.0, -23.0, -23.0, 65.0, 43.0, 32.0, 10.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2049378988106231, "mean_inference_ms": 22.727727613217176, "mean_action_processing_ms": 0.08022481632207569, "mean_env_wait_ms": 0.03790060076314457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035810470581054688, "StateBufferConnector_ms": 0.005180835723876953, "ViewRequirementAgentConnector_ms": 0.09998083114624023}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.343289375305176, "policy_loss": -0.031378600746393204, "vf_loss": 6.349287033081055, "vf_explained_var": -0.07590045779943466, "kl": 0.006602133624255657, "entropy": 2.8848884105682373, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86325.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 7.25, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -1.0, 32.0, 43.0, 54.0, 43.0, 76.0, 54.0, 21.0, 10.0, 65.0, -1.0, 21.0, -23.0, 21.0, -34.0, -12.0, 10.0, 65.0, 43.0, 32.0, 76.0, 43.0, 43.0, 76.0, 54.0, 65.0, 43.0, 32.0, 65.0, 43.0, 21.0, -34.0, -78.0, 54.0, 21.0, 65.0, 21.0, 21.0, -78.0, -45.0, -111.0, -23.0, -12.0, -34.0, 43.0, 10.0, -56.0, -67.0, 21.0, -1.0, -23.0, -12.0, 32.0, 21.0, -1.0, -1.0, 21.0, 10.0, -1.0, 21.0, -45.0, -45.0, -23.0, 21.0, 21.0, -12.0, 43.0, 43.0, 43.0, -1.0, -45.0, -67.0, -56.0, -45.0, -23.0, -78.0, -78.0, -34.0, -56.0, -111.0, -78.0, 21.0, 10.0, 43.0, 32.0, 76.0, 43.0, 10.0, 10.0, 32.0, 65.0, -1.0, -67.0, -12.0, -34.0, 43.0, 65.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2214971523364656, "mean_inference_ms": 22.88650449659409, "mean_action_processing_ms": 0.08213164917145598, "mean_env_wait_ms": 0.03836043595206891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004933595657348633, "StateBufferConnector_ms": 0.004655361175537109, "ViewRequirementAgentConnector_ms": 0.09974074363708496}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 7.25, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, -1.0, 32.0, 43.0, 54.0, 43.0, 76.0, 54.0, 21.0, 10.0, 65.0, -1.0, 21.0, -23.0, 21.0, -34.0, -12.0, 10.0, 65.0, 43.0, 32.0, 76.0, 43.0, 43.0, 76.0, 54.0, 65.0, 43.0, 32.0, 65.0, 43.0, 21.0, -34.0, -78.0, 54.0, 21.0, 65.0, 21.0, 21.0, -78.0, -45.0, -111.0, -23.0, -12.0, -34.0, 43.0, 10.0, -56.0, -67.0, 21.0, -1.0, -23.0, -12.0, 32.0, 21.0, -1.0, -1.0, 21.0, 10.0, -1.0, 21.0, -45.0, -45.0, -23.0, 21.0, 21.0, -12.0, 43.0, 43.0, 43.0, -1.0, -45.0, -67.0, -56.0, -45.0, -23.0, -78.0, -78.0, -34.0, -56.0, -111.0, -78.0, 21.0, 10.0, 43.0, 32.0, 76.0, 43.0, 10.0, 10.0, 32.0, 65.0, -1.0, -67.0, -12.0, -34.0, 43.0, 65.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2214971523364656, "mean_inference_ms": 22.88650449659409, "mean_action_processing_ms": 0.08213164917145598, "mean_env_wait_ms": 0.03836043595206891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004933595657348633, "StateBufferConnector_ms": 0.004655361175537109, "ViewRequirementAgentConnector_ms": 0.09974074363708496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 161563.168, "sample_time_ms": 86372.242, "learn_time_ms": 75180.72, "learn_throughput": 53.205, "synch_weights_time_ms": 9.404}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 4473, "training_iteration": 85, "trial_id": "38794_00007", "date": "2023-06-02_08-52-37", "timestamp": 1685685157, "time_this_iter_s": 180.11864805221558, "time_total_s": 16011.042296886444, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16011.042296886444, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 16.61410788381743, "ram_util_percent": 52.74439834024898}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -100.0, "episode_reward_mean": -16.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 10.0, -56.0, -100.0, -67.0, -12.0, 10.0, -34.0, 10.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20485098239660968, "mean_inference_ms": 22.717241386536955, "mean_action_processing_ms": 0.08018976420693483, "mean_env_wait_ms": 0.037886977817675874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004332065582275391, "StateBufferConnector_ms": 0.005233287811279297, "ViewRequirementAgentConnector_ms": 0.10361194610595703}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 6.144686698913574, "policy_loss": 0.00015103303303476423, "vf_loss": 6.122172832489014, "vf_explained_var": -0.1571711152791977, "kl": 0.00581706315279007, "entropy": 2.8940024375915527, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87360.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 2.57, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, -1.0, -1.0, 21.0, 10.0, -1.0, 21.0, -45.0, -45.0, -23.0, 21.0, 21.0, -12.0, 43.0, 43.0, 43.0, -1.0, -45.0, -67.0, -56.0, -45.0, -23.0, -78.0, -78.0, -34.0, -56.0, -111.0, -78.0, 21.0, 10.0, 43.0, 32.0, 76.0, 43.0, 10.0, 10.0, 32.0, 65.0, -1.0, -67.0, -12.0, -34.0, 43.0, 65.0, 32.0, 54.0, 54.0, 54.0, 65.0, -12.0, 21.0, 32.0, -45.0, -23.0, 21.0, 10.0, -12.0, -45.0, 65.0, 21.0, -1.0, -1.0, -23.0, -1.0, 10.0, 32.0, -12.0, 10.0, -34.0, -34.0, -89.0, -100.0, -100.0, -23.0, 15.0, -45.0, 43.0, 32.0, 32.0, 21.0, 10.0, 10.0, -12.0, -45.0, -1.0, -34.0, 10.0, 32.0, 43.0, 54.0, 32.0, 32.0, 10.0, 10.0, 21.0, 76.0, 21.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22133141191657735, "mean_inference_ms": 22.86757104929295, "mean_action_processing_ms": 0.08205801057872866, "mean_env_wait_ms": 0.03832762298811112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004872322082519531, "StateBufferConnector_ms": 0.004573345184326172, "ViewRequirementAgentConnector_ms": 0.0988922119140625}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 2.57, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 21.0, -1.0, -1.0, 21.0, 10.0, -1.0, 21.0, -45.0, -45.0, -23.0, 21.0, 21.0, -12.0, 43.0, 43.0, 43.0, -1.0, -45.0, -67.0, -56.0, -45.0, -23.0, -78.0, -78.0, -34.0, -56.0, -111.0, -78.0, 21.0, 10.0, 43.0, 32.0, 76.0, 43.0, 10.0, 10.0, 32.0, 65.0, -1.0, -67.0, -12.0, -34.0, 43.0, 65.0, 32.0, 54.0, 54.0, 54.0, 65.0, -12.0, 21.0, 32.0, -45.0, -23.0, 21.0, 10.0, -12.0, -45.0, 65.0, 21.0, -1.0, -1.0, -23.0, -1.0, 10.0, 32.0, -12.0, 10.0, -34.0, -34.0, -89.0, -100.0, -100.0, -23.0, 15.0, -45.0, 43.0, 32.0, 32.0, 21.0, 10.0, 10.0, -12.0, -45.0, -1.0, -34.0, 10.0, 32.0, 43.0, 54.0, 32.0, 32.0, 10.0, 10.0, 21.0, 76.0, 21.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22133141191657735, "mean_inference_ms": 22.86757104929295, "mean_action_processing_ms": 0.08205801057872866, "mean_env_wait_ms": 0.03832762298811112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004872322082519531, "StateBufferConnector_ms": 0.004573345184326172, "ViewRequirementAgentConnector_ms": 0.0988922119140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 161685.114, "sample_time_ms": 86415.728, "learn_time_ms": 75259.264, "learn_throughput": 53.15, "synch_weights_time_ms": 9.331}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 4526, "training_iteration": 86, "trial_id": "38794_00007", "date": "2023-06-02_08-55-36", "timestamp": 1685685336, "time_this_iter_s": 178.83251404762268, "time_total_s": 16189.874810934067, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16189.874810934067, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 16.80708333333333, "ram_util_percent": 52.79291666666668}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": 33.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -45.0, 32.0, -12.0, 43.0, 43.0, 65.0, 76.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20468987364389726, "mean_inference_ms": 22.698696431889942, "mean_action_processing_ms": 0.08012154410224026, "mean_env_wait_ms": 0.03785390829795145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004088878631591797, "StateBufferConnector_ms": 0.005106925964355469, "ViewRequirementAgentConnector_ms": 0.09827375411987305}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.433073997497559, "policy_loss": -0.008434196002781391, "vf_loss": 5.41605281829834, "vf_explained_var": -0.08540026843547821, "kl": 0.006621531676501036, "entropy": 2.895749568939209, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88380.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 13.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -45.0, -23.0, 21.0, 10.0, -12.0, -45.0, 65.0, 21.0, -1.0, -1.0, -23.0, -1.0, 10.0, 32.0, -12.0, 10.0, -34.0, -34.0, -89.0, -100.0, -100.0, -23.0, 15.0, -45.0, 43.0, 32.0, 32.0, 21.0, 10.0, 10.0, -12.0, -45.0, -1.0, -34.0, 10.0, 32.0, 43.0, 54.0, 32.0, 32.0, 10.0, 10.0, 21.0, 76.0, 21.0, 76.0, 76.0, 54.0, 21.0, 32.0, 21.0, -23.0, 54.0, -12.0, -12.0, 21.0, -78.0, 10.0, 54.0, 21.0, 32.0, 32.0, 76.0, 76.0, 76.0, 76.0, 65.0, 32.0, 21.0, 43.0, 76.0, 32.0, 43.0, 32.0, 32.0, 21.0, 21.0, 10.0, -1.0, 65.0, 21.0, -111.0, -56.0, 32.0, -12.0, 32.0, 32.0, 21.0, -34.0, -1.0, -1.0, -1.0, 10.0, 32.0, 43.0, 32.0, 10.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22118050628552613, "mean_inference_ms": 22.849777691432127, "mean_action_processing_ms": 0.08199168069667882, "mean_env_wait_ms": 0.0382968152657411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048525333404541016, "StateBufferConnector_ms": 0.00459742546081543, "ViewRequirementAgentConnector_ms": 0.09880828857421875}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 13.9, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -45.0, -23.0, 21.0, 10.0, -12.0, -45.0, 65.0, 21.0, -1.0, -1.0, -23.0, -1.0, 10.0, 32.0, -12.0, 10.0, -34.0, -34.0, -89.0, -100.0, -100.0, -23.0, 15.0, -45.0, 43.0, 32.0, 32.0, 21.0, 10.0, 10.0, -12.0, -45.0, -1.0, -34.0, 10.0, 32.0, 43.0, 54.0, 32.0, 32.0, 10.0, 10.0, 21.0, 76.0, 21.0, 76.0, 76.0, 54.0, 21.0, 32.0, 21.0, -23.0, 54.0, -12.0, -12.0, 21.0, -78.0, 10.0, 54.0, 21.0, 32.0, 32.0, 76.0, 76.0, 76.0, 76.0, 65.0, 32.0, 21.0, 43.0, 76.0, 32.0, 43.0, 32.0, 32.0, 21.0, 21.0, 10.0, -1.0, 65.0, 21.0, -111.0, -56.0, 32.0, -12.0, 32.0, 32.0, 21.0, -34.0, -1.0, -1.0, -1.0, 10.0, 32.0, 43.0, 32.0, 10.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22118050628552613, "mean_inference_ms": 22.849777691432127, "mean_action_processing_ms": 0.08199168069667882, "mean_env_wait_ms": 0.0382968152657411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048525333404541016, "StateBufferConnector_ms": 0.00459742546081543, "ViewRequirementAgentConnector_ms": 0.09880828857421875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 161739.541, "sample_time_ms": 86442.816, "learn_time_ms": 75286.578, "learn_throughput": 53.13, "synch_weights_time_ms": 9.356}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 4578, "training_iteration": 87, "trial_id": "38794_00007", "date": "2023-06-02_08-58-34", "timestamp": 1685685514, "time_this_iter_s": 178.0905168056488, "time_total_s": 16367.965327739716, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16367.965327739716, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 16.313865546218487, "ram_util_percent": 52.89915966386556}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -23.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, -12.0, 21.0, 43.0, -23.0, 21.0, -1.0, 21.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2045429069633231, "mean_inference_ms": 22.68120089340284, "mean_action_processing_ms": 0.08005899536066194, "mean_env_wait_ms": 0.0378246026180219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004105567932128906, "StateBufferConnector_ms": 0.005183219909667969, "ViewRequirementAgentConnector_ms": 0.09921789169311523}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.8443360328674316, "cur_lr": 9.999999747378752e-05, "total_loss": 5.968777179718018, "policy_loss": 0.007523609325289726, "vf_loss": 5.944283962249756, "vf_explained_var": -0.017761068418622017, "kl": 0.00441442895680666, "entropy": 2.8929755687713623, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89400.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 15.66, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, -12.0, -12.0, 21.0, -78.0, 10.0, 54.0, 21.0, 32.0, 32.0, 76.0, 76.0, 76.0, 76.0, 65.0, 32.0, 21.0, 43.0, 76.0, 32.0, 43.0, 32.0, 32.0, 21.0, 21.0, 10.0, -1.0, 65.0, 21.0, -111.0, -56.0, 32.0, -12.0, 32.0, 32.0, 21.0, -34.0, -1.0, -1.0, -1.0, 10.0, 32.0, 43.0, 32.0, 10.0, 65.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, 65.0, 54.0, 43.0, 32.0, 43.0, 10.0, 32.0, 32.0, 21.0, 32.0, 76.0, -1.0, -12.0, -1.0, 32.0, 54.0, 43.0, 32.0, 10.0, 54.0, 54.0, -1.0, -89.0, -23.0, 43.0, -34.0, 21.0, -89.0, -133.0, -34.0, -34.0, 10.0, 10.0, -1.0, -95.0, -34.0, 54.0, -1.0, -34.0, -78.0, -56.0, -23.0, -34.0, -23.0, -1.0, 43.0, -12.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22103441037696236, "mean_inference_ms": 22.831456726106254, "mean_action_processing_ms": 0.08192779141627651, "mean_env_wait_ms": 0.038266605986351114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004917144775390625, "StateBufferConnector_ms": 0.004623889923095703, "ViewRequirementAgentConnector_ms": 0.09970259666442871}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 15.66, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -12.0, -12.0, 21.0, -78.0, 10.0, 54.0, 21.0, 32.0, 32.0, 76.0, 76.0, 76.0, 76.0, 65.0, 32.0, 21.0, 43.0, 76.0, 32.0, 43.0, 32.0, 32.0, 21.0, 21.0, 10.0, -1.0, 65.0, 21.0, -111.0, -56.0, 32.0, -12.0, 32.0, 32.0, 21.0, -34.0, -1.0, -1.0, -1.0, 10.0, 32.0, 43.0, 32.0, 10.0, 65.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, 65.0, 54.0, 43.0, 32.0, 43.0, 10.0, 32.0, 32.0, 21.0, 32.0, 76.0, -1.0, -12.0, -1.0, 32.0, 54.0, 43.0, 32.0, 10.0, 54.0, 54.0, -1.0, -89.0, -23.0, 43.0, -34.0, 21.0, -89.0, -133.0, -34.0, -34.0, 10.0, 10.0, -1.0, -95.0, -34.0, 54.0, -1.0, -34.0, -78.0, -56.0, -23.0, -34.0, -23.0, -1.0, 43.0, -12.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22103441037696236, "mean_inference_ms": 22.831456726106254, "mean_action_processing_ms": 0.08192779141627651, "mean_env_wait_ms": 0.038266605986351114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004917144775390625, "StateBufferConnector_ms": 0.004623889923095703, "ViewRequirementAgentConnector_ms": 0.09970259666442871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 161729.935, "sample_time_ms": 86397.414, "learn_time_ms": 75322.315, "learn_throughput": 53.105, "synch_weights_time_ms": 9.377}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 4631, "training_iteration": 88, "trial_id": "38794_00007", "date": "2023-06-02_09-01-32", "timestamp": 1685685692, "time_this_iter_s": 177.86538791656494, "time_total_s": 16545.83071565628, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16545.83071565628, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.23235294117647, "ram_util_percent": 52.957142857142856}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -78.0, "episode_reward_mean": -23.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 32.0, -12.0, -34.0, -23.0, 43.0, -45.0, -1.0, -56.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20439906661774582, "mean_inference_ms": 22.663764687423082, "mean_action_processing_ms": 0.07999558928934891, "mean_env_wait_ms": 0.03779698823888876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003769397735595703, "StateBufferConnector_ms": 0.0050067901611328125, "ViewRequirementAgentConnector_ms": 0.09850025177001953}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 5.671730041503906, "policy_loss": -0.04369370639324188, "vf_loss": 5.7050371170043945, "vf_explained_var": 0.00784042477607727, "kl": 0.00540350005030632, "entropy": 2.884340524673462, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90420.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 11.97, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 32.0, 43.0, 10.0, 32.0, 32.0, 21.0, 32.0, 76.0, -1.0, -12.0, -1.0, 32.0, 54.0, 43.0, 32.0, 10.0, 54.0, 54.0, -1.0, -89.0, -23.0, 43.0, -34.0, 21.0, -89.0, -133.0, -34.0, -34.0, 10.0, 10.0, -1.0, -95.0, -34.0, 54.0, -1.0, -34.0, -78.0, -56.0, -23.0, -34.0, -23.0, -1.0, 43.0, -12.0, 32.0, 32.0, 43.0, 65.0, 43.0, 43.0, 65.0, 54.0, 54.0, 43.0, 65.0, 43.0, 32.0, 32.0, 65.0, 65.0, 54.0, 32.0, 32.0, 21.0, -12.0, -1.0, 21.0, -34.0, 43.0, 10.0, 43.0, 21.0, 21.0, -12.0, 21.0, -34.0, 43.0, -18.0, 43.0, -12.0, 32.0, 10.0, 10.0, -1.0, 10.0, -12.0, -45.0, -12.0, 32.0, 54.0, 54.0, -23.0, -78.0, 43.0, 32.0, -12.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2208888722628695, "mean_inference_ms": 22.81397749673636, "mean_action_processing_ms": 0.08186295647747822, "mean_env_wait_ms": 0.03823658275004107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049097537994384766, "StateBufferConnector_ms": 0.0045871734619140625, "ViewRequirementAgentConnector_ms": 0.10010075569152832}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 11.97, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 32.0, 43.0, 10.0, 32.0, 32.0, 21.0, 32.0, 76.0, -1.0, -12.0, -1.0, 32.0, 54.0, 43.0, 32.0, 10.0, 54.0, 54.0, -1.0, -89.0, -23.0, 43.0, -34.0, 21.0, -89.0, -133.0, -34.0, -34.0, 10.0, 10.0, -1.0, -95.0, -34.0, 54.0, -1.0, -34.0, -78.0, -56.0, -23.0, -34.0, -23.0, -1.0, 43.0, -12.0, 32.0, 32.0, 43.0, 65.0, 43.0, 43.0, 65.0, 54.0, 54.0, 43.0, 65.0, 43.0, 32.0, 32.0, 65.0, 65.0, 54.0, 32.0, 32.0, 21.0, -12.0, -1.0, 21.0, -34.0, 43.0, 10.0, 43.0, 21.0, 21.0, -12.0, 21.0, -34.0, 43.0, -18.0, 43.0, -12.0, 32.0, 10.0, 10.0, -1.0, 10.0, -12.0, -45.0, -12.0, 32.0, 54.0, 54.0, -23.0, -78.0, 43.0, 32.0, -12.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2208888722628695, "mean_inference_ms": 22.81397749673636, "mean_action_processing_ms": 0.08186295647747822, "mean_env_wait_ms": 0.03823658275004107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049097537994384766, "StateBufferConnector_ms": 0.0045871734619140625, "ViewRequirementAgentConnector_ms": 0.10010075569152832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 161819.6, "sample_time_ms": 86429.561, "learn_time_ms": 75379.733, "learn_throughput": 53.065, "synch_weights_time_ms": 9.415}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 4684, "training_iteration": 89, "trial_id": "38794_00007", "date": "2023-06-02_09-04-30", "timestamp": 1685685870, "time_this_iter_s": 178.4917130470276, "time_total_s": 16724.322428703308, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16724.322428703308, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 16.08075313807531, "ram_util_percent": 52.99330543933054}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -67.0, "episode_reward_mean": -2.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, 43.0, -12.0, 21.0, -23.0, 32.0, 21.0, -67.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20425194991690881, "mean_inference_ms": 22.646981870477497, "mean_action_processing_ms": 0.07993355736523557, "mean_env_wait_ms": 0.037768798913787135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041675567626953125, "StateBufferConnector_ms": 0.005123615264892578, "ViewRequirementAgentConnector_ms": 0.09860038757324219}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 6.065617561340332, "policy_loss": -0.019669566303491592, "vf_loss": 6.071321964263916, "vf_explained_var": -0.07569952309131622, "kl": 0.007265164982527494, "entropy": 2.8761589527130127, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91440.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 18.24, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 54.0, 43.0, 65.0, 43.0, 32.0, 32.0, 65.0, 65.0, 54.0, 32.0, 32.0, 21.0, -12.0, -1.0, 21.0, -34.0, 43.0, 10.0, 43.0, 21.0, 21.0, -12.0, 21.0, -34.0, 43.0, -18.0, 43.0, -12.0, 32.0, 10.0, 10.0, -1.0, 10.0, -12.0, -45.0, -12.0, 32.0, 54.0, 54.0, -23.0, -78.0, 43.0, 32.0, -12.0, 43.0, 10.0, 65.0, 54.0, 43.0, -1.0, 32.0, 76.0, 32.0, 32.0, 10.0, 76.0, -1.0, 10.0, 21.0, 10.0, -1.0, -34.0, 10.0, 10.0, 43.0, 65.0, 43.0, 65.0, 32.0, 32.0, 43.0, 65.0, 65.0, 54.0, 32.0, -34.0, 21.0, 21.0, 21.0, -23.0, -23.0, -67.0, -45.0, -45.0, 21.0, 21.0, -23.0, -1.0, -45.0, 21.0, -12.0, -23.0, 10.0, 10.0, 65.0, 32.0, -23.0, 15.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.220749657539512, "mean_inference_ms": 22.797655487383494, "mean_action_processing_ms": 0.08180108579470254, "mean_env_wait_ms": 0.03820835004448054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048580169677734375, "StateBufferConnector_ms": 0.004600048065185547, "ViewRequirementAgentConnector_ms": 0.09997916221618652}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 18.24, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 54.0, 43.0, 65.0, 43.0, 32.0, 32.0, 65.0, 65.0, 54.0, 32.0, 32.0, 21.0, -12.0, -1.0, 21.0, -34.0, 43.0, 10.0, 43.0, 21.0, 21.0, -12.0, 21.0, -34.0, 43.0, -18.0, 43.0, -12.0, 32.0, 10.0, 10.0, -1.0, 10.0, -12.0, -45.0, -12.0, 32.0, 54.0, 54.0, -23.0, -78.0, 43.0, 32.0, -12.0, 43.0, 10.0, 65.0, 54.0, 43.0, -1.0, 32.0, 76.0, 32.0, 32.0, 10.0, 76.0, -1.0, 10.0, 21.0, 10.0, -1.0, -34.0, 10.0, 10.0, 43.0, 65.0, 43.0, 65.0, 32.0, 32.0, 43.0, 65.0, 65.0, 54.0, 32.0, -34.0, 21.0, 21.0, 21.0, -23.0, -23.0, -67.0, -45.0, -45.0, 21.0, 21.0, -23.0, -1.0, -45.0, 21.0, -12.0, -23.0, 10.0, 10.0, 65.0, 32.0, -23.0, 15.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.220749657539512, "mean_inference_ms": 22.797655487383494, "mean_action_processing_ms": 0.08180108579470254, "mean_env_wait_ms": 0.03820835004448054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048580169677734375, "StateBufferConnector_ms": 0.004600048065185547, "ViewRequirementAgentConnector_ms": 0.09997916221618652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 161836.104, "sample_time_ms": 86428.956, "learn_time_ms": 75396.885, "learn_throughput": 53.053, "synch_weights_time_ms": 9.386}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 4736, "training_iteration": 90, "trial_id": "38794_00007", "date": "2023-06-02_09-07-29", "timestamp": 1685686049, "time_this_iter_s": 178.1334571838379, "time_total_s": 16902.455885887146, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16902.455885887146, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 16.51890756302521, "ram_util_percent": 53.048739495798316}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -78.0, "episode_reward_mean": 1.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 43.0, -23.0, 21.0, 43.0, 21.0, -78.0, 32.0, -45.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20410036523960473, "mean_inference_ms": 22.63042978187543, "mean_action_processing_ms": 0.07987417460256663, "mean_env_wait_ms": 0.03773874707075199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004122257232666016, "StateBufferConnector_ms": 0.005092620849609375, "ViewRequirementAgentConnector_ms": 0.09786605834960938}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 5.713593482971191, "policy_loss": -0.006698297336697578, "vf_loss": 5.70479679107666, "vf_explained_var": -0.0963842049241066, "kl": 0.008061237633228302, "entropy": 2.8608791828155518, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92460.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 15.92, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 32.0, 32.0, 10.0, 76.0, -1.0, 10.0, 21.0, 10.0, -1.0, -34.0, 10.0, 10.0, 43.0, 65.0, 43.0, 65.0, 32.0, 32.0, 43.0, 65.0, 65.0, 54.0, 32.0, -34.0, 21.0, 21.0, 21.0, -23.0, -23.0, -67.0, -45.0, -45.0, 21.0, 21.0, -23.0, -1.0, -45.0, 21.0, -12.0, -23.0, 10.0, 10.0, 65.0, 32.0, -23.0, 15.0, 43.0, 43.0, 54.0, 10.0, -56.0, 43.0, 21.0, 10.0, -34.0, 32.0, 65.0, 65.0, -29.0, -1.0, -45.0, -12.0, -34.0, 54.0, 54.0, 43.0, 43.0, 65.0, 76.0, 21.0, 32.0, 32.0, 65.0, 43.0, -12.0, 37.0, -45.0, 43.0, 32.0, -12.0, 48.0, -12.0, -45.0, -12.0, -12.0, -12.0, 32.0, 21.0, 43.0, 10.0, 43.0, -1.0, 10.0, -1.0, -34.0, 10.0, -23.0, 21.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2206082285484816, "mean_inference_ms": 22.78077191778094, "mean_action_processing_ms": 0.08174088365589442, "mean_env_wait_ms": 0.03817963967970768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048828125, "StateBufferConnector_ms": 0.0045964717864990234, "ViewRequirementAgentConnector_ms": 0.09983587265014648}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 15.92, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 32.0, 32.0, 10.0, 76.0, -1.0, 10.0, 21.0, 10.0, -1.0, -34.0, 10.0, 10.0, 43.0, 65.0, 43.0, 65.0, 32.0, 32.0, 43.0, 65.0, 65.0, 54.0, 32.0, -34.0, 21.0, 21.0, 21.0, -23.0, -23.0, -67.0, -45.0, -45.0, 21.0, 21.0, -23.0, -1.0, -45.0, 21.0, -12.0, -23.0, 10.0, 10.0, 65.0, 32.0, -23.0, 15.0, 43.0, 43.0, 54.0, 10.0, -56.0, 43.0, 21.0, 10.0, -34.0, 32.0, 65.0, 65.0, -29.0, -1.0, -45.0, -12.0, -34.0, 54.0, 54.0, 43.0, 43.0, 65.0, 76.0, 21.0, 32.0, 32.0, 65.0, 43.0, -12.0, 37.0, -45.0, 43.0, 32.0, -12.0, 48.0, -12.0, -45.0, -12.0, -12.0, -12.0, 32.0, 21.0, 43.0, 10.0, 43.0, -1.0, 10.0, -1.0, -34.0, 10.0, -23.0, 21.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2206082285484816, "mean_inference_ms": 22.78077191778094, "mean_action_processing_ms": 0.08174088365589442, "mean_env_wait_ms": 0.03817963967970768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048828125, "StateBufferConnector_ms": 0.0045964717864990234, "ViewRequirementAgentConnector_ms": 0.09983587265014648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 161892.287, "sample_time_ms": 86416.653, "learn_time_ms": 75465.422, "learn_throughput": 53.004, "synch_weights_time_ms": 9.384}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 4789, "training_iteration": 91, "trial_id": "38794_00007", "date": "2023-06-02_09-10-27", "timestamp": 1685686227, "time_this_iter_s": 178.15750885009766, "time_total_s": 17080.613394737244, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17080.613394737244, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 16.364705882352943, "ram_util_percent": 53.09747899159664}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -111.0, "episode_reward_mean": -28.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -78.0, -111.0, -78.0, -89.0, 10.0, 21.0, -1.0, -45.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20395602100516505, "mean_inference_ms": 22.61412602840607, "mean_action_processing_ms": 0.07981979946350828, "mean_env_wait_ms": 0.037711067072588644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004260540008544922, "StateBufferConnector_ms": 0.005130767822265625, "ViewRequirementAgentConnector_ms": 0.09708166122436523}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 6.133581161499023, "policy_loss": -0.01628061570227146, "vf_loss": 6.134376525878906, "vf_explained_var": -0.044212549924850464, "kl": 0.008056134916841984, "entropy": 2.8589651584625244, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93480.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 12.57, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 10.0, -34.0, 32.0, 65.0, 65.0, -29.0, -1.0, -45.0, -12.0, -34.0, 54.0, 54.0, 43.0, 43.0, 65.0, 76.0, 21.0, 32.0, 32.0, 65.0, 43.0, -12.0, 37.0, -45.0, 43.0, 32.0, -12.0, 48.0, -12.0, -45.0, -12.0, -12.0, -12.0, 32.0, 21.0, 43.0, 10.0, 43.0, -1.0, 10.0, -1.0, -34.0, 10.0, -23.0, 21.0, 76.0, 43.0, 54.0, 54.0, 10.0, 54.0, 76.0, 43.0, 32.0, 10.0, 32.0, 32.0, 32.0, -23.0, 10.0, 43.0, -34.0, 21.0, 32.0, -12.0, -12.0, 32.0, 32.0, 10.0, -12.0, -34.0, 65.0, -12.0, 21.0, 10.0, -12.0, 54.0, 21.0, -1.0, 32.0, -78.0, 54.0, 43.0, 10.0, 10.0, -34.0, -34.0, -89.0, 10.0, -23.0, -12.0, -34.0, 10.0, -56.0, -23.0, -34.0, -1.0, 43.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2204674560580447, "mean_inference_ms": 22.763286916799466, "mean_action_processing_ms": 0.08168182153753724, "mean_env_wait_ms": 0.03815074588274059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004828214645385742, "StateBufferConnector_ms": 0.004583597183227539, "ViewRequirementAgentConnector_ms": 0.09913849830627441}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 12.57, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 10.0, -34.0, 32.0, 65.0, 65.0, -29.0, -1.0, -45.0, -12.0, -34.0, 54.0, 54.0, 43.0, 43.0, 65.0, 76.0, 21.0, 32.0, 32.0, 65.0, 43.0, -12.0, 37.0, -45.0, 43.0, 32.0, -12.0, 48.0, -12.0, -45.0, -12.0, -12.0, -12.0, 32.0, 21.0, 43.0, 10.0, 43.0, -1.0, 10.0, -1.0, -34.0, 10.0, -23.0, 21.0, 76.0, 43.0, 54.0, 54.0, 10.0, 54.0, 76.0, 43.0, 32.0, 10.0, 32.0, 32.0, 32.0, -23.0, 10.0, 43.0, -34.0, 21.0, 32.0, -12.0, -12.0, 32.0, 32.0, 10.0, -12.0, -34.0, 65.0, -12.0, 21.0, 10.0, -12.0, 54.0, 21.0, -1.0, 32.0, -78.0, 54.0, 43.0, 10.0, 10.0, -34.0, -34.0, -89.0, 10.0, -23.0, -12.0, -34.0, 10.0, -56.0, -23.0, -34.0, -1.0, 43.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2204674560580447, "mean_inference_ms": 22.763286916799466, "mean_action_processing_ms": 0.08168182153753724, "mean_env_wait_ms": 0.03815074588274059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004828214645385742, "StateBufferConnector_ms": 0.004583597183227539, "ViewRequirementAgentConnector_ms": 0.09913849830627441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 161902.828, "sample_time_ms": 86412.576, "learn_time_ms": 75479.932, "learn_throughput": 52.994, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 4842, "training_iteration": 92, "trial_id": "38794_00007", "date": "2023-06-02_09-13-24", "timestamp": 1685686404, "time_this_iter_s": 177.49423694610596, "time_total_s": 17258.10763168335, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17258.10763168335, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.153164556962025, "ram_util_percent": 53.18987341772152}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -23.0, "episode_reward_mean": 15.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -23.0, 10.0, 21.0, -1.0, 65.0, 21.0, 32.0, 21.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20384838436005434, "mean_inference_ms": 22.596613346600215, "mean_action_processing_ms": 0.07977666255919465, "mean_env_wait_ms": 0.0376903103897661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043010711669921875, "StateBufferConnector_ms": 0.005130767822265625, "ViewRequirementAgentConnector_ms": 0.09859561920166016}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 4.926106929779053, "policy_loss": -0.038428887724876404, "vf_loss": 4.948009490966797, "vf_explained_var": -0.0066963364370167255, "kl": 0.008597634732723236, "entropy": 2.855858087539673, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 94500.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 18.12, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 43.0, 32.0, 10.0, 32.0, 32.0, 32.0, -23.0, 10.0, 43.0, -34.0, 21.0, 32.0, -12.0, -12.0, 32.0, 32.0, 10.0, -12.0, -34.0, 65.0, -12.0, 21.0, 10.0, -12.0, 54.0, 21.0, -1.0, 32.0, -78.0, 54.0, 43.0, 10.0, 10.0, -34.0, -34.0, -89.0, 10.0, -23.0, -12.0, -34.0, 10.0, -56.0, -23.0, -34.0, -1.0, 43.0, 21.0, 65.0, -45.0, -56.0, 21.0, 10.0, 32.0, 21.0, 54.0, 21.0, 65.0, 32.0, 70.0, 76.0, 76.0, 76.0, 76.0, 76.0, 54.0, 10.0, 10.0, -1.0, 65.0, -23.0, 21.0, 54.0, 32.0, -1.0, 32.0, 21.0, 43.0, 32.0, 10.0, -23.0, 43.0, 54.0, 43.0, -23.0, -1.0, 43.0, 37.0, -12.0, 21.0, -23.0, -12.0, 59.0, 10.0, 65.0, 48.0, 76.0, 65.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2203302546333892, "mean_inference_ms": 22.74681827150419, "mean_action_processing_ms": 0.0816223222443366, "mean_env_wait_ms": 0.038122584801890916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047724246978759766, "StateBufferConnector_ms": 0.0045735836029052734, "ViewRequirementAgentConnector_ms": 0.09911417961120605}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 18.12, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 43.0, 32.0, 10.0, 32.0, 32.0, 32.0, -23.0, 10.0, 43.0, -34.0, 21.0, 32.0, -12.0, -12.0, 32.0, 32.0, 10.0, -12.0, -34.0, 65.0, -12.0, 21.0, 10.0, -12.0, 54.0, 21.0, -1.0, 32.0, -78.0, 54.0, 43.0, 10.0, 10.0, -34.0, -34.0, -89.0, 10.0, -23.0, -12.0, -34.0, 10.0, -56.0, -23.0, -34.0, -1.0, 43.0, 21.0, 65.0, -45.0, -56.0, 21.0, 10.0, 32.0, 21.0, 54.0, 21.0, 65.0, 32.0, 70.0, 76.0, 76.0, 76.0, 76.0, 76.0, 54.0, 10.0, 10.0, -1.0, 65.0, -23.0, 21.0, 54.0, 32.0, -1.0, 32.0, 21.0, 43.0, 32.0, 10.0, -23.0, 43.0, 54.0, 43.0, -23.0, -1.0, 43.0, 37.0, -12.0, 21.0, -23.0, -12.0, 59.0, 10.0, 65.0, 48.0, 76.0, 65.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2203302546333892, "mean_inference_ms": 22.74681827150419, "mean_action_processing_ms": 0.0816223222443366, "mean_env_wait_ms": 0.038122584801890916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047724246978759766, "StateBufferConnector_ms": 0.0045735836029052734, "ViewRequirementAgentConnector_ms": 0.09911417961120605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 161972.479, "sample_time_ms": 86421.293, "learn_time_ms": 75540.839, "learn_throughput": 52.951, "synch_weights_time_ms": 9.545}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 4894, "training_iteration": 93, "trial_id": "38794_00007", "date": "2023-06-02_09-16-23", "timestamp": 1685686583, "time_this_iter_s": 178.46031785011292, "time_total_s": 17436.567949533463, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17436.567949533463, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 16.22510460251046, "ram_util_percent": 53.167782426778246}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -89.0, "episode_reward_mean": 4.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 32.0, -12.0, 32.0, 54.0, -1.0, -89.0, 21.0, 65.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2037071220231459, "mean_inference_ms": 22.58178083168543, "mean_action_processing_ms": 0.07972074391648624, "mean_env_wait_ms": 0.03766009362426968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004000663757324219, "StateBufferConnector_ms": 0.005147457122802734, "ViewRequirementAgentConnector_ms": 0.09787321090698242}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 5.802137851715088, "policy_loss": -0.015066529624164104, "vf_loss": 5.800690174102783, "vf_explained_var": -0.17364917695522308, "kl": 0.008591791614890099, "entropy": 2.8457083702087402, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 23.51, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, 54.0, 21.0, 65.0, 32.0, 70.0, 76.0, 76.0, 76.0, 76.0, 76.0, 54.0, 10.0, 10.0, -1.0, 65.0, -23.0, 21.0, 54.0, 32.0, -1.0, 32.0, 21.0, 43.0, 32.0, 10.0, -23.0, 43.0, 54.0, 43.0, -23.0, -1.0, 43.0, 37.0, -12.0, 21.0, -23.0, -12.0, 59.0, 10.0, 65.0, 48.0, 76.0, 65.0, 32.0, 10.0, 21.0, -1.0, 54.0, 54.0, -1.0, 32.0, -56.0, -12.0, 10.0, 43.0, 32.0, 54.0, 43.0, -12.0, -45.0, -34.0, -1.0, -23.0, -133.0, 54.0, 43.0, 65.0, -1.0, -12.0, 65.0, 54.0, 21.0, 54.0, -1.0, 65.0, 21.0, 65.0, 21.0, 43.0, 54.0, -12.0, 32.0, -12.0, -23.0, -1.0, -12.0, 65.0, 10.0, 32.0, -45.0, 21.0, -1.0, 54.0, 32.0, -67.0, 21.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22019166692724088, "mean_inference_ms": 22.73127941979415, "mean_action_processing_ms": 0.08156383912528678, "mean_env_wait_ms": 0.03809413016856414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048258304595947266, "StateBufferConnector_ms": 0.0045833587646484375, "ViewRequirementAgentConnector_ms": 0.09931349754333496}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 23.51, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 21.0, 54.0, 21.0, 65.0, 32.0, 70.0, 76.0, 76.0, 76.0, 76.0, 76.0, 54.0, 10.0, 10.0, -1.0, 65.0, -23.0, 21.0, 54.0, 32.0, -1.0, 32.0, 21.0, 43.0, 32.0, 10.0, -23.0, 43.0, 54.0, 43.0, -23.0, -1.0, 43.0, 37.0, -12.0, 21.0, -23.0, -12.0, 59.0, 10.0, 65.0, 48.0, 76.0, 65.0, 32.0, 10.0, 21.0, -1.0, 54.0, 54.0, -1.0, 32.0, -56.0, -12.0, 10.0, 43.0, 32.0, 54.0, 43.0, -12.0, -45.0, -34.0, -1.0, -23.0, -133.0, 54.0, 43.0, 65.0, -1.0, -12.0, 65.0, 54.0, 21.0, 54.0, -1.0, 65.0, 21.0, 65.0, 21.0, 43.0, 54.0, -12.0, 32.0, -12.0, -23.0, -1.0, -12.0, 65.0, 10.0, 32.0, -45.0, 21.0, -1.0, 54.0, 32.0, -67.0, 21.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22019166692724088, "mean_inference_ms": 22.73127941979415, "mean_action_processing_ms": 0.08156383912528678, "mean_env_wait_ms": 0.03809413016856414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048258304595947266, "StateBufferConnector_ms": 0.0045833587646484375, "ViewRequirementAgentConnector_ms": 0.09931349754333496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 161995.182, "sample_time_ms": 86422.395, "learn_time_ms": 75562.392, "learn_throughput": 52.936, "synch_weights_time_ms": 9.594}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 4947, "training_iteration": 94, "trial_id": "38794_00007", "date": "2023-06-02_09-19-21", "timestamp": 1685686761, "time_this_iter_s": 178.39099979400635, "time_total_s": 17614.95894932747, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17614.95894932747, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 16.124369747899156, "ram_util_percent": 53.20042016806723}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 17.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 43.0, 21.0, 21.0, 65.0, 10.0, -12.0, 21.0, 10.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20356762169969392, "mean_inference_ms": 22.566448590281308, "mean_action_processing_ms": 0.07966604211786407, "mean_env_wait_ms": 0.03763203198169318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037384033203125, "StateBufferConnector_ms": 0.005137920379638672, "ViewRequirementAgentConnector_ms": 0.09813785552978516}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 5.095643997192383, "policy_loss": -0.012441528029739857, "vf_loss": 5.089305400848389, "vf_explained_var": 0.0904361829161644, "kl": 0.009770558215677738, "entropy": 2.847113847732544, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 96540.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 22.21, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -12.0, 10.0, 43.0, 32.0, 54.0, 43.0, -12.0, -45.0, -34.0, -1.0, -23.0, -133.0, 54.0, 43.0, 65.0, -1.0, -12.0, 65.0, 54.0, 21.0, 54.0, -1.0, 65.0, 21.0, 65.0, 21.0, 43.0, 54.0, -12.0, 32.0, -12.0, -23.0, -1.0, -12.0, 65.0, 10.0, 32.0, -45.0, 21.0, -1.0, 54.0, 32.0, -67.0, 21.0, 21.0, 54.0, 76.0, 76.0, 21.0, 32.0, 32.0, 21.0, 43.0, 32.0, -23.0, -45.0, -23.0, -67.0, 43.0, 32.0, -34.0, -23.0, -1.0, 43.0, 32.0, 43.0, 76.0, 43.0, 76.0, 76.0, 43.0, -23.0, -34.0, 21.0, -1.0, 43.0, 21.0, 43.0, 65.0, 65.0, 21.0, 43.0, 21.0, 21.0, 54.0, 54.0, 54.0, 43.0, 65.0, 10.0, 21.0, 43.0, 76.0, 21.0, 21.0, 21.0, 65.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22004080511742596, "mean_inference_ms": 22.716090936303907, "mean_action_processing_ms": 0.08151011594146221, "mean_env_wait_ms": 0.03806630389297247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004845619201660156, "StateBufferConnector_ms": 0.004580020904541016, "ViewRequirementAgentConnector_ms": 0.09923410415649414}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 22.21, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -12.0, 10.0, 43.0, 32.0, 54.0, 43.0, -12.0, -45.0, -34.0, -1.0, -23.0, -133.0, 54.0, 43.0, 65.0, -1.0, -12.0, 65.0, 54.0, 21.0, 54.0, -1.0, 65.0, 21.0, 65.0, 21.0, 43.0, 54.0, -12.0, 32.0, -12.0, -23.0, -1.0, -12.0, 65.0, 10.0, 32.0, -45.0, 21.0, -1.0, 54.0, 32.0, -67.0, 21.0, 21.0, 54.0, 76.0, 76.0, 21.0, 32.0, 32.0, 21.0, 43.0, 32.0, -23.0, -45.0, -23.0, -67.0, 43.0, 32.0, -34.0, -23.0, -1.0, 43.0, 32.0, 43.0, 76.0, 43.0, 76.0, 76.0, 43.0, -23.0, -34.0, 21.0, -1.0, 43.0, 21.0, 43.0, 65.0, 65.0, 21.0, 43.0, 21.0, 21.0, 54.0, 54.0, 54.0, 43.0, 65.0, 10.0, 21.0, 43.0, 76.0, 21.0, 21.0, 21.0, 65.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22004080511742596, "mean_inference_ms": 22.716090936303907, "mean_action_processing_ms": 0.08151011594146221, "mean_env_wait_ms": 0.03806630389297247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004845619201660156, "StateBufferConnector_ms": 0.004580020904541016, "ViewRequirementAgentConnector_ms": 0.09923410415649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 161826.278, "sample_time_ms": 86430.806, "learn_time_ms": 75385.051, "learn_throughput": 53.061, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 5000, "training_iteration": 95, "trial_id": "38794_00007", "date": "2023-06-02_09-22-19", "timestamp": 1685686939, "time_this_iter_s": 178.39383029937744, "time_total_s": 17793.352779626846, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17793.352779626846, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 16.3890756302521, "ram_util_percent": 53.2857142857143}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 15.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -45.0, -56.0, 76.0, 54.0, 32.0, 43.0, -12.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20343322679140044, "mean_inference_ms": 22.551154304764033, "mean_action_processing_ms": 0.07960689533332092, "mean_env_wait_ms": 0.03760702210271556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041294097900390625, "StateBufferConnector_ms": 0.0050067901611328125, "ViewRequirementAgentConnector_ms": 0.09824275970458984}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 6.743680000305176, "policy_loss": -0.0015368032036349177, "vf_loss": 6.73028039932251, "vf_explained_var": -0.18212303519248962, "kl": 0.00777024682611227, "entropy": 2.8715298175811768, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 97560.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 9.34, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 32.0, -23.0, -45.0, -23.0, -67.0, 43.0, 32.0, -34.0, -23.0, -1.0, 43.0, 32.0, 43.0, 76.0, 43.0, 76.0, 76.0, 43.0, -23.0, -34.0, 21.0, -1.0, 43.0, 21.0, 43.0, 65.0, 65.0, 21.0, 43.0, 21.0, 21.0, 54.0, 54.0, 54.0, 43.0, 65.0, 10.0, 21.0, 43.0, 76.0, 21.0, 21.0, 21.0, 65.0, 32.0, 65.0, 43.0, -12.0, -23.0, 21.0, -1.0, -23.0, 21.0, -45.0, -23.0, -78.0, -111.0, -45.0, -34.0, -23.0, -144.0, -1.0, 43.0, 43.0, -122.0, -12.0, -23.0, 43.0, 54.0, 10.0, 21.0, 10.0, 32.0, 10.0, 65.0, 32.0, 54.0, 10.0, 21.0, -1.0, -1.0, -23.0, -45.0, -12.0, 43.0, 65.0, 32.0, 10.0, -56.0, 10.0, -122.0, -1.0, -45.0, -78.0, -12.0, 32.0, -34.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21989831664451212, "mean_inference_ms": 22.701095180745327, "mean_action_processing_ms": 0.08145891546523273, "mean_env_wait_ms": 0.038039337937746755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004883527755737305, "StateBufferConnector_ms": 0.00458979606628418, "ViewRequirementAgentConnector_ms": 0.0996239185333252}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 9.34, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 32.0, -23.0, -45.0, -23.0, -67.0, 43.0, 32.0, -34.0, -23.0, -1.0, 43.0, 32.0, 43.0, 76.0, 43.0, 76.0, 76.0, 43.0, -23.0, -34.0, 21.0, -1.0, 43.0, 21.0, 43.0, 65.0, 65.0, 21.0, 43.0, 21.0, 21.0, 54.0, 54.0, 54.0, 43.0, 65.0, 10.0, 21.0, 43.0, 76.0, 21.0, 21.0, 21.0, 65.0, 32.0, 65.0, 43.0, -12.0, -23.0, 21.0, -1.0, -23.0, 21.0, -45.0, -23.0, -78.0, -111.0, -45.0, -34.0, -23.0, -144.0, -1.0, 43.0, 43.0, -122.0, -12.0, -23.0, 43.0, 54.0, 10.0, 21.0, 10.0, 32.0, 10.0, 65.0, 32.0, 54.0, 10.0, 21.0, -1.0, -1.0, -23.0, -45.0, -12.0, 43.0, 65.0, 32.0, 10.0, -56.0, 10.0, -122.0, -1.0, -45.0, -78.0, -12.0, 32.0, -34.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21989831664451212, "mean_inference_ms": 22.701095180745327, "mean_action_processing_ms": 0.08145891546523273, "mean_env_wait_ms": 0.038039337937746755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004883527755737305, "StateBufferConnector_ms": 0.00458979606628418, "ViewRequirementAgentConnector_ms": 0.0996239185333252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 161778.08, "sample_time_ms": 86412.027, "learn_time_ms": 75355.655, "learn_throughput": 53.082, "synch_weights_time_ms": 9.566}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 5052, "training_iteration": 96, "trial_id": "38794_00007", "date": "2023-06-02_09-25-17", "timestamp": 1685687117, "time_this_iter_s": 177.7759871482849, "time_total_s": 17971.12876677513, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17971.12876677513, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 16.61814345991561, "ram_util_percent": 53.32573839662447}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -12.0, "episode_reward_mean": 38.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, 76.0, 65.0, 10.0, 43.0, 43.0, -12.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20330162874708385, "mean_inference_ms": 22.536452129195997, "mean_action_processing_ms": 0.07955242850417914, "mean_env_wait_ms": 0.03758541590528301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003898143768310547, "StateBufferConnector_ms": 0.00507354736328125, "ViewRequirementAgentConnector_ms": 0.09721994400024414}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 5.63495397567749, "policy_loss": -0.03549089655280113, "vf_loss": 5.653134822845459, "vf_explained_var": -0.1533452719449997, "kl": 0.009005255065858364, "entropy": 2.8790385723114014, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98580.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 9.28, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, -45.0, -23.0, -78.0, -111.0, -45.0, -34.0, -23.0, -144.0, -1.0, 43.0, 43.0, -122.0, -12.0, -23.0, 43.0, 54.0, 10.0, 21.0, 10.0, 32.0, 10.0, 65.0, 32.0, 54.0, 10.0, 21.0, -1.0, -1.0, -23.0, -45.0, -12.0, 43.0, 65.0, 32.0, 10.0, -56.0, 10.0, -122.0, -1.0, -45.0, -78.0, -12.0, 32.0, -34.0, 21.0, 65.0, 21.0, 32.0, 65.0, 48.0, 54.0, 65.0, -12.0, -1.0, 43.0, 43.0, 10.0, 65.0, 54.0, 54.0, 65.0, 10.0, 43.0, 10.0, -12.0, 21.0, -45.0, 21.0, 54.0, 21.0, 43.0, 21.0, -56.0, -12.0, 54.0, -34.0, 21.0, 65.0, 43.0, -1.0, 21.0, 10.0, -1.0, 32.0, 54.0, 76.0, 43.0, 32.0, 21.0, 10.0, 21.0, -34.0, -23.0, 32.0, 21.0, -12.0, 76.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2197754866866572, "mean_inference_ms": 22.68663707717687, "mean_action_processing_ms": 0.08140798577700731, "mean_env_wait_ms": 0.03801409734093165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004946708679199219, "StateBufferConnector_ms": 0.0045680999755859375, "ViewRequirementAgentConnector_ms": 0.0999300479888916}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 9.28, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, -45.0, -23.0, -78.0, -111.0, -45.0, -34.0, -23.0, -144.0, -1.0, 43.0, 43.0, -122.0, -12.0, -23.0, 43.0, 54.0, 10.0, 21.0, 10.0, 32.0, 10.0, 65.0, 32.0, 54.0, 10.0, 21.0, -1.0, -1.0, -23.0, -45.0, -12.0, 43.0, 65.0, 32.0, 10.0, -56.0, 10.0, -122.0, -1.0, -45.0, -78.0, -12.0, 32.0, -34.0, 21.0, 65.0, 21.0, 32.0, 65.0, 48.0, 54.0, 65.0, -12.0, -1.0, 43.0, 43.0, 10.0, 65.0, 54.0, 54.0, 65.0, 10.0, 43.0, 10.0, -12.0, 21.0, -45.0, 21.0, 54.0, 21.0, 43.0, 21.0, -56.0, -12.0, 54.0, -34.0, 21.0, 65.0, 43.0, -1.0, 21.0, 10.0, -1.0, 32.0, 54.0, 76.0, 43.0, 32.0, 21.0, 10.0, 21.0, -34.0, -23.0, 32.0, 21.0, -12.0, 76.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2197754866866572, "mean_inference_ms": 22.68663707717687, "mean_action_processing_ms": 0.08140798577700731, "mean_env_wait_ms": 0.03801409734093165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004946708679199219, "StateBufferConnector_ms": 0.0045680999755859375, "ViewRequirementAgentConnector_ms": 0.0999300479888916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 161807.114, "sample_time_ms": 86434.671, "learn_time_ms": 75361.917, "learn_throughput": 53.077, "synch_weights_time_ms": 9.65}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 5105, "training_iteration": 97, "trial_id": "38794_00007", "date": "2023-06-02_09-28-16", "timestamp": 1685687296, "time_this_iter_s": 178.40691614151, "time_total_s": 18149.53568291664, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18149.53568291664, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 16.76344537815126, "ram_util_percent": 53.49159663865547}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 21.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 65.0, 32.0, 76.0, 10.0, 65.0, 21.0, -12.0, -67.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20317579576634665, "mean_inference_ms": 22.52237398987005, "mean_action_processing_ms": 0.07949812891365474, "mean_env_wait_ms": 0.03756016288375552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003883838653564453, "StateBufferConnector_ms": 0.005018711090087891, "ViewRequirementAgentConnector_ms": 0.0976705551147461}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 6.112925052642822, "policy_loss": -0.026840150356292725, "vf_loss": 6.1228179931640625, "vf_explained_var": -0.14093919098377228, "kl": 0.00881645455956459, "entropy": 2.872244119644165, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99600.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 10.44, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 65.0, -12.0, -1.0, 43.0, 43.0, 10.0, 65.0, 54.0, 54.0, 65.0, 10.0, 43.0, 10.0, -12.0, 21.0, -45.0, 21.0, 54.0, 21.0, 43.0, 21.0, -56.0, -12.0, 54.0, -34.0, 21.0, 65.0, 43.0, -1.0, 21.0, 10.0, -1.0, 32.0, 54.0, 76.0, 43.0, 32.0, 21.0, 10.0, 21.0, -34.0, -23.0, 32.0, 21.0, -12.0, 76.0, 43.0, 76.0, 76.0, 65.0, 43.0, 21.0, 10.0, 10.0, 10.0, -45.0, 43.0, 43.0, 21.0, 43.0, -1.0, 43.0, 32.0, 54.0, 21.0, 54.0, 43.0, 65.0, 43.0, 21.0, -1.0, 43.0, -67.0, -12.0, -1.0, 32.0, 10.0, -23.0, -56.0, -12.0, -12.0, -1.0, -133.0, -111.0, -56.0, -100.0, -45.0, -34.0, 43.0, 21.0, -45.0, -67.0, -56.0, -45.0, 21.0, -67.0, -89.0, 10.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21965886442773805, "mean_inference_ms": 22.67308442109416, "mean_action_processing_ms": 0.08135776540008594, "mean_env_wait_ms": 0.03799090374618255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049021244049072266, "StateBufferConnector_ms": 0.004591226577758789, "ViewRequirementAgentConnector_ms": 0.09964728355407715}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 10.44, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 65.0, -12.0, -1.0, 43.0, 43.0, 10.0, 65.0, 54.0, 54.0, 65.0, 10.0, 43.0, 10.0, -12.0, 21.0, -45.0, 21.0, 54.0, 21.0, 43.0, 21.0, -56.0, -12.0, 54.0, -34.0, 21.0, 65.0, 43.0, -1.0, 21.0, 10.0, -1.0, 32.0, 54.0, 76.0, 43.0, 32.0, 21.0, 10.0, 21.0, -34.0, -23.0, 32.0, 21.0, -12.0, 76.0, 43.0, 76.0, 76.0, 65.0, 43.0, 21.0, 10.0, 10.0, 10.0, -45.0, 43.0, 43.0, 21.0, 43.0, -1.0, 43.0, 32.0, 54.0, 21.0, 54.0, 43.0, 65.0, 43.0, 21.0, -1.0, 43.0, -67.0, -12.0, -1.0, 32.0, 10.0, -23.0, -56.0, -12.0, -12.0, -1.0, -133.0, -111.0, -56.0, -100.0, -45.0, -34.0, 43.0, 21.0, -45.0, -67.0, -56.0, -45.0, 21.0, -67.0, -89.0, 10.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21965886442773805, "mean_inference_ms": 22.67308442109416, "mean_action_processing_ms": 0.08135776540008594, "mean_env_wait_ms": 0.03799090374618255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049021244049072266, "StateBufferConnector_ms": 0.004591226577758789, "ViewRequirementAgentConnector_ms": 0.09964728355407715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 161822.83, "sample_time_ms": 86482.479, "learn_time_ms": 75329.787, "learn_throughput": 53.1, "synch_weights_time_ms": 9.723}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 5157, "training_iteration": 98, "trial_id": "38794_00007", "date": "2023-06-02_09-31-14", "timestamp": 1685687474, "time_this_iter_s": 178.01603603363037, "time_total_s": 18327.55171895027, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18327.55171895027, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 16.340336134453782, "ram_util_percent": 53.59201680672268}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 10.0, -45.0, -12.0, 21.0, 21.0, -12.0, 32.0, 54.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20304364505702469, "mean_inference_ms": 22.508440385780126, "mean_action_processing_ms": 0.07944808866470662, "mean_env_wait_ms": 0.037537514549479775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.005092620849609375, "ViewRequirementAgentConnector_ms": 0.09798288345336914}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 6.0986328125, "policy_loss": -0.03558703884482384, "vf_loss": 6.119034290313721, "vf_explained_var": -0.10523081570863724, "kl": 0.007900352589786053, "entropy": 2.8824856281280518, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 100620.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -0.57, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, -45.0, 43.0, 43.0, 21.0, 43.0, -1.0, 43.0, 32.0, 54.0, 21.0, 54.0, 43.0, 65.0, 43.0, 21.0, -1.0, 43.0, -67.0, -12.0, -1.0, 32.0, 10.0, -23.0, -56.0, -12.0, -12.0, -1.0, -133.0, -111.0, -56.0, -100.0, -45.0, -34.0, 43.0, 21.0, -45.0, -67.0, -56.0, -45.0, 21.0, -67.0, -89.0, 10.0, -23.0, 21.0, -34.0, -56.0, -133.0, -128.0, -34.0, -12.0, 10.0, 43.0, -122.0, -1.0, -34.0, 43.0, 65.0, -12.0, -34.0, -1.0, -1.0, -23.0, 21.0, 43.0, 32.0, 54.0, 76.0, 32.0, -1.0, -34.0, 43.0, 54.0, -23.0, 32.0, 10.0, 54.0, 32.0, -34.0, -23.0, 43.0, 43.0, 21.0, 43.0, 15.0, -23.0, -1.0, 65.0, 32.0, 65.0, 32.0, -1.0, -1.0, 32.0, 43.0, 32.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21953543389584643, "mean_inference_ms": 22.65903765678572, "mean_action_processing_ms": 0.08130516560848657, "mean_env_wait_ms": 0.03796668214725778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004866838455200195, "StateBufferConnector_ms": 0.004645586013793945, "ViewRequirementAgentConnector_ms": 0.0995025634765625}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -0.57, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 10.0, -45.0, 43.0, 43.0, 21.0, 43.0, -1.0, 43.0, 32.0, 54.0, 21.0, 54.0, 43.0, 65.0, 43.0, 21.0, -1.0, 43.0, -67.0, -12.0, -1.0, 32.0, 10.0, -23.0, -56.0, -12.0, -12.0, -1.0, -133.0, -111.0, -56.0, -100.0, -45.0, -34.0, 43.0, 21.0, -45.0, -67.0, -56.0, -45.0, 21.0, -67.0, -89.0, 10.0, -23.0, 21.0, -34.0, -56.0, -133.0, -128.0, -34.0, -12.0, 10.0, 43.0, -122.0, -1.0, -34.0, 43.0, 65.0, -12.0, -34.0, -1.0, -1.0, -23.0, 21.0, 43.0, 32.0, 54.0, 76.0, 32.0, -1.0, -34.0, 43.0, 54.0, -23.0, 32.0, 10.0, 54.0, 32.0, -34.0, -23.0, 43.0, 43.0, 21.0, 43.0, 15.0, -23.0, -1.0, 65.0, 32.0, 65.0, 32.0, -1.0, -1.0, 32.0, 43.0, 32.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21953543389584643, "mean_inference_ms": 22.65903765678572, "mean_action_processing_ms": 0.08130516560848657, "mean_env_wait_ms": 0.03796668214725778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004866838455200195, "StateBufferConnector_ms": 0.004645586013793945, "ViewRequirementAgentConnector_ms": 0.0995025634765625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 161779.744, "sample_time_ms": 86453.381, "learn_time_ms": 75315.959, "learn_throughput": 53.11, "synch_weights_time_ms": 9.62}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 5210, "training_iteration": 99, "trial_id": "38794_00007", "date": "2023-06-02_09-34-12", "timestamp": 1685687652, "time_this_iter_s": 178.07895588874817, "time_total_s": 18505.63067483902, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18505.63067483902, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 16.67004219409283, "ram_util_percent": 53.68649789029537}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -23.0, "episode_reward_mean": 24.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 21.0, -23.0, 54.0, 43.0, 32.0, 21.0, 32.0, 21.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2029222810966865, "mean_inference_ms": 22.49482057560143, "mean_action_processing_ms": 0.07939737088833888, "mean_env_wait_ms": 0.037515002334355216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004010200500488281, "StateBufferConnector_ms": 0.005042552947998047, "ViewRequirementAgentConnector_ms": 0.09750843048095703}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9221680164337158, "cur_lr": 9.999999747378752e-05, "total_loss": 6.043278217315674, "policy_loss": -0.014599586836993694, "vf_loss": 6.037452697753906, "vf_explained_var": -0.12869438529014587, "kl": 0.010625842958688736, "entropy": 2.8380959033966064, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 101640.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 13.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, 43.0, -122.0, -1.0, -34.0, 43.0, 65.0, -12.0, -34.0, -1.0, -1.0, -23.0, 21.0, 43.0, 32.0, 54.0, 76.0, 32.0, -1.0, -34.0, 43.0, 54.0, -23.0, 32.0, 10.0, 54.0, 32.0, -34.0, -23.0, 43.0, 43.0, 21.0, 43.0, 15.0, -23.0, -1.0, 65.0, 32.0, 65.0, 32.0, -1.0, -1.0, 32.0, 43.0, 32.0, -56.0, 21.0, 32.0, 43.0, -23.0, 43.0, 43.0, 43.0, -12.0, -1.0, 21.0, 10.0, -12.0, -23.0, 10.0, 32.0, 65.0, -1.0, 32.0, -34.0, -1.0, 54.0, 21.0, 21.0, 32.0, 65.0, 76.0, 54.0, 54.0, -12.0, -34.0, 10.0, 54.0, -56.0, 32.0, 43.0, -56.0, -34.0, -45.0, -1.0, -1.0, -12.0, 10.0, 21.0, -23.0, -1.0, 65.0, -23.0, -1.0, 43.0, 43.0, 10.0, -34.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2194174297882762, "mean_inference_ms": 22.64560452908775, "mean_action_processing_ms": 0.08125324230056138, "mean_env_wait_ms": 0.037942001030900306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004895687103271484, "StateBufferConnector_ms": 0.0046117305755615234, "ViewRequirementAgentConnector_ms": 0.0994882583618164}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 13.9, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, 43.0, -122.0, -1.0, -34.0, 43.0, 65.0, -12.0, -34.0, -1.0, -1.0, -23.0, 21.0, 43.0, 32.0, 54.0, 76.0, 32.0, -1.0, -34.0, 43.0, 54.0, -23.0, 32.0, 10.0, 54.0, 32.0, -34.0, -23.0, 43.0, 43.0, 21.0, 43.0, 15.0, -23.0, -1.0, 65.0, 32.0, 65.0, 32.0, -1.0, -1.0, 32.0, 43.0, 32.0, -56.0, 21.0, 32.0, 43.0, -23.0, 43.0, 43.0, 43.0, -12.0, -1.0, 21.0, 10.0, -12.0, -23.0, 10.0, 32.0, 65.0, -1.0, 32.0, -34.0, -1.0, 54.0, 21.0, 21.0, 32.0, 65.0, 76.0, 54.0, 54.0, -12.0, -34.0, 10.0, 54.0, -56.0, 32.0, 43.0, -56.0, -34.0, -45.0, -1.0, -1.0, -12.0, 10.0, 21.0, -23.0, -1.0, 65.0, -23.0, -1.0, 43.0, 43.0, 10.0, -34.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2194174297882762, "mean_inference_ms": 22.64560452908775, "mean_action_processing_ms": 0.08125324230056138, "mean_env_wait_ms": 0.037942001030900306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004895687103271484, "StateBufferConnector_ms": 0.0046117305755615234, "ViewRequirementAgentConnector_ms": 0.0994882583618164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 161790.374, "sample_time_ms": 86466.817, "learn_time_ms": 75313.231, "learn_throughput": 53.112, "synch_weights_time_ms": 9.533}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "episodes_total": 5263, "training_iteration": 100, "trial_id": "38794_00007", "date": "2023-06-02_09-37-10", "timestamp": 1685687830, "time_this_iter_s": 178.24521613121033, "time_total_s": 18683.87589097023, "pid": 72342, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18683.87589097023, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.393697478991598, "ram_util_percent": 53.73445378151262}}
