{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -56.0, "episode_reward_mean": -14.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.0, -34.0, -56.0, -45.0, 21.0, 10.0, 32.0, -1.0, 10.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19535003291166406, "mean_inference_ms": 10.08208634505604, "mean_action_processing_ms": 0.0916542424165623, "mean_env_wait_ms": 0.04770439338433445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006086826324462891, "StateBufferConnector_ms": 0.0033712387084960938, "ViewRequirementAgentConnector_ms": 0.09795427322387695}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 8.095427513122559, "policy_loss": -0.011756356805562973, "vf_loss": 8.105764389038086, "vf_explained_var": 0.0006262094830162823, "kl": 0.007096732966601849, "entropy": 2.988705635070801, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 16.846153846153847, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -1.0, 32.0, -12.0, 43.0, -1.0, 32.0, -56.0, 10.0, -45.0, 10.0, -12.0, 32.0, 43.0, 21.0, 10.0, -12.0, 21.0, 43.0, 21.0, 32.0, 10.0, 43.0, 32.0, -34.0, -1.0, 32.0, 43.0, -1.0, 48.0, 76.0, 10.0, 26.0, 10.0, 65.0, 43.0, 21.0, 54.0, 65.0, -67.0, 10.0, 15.0, -56.0, -12.0, -1.0, 32.0, 54.0, 65.0, -23.0, 10.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19425393581032843, "mean_inference_ms": 9.653197083286095, "mean_action_processing_ms": 0.08418350868063017, "mean_env_wait_ms": 0.04218983906443434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005001288193922777, "StateBufferConnector_ms": 0.002833054615901067, "ViewRequirementAgentConnector_ms": 0.08592926538907565}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 16.846153846153847, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -1.0, 32.0, -12.0, 43.0, -1.0, 32.0, -56.0, 10.0, -45.0, 10.0, -12.0, 32.0, 43.0, 21.0, 10.0, -12.0, 21.0, 43.0, 21.0, 32.0, 10.0, 43.0, 32.0, -34.0, -1.0, 32.0, 43.0, -1.0, 48.0, 76.0, 10.0, 26.0, 10.0, 65.0, 43.0, 21.0, 54.0, 65.0, -67.0, 10.0, 15.0, -56.0, -12.0, -1.0, 32.0, 54.0, 65.0, -23.0, 10.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19425393581032843, "mean_inference_ms": 9.653197083286095, "mean_action_processing_ms": 0.08418350868063017, "mean_env_wait_ms": 0.04218983906443434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005001288193922777, "StateBufferConnector_ms": 0.002833054615901067, "ViewRequirementAgentConnector_ms": 0.08592926538907565}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 73160.427, "sample_time_ms": 39946.736, "learn_time_ms": 33204.493, "learn_throughput": 120.466, "synch_weights_time_ms": 8.39}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 52, "training_iteration": 1, "trial_id": "38794_00001", "date": "2023-06-01_20-26-46", "timestamp": 1685640406, "time_this_iter_s": 81.14762878417969, "time_total_s": 81.14762878417969, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.14762878417969, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.277192982456135, "ram_util_percent": 70.00877192982456}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -1.0, "episode_reward_mean": 30.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 21.0, 32.0, 32.0, -1.0, 32.0, 54.0, 32.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18910245625773675, "mean_inference_ms": 9.786885322355108, "mean_action_processing_ms": 0.08753817932610444, "mean_env_wait_ms": 0.04507788382886978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005424022674560547, "StateBufferConnector_ms": 0.0029039382934570312, "ViewRequirementAgentConnector_ms": 0.08708953857421875}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 7.816992282867432, "policy_loss": -0.011811565607786179, "vf_loss": 7.827130317687988, "vf_explained_var": 0.0008518010145053267, "kl": 0.008366698399186134, "entropy": 2.967268228530884, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 25.38, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, -56.0, 10.0, -45.0, 10.0, -12.0, 32.0, 43.0, 21.0, 10.0, -12.0, 21.0, 43.0, 21.0, 32.0, 10.0, 43.0, 32.0, -34.0, -1.0, 32.0, 43.0, -1.0, 48.0, 76.0, 10.0, 26.0, 10.0, 65.0, 43.0, 21.0, 54.0, 65.0, -67.0, 10.0, 15.0, -56.0, -12.0, -1.0, 32.0, 54.0, 65.0, -23.0, 10.0, 65.0, 76.0, 54.0, 54.0, 54.0, 76.0, 43.0, 65.0, -23.0, 32.0, -12.0, 59.0, 54.0, -1.0, -1.0, 76.0, 10.0, 21.0, -1.0, -1.0, -34.0, 32.0, 76.0, 54.0, 43.0, 43.0, -1.0, 10.0, 32.0, 54.0, 21.0, -12.0, 54.0, 32.0, -1.0, 54.0, 10.0, 65.0, 21.0, 43.0, -1.0, 43.0, 43.0, 43.0, 43.0, 32.0, 65.0, 54.0, 21.0, 21.0, 21.0, 21.0, 10.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196044160841817, "mean_inference_ms": 9.684657510339928, "mean_action_processing_ms": 0.08509552331654405, "mean_env_wait_ms": 0.04253425772779061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004948854446411133, "StateBufferConnector_ms": 0.002912282943725586, "ViewRequirementAgentConnector_ms": 0.0883641242980957}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 25.38, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, -56.0, 10.0, -45.0, 10.0, -12.0, 32.0, 43.0, 21.0, 10.0, -12.0, 21.0, 43.0, 21.0, 32.0, 10.0, 43.0, 32.0, -34.0, -1.0, 32.0, 43.0, -1.0, 48.0, 76.0, 10.0, 26.0, 10.0, 65.0, 43.0, 21.0, 54.0, 65.0, -67.0, 10.0, 15.0, -56.0, -12.0, -1.0, 32.0, 54.0, 65.0, -23.0, 10.0, 65.0, 76.0, 54.0, 54.0, 54.0, 76.0, 43.0, 65.0, -23.0, 32.0, -12.0, 59.0, 54.0, -1.0, -1.0, 76.0, 10.0, 21.0, -1.0, -1.0, -34.0, 32.0, 76.0, 54.0, 43.0, 43.0, -1.0, 10.0, 32.0, 54.0, 21.0, -12.0, 54.0, 32.0, -1.0, 54.0, 10.0, 65.0, 21.0, 43.0, -1.0, 43.0, 43.0, 43.0, 43.0, 32.0, 65.0, 54.0, 21.0, 21.0, 21.0, 21.0, 10.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196044160841817, "mean_inference_ms": 9.684657510339928, "mean_action_processing_ms": 0.08509552331654405, "mean_env_wait_ms": 0.04253425772779061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004948854446411133, "StateBufferConnector_ms": 0.002912282943725586, "ViewRequirementAgentConnector_ms": 0.0883641242980957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 74265.807, "sample_time_ms": 40201.975, "learn_time_ms": 34055.687, "learn_throughput": 117.455, "synch_weights_time_ms": 7.456}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 105, "training_iteration": 2, "trial_id": "38794_00001", "date": "2023-06-01_20-28-09", "timestamp": 1685640489, "time_this_iter_s": 82.86537337303162, "time_total_s": 164.0130021572113, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 164.0130021572113, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 46.66434782608695, "ram_util_percent": 71.50869565217393}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -133.0, "episode_reward_mean": -32.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -12.0, 43.0, -78.0, -89.0, -133.0, -56.0, 10.0, 10.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18750999330272283, "mean_inference_ms": 9.73253174865, "mean_action_processing_ms": 0.0865353873193081, "mean_env_wait_ms": 0.04412510164052653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057697296142578125, "StateBufferConnector_ms": 0.0028204917907714844, "ViewRequirementAgentConnector_ms": 0.09107589721679688}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 7.86553430557251, "policy_loss": -0.01036874670535326, "vf_loss": 7.874654293060303, "vf_explained_var": -0.00029973109485581517, "kl": 0.006244230084121227, "entropy": 2.9544565677642822, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 10.65, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -23.0, 32.0, -12.0, 59.0, 54.0, -1.0, -1.0, 76.0, 10.0, 21.0, -1.0, -1.0, -34.0, 32.0, 76.0, 54.0, 43.0, 43.0, -1.0, 10.0, 32.0, 54.0, 21.0, -12.0, 54.0, 32.0, -1.0, 54.0, 10.0, 65.0, 21.0, 43.0, -1.0, 43.0, 43.0, 43.0, 43.0, 32.0, 65.0, 54.0, 21.0, 21.0, 21.0, 21.0, 10.0, 65.0, 43.0, -34.0, 54.0, -111.0, 10.0, 32.0, -56.0, 32.0, -1.0, -23.0, -34.0, -100.0, -23.0, 32.0, 10.0, 21.0, -12.0, -12.0, -34.0, -45.0, 10.0, 32.0, 32.0, 43.0, -45.0, 43.0, 43.0, 43.0, -45.0, -18.0, 21.0, -1.0, -34.0, -34.0, 21.0, 21.0, 43.0, -1.0, 32.0, 43.0, 21.0, 65.0, -23.0, -56.0, -23.0, -12.0, -12.0, -56.0, -12.0, -78.0, -45.0, -45.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19938143473960104, "mean_inference_ms": 9.800576683335247, "mean_action_processing_ms": 0.08689958498144898, "mean_env_wait_ms": 0.04331238688713133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005168437957763672, "StateBufferConnector_ms": 0.003087759017944336, "ViewRequirementAgentConnector_ms": 0.09298110008239746}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 10.65, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, -23.0, 32.0, -12.0, 59.0, 54.0, -1.0, -1.0, 76.0, 10.0, 21.0, -1.0, -1.0, -34.0, 32.0, 76.0, 54.0, 43.0, 43.0, -1.0, 10.0, 32.0, 54.0, 21.0, -12.0, 54.0, 32.0, -1.0, 54.0, 10.0, 65.0, 21.0, 43.0, -1.0, 43.0, 43.0, 43.0, 43.0, 32.0, 65.0, 54.0, 21.0, 21.0, 21.0, 21.0, 10.0, 65.0, 43.0, -34.0, 54.0, -111.0, 10.0, 32.0, -56.0, 32.0, -1.0, -23.0, -34.0, -100.0, -23.0, 32.0, 10.0, 21.0, -12.0, -12.0, -34.0, -45.0, 10.0, 32.0, 32.0, 43.0, -45.0, 43.0, 43.0, 43.0, -45.0, -18.0, 21.0, -1.0, -34.0, -34.0, 21.0, 21.0, 43.0, -1.0, 32.0, 43.0, 21.0, 65.0, -23.0, -56.0, -23.0, -12.0, -12.0, -56.0, -12.0, -78.0, -45.0, -45.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19938143473960104, "mean_inference_ms": 9.800576683335247, "mean_action_processing_ms": 0.08689958498144898, "mean_env_wait_ms": 0.04331238688713133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005168437957763672, "StateBufferConnector_ms": 0.003087759017944336, "ViewRequirementAgentConnector_ms": 0.09298110008239746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 74547.247, "sample_time_ms": 40902.605, "learn_time_ms": 33636.872, "learn_throughput": 118.917, "synch_weights_time_ms": 7.158}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 157, "training_iteration": 3, "trial_id": "38794_00001", "date": "2023-06-01_20-29-32", "timestamp": 1685640572, "time_this_iter_s": 82.70881676673889, "time_total_s": 246.7218189239502, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.7218189239502, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.737931034482756, "ram_util_percent": 72.5}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -100.0, "episode_reward_mean": -1.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -100.0, -56.0, 43.0, -56.0, 32.0, 21.0, 54.0, 10.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19362418912657392, "mean_inference_ms": 10.330219638853317, "mean_action_processing_ms": 0.09008435503662672, "mean_env_wait_ms": 0.04551105693702986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005397796630859375, "StateBufferConnector_ms": 0.0033521652221679688, "ViewRequirementAgentConnector_ms": 0.10160446166992188}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 7.673871994018555, "policy_loss": -0.010095460340380669, "vf_loss": 7.6829729080200195, "vf_explained_var": -0.0021231763530522585, "kl": 0.004973240662366152, "entropy": 2.9441771507263184, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 6.52, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 32.0, -1.0, -23.0, -34.0, -100.0, -23.0, 32.0, 10.0, 21.0, -12.0, -12.0, -34.0, -45.0, 10.0, 32.0, 32.0, 43.0, -45.0, 43.0, 43.0, 43.0, -45.0, -18.0, 21.0, -1.0, -34.0, -34.0, 21.0, 21.0, 43.0, -1.0, 32.0, 43.0, 21.0, 65.0, -23.0, -56.0, -23.0, -12.0, -12.0, -56.0, -12.0, -78.0, -45.0, -45.0, -12.0, 21.0, 32.0, 21.0, 54.0, 54.0, 43.0, 21.0, -1.0, -12.0, -122.0, -34.0, -45.0, -12.0, -34.0, 32.0, -45.0, -45.0, -12.0, 37.0, 21.0, 10.0, 43.0, 54.0, 32.0, 10.0, 43.0, 54.0, -23.0, 43.0, 65.0, 32.0, 76.0, 54.0, 43.0, 10.0, 10.0, 43.0, 32.0, 65.0, 65.0, 32.0, 4.0, 54.0, 32.0, 65.0, -1.0, -12.0, -45.0, -56.0, 10.0, 10.0, 76.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20056912808219438, "mean_inference_ms": 9.853985984779554, "mean_action_processing_ms": 0.08745746767581089, "mean_env_wait_ms": 0.04357472265876219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005026102066040039, "StateBufferConnector_ms": 0.0030257701873779297, "ViewRequirementAgentConnector_ms": 0.09242033958435059}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 6.52, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, 32.0, -1.0, -23.0, -34.0, -100.0, -23.0, 32.0, 10.0, 21.0, -12.0, -12.0, -34.0, -45.0, 10.0, 32.0, 32.0, 43.0, -45.0, 43.0, 43.0, 43.0, -45.0, -18.0, 21.0, -1.0, -34.0, -34.0, 21.0, 21.0, 43.0, -1.0, 32.0, 43.0, 21.0, 65.0, -23.0, -56.0, -23.0, -12.0, -12.0, -56.0, -12.0, -78.0, -45.0, -45.0, -12.0, 21.0, 32.0, 21.0, 54.0, 54.0, 43.0, 21.0, -1.0, -12.0, -122.0, -34.0, -45.0, -12.0, -34.0, 32.0, -45.0, -45.0, -12.0, 37.0, 21.0, 10.0, 43.0, 54.0, 32.0, 10.0, 43.0, 54.0, -23.0, 43.0, 65.0, 32.0, 76.0, 54.0, 43.0, 10.0, 10.0, 43.0, 32.0, 65.0, 65.0, 32.0, 4.0, 54.0, 32.0, 65.0, -1.0, -12.0, -45.0, -56.0, 10.0, 10.0, 76.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20056912808219438, "mean_inference_ms": 9.853985984779554, "mean_action_processing_ms": 0.08745746767581089, "mean_env_wait_ms": 0.04357472265876219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005026102066040039, "StateBufferConnector_ms": 0.0030257701873779297, "ViewRequirementAgentConnector_ms": 0.09242033958435059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 75724.02, "sample_time_ms": 40683.732, "learn_time_ms": 35032.553, "learn_throughput": 114.18, "synch_weights_time_ms": 6.867}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 210, "training_iteration": 4, "trial_id": "38794_00001", "date": "2023-06-01_20-31-01", "timestamp": 1685640661, "time_this_iter_s": 88.80412197113037, "time_total_s": 335.52594089508057, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 335.52594089508057, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 53.01219512195122, "ram_util_percent": 73.98455284552844}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -78.0, "episode_reward_mean": -26.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -23.0, -45.0, -34.0, -78.0, -34.0, -34.0, -56.0, -56.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19132416676734817, "mean_inference_ms": 10.15401877594195, "mean_action_processing_ms": 0.08859925444456693, "mean_env_wait_ms": 0.0448841008660794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004286766052246094, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.08376359939575195}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 7.7027764320373535, "policy_loss": -0.01522036548703909, "vf_loss": 7.7171735763549805, "vf_explained_var": -0.0012123589403927326, "kl": 0.008229563944041729, "entropy": 2.9383225440979004, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 10.76, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -1.0, -12.0, -122.0, -34.0, -45.0, -12.0, -34.0, 32.0, -45.0, -45.0, -12.0, 37.0, 21.0, 10.0, 43.0, 54.0, 32.0, 10.0, 43.0, 54.0, -23.0, 43.0, 65.0, 32.0, 76.0, 54.0, 43.0, 10.0, 10.0, 43.0, 32.0, 65.0, 65.0, 32.0, 4.0, 54.0, 32.0, 65.0, -1.0, -12.0, -45.0, -56.0, 10.0, 10.0, 76.0, 32.0, 10.0, 32.0, -1.0, -45.0, 43.0, -1.0, 32.0, 76.0, 21.0, 21.0, -34.0, 32.0, 21.0, 21.0, 10.0, 21.0, 54.0, -12.0, 65.0, 54.0, 43.0, 54.0, 10.0, 10.0, -23.0, 21.0, 10.0, 32.0, 65.0, 10.0, -23.0, -89.0, -67.0, -34.0, 32.0, 32.0, 32.0, -34.0, -133.0, -34.0, -23.0, -12.0, -34.0, -1.0, 21.0, -34.0, 32.0, 54.0, 21.0, -12.0, -1.0, 10.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2011459015681222, "mean_inference_ms": 9.890751385237445, "mean_action_processing_ms": 0.08765287182554936, "mean_env_wait_ms": 0.0436586561311295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050907135009765625, "StateBufferConnector_ms": 0.003145456314086914, "ViewRequirementAgentConnector_ms": 0.09266257286071777}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 10.76, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -1.0, -12.0, -122.0, -34.0, -45.0, -12.0, -34.0, 32.0, -45.0, -45.0, -12.0, 37.0, 21.0, 10.0, 43.0, 54.0, 32.0, 10.0, 43.0, 54.0, -23.0, 43.0, 65.0, 32.0, 76.0, 54.0, 43.0, 10.0, 10.0, 43.0, 32.0, 65.0, 65.0, 32.0, 4.0, 54.0, 32.0, 65.0, -1.0, -12.0, -45.0, -56.0, 10.0, 10.0, 76.0, 32.0, 10.0, 32.0, -1.0, -45.0, 43.0, -1.0, 32.0, 76.0, 21.0, 21.0, -34.0, 32.0, 21.0, 21.0, 10.0, 21.0, 54.0, -12.0, 65.0, 54.0, 43.0, 54.0, 10.0, 10.0, -23.0, 21.0, 10.0, 32.0, 65.0, 10.0, -23.0, -89.0, -67.0, -34.0, 32.0, 32.0, 32.0, -34.0, -133.0, -34.0, -23.0, -12.0, -34.0, -1.0, 21.0, -34.0, 32.0, 54.0, 21.0, -12.0, -1.0, 10.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2011459015681222, "mean_inference_ms": 9.890751385237445, "mean_action_processing_ms": 0.08765287182554936, "mean_env_wait_ms": 0.0436586561311295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050907135009765625, "StateBufferConnector_ms": 0.003145456314086914, "ViewRequirementAgentConnector_ms": 0.09266257286071777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 76170.782, "sample_time_ms": 41160.323, "learn_time_ms": 35002.388, "learn_throughput": 114.278, "synch_weights_time_ms": 7.256}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 263, "training_iteration": 5, "trial_id": "38794_00001", "date": "2023-06-01_20-32-26", "timestamp": 1685640746, "time_this_iter_s": 85.42664313316345, "time_total_s": 420.952584028244, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 420.952584028244, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.844537815126046, "ram_util_percent": 73.66638655462182}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -56.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -56.0, -12.0, 10.0, 65.0, 43.0, -1.0, 21.0, 54.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1903539999251145, "mean_inference_ms": 10.090508395134162, "mean_action_processing_ms": 0.08810990945573073, "mean_env_wait_ms": 0.04444334544102578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049495697021484375, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.08536338806152344}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 7.822855472564697, "policy_loss": -0.012370779179036617, "vf_loss": 7.834348678588867, "vf_explained_var": 0.0004668957262765616, "kl": 0.00877698976546526, "entropy": 2.9293603897094727, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 5.32, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, 76.0, 21.0, 21.0, -34.0, 32.0, 21.0, 21.0, 10.0, 21.0, 54.0, -12.0, 65.0, 54.0, 43.0, 54.0, 10.0, 10.0, -23.0, 21.0, 10.0, 32.0, 65.0, 10.0, -23.0, -89.0, -67.0, -34.0, 32.0, 32.0, 32.0, -34.0, -133.0, -34.0, -23.0, -12.0, -34.0, -1.0, 21.0, -34.0, 32.0, 54.0, 21.0, -12.0, -1.0, 10.0, 10.0, -45.0, -45.0, -12.0, 10.0, -1.0, 32.0, -12.0, 43.0, -1.0, -34.0, 21.0, 32.0, -12.0, -67.0, -67.0, -12.0, -12.0, -23.0, 54.0, -45.0, -23.0, -23.0, -23.0, 21.0, -23.0, 76.0, 21.0, 43.0, 54.0, 43.0, 21.0, -67.0, -56.0, -1.0, 54.0, 10.0, -23.0, -18.0, -1.0, -1.0, 21.0, 21.0, 65.0, 43.0, 54.0, 65.0, 54.0, 10.0, 43.0, -12.0, -12.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20257027826052382, "mean_inference_ms": 10.023484840031227, "mean_action_processing_ms": 0.08852624647088259, "mean_env_wait_ms": 0.044094287860267034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005151987075805664, "StateBufferConnector_ms": 0.0031685829162597656, "ViewRequirementAgentConnector_ms": 0.09286117553710938}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 5.32, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 32.0, 76.0, 21.0, 21.0, -34.0, 32.0, 21.0, 21.0, 10.0, 21.0, 54.0, -12.0, 65.0, 54.0, 43.0, 54.0, 10.0, 10.0, -23.0, 21.0, 10.0, 32.0, 65.0, 10.0, -23.0, -89.0, -67.0, -34.0, 32.0, 32.0, 32.0, -34.0, -133.0, -34.0, -23.0, -12.0, -34.0, -1.0, 21.0, -34.0, 32.0, 54.0, 21.0, -12.0, -1.0, 10.0, 10.0, -45.0, -45.0, -12.0, 10.0, -1.0, 32.0, -12.0, 43.0, -1.0, -34.0, 21.0, 32.0, -12.0, -67.0, -67.0, -12.0, -12.0, -23.0, 54.0, -45.0, -23.0, -23.0, -23.0, 21.0, -23.0, 76.0, 21.0, 43.0, 54.0, 43.0, 21.0, -67.0, -56.0, -1.0, 54.0, 10.0, -23.0, -18.0, -1.0, -1.0, 21.0, 21.0, 65.0, 43.0, 54.0, 65.0, 54.0, 10.0, 43.0, -12.0, -12.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20257027826052382, "mean_inference_ms": 10.023484840031227, "mean_action_processing_ms": 0.08852624647088259, "mean_env_wait_ms": 0.044094287860267034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005151987075805664, "StateBufferConnector_ms": 0.0031685829162597656, "ViewRequirementAgentConnector_ms": 0.09286117553710938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 76629.302, "sample_time_ms": 41771.473, "learn_time_ms": 34850.063, "learn_throughput": 114.777, "synch_weights_time_ms": 6.993}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 315, "training_iteration": 6, "trial_id": "38794_00001", "date": "2023-06-01_20-33-53", "timestamp": 1685640833, "time_this_iter_s": 86.63945174217224, "time_total_s": 507.59203577041626, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 507.59203577041626, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.94876033057851, "ram_util_percent": 74.41818181818182}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 21.0, "episode_reward_mean": 46.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 54.0, 54.0, 32.0, 21.0, 43.0, 76.0, 76.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18916303021323969, "mean_inference_ms": 10.002934603376556, "mean_action_processing_ms": 0.08744602923867309, "mean_env_wait_ms": 0.04408982794348894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004913806915283203, "StateBufferConnector_ms": 0.002987384796142578, "ViewRequirementAgentConnector_ms": 0.08448362350463867}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 7.588125705718994, "policy_loss": -0.012913589365780354, "vf_loss": 7.600088596343994, "vf_explained_var": 0.00031544006196781993, "kl": 0.009504999034106731, "entropy": 2.9155681133270264, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 19.78, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -12.0, 43.0, -1.0, -34.0, 21.0, 32.0, -12.0, -67.0, -67.0, -12.0, -12.0, -23.0, 54.0, -45.0, -23.0, -23.0, -23.0, 21.0, -23.0, 76.0, 21.0, 43.0, 54.0, 43.0, 21.0, -67.0, -56.0, -1.0, 54.0, 10.0, -23.0, -18.0, -1.0, -1.0, 21.0, 21.0, 65.0, 43.0, 54.0, 65.0, 54.0, 10.0, 43.0, -12.0, -12.0, -34.0, 43.0, 21.0, 10.0, 65.0, 32.0, 32.0, 21.0, 10.0, 65.0, 10.0, 21.0, 43.0, 54.0, 76.0, 43.0, 54.0, 32.0, 54.0, 76.0, 76.0, 10.0, 21.0, 43.0, 65.0, 54.0, -23.0, 32.0, 43.0, 32.0, 21.0, 26.0, 10.0, 76.0, -34.0, 43.0, 65.0, -23.0, -1.0, 32.0, 32.0, 21.0, -12.0, 10.0, 21.0, 43.0, 76.0, 76.0, 65.0, 32.0, 21.0, -12.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20364606313486633, "mean_inference_ms": 10.149711045448798, "mean_action_processing_ms": 0.08926805824662115, "mean_env_wait_ms": 0.044488635878436364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005174398422241211, "StateBufferConnector_ms": 0.0032520294189453125, "ViewRequirementAgentConnector_ms": 0.09426712989807129}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 19.78, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -12.0, 43.0, -1.0, -34.0, 21.0, 32.0, -12.0, -67.0, -67.0, -12.0, -12.0, -23.0, 54.0, -45.0, -23.0, -23.0, -23.0, 21.0, -23.0, 76.0, 21.0, 43.0, 54.0, 43.0, 21.0, -67.0, -56.0, -1.0, 54.0, 10.0, -23.0, -18.0, -1.0, -1.0, 21.0, 21.0, 65.0, 43.0, 54.0, 65.0, 54.0, 10.0, 43.0, -12.0, -12.0, -34.0, 43.0, 21.0, 10.0, 65.0, 32.0, 32.0, 21.0, 10.0, 65.0, 10.0, 21.0, 43.0, 54.0, 76.0, 43.0, 54.0, 32.0, 54.0, 76.0, 76.0, 10.0, 21.0, 43.0, 65.0, 54.0, -23.0, 32.0, 43.0, 32.0, 21.0, 26.0, 10.0, 76.0, -34.0, 43.0, 65.0, -23.0, -1.0, 32.0, 32.0, 21.0, -12.0, 10.0, 21.0, 43.0, 76.0, 76.0, 65.0, 32.0, 21.0, -12.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20364606313486633, "mean_inference_ms": 10.149711045448798, "mean_action_processing_ms": 0.08926805824662115, "mean_env_wait_ms": 0.044488635878436364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005174398422241211, "StateBufferConnector_ms": 0.0032520294189453125, "ViewRequirementAgentConnector_ms": 0.09426712989807129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 76877.858, "sample_time_ms": 42187.485, "learn_time_ms": 34682.714, "learn_throughput": 115.331, "synch_weights_time_ms": 6.914}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 368, "training_iteration": 7, "trial_id": "38794_00001", "date": "2023-06-01_20-35-18", "timestamp": 1685640918, "time_this_iter_s": 85.85684108734131, "time_total_s": 593.4488768577576, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 593.4488768577576, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 46.625, "ram_util_percent": 74.60916666666667}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -100.0, "episode_reward_mean": 37.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 65.0, 54.0, -100.0, 43.0, 65.0, 54.0, 54.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18835726428867033, "mean_inference_ms": 9.944891031783104, "mean_action_processing_ms": 0.08692307763145934, "mean_env_wait_ms": 0.043801543077852466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004887580871582031, "StateBufferConnector_ms": 0.0028967857360839844, "ViewRequirementAgentConnector_ms": 0.08844614028930664}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 7.545750141143799, "policy_loss": -0.007387824822217226, "vf_loss": 7.552649021148682, "vf_explained_var": 8.981681457953528e-05, "kl": 0.004887288436293602, "entropy": 2.892012357711792, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 15.27, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 10.0, 65.0, 10.0, 21.0, 43.0, 54.0, 76.0, 43.0, 54.0, 32.0, 54.0, 76.0, 76.0, 10.0, 21.0, 43.0, 65.0, 54.0, -23.0, 32.0, 43.0, 32.0, 21.0, 26.0, 10.0, 76.0, -34.0, 43.0, 65.0, -23.0, -1.0, 32.0, 32.0, 21.0, -12.0, 10.0, 21.0, 43.0, 76.0, 76.0, 65.0, 32.0, 21.0, -12.0, -12.0, -12.0, -34.0, -23.0, 10.0, -12.0, 10.0, 43.0, 21.0, -12.0, -67.0, -23.0, -34.0, -56.0, -78.0, 32.0, -23.0, -12.0, -1.0, -23.0, -12.0, -1.0, 21.0, 43.0, 21.0, 10.0, 32.0, -56.0, 10.0, -1.0, 65.0, 21.0, -1.0, -45.0, -12.0, -12.0, 32.0, -23.0, 10.0, 10.0, -1.0, 21.0, 54.0, 32.0, -12.0, 43.0, -12.0, 43.0, -67.0, 15.0, -1.0, 21.0, -23.0, 43.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20401699982871796, "mean_inference_ms": 10.177784067227861, "mean_action_processing_ms": 0.08951624249826669, "mean_env_wait_ms": 0.04460448130744197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051593780517578125, "StateBufferConnector_ms": 0.0032575130462646484, "ViewRequirementAgentConnector_ms": 0.09544777870178223}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 15.27, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 10.0, 65.0, 10.0, 21.0, 43.0, 54.0, 76.0, 43.0, 54.0, 32.0, 54.0, 76.0, 76.0, 10.0, 21.0, 43.0, 65.0, 54.0, -23.0, 32.0, 43.0, 32.0, 21.0, 26.0, 10.0, 76.0, -34.0, 43.0, 65.0, -23.0, -1.0, 32.0, 32.0, 21.0, -12.0, 10.0, 21.0, 43.0, 76.0, 76.0, 65.0, 32.0, 21.0, -12.0, -12.0, -12.0, -34.0, -23.0, 10.0, -12.0, 10.0, 43.0, 21.0, -12.0, -67.0, -23.0, -34.0, -56.0, -78.0, 32.0, -23.0, -12.0, -1.0, -23.0, -12.0, -1.0, 21.0, 43.0, 21.0, 10.0, 32.0, -56.0, 10.0, -1.0, 65.0, 21.0, -1.0, -45.0, -12.0, -12.0, 32.0, -23.0, 10.0, 10.0, -1.0, 21.0, 54.0, 32.0, -12.0, 43.0, -12.0, 43.0, -67.0, 15.0, -1.0, 21.0, -23.0, 43.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20401699982871796, "mean_inference_ms": 10.177784067227861, "mean_action_processing_ms": 0.08951624249826669, "mean_env_wait_ms": 0.04460448130744197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051593780517578125, "StateBufferConnector_ms": 0.0032575130462646484, "ViewRequirementAgentConnector_ms": 0.09544777870178223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 76714.429, "sample_time_ms": 42036.123, "learn_time_ms": 34670.673, "learn_throughput": 115.371, "synch_weights_time_ms": 6.862}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 421, "training_iteration": 8, "trial_id": "38794_00001", "date": "2023-06-01_20-36-42", "timestamp": 1685641002, "time_this_iter_s": 83.10647702217102, "time_total_s": 676.5553538799286, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 676.5553538799286, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.83913043478261, "ram_util_percent": 74.46260869565218}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": 33.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 43.0, 54.0, -1.0, 10.0, 76.0, 21.0, -45.0, 43.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18766250130795994, "mean_inference_ms": 9.911569233718556, "mean_action_processing_ms": 0.086451496859772, "mean_env_wait_ms": 0.0435698539467343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546642303466797, "StateBufferConnector_ms": 0.0028228759765625, "ViewRequirementAgentConnector_ms": 0.08640289306640625}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 7.353914737701416, "policy_loss": -0.015392592176795006, "vf_loss": 7.368840217590332, "vf_explained_var": -5.906516162212938e-05, "kl": 0.009351213462650776, "entropy": 2.8854610919952393, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 8.45, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 21.0, -12.0, -67.0, -23.0, -34.0, -56.0, -78.0, 32.0, -23.0, -12.0, -1.0, -23.0, -12.0, -1.0, 21.0, 43.0, 21.0, 10.0, 32.0, -56.0, 10.0, -1.0, 65.0, 21.0, -1.0, -45.0, -12.0, -12.0, 32.0, -23.0, 10.0, 10.0, -1.0, 21.0, 54.0, 32.0, -12.0, 43.0, -12.0, 43.0, -67.0, 15.0, -1.0, 21.0, -23.0, 43.0, 65.0, 10.0, 76.0, 65.0, 21.0, -67.0, -1.0, 54.0, 65.0, -23.0, 21.0, 21.0, -23.0, 65.0, 65.0, -23.0, 32.0, 43.0, -1.0, 32.0, 21.0, -111.0, -45.0, 10.0, 21.0, -12.0, -1.0, 54.0, 10.0, 65.0, 32.0, 21.0, -56.0, 32.0, 21.0, -45.0, 32.0, -45.0, 32.0, -34.0, 54.0, 10.0, -1.0, 54.0, -12.0, -62.0, 21.0, -1.0, 10.0, 21.0, 65.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20417646900823883, "mean_inference_ms": 10.165818519637645, "mean_action_processing_ms": 0.08965490134527894, "mean_env_wait_ms": 0.044662455573359267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005238056182861328, "StateBufferConnector_ms": 0.0031566619873046875, "ViewRequirementAgentConnector_ms": 0.09338068962097168}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 8.45, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 21.0, -12.0, -67.0, -23.0, -34.0, -56.0, -78.0, 32.0, -23.0, -12.0, -1.0, -23.0, -12.0, -1.0, 21.0, 43.0, 21.0, 10.0, 32.0, -56.0, 10.0, -1.0, 65.0, 21.0, -1.0, -45.0, -12.0, -12.0, 32.0, -23.0, 10.0, 10.0, -1.0, 21.0, 54.0, 32.0, -12.0, 43.0, -12.0, 43.0, -67.0, 15.0, -1.0, 21.0, -23.0, 43.0, 65.0, 10.0, 76.0, 65.0, 21.0, -67.0, -1.0, 54.0, 65.0, -23.0, 21.0, 21.0, -23.0, 65.0, 65.0, -23.0, 32.0, 43.0, -1.0, 32.0, 21.0, -111.0, -45.0, 10.0, 21.0, -12.0, -1.0, 54.0, 10.0, 65.0, 32.0, 21.0, -56.0, 32.0, 21.0, -45.0, 32.0, -45.0, 32.0, -34.0, 54.0, 10.0, -1.0, 54.0, -12.0, -62.0, 21.0, -1.0, 10.0, 21.0, 65.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20417646900823883, "mean_inference_ms": 10.165818519637645, "mean_action_processing_ms": 0.08965490134527894, "mean_env_wait_ms": 0.044662455573359267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005238056182861328, "StateBufferConnector_ms": 0.0031566619873046875, "ViewRequirementAgentConnector_ms": 0.09338068962097168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 76613.019, "sample_time_ms": 42083.603, "learn_time_ms": 34521.914, "learn_throughput": 115.868, "synch_weights_time_ms": 6.759}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 473, "training_iteration": 9, "trial_id": "38794_00001", "date": "2023-06-01_20-38-05", "timestamp": 1685641085, "time_this_iter_s": 83.41741895675659, "time_total_s": 759.9727728366852, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 759.9727728366852, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 48.97521367521369, "ram_util_percent": 75.02393162393163}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -1.0, "episode_reward_mean": 40.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 21.0, 32.0, 65.0, 54.0, 65.0, 43.0, 21.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18882535034348313, "mean_inference_ms": 9.972525402019404, "mean_action_processing_ms": 0.08701321451683731, "mean_env_wait_ms": 0.043816040133413656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006146430969238281, "StateBufferConnector_ms": 0.0029802322387695312, "ViewRequirementAgentConnector_ms": 0.0976705551147461}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 7.06614875793457, "policy_loss": -0.01276010274887085, "vf_loss": 7.078371524810791, "vf_explained_var": -2.9921407985966653e-05, "kl": 0.010743578895926476, "entropy": 2.846564531326294, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 8.73, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 54.0, 65.0, -23.0, 21.0, 21.0, -23.0, 65.0, 65.0, -23.0, 32.0, 43.0, -1.0, 32.0, 21.0, -111.0, -45.0, 10.0, 21.0, -12.0, -1.0, 54.0, 10.0, 65.0, 32.0, 21.0, -56.0, 32.0, 21.0, -45.0, 32.0, -45.0, 32.0, -34.0, 54.0, 10.0, -1.0, 54.0, -12.0, -62.0, 21.0, -1.0, 10.0, 21.0, 65.0, 76.0, 76.0, 43.0, 10.0, 32.0, 32.0, -34.0, -56.0, 32.0, 21.0, 43.0, -23.0, 21.0, -45.0, -34.0, -23.0, 65.0, 76.0, 32.0, -12.0, -67.0, -45.0, 32.0, 43.0, -12.0, -89.0, -144.0, -34.0, -12.0, 32.0, 21.0, -23.0, 32.0, 43.0, -1.0, 21.0, -1.0, -1.0, 21.0, 10.0, -1.0, 32.0, 21.0, 43.0, 54.0, 65.0, 54.0, -23.0, -34.0, -67.0, -89.0, 10.0, 54.0, 32.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20445608500923484, "mean_inference_ms": 10.165125387936119, "mean_action_processing_ms": 0.08983972953529933, "mean_env_wait_ms": 0.04477087145750378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005254030227661133, "StateBufferConnector_ms": 0.0031147003173828125, "ViewRequirementAgentConnector_ms": 0.09286069869995117}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 8.73, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 54.0, 65.0, -23.0, 21.0, 21.0, -23.0, 65.0, 65.0, -23.0, 32.0, 43.0, -1.0, 32.0, 21.0, -111.0, -45.0, 10.0, 21.0, -12.0, -1.0, 54.0, 10.0, 65.0, 32.0, 21.0, -56.0, 32.0, 21.0, -45.0, 32.0, -45.0, 32.0, -34.0, 54.0, 10.0, -1.0, 54.0, -12.0, -62.0, 21.0, -1.0, 10.0, 21.0, 65.0, 76.0, 76.0, 43.0, 10.0, 32.0, 32.0, -34.0, -56.0, 32.0, 21.0, 43.0, -23.0, 21.0, -45.0, -34.0, -23.0, 65.0, 76.0, 32.0, -12.0, -67.0, -45.0, 32.0, 43.0, -12.0, -89.0, -144.0, -34.0, -12.0, 32.0, 21.0, -23.0, 32.0, 43.0, -1.0, 21.0, -1.0, -1.0, 21.0, 10.0, -1.0, 32.0, 21.0, 43.0, 54.0, 65.0, 54.0, -23.0, -34.0, -67.0, -89.0, 10.0, 54.0, 32.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20445608500923484, "mean_inference_ms": 10.165125387936119, "mean_action_processing_ms": 0.08983972953529933, "mean_env_wait_ms": 0.04477087145750378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005254030227661133, "StateBufferConnector_ms": 0.0031147003173828125, "ViewRequirementAgentConnector_ms": 0.09286069869995117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 77015.848, "sample_time_ms": 42039.553, "learn_time_ms": 34967.941, "learn_throughput": 114.39, "synch_weights_time_ms": 7.601}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 526, "training_iteration": 10, "trial_id": "38794_00001", "date": "2023-06-01_20-39-34", "timestamp": 1685641174, "time_this_iter_s": 88.96356773376465, "time_total_s": 848.9363405704498, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 848.9363405704498, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 54.95967741935485, "ram_util_percent": 76.19919354838707}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -1.0, "episode_reward_mean": 27.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -1.0, 76.0, 32.0, -1.0, 43.0, 54.0, -1.0, 54.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18950977788532114, "mean_inference_ms": 10.01081260222166, "mean_action_processing_ms": 0.0874588983136777, "mean_env_wait_ms": 0.04404344822199575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005345344543457031, "StateBufferConnector_ms": 0.0029778480529785156, "ViewRequirementAgentConnector_ms": 0.09351491928100586}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 7.005197525024414, "policy_loss": -0.009895305149257183, "vf_loss": 7.014666557312012, "vf_explained_var": 0.0016100628999993205, "kl": 0.008516098372638226, "entropy": 2.8064351081848145, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 7.36, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 32.0, 21.0, 43.0, -23.0, 21.0, -45.0, -34.0, -23.0, 65.0, 76.0, 32.0, -12.0, -67.0, -45.0, 32.0, 43.0, -12.0, -89.0, -144.0, -34.0, -12.0, 32.0, 21.0, -23.0, 32.0, 43.0, -1.0, 21.0, -1.0, -1.0, 21.0, 10.0, -1.0, 32.0, 21.0, 43.0, 54.0, 65.0, 54.0, -23.0, -34.0, -67.0, -89.0, 10.0, 54.0, 32.0, 76.0, 32.0, 10.0, 21.0, -1.0, 21.0, 32.0, 65.0, 43.0, 54.0, 32.0, 32.0, -23.0, -1.0, 10.0, 10.0, 21.0, -56.0, -1.0, 43.0, 43.0, 54.0, 10.0, -67.0, 32.0, 32.0, 54.0, 10.0, -56.0, -78.0, -34.0, -78.0, -12.0, -12.0, 54.0, 43.0, -1.0, 43.0, 54.0, 32.0, 10.0, -45.0, 65.0, 65.0, 43.0, -23.0, 21.0, 32.0, 21.0, -45.0, 10.0, 21.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20502431019783288, "mean_inference_ms": 10.201575081951356, "mean_action_processing_ms": 0.09013958224372115, "mean_env_wait_ms": 0.044951338921824145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414724349975586, "StateBufferConnector_ms": 0.003157377243041992, "ViewRequirementAgentConnector_ms": 0.09538531303405762}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 7.36, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, 32.0, 21.0, 43.0, -23.0, 21.0, -45.0, -34.0, -23.0, 65.0, 76.0, 32.0, -12.0, -67.0, -45.0, 32.0, 43.0, -12.0, -89.0, -144.0, -34.0, -12.0, 32.0, 21.0, -23.0, 32.0, 43.0, -1.0, 21.0, -1.0, -1.0, 21.0, 10.0, -1.0, 32.0, 21.0, 43.0, 54.0, 65.0, 54.0, -23.0, -34.0, -67.0, -89.0, 10.0, 54.0, 32.0, 76.0, 32.0, 10.0, 21.0, -1.0, 21.0, 32.0, 65.0, 43.0, 54.0, 32.0, 32.0, -23.0, -1.0, 10.0, 10.0, 21.0, -56.0, -1.0, 43.0, 43.0, 54.0, 10.0, -67.0, 32.0, 32.0, 54.0, 10.0, -56.0, -78.0, -34.0, -78.0, -12.0, -12.0, 54.0, 43.0, -1.0, 43.0, 54.0, 32.0, 10.0, -45.0, 65.0, 65.0, 43.0, -23.0, 21.0, 32.0, 21.0, -45.0, 10.0, 21.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20502431019783288, "mean_inference_ms": 10.201575081951356, "mean_action_processing_ms": 0.09013958224372115, "mean_env_wait_ms": 0.044951338921824145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414724349975586, "StateBufferConnector_ms": 0.003157377243041992, "ViewRequirementAgentConnector_ms": 0.09538531303405762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 77715.713, "sample_time_ms": 42609.979, "learn_time_ms": 35097.58, "learn_throughput": 113.968, "synch_weights_time_ms": 7.432}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 578, "training_iteration": 11, "trial_id": "38794_00001", "date": "2023-06-01_20-41-02", "timestamp": 1685641262, "time_this_iter_s": 88.36470794677734, "time_total_s": 937.3010485172272, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 937.3010485172272, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 53.698373983739835, "ram_util_percent": 74.46504065040651}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -78.0, "episode_reward_mean": -8.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 32.0, -34.0, -23.0, -45.0, -78.0, 10.0, -12.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18872860269762942, "mean_inference_ms": 9.957521738889458, "mean_action_processing_ms": 0.08703234843707976, "mean_env_wait_ms": 0.04377086465001407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005116462707519531, "StateBufferConnector_ms": 0.002892017364501953, "ViewRequirementAgentConnector_ms": 0.09021997451782227}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.6053690910339355, "policy_loss": -0.016454877331852913, "vf_loss": 6.621064186096191, "vf_explained_var": 0.0025983399245887995, "kl": 0.015182262286543846, "entropy": 2.718611240386963, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 15.55, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 65.0, 43.0, 54.0, 32.0, 32.0, -23.0, -1.0, 10.0, 10.0, 21.0, -56.0, -1.0, 43.0, 43.0, 54.0, 10.0, -67.0, 32.0, 32.0, 54.0, 10.0, -56.0, -78.0, -34.0, -78.0, -12.0, -12.0, 54.0, 43.0, -1.0, 43.0, 54.0, 32.0, 10.0, -45.0, 65.0, 65.0, 43.0, -23.0, 21.0, 32.0, 21.0, -45.0, 10.0, 21.0, -56.0, -45.0, -45.0, 43.0, 21.0, -23.0, 21.0, -78.0, -12.0, 43.0, -12.0, -45.0, 10.0, 54.0, 32.0, 32.0, -1.0, 43.0, 21.0, 37.0, 65.0, 54.0, 65.0, 10.0, -12.0, 10.0, -45.0, -23.0, -1.0, 43.0, 43.0, 54.0, 43.0, 65.0, 54.0, 10.0, 32.0, 43.0, 21.0, -23.0, 21.0, 10.0, -12.0, -1.0, 65.0, 21.0, 32.0, 43.0, 54.0, 76.0, 54.0, 43.0, -1.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20585276832366176, "mean_inference_ms": 10.251048568651434, "mean_action_processing_ms": 0.09062532482685093, "mean_env_wait_ms": 0.045193052216411046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005305767059326172, "StateBufferConnector_ms": 0.0032417774200439453, "ViewRequirementAgentConnector_ms": 0.09731769561767578}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 15.55, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 65.0, 43.0, 54.0, 32.0, 32.0, -23.0, -1.0, 10.0, 10.0, 21.0, -56.0, -1.0, 43.0, 43.0, 54.0, 10.0, -67.0, 32.0, 32.0, 54.0, 10.0, -56.0, -78.0, -34.0, -78.0, -12.0, -12.0, 54.0, 43.0, -1.0, 43.0, 54.0, 32.0, 10.0, -45.0, 65.0, 65.0, 43.0, -23.0, 21.0, 32.0, 21.0, -45.0, 10.0, 21.0, -56.0, -45.0, -45.0, 43.0, 21.0, -23.0, 21.0, -78.0, -12.0, 43.0, -12.0, -45.0, 10.0, 54.0, 32.0, 32.0, -1.0, 43.0, 21.0, 37.0, 65.0, 54.0, 65.0, 10.0, -12.0, 10.0, -45.0, -23.0, -1.0, 43.0, 43.0, 54.0, 43.0, 65.0, 54.0, 10.0, 32.0, 43.0, 21.0, -23.0, 21.0, 10.0, -12.0, -1.0, 65.0, 21.0, 32.0, 43.0, 54.0, 76.0, 54.0, 43.0, -1.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20585276832366176, "mean_inference_ms": 10.251048568651434, "mean_action_processing_ms": 0.09062532482685093, "mean_env_wait_ms": 0.045193052216411046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005305767059326172, "StateBufferConnector_ms": 0.0032417774200439453, "ViewRequirementAgentConnector_ms": 0.09731769561767578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 77863.792, "sample_time_ms": 42906.876, "learn_time_ms": 34948.75, "learn_throughput": 114.453, "synch_weights_time_ms": 7.424}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 631, "training_iteration": 12, "trial_id": "38794_00001", "date": "2023-06-01_20-42-27", "timestamp": 1685641347, "time_this_iter_s": 84.2520079612732, "time_total_s": 1021.5530564785004, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1021.5530564785004, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 49.19914529914529, "ram_util_percent": 74.20683760683761}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -111.0, "episode_reward_mean": -17.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.0, -1.0, -1.0, -45.0, -1.0, -23.0, -45.0, -12.0, 21.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18799146917254542, "mean_inference_ms": 9.926796683342443, "mean_action_processing_ms": 0.08660271973422203, "mean_env_wait_ms": 0.04356301466640028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005323886871337891, "StateBufferConnector_ms": 0.0027561187744140625, "ViewRequirementAgentConnector_ms": 0.0861501693725586}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.467687129974365, "policy_loss": -0.008598597720265388, "vf_loss": 6.47595739364624, "vf_explained_var": 0.0005203514592722058, "kl": 0.0065673342905938625, "entropy": 2.7677700519561768, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 22.37, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -12.0, 43.0, -12.0, -45.0, 10.0, 54.0, 32.0, 32.0, -1.0, 43.0, 21.0, 37.0, 65.0, 54.0, 65.0, 10.0, -12.0, 10.0, -45.0, -23.0, -1.0, 43.0, 43.0, 54.0, 43.0, 65.0, 54.0, 10.0, 32.0, 43.0, 21.0, -23.0, 21.0, 10.0, -12.0, -1.0, 65.0, 21.0, 32.0, 43.0, 54.0, 76.0, 54.0, 43.0, -1.0, 43.0, 54.0, -67.0, 10.0, -23.0, 32.0, 54.0, 76.0, 54.0, 65.0, 43.0, 65.0, -78.0, -12.0, -12.0, -12.0, -1.0, 54.0, 43.0, 32.0, 54.0, 54.0, 54.0, 32.0, 54.0, -34.0, 10.0, 76.0, 54.0, 76.0, 21.0, 10.0, 54.0, 43.0, -23.0, -1.0, 43.0, 32.0, -1.0, 10.0, 54.0, 43.0, 10.0, 21.0, -12.0, 21.0, -1.0, 10.0, 32.0, -23.0, 21.0, -78.0, -12.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20609112841988142, "mean_inference_ms": 10.25239141126954, "mean_action_processing_ms": 0.09081718540102197, "mean_env_wait_ms": 0.045252432215411725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005311489105224609, "StateBufferConnector_ms": 0.003148794174194336, "ViewRequirementAgentConnector_ms": 0.09443378448486328}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 22.37, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.0, -12.0, 43.0, -12.0, -45.0, 10.0, 54.0, 32.0, 32.0, -1.0, 43.0, 21.0, 37.0, 65.0, 54.0, 65.0, 10.0, -12.0, 10.0, -45.0, -23.0, -1.0, 43.0, 43.0, 54.0, 43.0, 65.0, 54.0, 10.0, 32.0, 43.0, 21.0, -23.0, 21.0, 10.0, -12.0, -1.0, 65.0, 21.0, 32.0, 43.0, 54.0, 76.0, 54.0, 43.0, -1.0, 43.0, 54.0, -67.0, 10.0, -23.0, 32.0, 54.0, 76.0, 54.0, 65.0, 43.0, 65.0, -78.0, -12.0, -12.0, -12.0, -1.0, 54.0, 43.0, 32.0, 54.0, 54.0, 54.0, 32.0, 54.0, -34.0, 10.0, 76.0, 54.0, 76.0, 21.0, 10.0, 54.0, 43.0, -23.0, -1.0, 43.0, 32.0, -1.0, 10.0, 54.0, 43.0, 10.0, 21.0, -12.0, 21.0, -1.0, 10.0, 32.0, -23.0, 21.0, -78.0, -12.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20609112841988142, "mean_inference_ms": 10.25239141126954, "mean_action_processing_ms": 0.09081718540102197, "mean_env_wait_ms": 0.045252432215411725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005311489105224609, "StateBufferConnector_ms": 0.003148794174194336, "ViewRequirementAgentConnector_ms": 0.09443378448486328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 77903.826, "sample_time_ms": 42838.561, "learn_time_ms": 35055.815, "learn_throughput": 114.104, "synch_weights_time_ms": 8.676}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 684, "training_iteration": 13, "trial_id": "38794_00001", "date": "2023-06-01_20-43-50", "timestamp": 1685641430, "time_this_iter_s": 83.06721591949463, "time_total_s": 1104.620272397995, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1104.620272397995, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 51.25258620689655, "ram_util_percent": 75.3094827586207}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": 3.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, -34.0, -12.0, -45.0, -1.0, 76.0, 10.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18854235787217347, "mean_inference_ms": 9.967985351264236, "mean_action_processing_ms": 0.08684842056175471, "mean_env_wait_ms": 0.04366467897744793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006444454193115234, "StateBufferConnector_ms": 0.0036478042602539062, "ViewRequirementAgentConnector_ms": 0.10085344314575195}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 7.773695468902588, "policy_loss": -0.01094360277056694, "vf_loss": 7.784251689910889, "vf_explained_var": -0.0004698199627455324, "kl": 0.007736371364444494, "entropy": 2.7374472618103027, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 7.52, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 54.0, 65.0, 43.0, 65.0, -78.0, -12.0, -12.0, -12.0, -1.0, 54.0, 43.0, 32.0, 54.0, 54.0, 54.0, 32.0, 54.0, -34.0, 10.0, 76.0, 54.0, 76.0, 21.0, 10.0, 54.0, 43.0, -23.0, -1.0, 43.0, 32.0, -1.0, 10.0, 54.0, 43.0, 10.0, 21.0, -12.0, 21.0, -1.0, 10.0, 32.0, -23.0, 21.0, -78.0, -12.0, 76.0, -1.0, 43.0, 54.0, 54.0, 76.0, -23.0, -34.0, -89.0, -1.0, -45.0, 32.0, -56.0, 32.0, -45.0, -67.0, 21.0, -1.0, 76.0, 21.0, -12.0, 10.0, 10.0, -34.0, 10.0, 21.0, 43.0, 10.0, -89.0, -45.0, -100.0, -67.0, 32.0, -23.0, -73.0, -12.0, -1.0, -34.0, 32.0, 10.0, 10.0, -12.0, 76.0, -12.0, 10.0, -56.0, -56.0, -23.0, -12.0, 21.0, -67.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20616937299744048, "mean_inference_ms": 10.250847132553542, "mean_action_processing_ms": 0.09090849681130372, "mean_env_wait_ms": 0.04528689684922976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005284547805786133, "StateBufferConnector_ms": 0.003154277801513672, "ViewRequirementAgentConnector_ms": 0.09374141693115234}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 7.52, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 54.0, 65.0, 43.0, 65.0, -78.0, -12.0, -12.0, -12.0, -1.0, 54.0, 43.0, 32.0, 54.0, 54.0, 54.0, 32.0, 54.0, -34.0, 10.0, 76.0, 54.0, 76.0, 21.0, 10.0, 54.0, 43.0, -23.0, -1.0, 43.0, 32.0, -1.0, 10.0, 54.0, 43.0, 10.0, 21.0, -12.0, 21.0, -1.0, 10.0, 32.0, -23.0, 21.0, -78.0, -12.0, 76.0, -1.0, 43.0, 54.0, 54.0, 76.0, -23.0, -34.0, -89.0, -1.0, -45.0, 32.0, -56.0, 32.0, -45.0, -67.0, 21.0, -1.0, 76.0, 21.0, -12.0, 10.0, 10.0, -34.0, 10.0, 21.0, 43.0, 10.0, -89.0, -45.0, -100.0, -67.0, 32.0, -23.0, -73.0, -12.0, -1.0, -34.0, 32.0, 10.0, 10.0, -12.0, 76.0, -12.0, 10.0, -56.0, -56.0, -23.0, -12.0, 21.0, -67.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20616937299744048, "mean_inference_ms": 10.250847132553542, "mean_action_processing_ms": 0.09090849681130372, "mean_env_wait_ms": 0.04528689684922976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005284547805786133, "StateBufferConnector_ms": 0.003154277801513672, "ViewRequirementAgentConnector_ms": 0.09374141693115234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 77810.68, "sample_time_ms": 43141.809, "learn_time_ms": 34659.449, "learn_throughput": 115.409, "synch_weights_time_ms": 8.743}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 736, "training_iteration": 14, "trial_id": "38794_00001", "date": "2023-06-01_20-45-16", "timestamp": 1685641516, "time_this_iter_s": 86.6131157875061, "time_total_s": 1191.233388185501, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1191.233388185501, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 51.231404958677686, "ram_util_percent": 74.83388429752065}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -12.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 54.0, 54.0, 32.0, 43.0, 43.0, -1.0, 43.0, -12.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18828775305338527, "mean_inference_ms": 9.953094463517358, "mean_action_processing_ms": 0.08667963511608598, "mean_env_wait_ms": 0.04357319632681532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046825408935546875, "StateBufferConnector_ms": 0.0033736228942871094, "ViewRequirementAgentConnector_ms": 0.08656024932861328}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.590439319610596, "policy_loss": -0.013507801108062267, "vf_loss": 6.6032867431640625, "vf_explained_var": 0.0011217400897294283, "kl": 0.013204559683799744, "entropy": 2.656855583190918, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 1.96, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -34.0, -89.0, -1.0, -45.0, 32.0, -56.0, 32.0, -45.0, -67.0, 21.0, -1.0, 76.0, 21.0, -12.0, 10.0, 10.0, -34.0, 10.0, 21.0, 43.0, 10.0, -89.0, -45.0, -100.0, -67.0, 32.0, -23.0, -73.0, -12.0, -1.0, -34.0, 32.0, 10.0, 10.0, -12.0, 76.0, -12.0, 10.0, -56.0, -56.0, -23.0, -12.0, 21.0, -67.0, -23.0, 10.0, 10.0, 32.0, 10.0, 21.0, -34.0, 21.0, -23.0, -23.0, -23.0, -12.0, 10.0, 54.0, -23.0, -1.0, 65.0, 21.0, -1.0, 21.0, 54.0, -34.0, -89.0, -1.0, 32.0, 43.0, 21.0, -45.0, 21.0, 65.0, 76.0, 65.0, 65.0, 65.0, 65.0, 76.0, 43.0, 59.0, -34.0, -56.0, 65.0, 43.0, 21.0, 10.0, 43.0, -12.0, -1.0, -67.0, -23.0, 43.0, -1.0, 21.0, 43.0, 43.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20693182152868458, "mean_inference_ms": 10.329483893672316, "mean_action_processing_ms": 0.09133184546644724, "mean_env_wait_ms": 0.045525799881192465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005655527114868164, "StateBufferConnector_ms": 0.003470897674560547, "ViewRequirementAgentConnector_ms": 0.09948039054870605}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 1.96, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, -34.0, -89.0, -1.0, -45.0, 32.0, -56.0, 32.0, -45.0, -67.0, 21.0, -1.0, 76.0, 21.0, -12.0, 10.0, 10.0, -34.0, 10.0, 21.0, 43.0, 10.0, -89.0, -45.0, -100.0, -67.0, 32.0, -23.0, -73.0, -12.0, -1.0, -34.0, 32.0, 10.0, 10.0, -12.0, 76.0, -12.0, 10.0, -56.0, -56.0, -23.0, -12.0, 21.0, -67.0, -23.0, 10.0, 10.0, 32.0, 10.0, 21.0, -34.0, 21.0, -23.0, -23.0, -23.0, -12.0, 10.0, 54.0, -23.0, -1.0, 65.0, 21.0, -1.0, 21.0, 54.0, -34.0, -89.0, -1.0, 32.0, 43.0, 21.0, -45.0, 21.0, 65.0, 76.0, 65.0, 65.0, 65.0, 65.0, 76.0, 43.0, 59.0, -34.0, -56.0, 65.0, 43.0, 21.0, 10.0, 43.0, -12.0, -1.0, -67.0, -23.0, 43.0, -1.0, 21.0, 43.0, 43.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20693182152868458, "mean_inference_ms": 10.329483893672316, "mean_action_processing_ms": 0.09133184546644724, "mean_env_wait_ms": 0.045525799881192465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005655527114868164, "StateBufferConnector_ms": 0.003470897674560547, "ViewRequirementAgentConnector_ms": 0.09948039054870605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 78498.065, "sample_time_ms": 43920.984, "learn_time_ms": 34567.899, "learn_throughput": 115.714, "synch_weights_time_ms": 8.496}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 789, "training_iteration": 15, "trial_id": "38794_00001", "date": "2023-06-01_20-46-49", "timestamp": 1685641609, "time_this_iter_s": 92.5239942073822, "time_total_s": 1283.7573823928833, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1283.7573823928833, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 50.14728682170543, "ram_util_percent": 76.91782945736433}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 6.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -100.0, -111.0, -1.0, 10.0, 76.0, 32.0, 32.0, 59.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18875552443197002, "mean_inference_ms": 9.965153197671285, "mean_action_processing_ms": 0.08686407744987416, "mean_env_wait_ms": 0.043671084669759504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005698204040527344, "StateBufferConnector_ms": 0.0031709671020507812, "ViewRequirementAgentConnector_ms": 0.09276151657104492}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.671045780181885, "policy_loss": -0.01765521802008152, "vf_loss": 6.687811374664307, "vf_explained_var": 0.009487450122833252, "kl": 0.01780199259519577, "entropy": 2.608647584915161, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 15.33, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -23.0, -23.0, -12.0, 10.0, 54.0, -23.0, -1.0, 65.0, 21.0, -1.0, 21.0, 54.0, -34.0, -89.0, -1.0, 32.0, 43.0, 21.0, -45.0, 21.0, 65.0, 76.0, 65.0, 65.0, 65.0, 65.0, 76.0, 43.0, 59.0, -34.0, -56.0, 65.0, 43.0, 21.0, 10.0, 43.0, -12.0, -1.0, -67.0, -23.0, 43.0, -1.0, 21.0, 43.0, 43.0, -23.0, -23.0, -23.0, 43.0, -45.0, 32.0, -23.0, -23.0, -1.0, -45.0, 10.0, 43.0, 76.0, 21.0, 43.0, 43.0, 43.0, 54.0, 10.0, 10.0, 32.0, -12.0, -89.0, -12.0, 21.0, 21.0, 32.0, 10.0, 43.0, 32.0, 32.0, -12.0, 21.0, 65.0, 21.0, 21.0, 65.0, -1.0, -78.0, 32.0, -23.0, -34.0, 10.0, -12.0, -56.0, 43.0, 21.0, 32.0, 54.0, 65.0, 54.0, 32.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20753939124253837, "mean_inference_ms": 10.394769249109038, "mean_action_processing_ms": 0.09169007659280937, "mean_env_wait_ms": 0.04571895748340562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00559687614440918, "StateBufferConnector_ms": 0.0034456253051757812, "ViewRequirementAgentConnector_ms": 0.09900283813476562}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 15.33, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, -23.0, -23.0, -12.0, 10.0, 54.0, -23.0, -1.0, 65.0, 21.0, -1.0, 21.0, 54.0, -34.0, -89.0, -1.0, 32.0, 43.0, 21.0, -45.0, 21.0, 65.0, 76.0, 65.0, 65.0, 65.0, 65.0, 76.0, 43.0, 59.0, -34.0, -56.0, 65.0, 43.0, 21.0, 10.0, 43.0, -12.0, -1.0, -67.0, -23.0, 43.0, -1.0, 21.0, 43.0, 43.0, -23.0, -23.0, -23.0, 43.0, -45.0, 32.0, -23.0, -23.0, -1.0, -45.0, 10.0, 43.0, 76.0, 21.0, 43.0, 43.0, 43.0, 54.0, 10.0, 10.0, 32.0, -12.0, -89.0, -12.0, 21.0, 21.0, 32.0, 10.0, 43.0, 32.0, 32.0, -12.0, 21.0, 65.0, 21.0, 21.0, 65.0, -1.0, -78.0, 32.0, -23.0, -34.0, 10.0, -12.0, -56.0, 43.0, 21.0, 32.0, 54.0, 65.0, 54.0, 32.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20753939124253837, "mean_inference_ms": 10.394769249109038, "mean_action_processing_ms": 0.09169007659280937, "mean_env_wait_ms": 0.04571895748340562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00559687614440918, "StateBufferConnector_ms": 0.0034456253051757812, "ViewRequirementAgentConnector_ms": 0.09900283813476562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 78329.411, "sample_time_ms": 43744.532, "learn_time_ms": 34575.67, "learn_throughput": 115.688, "synch_weights_time_ms": 8.525}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 842, "training_iteration": 16, "trial_id": "38794_00001", "date": "2023-06-01_20-48-14", "timestamp": 1685641694, "time_this_iter_s": 85.24813294410706, "time_total_s": 1369.0055153369904, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1369.0055153369904, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 48.744537815126044, "ram_util_percent": 75.41932773109244}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -89.0, "episode_reward_mean": 24.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 59.0, 65.0, -1.0, 32.0, -1.0, 32.0, 54.0, 65.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19020842708732014, "mean_inference_ms": 10.142591418279654, "mean_action_processing_ms": 0.08765638691105253, "mean_env_wait_ms": 0.044036083163865244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005795955657958984, "StateBufferConnector_ms": 0.003299713134765625, "ViewRequirementAgentConnector_ms": 0.0995182991027832}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.462803363800049, "policy_loss": -0.013608122244477272, "vf_loss": 6.475656032562256, "vf_explained_var": 0.008014420047402382, "kl": 0.01510043814778328, "entropy": 2.5823023319244385, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 16.71, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -23.0, -1.0, -45.0, 10.0, 43.0, 76.0, 21.0, 43.0, 43.0, 43.0, 54.0, 10.0, 10.0, 32.0, -12.0, -89.0, -12.0, 21.0, 21.0, 32.0, 10.0, 43.0, 32.0, 32.0, -12.0, 21.0, 65.0, 21.0, 21.0, 65.0, -1.0, -78.0, 32.0, -23.0, -34.0, 10.0, -12.0, -56.0, 43.0, 21.0, 32.0, 54.0, 65.0, 54.0, 32.0, 54.0, 43.0, 43.0, 32.0, -1.0, 21.0, -45.0, 43.0, 54.0, 76.0, 65.0, 65.0, 43.0, 32.0, 54.0, 32.0, 54.0, 43.0, 54.0, -34.0, 10.0, -56.0, -23.0, -45.0, 10.0, 32.0, 21.0, 10.0, -1.0, -45.0, 32.0, -12.0, -23.0, -34.0, -34.0, 21.0, 21.0, 10.0, 43.0, 65.0, 43.0, 10.0, -45.0, -12.0, 54.0, 10.0, -34.0, 21.0, 43.0, 21.0, 43.0, 54.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20787191500743937, "mean_inference_ms": 10.40594626082391, "mean_action_processing_ms": 0.09190944594720976, "mean_env_wait_ms": 0.04582918171757683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005326271057128906, "StateBufferConnector_ms": 0.003340482711791992, "ViewRequirementAgentConnector_ms": 0.0973351001739502}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 16.71, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, -23.0, -1.0, -45.0, 10.0, 43.0, 76.0, 21.0, 43.0, 43.0, 43.0, 54.0, 10.0, 10.0, 32.0, -12.0, -89.0, -12.0, 21.0, 21.0, 32.0, 10.0, 43.0, 32.0, 32.0, -12.0, 21.0, 65.0, 21.0, 21.0, 65.0, -1.0, -78.0, 32.0, -23.0, -34.0, 10.0, -12.0, -56.0, 43.0, 21.0, 32.0, 54.0, 65.0, 54.0, 32.0, 54.0, 43.0, 43.0, 32.0, -1.0, 21.0, -45.0, 43.0, 54.0, 76.0, 65.0, 65.0, 43.0, 32.0, 54.0, 32.0, 54.0, 43.0, 54.0, -34.0, 10.0, -56.0, -23.0, -45.0, 10.0, 32.0, 21.0, 10.0, -1.0, -45.0, 32.0, -12.0, -23.0, -34.0, -34.0, 21.0, 21.0, 10.0, 43.0, 65.0, 43.0, 10.0, -45.0, -12.0, 54.0, 10.0, -34.0, 21.0, 43.0, 21.0, 43.0, 54.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20787191500743937, "mean_inference_ms": 10.40594626082391, "mean_action_processing_ms": 0.09190944594720976, "mean_env_wait_ms": 0.04582918171757683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005326271057128906, "StateBufferConnector_ms": 0.003340482711791992, "ViewRequirementAgentConnector_ms": 0.0973351001739502}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 78612.584, "sample_time_ms": 43725.553, "learn_time_ms": 34877.623, "learn_throughput": 114.687, "synch_weights_time_ms": 8.708}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 894, "training_iteration": 17, "trial_id": "38794_00001", "date": "2023-06-01_20-49-46", "timestamp": 1685641786, "time_this_iter_s": 91.42307996749878, "time_total_s": 1460.4285953044891, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1460.4285953044891, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 52.0748031496063, "ram_util_percent": 76.2937007874016}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -56.0, "episode_reward_mean": -15.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, -45.0, -45.0, -34.0, -56.0, -23.0, -23.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19071919642191132, "mean_inference_ms": 10.166945160154137, "mean_action_processing_ms": 0.08778960355740961, "mean_env_wait_ms": 0.0441428313399257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005037784576416016, "StateBufferConnector_ms": 0.0030922889709472656, "ViewRequirementAgentConnector_ms": 0.09195804595947266}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.411323070526123, "policy_loss": -0.007487555034458637, "vf_loss": 6.4185099601745605, "vf_explained_var": 0.0011306704254820943, "kl": 0.0060069384053349495, "entropy": 2.5752065181732178, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 18.69, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 54.0, 76.0, 65.0, 65.0, 43.0, 32.0, 54.0, 32.0, 54.0, 43.0, 54.0, -34.0, 10.0, -56.0, -23.0, -45.0, 10.0, 32.0, 21.0, 10.0, -1.0, -45.0, 32.0, -12.0, -23.0, -34.0, -34.0, 21.0, 21.0, 10.0, 43.0, 65.0, 43.0, 10.0, -45.0, -12.0, 54.0, 10.0, -34.0, 21.0, 43.0, 21.0, 43.0, 54.0, 21.0, 21.0, 43.0, 54.0, 43.0, -45.0, 10.0, 32.0, 54.0, 76.0, 32.0, 32.0, -100.0, -111.0, 43.0, 10.0, 54.0, 32.0, 43.0, 65.0, 65.0, -23.0, -78.0, 21.0, 43.0, 21.0, 32.0, 10.0, 54.0, 43.0, -34.0, 65.0, 43.0, 43.0, 54.0, 10.0, 32.0, 76.0, -1.0, 21.0, 43.0, -34.0, 21.0, -1.0, -23.0, -12.0, -23.0, -12.0, 10.0, -1.0, 54.0, 32.0, 32.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20855640778048345, "mean_inference_ms": 10.45428294119956, "mean_action_processing_ms": 0.09230113832577354, "mean_env_wait_ms": 0.04604109015638162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056400299072265625, "StateBufferConnector_ms": 0.00360107421875, "ViewRequirementAgentConnector_ms": 0.1016082763671875}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 18.69, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 54.0, 76.0, 65.0, 65.0, 43.0, 32.0, 54.0, 32.0, 54.0, 43.0, 54.0, -34.0, 10.0, -56.0, -23.0, -45.0, 10.0, 32.0, 21.0, 10.0, -1.0, -45.0, 32.0, -12.0, -23.0, -34.0, -34.0, 21.0, 21.0, 10.0, 43.0, 65.0, 43.0, 10.0, -45.0, -12.0, 54.0, 10.0, -34.0, 21.0, 43.0, 21.0, 43.0, 54.0, 21.0, 21.0, 43.0, 54.0, 43.0, -45.0, 10.0, 32.0, 54.0, 76.0, 32.0, 32.0, -100.0, -111.0, 43.0, 10.0, 54.0, 32.0, 43.0, 65.0, 65.0, -23.0, -78.0, 21.0, 43.0, 21.0, 32.0, 10.0, 54.0, 43.0, -34.0, 65.0, 43.0, 43.0, 54.0, 10.0, 32.0, 76.0, -1.0, 21.0, 43.0, -34.0, 21.0, -1.0, -23.0, -12.0, -23.0, -12.0, 10.0, -1.0, 54.0, 32.0, 32.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20855640778048345, "mean_inference_ms": 10.45428294119956, "mean_action_processing_ms": 0.09230113832577354, "mean_env_wait_ms": 0.04604109015638162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056400299072265625, "StateBufferConnector_ms": 0.00360107421875, "ViewRequirementAgentConnector_ms": 0.1016082763671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 79301.328, "sample_time_ms": 44469.128, "learn_time_ms": 34822.742, "learn_throughput": 114.867, "synch_weights_time_ms": 8.754}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 947, "training_iteration": 18, "trial_id": "38794_00001", "date": "2023-06-01_20-51-17", "timestamp": 1685641877, "time_this_iter_s": 90.81034302711487, "time_total_s": 1551.238938331604, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1551.238938331604, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 55.278571428571425, "ram_util_percent": 78.2984126984127}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -23.0, "episode_reward_mean": 34.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 43.0, 54.0, -1.0, 21.0, -23.0, 32.0, 54.0, 65.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1916994506009653, "mean_inference_ms": 10.2447943049829, "mean_action_processing_ms": 0.08835187290821137, "mean_env_wait_ms": 0.044437419277719735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414485931396484, "StateBufferConnector_ms": 0.0033664703369140625, "ViewRequirementAgentConnector_ms": 0.09912490844726562}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 7.352097511291504, "policy_loss": -0.009334269911050797, "vf_loss": 7.361113548278809, "vf_explained_var": 0.009844682179391384, "kl": 0.006356863304972649, "entropy": 2.705772876739502, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 6.81, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 32.0, 32.0, -100.0, -111.0, 43.0, 10.0, 54.0, 32.0, 43.0, 65.0, 65.0, -23.0, -78.0, 21.0, 43.0, 21.0, 32.0, 10.0, 54.0, 43.0, -34.0, 65.0, 43.0, 43.0, 54.0, 10.0, 32.0, 76.0, -1.0, 21.0, 43.0, -34.0, 21.0, -1.0, -23.0, -12.0, -23.0, -12.0, 10.0, -1.0, 54.0, 32.0, 32.0, 43.0, 43.0, 43.0, -12.0, -34.0, -12.0, 43.0, 65.0, 54.0, 32.0, 65.0, 43.0, 10.0, 10.0, 65.0, 65.0, 54.0, -78.0, -100.0, -34.0, -34.0, -45.0, -23.0, 76.0, 76.0, 54.0, -23.0, 43.0, -1.0, -56.0, 21.0, -56.0, 10.0, -1.0, -12.0, -34.0, -67.0, -78.0, 10.0, -1.0, -12.0, 54.0, -12.0, -56.0, -56.0, 21.0, -89.0, 32.0, -23.0, -45.0, -12.0, -45.0, -100.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20872340398945383, "mean_inference_ms": 10.482461994145176, "mean_action_processing_ms": 0.09244414553808188, "mean_env_wait_ms": 0.04611269262490488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005493879318237305, "StateBufferConnector_ms": 0.0034570693969726562, "ViewRequirementAgentConnector_ms": 0.09654378890991211}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 6.81, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 32.0, 32.0, -100.0, -111.0, 43.0, 10.0, 54.0, 32.0, 43.0, 65.0, 65.0, -23.0, -78.0, 21.0, 43.0, 21.0, 32.0, 10.0, 54.0, 43.0, -34.0, 65.0, 43.0, 43.0, 54.0, 10.0, 32.0, 76.0, -1.0, 21.0, 43.0, -34.0, 21.0, -1.0, -23.0, -12.0, -23.0, -12.0, 10.0, -1.0, 54.0, 32.0, 32.0, 43.0, 43.0, 43.0, -12.0, -34.0, -12.0, 43.0, 65.0, 54.0, 32.0, 65.0, 43.0, 10.0, 10.0, 65.0, 65.0, 54.0, -78.0, -100.0, -34.0, -34.0, -45.0, -23.0, 76.0, 76.0, 54.0, -23.0, 43.0, -1.0, -56.0, 21.0, -56.0, 10.0, -1.0, -12.0, -34.0, -67.0, -78.0, 10.0, -1.0, -12.0, 54.0, -12.0, -56.0, -56.0, 21.0, -89.0, 32.0, -23.0, -45.0, -12.0, -45.0, -100.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20872340398945383, "mean_inference_ms": 10.482461994145176, "mean_action_processing_ms": 0.09244414553808188, "mean_env_wait_ms": 0.04611269262490488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005493879318237305, "StateBufferConnector_ms": 0.0034570693969726562, "ViewRequirementAgentConnector_ms": 0.09654378890991211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 79343.72, "sample_time_ms": 44473.589, "learn_time_ms": 34860.536, "learn_throughput": 114.743, "synch_weights_time_ms": 8.863}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 1000, "training_iteration": 19, "trial_id": "38794_00001", "date": "2023-06-01_20-52-42", "timestamp": 1685641962, "time_this_iter_s": 85.40497899055481, "time_total_s": 1636.6439173221588, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1636.6439173221588, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 50.72268907563025, "ram_util_percent": 76.73025210084033}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -4.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -1.0, -45.0, -111.0, -56.0, 43.0, 32.0, -45.0, 10.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1919525531191362, "mean_inference_ms": 10.252251341800754, "mean_action_processing_ms": 0.08841428574147439, "mean_env_wait_ms": 0.04446355145774807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00560760498046875, "StateBufferConnector_ms": 0.0030565261840820312, "ViewRequirementAgentConnector_ms": 0.09511947631835938}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 7.510810375213623, "policy_loss": -0.008524459786713123, "vf_loss": 7.518894672393799, "vf_explained_var": -0.012457803823053837, "kl": 0.008804542943835258, "entropy": 2.572740077972412, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -6.61, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 32.0, 65.0, 43.0, 10.0, 10.0, 65.0, 65.0, 54.0, -78.0, -100.0, -34.0, -34.0, -45.0, -23.0, 76.0, 76.0, 54.0, -23.0, 43.0, -1.0, -56.0, 21.0, -56.0, 10.0, -1.0, -12.0, -34.0, -67.0, -78.0, 10.0, -1.0, -12.0, 54.0, -12.0, -56.0, -56.0, 21.0, -89.0, 32.0, -23.0, -45.0, -12.0, -45.0, -100.0, -23.0, 10.0, 54.0, -23.0, 21.0, -23.0, -23.0, -133.0, -34.0, -100.0, -111.0, -45.0, -1.0, -12.0, -1.0, 10.0, 10.0, 10.0, 21.0, -1.0, -23.0, -23.0, 10.0, -122.0, -78.0, -12.0, 10.0, -34.0, 10.0, 10.0, 65.0, 54.0, 10.0, -100.0, -23.0, -89.0, -78.0, 43.0, -1.0, 43.0, 32.0, 21.0, 32.0, 43.0, 43.0, -1.0, -1.0, -34.0, 65.0, 65.0, -45.0, 43.0, 43.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20854065804738225, "mean_inference_ms": 10.480234519576593, "mean_action_processing_ms": 0.09241146067018463, "mean_env_wait_ms": 0.046083353408662917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005301237106323242, "StateBufferConnector_ms": 0.003222227096557617, "ViewRequirementAgentConnector_ms": 0.09357428550720215}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -6.61, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 32.0, 65.0, 43.0, 10.0, 10.0, 65.0, 65.0, 54.0, -78.0, -100.0, -34.0, -34.0, -45.0, -23.0, 76.0, 76.0, 54.0, -23.0, 43.0, -1.0, -56.0, 21.0, -56.0, 10.0, -1.0, -12.0, -34.0, -67.0, -78.0, 10.0, -1.0, -12.0, 54.0, -12.0, -56.0, -56.0, 21.0, -89.0, 32.0, -23.0, -45.0, -12.0, -45.0, -100.0, -23.0, 10.0, 54.0, -23.0, 21.0, -23.0, -23.0, -133.0, -34.0, -100.0, -111.0, -45.0, -1.0, -12.0, -1.0, 10.0, 10.0, 10.0, 21.0, -1.0, -23.0, -23.0, 10.0, -122.0, -78.0, -12.0, 10.0, -34.0, 10.0, 10.0, 65.0, 54.0, 10.0, -100.0, -23.0, -89.0, -78.0, 43.0, -1.0, 43.0, 32.0, 21.0, 32.0, 43.0, 43.0, -1.0, -1.0, -34.0, 65.0, 65.0, -45.0, 43.0, 43.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20854065804738225, "mean_inference_ms": 10.480234519576593, "mean_action_processing_ms": 0.09241146067018463, "mean_env_wait_ms": 0.046083353408662917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005301237106323242, "StateBufferConnector_ms": 0.003222227096557617, "ViewRequirementAgentConnector_ms": 0.09357428550720215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 79121.72, "sample_time_ms": 44688.994, "learn_time_ms": 34423.953, "learn_throughput": 116.198, "synch_weights_time_ms": 8.062}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 1052, "training_iteration": 20, "trial_id": "38794_00001", "date": "2023-06-01_20-54-09", "timestamp": 1685642049, "time_this_iter_s": 86.62194585800171, "time_total_s": 1723.2658631801605, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1723.2658631801605, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 50.36694214876033, "ram_util_percent": 77.02727272727275}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 13.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 21.0, 76.0, 32.0, 54.0, -56.0, -56.0, 43.0, -45.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1921954739624811, "mean_inference_ms": 10.25631557572389, "mean_action_processing_ms": 0.08850224326856526, "mean_env_wait_ms": 0.044525435197757424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005137920379638672, "StateBufferConnector_ms": 0.003254413604736328, "ViewRequirementAgentConnector_ms": 0.09492158889770508}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.728531837463379, "policy_loss": -0.010255680419504642, "vf_loss": 6.738282203674316, "vf_explained_var": -0.0002208775549661368, "kl": 0.010121838189661503, "entropy": 2.6153900623321533, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 3.51, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-133.0, -34.0, -100.0, -111.0, -45.0, -1.0, -12.0, -1.0, 10.0, 10.0, 10.0, 21.0, -1.0, -23.0, -23.0, 10.0, -122.0, -78.0, -12.0, 10.0, -34.0, 10.0, 10.0, 65.0, 54.0, 10.0, -100.0, -23.0, -89.0, -78.0, 43.0, -1.0, 43.0, 32.0, 21.0, 32.0, 43.0, 43.0, -1.0, -1.0, -34.0, 65.0, 65.0, -45.0, 43.0, 43.0, -12.0, -1.0, 10.0, -45.0, 65.0, 21.0, 76.0, 76.0, 65.0, 32.0, 76.0, 54.0, 21.0, 10.0, -34.0, 32.0, -45.0, 10.0, 32.0, 54.0, -23.0, 32.0, 65.0, 54.0, 10.0, -12.0, -23.0, -100.0, -34.0, 76.0, 43.0, 10.0, -1.0, -12.0, -23.0, -12.0, 32.0, 54.0, 54.0, -12.0, 32.0, 43.0, 43.0, 21.0, -56.0, -56.0, -12.0, -1.0, -34.0, 21.0, 54.0, -12.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20835642527684087, "mean_inference_ms": 10.482189277935511, "mean_action_processing_ms": 0.09237278629961543, "mean_env_wait_ms": 0.04605310016817285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190849304199219, "StateBufferConnector_ms": 0.003124713897705078, "ViewRequirementAgentConnector_ms": 0.09429669380187988}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 3.51, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-133.0, -34.0, -100.0, -111.0, -45.0, -1.0, -12.0, -1.0, 10.0, 10.0, 10.0, 21.0, -1.0, -23.0, -23.0, 10.0, -122.0, -78.0, -12.0, 10.0, -34.0, 10.0, 10.0, 65.0, 54.0, 10.0, -100.0, -23.0, -89.0, -78.0, 43.0, -1.0, 43.0, 32.0, 21.0, 32.0, 43.0, 43.0, -1.0, -1.0, -34.0, 65.0, 65.0, -45.0, 43.0, 43.0, -12.0, -1.0, 10.0, -45.0, 65.0, 21.0, 76.0, 76.0, 65.0, 32.0, 76.0, 54.0, 21.0, 10.0, -34.0, 32.0, -45.0, 10.0, 32.0, 54.0, -23.0, 32.0, 65.0, 54.0, 10.0, -12.0, -23.0, -100.0, -34.0, 76.0, 43.0, 10.0, -1.0, -12.0, -23.0, -12.0, 32.0, 54.0, 54.0, -12.0, 32.0, 43.0, 43.0, 21.0, -56.0, -56.0, -12.0, -1.0, -34.0, 21.0, 54.0, -12.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20835642527684087, "mean_inference_ms": 10.482189277935511, "mean_action_processing_ms": 0.09237278629961543, "mean_env_wait_ms": 0.04605310016817285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190849304199219, "StateBufferConnector_ms": 0.003124713897705078, "ViewRequirementAgentConnector_ms": 0.09429669380187988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 79059.584, "sample_time_ms": 44443.646, "learn_time_ms": 34606.939, "learn_throughput": 115.584, "synch_weights_time_ms": 8.269}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 1105, "training_iteration": 21, "trial_id": "38794_00001", "date": "2023-06-01_20-55-36", "timestamp": 1685642136, "time_this_iter_s": 87.71979999542236, "time_total_s": 1810.9856631755829, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1810.9856631755829, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 50.88360655737704, "ram_util_percent": 75.46065573770493}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -89.0, "episode_reward_mean": -2.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 21.0, -89.0, -1.0, -34.0, 54.0, 43.0, 21.0, -34.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19242968700995935, "mean_inference_ms": 10.275029642759744, "mean_action_processing_ms": 0.08863875486799265, "mean_env_wait_ms": 0.044571142092282086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005819797515869141, "StateBufferConnector_ms": 0.00293731689453125, "ViewRequirementAgentConnector_ms": 0.09494543075561523}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.549118995666504, "policy_loss": -0.010300652123987675, "vf_loss": 6.558835029602051, "vf_explained_var": 0.0026658549904823303, "kl": 0.011710205115377903, "entropy": 2.671196460723877, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 13.24, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 65.0, 32.0, 76.0, 54.0, 21.0, 10.0, -34.0, 32.0, -45.0, 10.0, 32.0, 54.0, -23.0, 32.0, 65.0, 54.0, 10.0, -12.0, -23.0, -100.0, -34.0, 76.0, 43.0, 10.0, -1.0, -12.0, -23.0, -12.0, 32.0, 54.0, 54.0, -12.0, 32.0, 43.0, 43.0, 21.0, -56.0, -56.0, -12.0, -1.0, -34.0, 21.0, 54.0, -12.0, 32.0, 10.0, -1.0, 21.0, 43.0, 43.0, 54.0, 43.0, 76.0, 65.0, 76.0, 76.0, 21.0, 65.0, 54.0, -1.0, 10.0, -34.0, 10.0, 43.0, -23.0, 10.0, -12.0, 54.0, 76.0, 54.0, 65.0, 32.0, 54.0, 43.0, 21.0, -18.0, -1.0, 21.0, -12.0, -23.0, -34.0, -56.0, -1.0, -12.0, -56.0, -133.0, -45.0, -67.0, -111.0, 10.0, 21.0, 10.0, -12.0, 76.0, -100.0, -23.0, 65.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2081904407219222, "mean_inference_ms": 10.484709833718252, "mean_action_processing_ms": 0.09233499201798287, "mean_env_wait_ms": 0.04602669810588183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051441192626953125, "StateBufferConnector_ms": 0.0030825138092041016, "ViewRequirementAgentConnector_ms": 0.09388065338134766}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 13.24, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 65.0, 32.0, 76.0, 54.0, 21.0, 10.0, -34.0, 32.0, -45.0, 10.0, 32.0, 54.0, -23.0, 32.0, 65.0, 54.0, 10.0, -12.0, -23.0, -100.0, -34.0, 76.0, 43.0, 10.0, -1.0, -12.0, -23.0, -12.0, 32.0, 54.0, 54.0, -12.0, 32.0, 43.0, 43.0, 21.0, -56.0, -56.0, -12.0, -1.0, -34.0, 21.0, 54.0, -12.0, 32.0, 10.0, -1.0, 21.0, 43.0, 43.0, 54.0, 43.0, 76.0, 65.0, 76.0, 76.0, 21.0, 65.0, 54.0, -1.0, 10.0, -34.0, 10.0, 43.0, -23.0, 10.0, -12.0, 54.0, 76.0, 54.0, 65.0, 32.0, 54.0, 43.0, 21.0, -18.0, -1.0, 21.0, -12.0, -23.0, -34.0, -56.0, -1.0, -12.0, -56.0, -133.0, -45.0, -67.0, -111.0, 10.0, 21.0, 10.0, -12.0, 76.0, -100.0, -23.0, 65.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2081904407219222, "mean_inference_ms": 10.484709833718252, "mean_action_processing_ms": 0.09233499201798287, "mean_env_wait_ms": 0.04602669810588183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051441192626953125, "StateBufferConnector_ms": 0.0030825138092041016, "ViewRequirementAgentConnector_ms": 0.09388065338134766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 79188.168, "sample_time_ms": 44490.907, "learn_time_ms": 34688.217, "learn_throughput": 115.313, "synch_weights_time_ms": 8.342}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 1157, "training_iteration": 22, "trial_id": "38794_00001", "date": "2023-06-01_20-57-03", "timestamp": 1685642223, "time_this_iter_s": 86.55114912986755, "time_total_s": 1897.5368123054504, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1897.5368123054504, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 49.97520661157025, "ram_util_percent": 75.8504132231405}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, -100.0, 10.0, 65.0, 32.0, 32.0, 32.0, 21.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19263034622195002, "mean_inference_ms": 10.295037157809281, "mean_action_processing_ms": 0.08874025165362993, "mean_env_wait_ms": 0.04464829447449335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056934356689453125, "StateBufferConnector_ms": 0.0028967857360839844, "ViewRequirementAgentConnector_ms": 0.09454488754272461}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 7.481686592102051, "policy_loss": -0.013788501732051373, "vf_loss": 7.494729042053223, "vf_explained_var": -0.0028085808735340834, "kl": 0.014911799691617489, "entropy": 2.590367555618286, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -221.0, "episode_reward_mean": 1.25, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 76.0, 65.0, 76.0, 76.0, 21.0, 65.0, 54.0, -1.0, 10.0, -34.0, 10.0, 43.0, -23.0, 10.0, -12.0, 54.0, 76.0, 54.0, 65.0, 32.0, 54.0, 43.0, 21.0, -18.0, -1.0, 21.0, -12.0, -23.0, -34.0, -56.0, -1.0, -12.0, -56.0, -133.0, -45.0, -67.0, -111.0, 10.0, 21.0, 10.0, -12.0, 76.0, -100.0, -23.0, 65.0, 65.0, 32.0, -1.0, -67.0, -221.0, -78.0, 21.0, 21.0, -34.0, -100.0, 21.0, -122.0, 32.0, 21.0, -34.0, 32.0, -56.0, -56.0, -1.0, -12.0, -12.0, 43.0, 43.0, -1.0, 43.0, 10.0, -1.0, 32.0, 10.0, -34.0, -23.0, -34.0, -12.0, 54.0, -78.0, -23.0, 21.0, 43.0, -23.0, 43.0, -56.0, -23.0, 10.0, 76.0, 32.0, 32.0, -12.0, 76.0, 10.0, -23.0, 10.0, 10.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2081809616799214, "mean_inference_ms": 10.493697358962946, "mean_action_processing_ms": 0.0923591369071082, "mean_env_wait_ms": 0.04603896384333643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051877498626708984, "StateBufferConnector_ms": 0.0032072067260742188, "ViewRequirementAgentConnector_ms": 0.09593963623046875}}, "episode_reward_max": 76.0, "episode_reward_min": -221.0, "episode_reward_mean": 1.25, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 76.0, 65.0, 76.0, 76.0, 21.0, 65.0, 54.0, -1.0, 10.0, -34.0, 10.0, 43.0, -23.0, 10.0, -12.0, 54.0, 76.0, 54.0, 65.0, 32.0, 54.0, 43.0, 21.0, -18.0, -1.0, 21.0, -12.0, -23.0, -34.0, -56.0, -1.0, -12.0, -56.0, -133.0, -45.0, -67.0, -111.0, 10.0, 21.0, 10.0, -12.0, 76.0, -100.0, -23.0, 65.0, 65.0, 32.0, -1.0, -67.0, -221.0, -78.0, 21.0, 21.0, -34.0, -100.0, 21.0, -122.0, 32.0, 21.0, -34.0, 32.0, -56.0, -56.0, -1.0, -12.0, -12.0, 43.0, 43.0, -1.0, 43.0, 10.0, -1.0, 32.0, 10.0, -34.0, -23.0, -34.0, -12.0, 54.0, -78.0, -23.0, 21.0, 43.0, -23.0, 43.0, -56.0, -23.0, 10.0, 76.0, 32.0, 32.0, -12.0, 76.0, 10.0, -23.0, 10.0, 10.0, 21.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2081809616799214, "mean_inference_ms": 10.493697358962946, "mean_action_processing_ms": 0.0923591369071082, "mean_env_wait_ms": 0.04603896384333643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051877498626708984, "StateBufferConnector_ms": 0.0032072067260742188, "ViewRequirementAgentConnector_ms": 0.09593963623046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 79621.685, "sample_time_ms": 44771.896, "learn_time_ms": 34841.856, "learn_throughput": 114.804, "synch_weights_time_ms": 7.252}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 1210, "training_iteration": 23, "trial_id": "38794_00001", "date": "2023-06-01_20-58-31", "timestamp": 1685642311, "time_this_iter_s": 88.30994606018066, "time_total_s": 1985.846758365631, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1985.846758365631, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 49.824390243902435, "ram_util_percent": 76.99837398373982}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 17.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -1.0, -1.0, -1.0, -45.0, 10.0, 54.0, 54.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19252530956378106, "mean_inference_ms": 10.28093495172116, "mean_action_processing_ms": 0.08862886857021848, "mean_env_wait_ms": 0.0446140749805702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005240440368652344, "StateBufferConnector_ms": 0.0029230117797851562, "ViewRequirementAgentConnector_ms": 0.08819580078125}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.2859039306640625, "policy_loss": -0.012085339985787868, "vf_loss": 6.297448635101318, "vf_explained_var": 0.003795657306909561, "kl": 0.010807025246322155, "entropy": 2.5886809825897217, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 9.23, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -34.0, -100.0, 21.0, -122.0, 32.0, 21.0, -34.0, 32.0, -56.0, -56.0, -1.0, -12.0, -12.0, 43.0, 43.0, -1.0, 43.0, 10.0, -1.0, 32.0, 10.0, -34.0, -23.0, -34.0, -12.0, 54.0, -78.0, -23.0, 21.0, 43.0, -23.0, 43.0, -56.0, -23.0, 10.0, 76.0, 32.0, 32.0, -12.0, 76.0, 10.0, -23.0, 10.0, 10.0, 21.0, 21.0, -34.0, 10.0, -23.0, 10.0, 32.0, 76.0, 10.0, 65.0, 54.0, 32.0, 65.0, -144.0, -56.0, -12.0, 32.0, 54.0, 43.0, 54.0, 32.0, 32.0, 43.0, -111.0, 21.0, 21.0, -56.0, -122.0, -100.0, -12.0, 21.0, -89.0, 32.0, 10.0, 43.0, 43.0, 65.0, 21.0, 54.0, 43.0, -12.0, -1.0, 32.0, 54.0, 32.0, 21.0, 32.0, 54.0, 65.0, 76.0, 76.0, 76.0, 76.0, 21.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20826559511838433, "mean_inference_ms": 10.508659739602152, "mean_action_processing_ms": 0.09241681418951227, "mean_env_wait_ms": 0.046073305723111385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005218029022216797, "StateBufferConnector_ms": 0.003201007843017578, "ViewRequirementAgentConnector_ms": 0.09696173667907715}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 9.23, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -34.0, -100.0, 21.0, -122.0, 32.0, 21.0, -34.0, 32.0, -56.0, -56.0, -1.0, -12.0, -12.0, 43.0, 43.0, -1.0, 43.0, 10.0, -1.0, 32.0, 10.0, -34.0, -23.0, -34.0, -12.0, 54.0, -78.0, -23.0, 21.0, 43.0, -23.0, 43.0, -56.0, -23.0, 10.0, 76.0, 32.0, 32.0, -12.0, 76.0, 10.0, -23.0, 10.0, 10.0, 21.0, 21.0, -34.0, 10.0, -23.0, 10.0, 32.0, 76.0, 10.0, 65.0, 54.0, 32.0, 65.0, -144.0, -56.0, -12.0, 32.0, 54.0, 43.0, 54.0, 32.0, 32.0, 43.0, -111.0, 21.0, 21.0, -56.0, -122.0, -100.0, -12.0, 21.0, -89.0, 32.0, 10.0, 43.0, 43.0, 65.0, 21.0, 54.0, 43.0, -12.0, -1.0, 32.0, 54.0, 32.0, 21.0, 32.0, 54.0, 65.0, 76.0, 76.0, 76.0, 76.0, 21.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20826559511838433, "mean_inference_ms": 10.508659739602152, "mean_action_processing_ms": 0.09241681418951227, "mean_env_wait_ms": 0.046073305723111385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005218029022216797, "StateBufferConnector_ms": 0.003201007843017578, "ViewRequirementAgentConnector_ms": 0.09696173667907715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 79707.58, "sample_time_ms": 44985.881, "learn_time_ms": 34713.653, "learn_throughput": 115.228, "synch_weights_time_ms": 7.349}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 1263, "training_iteration": 24, "trial_id": "38794_00001", "date": "2023-06-01_20-59-58", "timestamp": 1685642398, "time_this_iter_s": 87.04872584342957, "time_total_s": 2072.8954842090607, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2072.8954842090607, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 51.958196721311474, "ram_util_percent": 74.9467213114754}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": -10.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 10.0, -56.0, -45.0, 10.0, -23.0, -1.0, -1.0, -23.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19245901570044838, "mean_inference_ms": 10.26453014976269, "mean_action_processing_ms": 0.08856742659729848, "mean_env_wait_ms": 0.044570785529688406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049495697021484375, "StateBufferConnector_ms": 0.0031065940856933594, "ViewRequirementAgentConnector_ms": 0.08844375610351562}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.944262981414795, "policy_loss": -0.010584180243313313, "vf_loss": 6.954451084136963, "vf_explained_var": 0.0003776919620577246, "kl": 0.007924990728497505, "entropy": 2.448113203048706, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 14.18, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 10.0, 65.0, 54.0, 32.0, 65.0, -144.0, -56.0, -12.0, 32.0, 54.0, 43.0, 54.0, 32.0, 32.0, 43.0, -111.0, 21.0, 21.0, -56.0, -122.0, -100.0, -12.0, 21.0, -89.0, 32.0, 10.0, 43.0, 43.0, 65.0, 21.0, 54.0, 43.0, -12.0, -1.0, 32.0, 54.0, 32.0, 21.0, 32.0, 54.0, 65.0, 76.0, 76.0, 76.0, 76.0, 21.0, 65.0, 54.0, -34.0, 32.0, 32.0, 21.0, -12.0, 43.0, 76.0, 65.0, -45.0, -23.0, -12.0, 43.0, 21.0, -34.0, 54.0, 65.0, 43.0, -34.0, -1.0, 43.0, 32.0, 65.0, 32.0, 10.0, -133.0, -23.0, 43.0, 21.0, -1.0, -12.0, 32.0, 21.0, 54.0, -1.0, -45.0, -12.0, -23.0, 43.0, 43.0, -23.0, -1.0, 32.0, -23.0, -111.0, 43.0, 10.0, 10.0, -12.0, 32.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20820799530847647, "mean_inference_ms": 10.510510723156344, "mean_action_processing_ms": 0.09240301389105919, "mean_env_wait_ms": 0.04607400079859611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118131637573242, "StateBufferConnector_ms": 0.0031821727752685547, "ViewRequirementAgentConnector_ms": 0.09637594223022461}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 14.18, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 10.0, 65.0, 54.0, 32.0, 65.0, -144.0, -56.0, -12.0, 32.0, 54.0, 43.0, 54.0, 32.0, 32.0, 43.0, -111.0, 21.0, 21.0, -56.0, -122.0, -100.0, -12.0, 21.0, -89.0, 32.0, 10.0, 43.0, 43.0, 65.0, 21.0, 54.0, 43.0, -12.0, -1.0, 32.0, 54.0, 32.0, 21.0, 32.0, 54.0, 65.0, 76.0, 76.0, 76.0, 76.0, 21.0, 65.0, 54.0, -34.0, 32.0, 32.0, 21.0, -12.0, 43.0, 76.0, 65.0, -45.0, -23.0, -12.0, 43.0, 21.0, -34.0, 54.0, 65.0, 43.0, -34.0, -1.0, 43.0, 32.0, 65.0, 32.0, 10.0, -133.0, -23.0, 43.0, 21.0, -1.0, -12.0, 32.0, 21.0, 54.0, -1.0, -45.0, -12.0, -23.0, 43.0, 43.0, -23.0, -1.0, 32.0, -23.0, -111.0, 43.0, 10.0, 10.0, -12.0, 32.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20820799530847647, "mean_inference_ms": 10.510510723156344, "mean_action_processing_ms": 0.09240301389105919, "mean_env_wait_ms": 0.04607400079859611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118131637573242, "StateBufferConnector_ms": 0.0031821727752685547, "ViewRequirementAgentConnector_ms": 0.09637594223022461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 78797.981, "sample_time_ms": 44117.385, "learn_time_ms": 34672.549, "learn_throughput": 115.365, "synch_weights_time_ms": 7.365}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 1315, "training_iteration": 25, "trial_id": "38794_00001", "date": "2023-06-01_21-01-22", "timestamp": 1685642482, "time_this_iter_s": 83.53028297424316, "time_total_s": 2156.425767183304, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2156.425767183304, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 48.65641025641026, "ram_util_percent": 75.39316239316241}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -12.0, "episode_reward_mean": 19.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 65.0, 65.0, 21.0, 32.0, -12.0, 43.0, -12.0, -1.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19214353691221914, "mean_inference_ms": 10.24423022724092, "mean_action_processing_ms": 0.08842421593884939, "mean_env_wait_ms": 0.04450312438242095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00507354736328125, "StateBufferConnector_ms": 0.0029611587524414062, "ViewRequirementAgentConnector_ms": 0.08435726165771484}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.76124382019043, "policy_loss": -0.01586603745818138, "vf_loss": 6.776427745819092, "vf_explained_var": 0.0056153759360313416, "kl": 0.013646353967487812, "entropy": 2.595616102218628, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 7.91, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 43.0, 76.0, 65.0, -45.0, -23.0, -12.0, 43.0, 21.0, -34.0, 54.0, 65.0, 43.0, -34.0, -1.0, 43.0, 32.0, 65.0, 32.0, 10.0, -133.0, -23.0, 43.0, 21.0, -1.0, -12.0, 32.0, 21.0, 54.0, -1.0, -45.0, -12.0, -23.0, 43.0, 43.0, -23.0, -1.0, 32.0, -23.0, -111.0, 43.0, 10.0, 10.0, -12.0, 32.0, -23.0, 10.0, 43.0, 43.0, 10.0, -12.0, -45.0, 54.0, -12.0, -122.0, -23.0, 32.0, 43.0, 21.0, 21.0, -78.0, -122.0, -34.0, -12.0, -78.0, 21.0, 43.0, 65.0, 43.0, 76.0, 65.0, 32.0, 65.0, 21.0, 10.0, 54.0, -45.0, -78.0, -45.0, 76.0, 32.0, 76.0, 54.0, 21.0, 43.0, 32.0, -1.0, 21.0, -12.0, 32.0, -34.0, -12.0, 10.0, 10.0, 32.0, -23.0, -56.0, 32.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20776370199041552, "mean_inference_ms": 10.486686131498223, "mean_action_processing_ms": 0.09216094602278131, "mean_env_wait_ms": 0.04594270164944905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004817008972167969, "StateBufferConnector_ms": 0.0030508041381835938, "ViewRequirementAgentConnector_ms": 0.0905001163482666}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 7.91, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, 43.0, 76.0, 65.0, -45.0, -23.0, -12.0, 43.0, 21.0, -34.0, 54.0, 65.0, 43.0, -34.0, -1.0, 43.0, 32.0, 65.0, 32.0, 10.0, -133.0, -23.0, 43.0, 21.0, -1.0, -12.0, 32.0, 21.0, 54.0, -1.0, -45.0, -12.0, -23.0, 43.0, 43.0, -23.0, -1.0, 32.0, -23.0, -111.0, 43.0, 10.0, 10.0, -12.0, 32.0, -23.0, 10.0, 43.0, 43.0, 10.0, -12.0, -45.0, 54.0, -12.0, -122.0, -23.0, 32.0, 43.0, 21.0, 21.0, -78.0, -122.0, -34.0, -12.0, -78.0, 21.0, 43.0, 65.0, 43.0, 76.0, 65.0, 32.0, 65.0, 21.0, 10.0, 54.0, -45.0, -78.0, -45.0, 76.0, 32.0, 76.0, 54.0, 21.0, 43.0, 32.0, -1.0, 21.0, -12.0, 32.0, -34.0, -12.0, 10.0, 10.0, 32.0, -23.0, -56.0, 32.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20776370199041552, "mean_inference_ms": 10.486686131498223, "mean_action_processing_ms": 0.09216094602278131, "mean_env_wait_ms": 0.04594270164944905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004817008972167969, "StateBufferConnector_ms": 0.0030508041381835938, "ViewRequirementAgentConnector_ms": 0.0905001163482666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 78441.896, "sample_time_ms": 43796.49, "learn_time_ms": 34637.246, "learn_throughput": 115.483, "synch_weights_time_ms": 7.482}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 1368, "training_iteration": 26, "trial_id": "38794_00001", "date": "2023-06-01_21-02-43", "timestamp": 1685642563, "time_this_iter_s": 81.35893297195435, "time_total_s": 2237.784700155258, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2237.784700155258, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 47.34778761061946, "ram_util_percent": 75.96017699115045}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -34.0, "episode_reward_mean": 10.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -34.0, -1.0, 32.0, 54.0, -12.0, 10.0, 21.0, -1.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19266275302062902, "mean_inference_ms": 10.300941991501631, "mean_action_processing_ms": 0.08875712230246083, "mean_env_wait_ms": 0.044643817940834614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005662441253662109, "StateBufferConnector_ms": 0.0035881996154785156, "ViewRequirementAgentConnector_ms": 0.09695768356323242}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.495636940002441, "policy_loss": -0.010725443251430988, "vf_loss": 5.505875110626221, "vf_explained_var": -0.0007544321124441922, "kl": 0.009740752167999744, "entropy": 2.5054657459259033, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 19.01, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -122.0, -23.0, 32.0, 43.0, 21.0, 21.0, -78.0, -122.0, -34.0, -12.0, -78.0, 21.0, 43.0, 65.0, 43.0, 76.0, 65.0, 32.0, 65.0, 21.0, 10.0, 54.0, -45.0, -78.0, -45.0, 76.0, 32.0, 76.0, 54.0, 21.0, 43.0, 32.0, -1.0, 21.0, -12.0, 32.0, -34.0, -12.0, 10.0, 10.0, 32.0, -23.0, -56.0, 32.0, 21.0, -1.0, 15.0, 43.0, 54.0, 65.0, 43.0, 54.0, 32.0, 70.0, 76.0, 65.0, 21.0, 43.0, 43.0, 54.0, 65.0, 65.0, 76.0, 76.0, 65.0, 76.0, -1.0, 54.0, -23.0, -45.0, 54.0, 21.0, -12.0, -67.0, 10.0, -45.0, -89.0, 54.0, 32.0, 43.0, 10.0, -12.0, 54.0, 43.0, 54.0, 21.0, 54.0, 65.0, 43.0, 32.0, 54.0, 21.0, 54.0, 43.0, 21.0, -56.0, -1.0, -1.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20745642228125655, "mean_inference_ms": 10.470630855663071, "mean_action_processing_ms": 0.09199488470394095, "mean_env_wait_ms": 0.045851507732569095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005160093307495117, "StateBufferConnector_ms": 0.003014087677001953, "ViewRequirementAgentConnector_ms": 0.09184694290161133}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 19.01, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -122.0, -23.0, 32.0, 43.0, 21.0, 21.0, -78.0, -122.0, -34.0, -12.0, -78.0, 21.0, 43.0, 65.0, 43.0, 76.0, 65.0, 32.0, 65.0, 21.0, 10.0, 54.0, -45.0, -78.0, -45.0, 76.0, 32.0, 76.0, 54.0, 21.0, 43.0, 32.0, -1.0, 21.0, -12.0, 32.0, -34.0, -12.0, 10.0, 10.0, 32.0, -23.0, -56.0, 32.0, 21.0, -1.0, 15.0, 43.0, 54.0, 65.0, 43.0, 54.0, 32.0, 70.0, 76.0, 65.0, 21.0, 43.0, 43.0, 54.0, 65.0, 65.0, 76.0, 76.0, 65.0, 76.0, -1.0, 54.0, -23.0, -45.0, 54.0, 21.0, -12.0, -67.0, 10.0, -45.0, -89.0, 54.0, 32.0, 43.0, 10.0, -12.0, 54.0, 43.0, 54.0, 21.0, 54.0, 65.0, 43.0, 32.0, 54.0, 21.0, 54.0, 43.0, 21.0, -56.0, -1.0, -1.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20745642228125655, "mean_inference_ms": 10.470630855663071, "mean_action_processing_ms": 0.09199488470394095, "mean_env_wait_ms": 0.045851507732569095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005160093307495117, "StateBufferConnector_ms": 0.003014087677001953, "ViewRequirementAgentConnector_ms": 0.09184694290161133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 78468.128, "sample_time_ms": 43669.738, "learn_time_ms": 34790.376, "learn_throughput": 114.974, "synch_weights_time_ms": 7.365}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1421, "training_iteration": 27, "trial_id": "38794_00001", "date": "2023-06-01_21-04-14", "timestamp": 1685642654, "time_this_iter_s": 90.73731589317322, "time_total_s": 2328.5220160484314, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2328.5220160484314, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 51.04285714285714, "ram_util_percent": 76.76904761904761}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -12.0, "episode_reward_mean": 22.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 65.0, 32.0, 21.0, -12.0, 10.0, 21.0, 21.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19298593081857057, "mean_inference_ms": 10.314879888632507, "mean_action_processing_ms": 0.08886948624901247, "mean_env_wait_ms": 0.04471632822704553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059223175048828125, "StateBufferConnector_ms": 0.003299713134765625, "ViewRequirementAgentConnector_ms": 0.1007986068725586}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.372179985046387, "policy_loss": -0.012824608944356441, "vf_loss": 6.384466648101807, "vf_explained_var": 0.01301057543605566, "kl": 0.010759049095213413, "entropy": 2.5195000171661377, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 24.29, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 70.0, 76.0, 65.0, 21.0, 43.0, 43.0, 54.0, 65.0, 65.0, 76.0, 76.0, 65.0, 76.0, -1.0, 54.0, -23.0, -45.0, 54.0, 21.0, -12.0, -67.0, 10.0, -45.0, -89.0, 54.0, 32.0, 43.0, 10.0, -12.0, 54.0, 43.0, 54.0, 21.0, 54.0, 65.0, 43.0, 32.0, 54.0, 21.0, 54.0, 43.0, 21.0, -56.0, -1.0, -1.0, -1.0, 65.0, 43.0, 21.0, 10.0, -1.0, 43.0, -1.0, -23.0, -56.0, -111.0, -78.0, -12.0, 21.0, 43.0, 54.0, 65.0, 76.0, 54.0, 76.0, 76.0, 54.0, 21.0, 21.0, 43.0, -12.0, -23.0, 21.0, -1.0, 10.0, -12.0, 32.0, 54.0, 65.0, 76.0, -1.0, 76.0, 43.0, -29.0, 43.0, 43.0, -45.0, -78.0, 43.0, 43.0, 54.0, 32.0, 10.0, -67.0, 32.0, 54.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20747635128519434, "mean_inference_ms": 10.47880393518958, "mean_action_processing_ms": 0.09202728893748643, "mean_env_wait_ms": 0.045869533086087697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005433320999145508, "StateBufferConnector_ms": 0.0031654834747314453, "ViewRequirementAgentConnector_ms": 0.09767866134643555}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 24.29, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 32.0, 70.0, 76.0, 65.0, 21.0, 43.0, 43.0, 54.0, 65.0, 65.0, 76.0, 76.0, 65.0, 76.0, -1.0, 54.0, -23.0, -45.0, 54.0, 21.0, -12.0, -67.0, 10.0, -45.0, -89.0, 54.0, 32.0, 43.0, 10.0, -12.0, 54.0, 43.0, 54.0, 21.0, 54.0, 65.0, 43.0, 32.0, 54.0, 21.0, 54.0, 43.0, 21.0, -56.0, -1.0, -1.0, -1.0, 65.0, 43.0, 21.0, 10.0, -1.0, 43.0, -1.0, -23.0, -56.0, -111.0, -78.0, -12.0, 21.0, 43.0, 54.0, 65.0, 76.0, 54.0, 76.0, 76.0, 54.0, 21.0, 21.0, 43.0, -12.0, -23.0, 21.0, -1.0, 10.0, -12.0, 32.0, 54.0, 65.0, 76.0, -1.0, 76.0, 43.0, -29.0, 43.0, 43.0, -45.0, -78.0, 43.0, 43.0, 54.0, 32.0, 10.0, -67.0, 32.0, 54.0, 54.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20747635128519434, "mean_inference_ms": 10.47880393518958, "mean_action_processing_ms": 0.09202728893748643, "mean_env_wait_ms": 0.045869533086087697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005433320999145508, "StateBufferConnector_ms": 0.0031654834747314453, "ViewRequirementAgentConnector_ms": 0.09767866134643555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 78247.711, "sample_time_ms": 43344.475, "learn_time_ms": 34895.243, "learn_throughput": 114.629, "synch_weights_time_ms": 7.368}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1473, "training_iteration": 28, "trial_id": "38794_00001", "date": "2023-06-01_21-05-43", "timestamp": 1685642743, "time_this_iter_s": 88.69223594665527, "time_total_s": 2417.2142519950867, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2417.2142519950867, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 51.359677419354824, "ram_util_percent": 76.34435483870966}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": 27.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 26.0, 76.0, 54.0, 54.0, -45.0, 65.0, 54.0, 10.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19342716189868586, "mean_inference_ms": 10.362335982348004, "mean_action_processing_ms": 0.08908518158660969, "mean_env_wait_ms": 0.044825407950416576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006144046783447266, "StateBufferConnector_ms": 0.0032591819763183594, "ViewRequirementAgentConnector_ms": 0.10226011276245117}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.99105167388916, "policy_loss": -0.011656437069177628, "vf_loss": 6.002169609069824, "vf_explained_var": 0.0037146613467484713, "kl": 0.010770807974040508, "entropy": 2.5698745250701904, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 23.41, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -1.0, -23.0, -56.0, -111.0, -78.0, -12.0, 21.0, 43.0, 54.0, 65.0, 76.0, 54.0, 76.0, 76.0, 54.0, 21.0, 21.0, 43.0, -12.0, -23.0, 21.0, -1.0, 10.0, -12.0, 32.0, 54.0, 65.0, 76.0, -1.0, 76.0, 43.0, -29.0, 43.0, 43.0, -45.0, -78.0, 43.0, 43.0, 54.0, 32.0, 10.0, -67.0, 32.0, 54.0, 54.0, 43.0, -1.0, -23.0, 10.0, -155.0, -45.0, -45.0, 10.0, -23.0, -23.0, -12.0, -12.0, -45.0, 32.0, 32.0, 54.0, 65.0, 65.0, 76.0, 65.0, 54.0, 54.0, 54.0, 65.0, 43.0, 54.0, 59.0, 76.0, 65.0, 21.0, 76.0, 54.0, 32.0, 32.0, 32.0, -1.0, 32.0, 43.0, 43.0, 76.0, 54.0, 65.0, 10.0, 76.0, 76.0, 54.0, 43.0, 32.0, -34.0, 32.0, -23.0, 43.0, -23.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20741286479131837, "mean_inference_ms": 10.482381051155453, "mean_action_processing_ms": 0.09201119466929082, "mean_env_wait_ms": 0.04586344778348616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005199909210205078, "StateBufferConnector_ms": 0.0031464099884033203, "ViewRequirementAgentConnector_ms": 0.09630560874938965}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 23.41, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, -1.0, -23.0, -56.0, -111.0, -78.0, -12.0, 21.0, 43.0, 54.0, 65.0, 76.0, 54.0, 76.0, 76.0, 54.0, 21.0, 21.0, 43.0, -12.0, -23.0, 21.0, -1.0, 10.0, -12.0, 32.0, 54.0, 65.0, 76.0, -1.0, 76.0, 43.0, -29.0, 43.0, 43.0, -45.0, -78.0, 43.0, 43.0, 54.0, 32.0, 10.0, -67.0, 32.0, 54.0, 54.0, 43.0, -1.0, -23.0, 10.0, -155.0, -45.0, -45.0, 10.0, -23.0, -23.0, -12.0, -12.0, -45.0, 32.0, 32.0, 54.0, 65.0, 65.0, 76.0, 65.0, 54.0, 54.0, 54.0, 65.0, 43.0, 54.0, 59.0, 76.0, 65.0, 21.0, 76.0, 54.0, 32.0, 32.0, 32.0, -1.0, 32.0, 43.0, 43.0, 76.0, 54.0, 65.0, 10.0, 76.0, 76.0, 54.0, 43.0, 32.0, -34.0, 32.0, -23.0, 43.0, -23.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20741286479131837, "mean_inference_ms": 10.482381051155453, "mean_action_processing_ms": 0.09201119466929082, "mean_env_wait_ms": 0.04586344778348616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005199909210205078, "StateBufferConnector_ms": 0.0031464099884033203, "ViewRequirementAgentConnector_ms": 0.09630560874938965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 78144.098, "sample_time_ms": 43333.35, "learn_time_ms": 34802.806, "learn_throughput": 114.933, "synch_weights_time_ms": 7.344}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1526, "training_iteration": 29, "trial_id": "38794_00001", "date": "2023-06-01_21-07-07", "timestamp": 1685642827, "time_this_iter_s": 84.3963987827301, "time_total_s": 2501.6106507778168, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2501.6106507778168, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 48.474576271186436, "ram_util_percent": 77.65932203389832}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -34.0, "episode_reward_mean": 34.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -34.0, 32.0, 65.0, 65.0, 43.0, 10.0, 43.0, 65.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19330800842242327, "mean_inference_ms": 10.351650987056875, "mean_action_processing_ms": 0.08899722934360019, "mean_env_wait_ms": 0.044761543278944896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005915164947509766, "StateBufferConnector_ms": 0.0029921531677246094, "ViewRequirementAgentConnector_ms": 0.08898496627807617}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.898940086364746, "policy_loss": -0.011738413013517857, "vf_loss": 6.909937381744385, "vf_explained_var": -0.0035016450565308332, "kl": 0.014829481951892376, "entropy": 2.52667236328125, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 20.76, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, 10.0, -23.0, -23.0, -12.0, -12.0, -45.0, 32.0, 32.0, 54.0, 65.0, 65.0, 76.0, 65.0, 54.0, 54.0, 54.0, 65.0, 43.0, 54.0, 59.0, 76.0, 65.0, 21.0, 76.0, 54.0, 32.0, 32.0, 32.0, -1.0, 32.0, 43.0, 43.0, 76.0, 54.0, 65.0, 10.0, 76.0, 76.0, 54.0, 43.0, 32.0, -34.0, 32.0, -23.0, 43.0, -23.0, 21.0, 21.0, 54.0, -12.0, -45.0, 21.0, 59.0, 54.0, 43.0, 21.0, -34.0, 43.0, -45.0, 10.0, 76.0, 43.0, -12.0, 65.0, 10.0, 43.0, -1.0, 54.0, 32.0, 65.0, 54.0, 10.0, 59.0, 43.0, 43.0, 10.0, -1.0, 10.0, 21.0, 10.0, 43.0, 10.0, 21.0, 43.0, -89.0, -23.0, -84.0, -34.0, -45.0, 21.0, 10.0, 21.0, 21.0, -1.0, -111.0, -56.0, -67.0, -67.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20741151366154698, "mean_inference_ms": 10.493264136090822, "mean_action_processing_ms": 0.0920259429036933, "mean_env_wait_ms": 0.04588724953356296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052318572998046875, "StateBufferConnector_ms": 0.0031566619873046875, "ViewRequirementAgentConnector_ms": 0.0962376594543457}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 20.76, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, 10.0, -23.0, -23.0, -12.0, -12.0, -45.0, 32.0, 32.0, 54.0, 65.0, 65.0, 76.0, 65.0, 54.0, 54.0, 54.0, 65.0, 43.0, 54.0, 59.0, 76.0, 65.0, 21.0, 76.0, 54.0, 32.0, 32.0, 32.0, -1.0, 32.0, 43.0, 43.0, 76.0, 54.0, 65.0, 10.0, 76.0, 76.0, 54.0, 43.0, 32.0, -34.0, 32.0, -23.0, 43.0, -23.0, 21.0, 21.0, 54.0, -12.0, -45.0, 21.0, 59.0, 54.0, 43.0, 21.0, -34.0, 43.0, -45.0, 10.0, 76.0, 43.0, -12.0, 65.0, 10.0, 43.0, -1.0, 54.0, 32.0, 65.0, 54.0, 10.0, 59.0, 43.0, 43.0, 10.0, -1.0, 10.0, 21.0, 10.0, 43.0, 10.0, 21.0, 43.0, -89.0, -23.0, -84.0, -34.0, -45.0, 21.0, 10.0, 21.0, 21.0, -1.0, -111.0, -56.0, -67.0, -67.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20741151366154698, "mean_inference_ms": 10.493264136090822, "mean_action_processing_ms": 0.0920259429036933, "mean_env_wait_ms": 0.04588724953356296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052318572998046875, "StateBufferConnector_ms": 0.0031566619873046875, "ViewRequirementAgentConnector_ms": 0.0962376594543457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 78610.475, "sample_time_ms": 43630.788, "learn_time_ms": 34971.6, "learn_throughput": 114.379, "synch_weights_time_ms": 7.453}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1578, "training_iteration": 30, "trial_id": "38794_00001", "date": "2023-06-01_21-08-38", "timestamp": 1685642918, "time_this_iter_s": 91.0221917629242, "time_total_s": 2592.632842540741, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2592.632842540741, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 50.899212598425194, "ram_util_percent": 77.2732283464567}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -34.0, "episode_reward_mean": 17.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 54.0, 43.0, -23.0, 54.0, 10.0, -1.0, -34.0, 21.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19292672347002446, "mean_inference_ms": 10.322526377473144, "mean_action_processing_ms": 0.08876596614898684, "mean_env_wait_ms": 0.04459936202602048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004897117614746094, "StateBufferConnector_ms": 0.003025531768798828, "ViewRequirementAgentConnector_ms": 0.09264230728149414}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.359617710113525, "policy_loss": -0.012401366606354713, "vf_loss": 6.371423244476318, "vf_explained_var": 0.005386085249483585, "kl": 0.011911487206816673, "entropy": 2.458953380584717, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 15.59, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, 54.0, 43.0, 21.0, -34.0, 43.0, -45.0, 10.0, 76.0, 43.0, -12.0, 65.0, 10.0, 43.0, -1.0, 54.0, 32.0, 65.0, 54.0, 10.0, 59.0, 43.0, 43.0, 10.0, -1.0, 10.0, 21.0, 10.0, 43.0, 10.0, 21.0, 43.0, -89.0, -23.0, -84.0, -34.0, -45.0, 21.0, 10.0, 21.0, 21.0, -1.0, -111.0, -56.0, -67.0, -67.0, 10.0, 65.0, 32.0, 43.0, 76.0, 26.0, 43.0, 54.0, 43.0, -12.0, -23.0, -1.0, 21.0, 43.0, 76.0, 65.0, 65.0, 65.0, 43.0, 65.0, 65.0, 21.0, 76.0, 65.0, 76.0, 43.0, 32.0, -12.0, 32.0, -45.0, 10.0, 43.0, -1.0, 43.0, -100.0, -67.0, 10.0, 10.0, 32.0, -89.0, 21.0, 10.0, 10.0, 43.0, 54.0, -45.0, 21.0, 21.0, 21.0, -12.0, 21.0, -34.0, -12.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20726456978802915, "mean_inference_ms": 10.495748785082178, "mean_action_processing_ms": 0.09194782733430643, "mean_env_wait_ms": 0.04585763384589895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004981040954589844, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.0931696891784668}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 15.59, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 54.0, 43.0, 21.0, -34.0, 43.0, -45.0, 10.0, 76.0, 43.0, -12.0, 65.0, 10.0, 43.0, -1.0, 54.0, 32.0, 65.0, 54.0, 10.0, 59.0, 43.0, 43.0, 10.0, -1.0, 10.0, 21.0, 10.0, 43.0, 10.0, 21.0, 43.0, -89.0, -23.0, -84.0, -34.0, -45.0, 21.0, 10.0, 21.0, 21.0, -1.0, -111.0, -56.0, -67.0, -67.0, 10.0, 65.0, 32.0, 43.0, 76.0, 26.0, 43.0, 54.0, 43.0, -12.0, -23.0, -1.0, 21.0, 43.0, 76.0, 65.0, 65.0, 65.0, 43.0, 65.0, 65.0, 21.0, 76.0, 65.0, 76.0, 43.0, 32.0, -12.0, 32.0, -45.0, 10.0, 43.0, -1.0, 43.0, -100.0, -67.0, 10.0, 10.0, 32.0, -89.0, 21.0, 10.0, 10.0, 43.0, 54.0, -45.0, 21.0, 21.0, 21.0, -12.0, 21.0, -34.0, -12.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20726456978802915, "mean_inference_ms": 10.495748785082178, "mean_action_processing_ms": 0.09194782733430643, "mean_env_wait_ms": 0.04585763384589895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004981040954589844, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.0931696891784668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 78028.714, "sample_time_ms": 43387.09, "learn_time_ms": 34633.738, "learn_throughput": 115.494, "synch_weights_time_ms": 7.275}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1631, "training_iteration": 31, "trial_id": "38794_00001", "date": "2023-06-01_21-09-59", "timestamp": 1685642999, "time_this_iter_s": 81.17661499977112, "time_total_s": 2673.809457540512, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2673.809457540512, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 45.7858407079646, "ram_util_percent": 76.69734513274335}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -40.0, "episode_reward_mean": 13.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.0, -23.0, 32.0, 76.0, 54.0, 10.0, 21.0, -1.0, -23.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19306886755397196, "mean_inference_ms": 10.328895554260805, "mean_action_processing_ms": 0.0888100531505012, "mean_env_wait_ms": 0.044642013917456126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005564689636230469, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.08648872375488281}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.681997776031494, "policy_loss": -0.014775549061596394, "vf_loss": 6.696171283721924, "vf_explained_var": 0.015217016451060772, "kl": 0.012045947834849358, "entropy": 2.336843967437744, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, -12.0, -23.0, -1.0, 21.0, 43.0, 76.0, 65.0, 65.0, 65.0, 43.0, 65.0, 65.0, 21.0, 76.0, 65.0, 76.0, 43.0, 32.0, -12.0, 32.0, -45.0, 10.0, 43.0, -1.0, 43.0, -100.0, -67.0, 10.0, 10.0, 32.0, -89.0, 21.0, 10.0, 10.0, 43.0, 54.0, -45.0, 21.0, 21.0, 21.0, -12.0, 21.0, -34.0, -12.0, -1.0, 10.0, 54.0, 32.0, 43.0, 65.0, 10.0, 21.0, 54.0, -12.0, -1.0, 32.0, 10.0, 43.0, 21.0, -23.0, 54.0, 65.0, 43.0, 54.0, -78.0, -1.0, -1.0, 32.0, 21.0, -23.0, 21.0, -45.0, -89.0, -122.0, -23.0, -78.0, 21.0, 43.0, 21.0, 10.0, 21.0, 10.0, 32.0, -23.0, 43.0, 43.0, 21.0, -12.0, -23.0, 10.0, 54.0, 43.0, 65.0, 65.0, -12.0, 65.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20690522921821056, "mean_inference_ms": 10.480209604549973, "mean_action_processing_ms": 0.09175473077349622, "mean_env_wait_ms": 0.04574662759983651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004834175109863281, "StateBufferConnector_ms": 0.0029609203338623047, "ViewRequirementAgentConnector_ms": 0.08937406539916992}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 43.0, -12.0, -23.0, -1.0, 21.0, 43.0, 76.0, 65.0, 65.0, 65.0, 43.0, 65.0, 65.0, 21.0, 76.0, 65.0, 76.0, 43.0, 32.0, -12.0, 32.0, -45.0, 10.0, 43.0, -1.0, 43.0, -100.0, -67.0, 10.0, 10.0, 32.0, -89.0, 21.0, 10.0, 10.0, 43.0, 54.0, -45.0, 21.0, 21.0, 21.0, -12.0, 21.0, -34.0, -12.0, -1.0, 10.0, 54.0, 32.0, 43.0, 65.0, 10.0, 21.0, 54.0, -12.0, -1.0, 32.0, 10.0, 43.0, 21.0, -23.0, 54.0, 65.0, 43.0, 54.0, -78.0, -1.0, -1.0, 32.0, 21.0, -23.0, 21.0, -45.0, -89.0, -122.0, -23.0, -78.0, 21.0, 43.0, 21.0, 10.0, 21.0, 10.0, 32.0, -23.0, 43.0, 43.0, 21.0, -12.0, -23.0, 10.0, 54.0, 43.0, 65.0, 65.0, -12.0, 65.0, 65.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20690522921821056, "mean_inference_ms": 10.480209604549973, "mean_action_processing_ms": 0.09175473077349622, "mean_env_wait_ms": 0.04574662759983651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004834175109863281, "StateBufferConnector_ms": 0.0029609203338623047, "ViewRequirementAgentConnector_ms": 0.08937406539916992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 77998.287, "sample_time_ms": 43188.273, "learn_time_ms": 34802.044, "learn_throughput": 114.936, "synch_weights_time_ms": 7.339}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1684, "training_iteration": 32, "trial_id": "38794_00001", "date": "2023-06-01_21-11-26", "timestamp": 1685643086, "time_this_iter_s": 86.14390802383423, "time_total_s": 2759.9533655643463, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2759.9533655643463, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 50.766666666666666, "ram_util_percent": 76.46666666666667}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 16.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.0, 43.0, -23.0, -56.0, -67.0, 65.0, 76.0, 21.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19283100946597573, "mean_inference_ms": 10.31039270752569, "mean_action_processing_ms": 0.08866658721603818, "mean_env_wait_ms": 0.04454434932758779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055599212646484375, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.08864879608154297}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.796459674835205, "policy_loss": -0.013400647789239883, "vf_loss": 6.809271335601807, "vf_explained_var": 0.011347562074661255, "kl": 0.011780351400375366, "entropy": 2.245779514312744, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": 9.11, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 21.0, 54.0, -12.0, -1.0, 32.0, 10.0, 43.0, 21.0, -23.0, 54.0, 65.0, 43.0, 54.0, -78.0, -1.0, -1.0, 32.0, 21.0, -23.0, 21.0, -45.0, -89.0, -122.0, -23.0, -78.0, 21.0, 43.0, 21.0, 10.0, 21.0, 10.0, 32.0, -23.0, 43.0, 43.0, 21.0, -12.0, -23.0, 10.0, 54.0, 43.0, 65.0, 65.0, -12.0, 65.0, 65.0, 43.0, 43.0, 32.0, 21.0, 65.0, -34.0, -12.0, -12.0, 43.0, 32.0, 21.0, -56.0, -56.0, -1.0, -12.0, 54.0, 26.0, -45.0, 54.0, 32.0, -56.0, -45.0, 54.0, 54.0, 54.0, -12.0, -1.0, -1.0, -1.0, 54.0, 32.0, 32.0, -23.0, 21.0, -67.0, -111.0, 21.0, 54.0, 65.0, -1.0, -7.0, 65.0, -56.0, -1.0, 21.0, 32.0, -56.0, -45.0, -45.0, 32.0, 32.0, -23.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20663178936078186, "mean_inference_ms": 10.466754407668969, "mean_action_processing_ms": 0.09161081684918612, "mean_env_wait_ms": 0.04566273302085784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004857063293457031, "StateBufferConnector_ms": 0.0030765533447265625, "ViewRequirementAgentConnector_ms": 0.09016942977905273}}, "episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": 9.11, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 21.0, 54.0, -12.0, -1.0, 32.0, 10.0, 43.0, 21.0, -23.0, 54.0, 65.0, 43.0, 54.0, -78.0, -1.0, -1.0, 32.0, 21.0, -23.0, 21.0, -45.0, -89.0, -122.0, -23.0, -78.0, 21.0, 43.0, 21.0, 10.0, 21.0, 10.0, 32.0, -23.0, 43.0, 43.0, 21.0, -12.0, -23.0, 10.0, 54.0, 43.0, 65.0, 65.0, -12.0, 65.0, 65.0, 43.0, 43.0, 32.0, 21.0, 65.0, -34.0, -12.0, -12.0, 43.0, 32.0, 21.0, -56.0, -56.0, -1.0, -12.0, 54.0, 26.0, -45.0, 54.0, 32.0, -56.0, -45.0, 54.0, 54.0, 54.0, -12.0, -1.0, -1.0, -1.0, 54.0, 32.0, 32.0, -23.0, 21.0, -67.0, -111.0, 21.0, 54.0, 65.0, -1.0, -7.0, 65.0, -56.0, -1.0, 21.0, 32.0, -56.0, -45.0, -45.0, 32.0, 32.0, -23.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20663178936078186, "mean_inference_ms": 10.466754407668969, "mean_action_processing_ms": 0.09161081684918612, "mean_env_wait_ms": 0.04566273302085784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004857063293457031, "StateBufferConnector_ms": 0.0030765533447265625, "ViewRequirementAgentConnector_ms": 0.09016942977905273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 77406.346, "sample_time_ms": 42858.039, "learn_time_ms": 34540.527, "learn_throughput": 115.806, "synch_weights_time_ms": 7.159}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1736, "training_iteration": 33, "trial_id": "38794_00001", "date": "2023-06-01_21-12-47", "timestamp": 1685643167, "time_this_iter_s": 81.59428095817566, "time_total_s": 2841.547646522522, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2841.547646522522, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 47.246491228070184, "ram_util_percent": 77.52105263157894}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -100.0, "episode_reward_mean": 3.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 21.0, 32.0, -100.0, -78.0, -12.0, 54.0, 10.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19276123206306642, "mean_inference_ms": 10.30994392549432, "mean_action_processing_ms": 0.08865393867461677, "mean_env_wait_ms": 0.044537496605523204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005335807800292969, "StateBufferConnector_ms": 0.003147125244140625, "ViewRequirementAgentConnector_ms": 0.09334802627563477}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.148171901702881, "policy_loss": -0.007958173751831055, "vf_loss": 6.155762195587158, "vf_explained_var": -2.4973229301394895e-05, "kl": 0.007347114849835634, "entropy": 2.1029794216156006, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 15.27, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, 43.0, 32.0, 21.0, -56.0, -56.0, -1.0, -12.0, 54.0, 26.0, -45.0, 54.0, 32.0, -56.0, -45.0, 54.0, 54.0, 54.0, -12.0, -1.0, -1.0, -1.0, 54.0, 32.0, 32.0, -23.0, 21.0, -67.0, -111.0, 21.0, 54.0, 65.0, -1.0, -7.0, 65.0, -56.0, -1.0, 21.0, 32.0, -56.0, -45.0, -45.0, 32.0, 32.0, -23.0, 54.0, 54.0, 10.0, -45.0, 65.0, 10.0, 54.0, 65.0, 54.0, 65.0, -1.0, 43.0, 54.0, 21.0, -45.0, 10.0, -1.0, 76.0, -12.0, 21.0, 32.0, 10.0, 32.0, -23.0, -12.0, 43.0, -45.0, -67.0, 21.0, 54.0, 54.0, -23.0, 76.0, 76.0, 76.0, 76.0, 65.0, 21.0, -67.0, -45.0, 43.0, 43.0, 32.0, 54.0, 21.0, 21.0, -34.0, 65.0, 10.0, 65.0, 32.0, 32.0, 76.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2063427719119679, "mean_inference_ms": 10.45076467538906, "mean_action_processing_ms": 0.09146358950986283, "mean_env_wait_ms": 0.04557673131854035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004790306091308594, "StateBufferConnector_ms": 0.0030617713928222656, "ViewRequirementAgentConnector_ms": 0.08918523788452148}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 15.27, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, 43.0, 32.0, 21.0, -56.0, -56.0, -1.0, -12.0, 54.0, 26.0, -45.0, 54.0, 32.0, -56.0, -45.0, 54.0, 54.0, 54.0, -12.0, -1.0, -1.0, -1.0, 54.0, 32.0, 32.0, -23.0, 21.0, -67.0, -111.0, 21.0, 54.0, 65.0, -1.0, -7.0, 65.0, -56.0, -1.0, 21.0, 32.0, -56.0, -45.0, -45.0, 32.0, 32.0, -23.0, 54.0, 54.0, 10.0, -45.0, 65.0, 10.0, 54.0, 65.0, 54.0, 65.0, -1.0, 43.0, 54.0, 21.0, -45.0, 10.0, -1.0, 76.0, -12.0, 21.0, 32.0, 10.0, 32.0, -23.0, -12.0, 43.0, -45.0, -67.0, 21.0, 54.0, 54.0, -23.0, 76.0, 76.0, 76.0, 76.0, 65.0, 21.0, -67.0, -45.0, 43.0, 43.0, 32.0, 54.0, 21.0, 21.0, -34.0, 65.0, 10.0, 65.0, 32.0, 32.0, 76.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2063427719119679, "mean_inference_ms": 10.45076467538906, "mean_action_processing_ms": 0.09146358950986283, "mean_env_wait_ms": 0.04557673131854035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004790306091308594, "StateBufferConnector_ms": 0.0030617713928222656, "ViewRequirementAgentConnector_ms": 0.08918523788452148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 77083.275, "sample_time_ms": 42443.915, "learn_time_ms": 34631.595, "learn_throughput": 115.501, "synch_weights_time_ms": 7.157}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1789, "training_iteration": 34, "trial_id": "38794_00001", "date": "2023-06-01_21-14-11", "timestamp": 1685643251, "time_this_iter_s": 84.07847285270691, "time_total_s": 2925.626119375229, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2925.626119375229, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 48.04871794871796, "ram_util_percent": 77.62393162393163}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 19.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 21.0, 43.0, 43.0, 65.0, 43.0, 76.0, -89.0, -34.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19245279278505484, "mean_inference_ms": 10.291560377995237, "mean_action_processing_ms": 0.08849996197721546, "mean_env_wait_ms": 0.04445260227418906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004646778106689453, "StateBufferConnector_ms": 0.0033330917358398438, "ViewRequirementAgentConnector_ms": 0.08609294891357422}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.425687789916992, "policy_loss": -0.01393154077231884, "vf_loss": 5.438867568969727, "vf_explained_var": 0.0028480852488428354, "kl": 0.015022757463157177, "entropy": 2.157061815261841, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 30.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 65.0, -1.0, 43.0, 54.0, 21.0, -45.0, 10.0, -1.0, 76.0, -12.0, 21.0, 32.0, 10.0, 32.0, -23.0, -12.0, 43.0, -45.0, -67.0, 21.0, 54.0, 54.0, -23.0, 76.0, 76.0, 76.0, 76.0, 65.0, 21.0, -67.0, -45.0, 43.0, 43.0, 32.0, 54.0, 21.0, 21.0, -34.0, 65.0, 10.0, 65.0, 32.0, 32.0, 76.0, 21.0, 54.0, 43.0, 54.0, -1.0, 65.0, 76.0, 10.0, 65.0, 65.0, 65.0, 76.0, 43.0, 65.0, 65.0, 54.0, 65.0, 76.0, 10.0, -23.0, 21.0, 10.0, 65.0, -12.0, 54.0, 32.0, 43.0, 54.0, 10.0, 54.0, 32.0, 15.0, 76.0, -1.0, 21.0, 43.0, -1.0, 54.0, 43.0, 21.0, 10.0, 21.0, 76.0, 65.0, 65.0, 54.0, -23.0, 54.0, 10.0, 76.0, 32.0, -1.0, -111.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2060886023094916, "mean_inference_ms": 10.439519069250641, "mean_action_processing_ms": 0.09133652977214975, "mean_env_wait_ms": 0.045499950529196906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048427581787109375, "StateBufferConnector_ms": 0.0030684471130371094, "ViewRequirementAgentConnector_ms": 0.0908658504486084}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 30.4, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 54.0, 65.0, -1.0, 43.0, 54.0, 21.0, -45.0, 10.0, -1.0, 76.0, -12.0, 21.0, 32.0, 10.0, 32.0, -23.0, -12.0, 43.0, -45.0, -67.0, 21.0, 54.0, 54.0, -23.0, 76.0, 76.0, 76.0, 76.0, 65.0, 21.0, -67.0, -45.0, 43.0, 43.0, 32.0, 54.0, 21.0, 21.0, -34.0, 65.0, 10.0, 65.0, 32.0, 32.0, 76.0, 21.0, 54.0, 43.0, 54.0, -1.0, 65.0, 76.0, 10.0, 65.0, 65.0, 65.0, 76.0, 43.0, 65.0, 65.0, 54.0, 65.0, 76.0, 10.0, -23.0, 21.0, 10.0, 65.0, -12.0, 54.0, 32.0, 43.0, 54.0, 10.0, 54.0, 32.0, 15.0, 76.0, -1.0, 21.0, 43.0, -1.0, 54.0, 43.0, 21.0, 10.0, 21.0, 76.0, 65.0, 65.0, 54.0, -23.0, 54.0, 10.0, 76.0, 32.0, -1.0, -111.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2060886023094916, "mean_inference_ms": 10.439519069250641, "mean_action_processing_ms": 0.09133652977214975, "mean_env_wait_ms": 0.045499950529196906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048427581787109375, "StateBufferConnector_ms": 0.0030684471130371094, "ViewRequirementAgentConnector_ms": 0.0908658504486084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 77217.347, "sample_time_ms": 42436.434, "learn_time_ms": 34773.193, "learn_throughput": 115.031, "synch_weights_time_ms": 7.105}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1842, "training_iteration": 35, "trial_id": "38794_00001", "date": "2023-06-01_21-15-36", "timestamp": 1685643336, "time_this_iter_s": 84.70531511306763, "time_total_s": 3010.3314344882965, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3010.3314344882965, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 49.106779661016944, "ram_util_percent": 75.97627118644068}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -144.0, "episode_reward_mean": -27.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 54.0, -45.0, 43.0, 65.0, -144.0, -100.0, -78.0, -133.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19235180673933505, "mean_inference_ms": 10.283562528917583, "mean_action_processing_ms": 0.08847831019767564, "mean_env_wait_ms": 0.04442907260665986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050067901611328125, "StateBufferConnector_ms": 0.0029706954956054688, "ViewRequirementAgentConnector_ms": 0.08636474609375}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.466925144195557, "policy_loss": -0.008782333694398403, "vf_loss": 5.475319862365723, "vf_explained_var": 0.004928082227706909, "kl": 0.007742748595774174, "entropy": 2.154331922531128, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 33.86, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 10.0, 65.0, 65.0, 65.0, 76.0, 43.0, 65.0, 65.0, 54.0, 65.0, 76.0, 10.0, -23.0, 21.0, 10.0, 65.0, -12.0, 54.0, 32.0, 43.0, 54.0, 10.0, 54.0, 32.0, 15.0, 76.0, -1.0, 21.0, 43.0, -1.0, 54.0, 43.0, 21.0, 10.0, 21.0, 76.0, 65.0, 65.0, 54.0, -23.0, 54.0, 10.0, 76.0, 32.0, -1.0, -111.0, -34.0, 54.0, 21.0, 32.0, 21.0, 43.0, 43.0, -23.0, 54.0, -12.0, 10.0, 32.0, -23.0, 54.0, -12.0, 65.0, 76.0, 32.0, -23.0, -34.0, 21.0, -1.0, -12.0, -1.0, 21.0, 76.0, 43.0, 76.0, 65.0, 65.0, 76.0, 76.0, 65.0, 65.0, 65.0, 65.0, 76.0, 54.0, 65.0, 10.0, -45.0, -12.0, 32.0, 43.0, 43.0, 26.0, 32.0, 76.0, 10.0, 43.0, 76.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20584977784050792, "mean_inference_ms": 10.428938375861497, "mean_action_processing_ms": 0.09122096153294215, "mean_env_wait_ms": 0.04543834419455079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004880428314208984, "StateBufferConnector_ms": 0.003122091293334961, "ViewRequirementAgentConnector_ms": 0.09041833877563477}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 33.86, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 10.0, 65.0, 65.0, 65.0, 76.0, 43.0, 65.0, 65.0, 54.0, 65.0, 76.0, 10.0, -23.0, 21.0, 10.0, 65.0, -12.0, 54.0, 32.0, 43.0, 54.0, 10.0, 54.0, 32.0, 15.0, 76.0, -1.0, 21.0, 43.0, -1.0, 54.0, 43.0, 21.0, 10.0, 21.0, 76.0, 65.0, 65.0, 54.0, -23.0, 54.0, 10.0, 76.0, 32.0, -1.0, -111.0, -34.0, 54.0, 21.0, 32.0, 21.0, 43.0, 43.0, -23.0, 54.0, -12.0, 10.0, 32.0, -23.0, 54.0, -12.0, 65.0, 76.0, 32.0, -23.0, -34.0, 21.0, -1.0, -12.0, -1.0, 21.0, 76.0, 43.0, 76.0, 65.0, 65.0, 76.0, 76.0, 65.0, 65.0, 65.0, 65.0, 76.0, 54.0, 65.0, 10.0, -45.0, -12.0, 32.0, 43.0, 43.0, 26.0, 32.0, 76.0, 10.0, 43.0, 76.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20584977784050792, "mean_inference_ms": 10.428938375861497, "mean_action_processing_ms": 0.09122096153294215, "mean_env_wait_ms": 0.04543834419455079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004880428314208984, "StateBufferConnector_ms": 0.003122091293334961, "ViewRequirementAgentConnector_ms": 0.09041833877563477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 77315.6, "sample_time_ms": 42563.369, "learn_time_ms": 34744.598, "learn_throughput": 115.126, "synch_weights_time_ms": 7.013}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1894, "training_iteration": 36, "trial_id": "38794_00001", "date": "2023-06-01_21-16-59", "timestamp": 1685643419, "time_this_iter_s": 82.55226802825928, "time_total_s": 3092.883702516556, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3092.883702516556, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 48.88879310344828, "ram_util_percent": 76.82413793103449}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 30.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 43.0, 65.0, 21.0, 65.0, 76.0, -23.0, 10.0, 32.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19161490346802015, "mean_inference_ms": 10.24857334161245, "mean_action_processing_ms": 0.08810844603161704, "mean_env_wait_ms": 0.04419359372853428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004565715789794922, "StateBufferConnector_ms": 0.0024247169494628906, "ViewRequirementAgentConnector_ms": 0.07729530334472656}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.862489700317383, "policy_loss": -0.00438097445294261, "vf_loss": 5.866426467895508, "vf_explained_var": 0.003974533639848232, "kl": 0.00888508465141058, "entropy": 2.1469333171844482, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 29.13, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -23.0, 54.0, -12.0, 10.0, 32.0, -23.0, 54.0, -12.0, 65.0, 76.0, 32.0, -23.0, -34.0, 21.0, -1.0, -12.0, -1.0, 21.0, 76.0, 43.0, 76.0, 65.0, 65.0, 76.0, 76.0, 65.0, 65.0, 65.0, 65.0, 76.0, 54.0, 65.0, 10.0, -45.0, -12.0, 32.0, 43.0, 43.0, 26.0, 32.0, 76.0, 10.0, 43.0, 76.0, 32.0, 10.0, -23.0, -1.0, 65.0, 76.0, -1.0, 54.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 21.0, -1.0, -12.0, 21.0, -34.0, 32.0, 43.0, 32.0, 65.0, 65.0, 65.0, 43.0, 43.0, 43.0, 54.0, 54.0, -89.0, -34.0, 43.0, 32.0, -34.0, -23.0, -23.0, -67.0, 76.0, 43.0, 10.0, 10.0, 43.0, 32.0, 43.0, -1.0, 21.0, 76.0, 21.0, -67.0, -45.0, -40.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20544337845704888, "mean_inference_ms": 10.41001236806715, "mean_action_processing_ms": 0.09101932430791085, "mean_env_wait_ms": 0.04532235430260711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048046112060546875, "StateBufferConnector_ms": 0.002890348434448242, "ViewRequirementAgentConnector_ms": 0.0861818790435791}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 29.13, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, -23.0, 54.0, -12.0, 10.0, 32.0, -23.0, 54.0, -12.0, 65.0, 76.0, 32.0, -23.0, -34.0, 21.0, -1.0, -12.0, -1.0, 21.0, 76.0, 43.0, 76.0, 65.0, 65.0, 76.0, 76.0, 65.0, 65.0, 65.0, 65.0, 76.0, 54.0, 65.0, 10.0, -45.0, -12.0, 32.0, 43.0, 43.0, 26.0, 32.0, 76.0, 10.0, 43.0, 76.0, 32.0, 10.0, -23.0, -1.0, 65.0, 76.0, -1.0, 54.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 21.0, -1.0, -12.0, 21.0, -34.0, 32.0, 43.0, 32.0, 65.0, 65.0, 65.0, 43.0, 43.0, 43.0, 54.0, 54.0, -89.0, -34.0, 43.0, 32.0, -34.0, -23.0, -23.0, -67.0, 76.0, 43.0, 10.0, 10.0, 43.0, 32.0, 43.0, -1.0, 21.0, 76.0, 21.0, -67.0, -45.0, -40.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20544337845704888, "mean_inference_ms": 10.41001236806715, "mean_action_processing_ms": 0.09101932430791085, "mean_env_wait_ms": 0.04532235430260711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048046112060546875, "StateBufferConnector_ms": 0.002890348434448242, "ViewRequirementAgentConnector_ms": 0.0861818790435791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 76225.523, "sample_time_ms": 42190.9, "learn_time_ms": 34027.046, "learn_throughput": 117.554, "synch_weights_time_ms": 6.956}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1947, "training_iteration": 37, "trial_id": "38794_00001", "date": "2023-06-01_21-18-16", "timestamp": 1685643496, "time_this_iter_s": 77.64939498901367, "time_total_s": 3170.5330975055695, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3170.5330975055695, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 43.47592592592592, "ram_util_percent": 76.67314814814816}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -23.0, "episode_reward_mean": 38.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -1.0, -23.0, 21.0, 32.0, 54.0, 54.0, 76.0, 32.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19100970382534574, "mean_inference_ms": 10.223564078473414, "mean_action_processing_ms": 0.08780924650874934, "mean_env_wait_ms": 0.044009703760360744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004918575286865234, "StateBufferConnector_ms": 0.002582073211669922, "ViewRequirementAgentConnector_ms": 0.08092641830444336}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.681347846984863, "policy_loss": -0.008913988247513771, "vf_loss": 5.689753532409668, "vf_explained_var": 0.04151420667767525, "kl": 0.010161789134144783, "entropy": 2.1344234943389893, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 26.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 21.0, -1.0, -12.0, 21.0, -34.0, 32.0, 43.0, 32.0, 65.0, 65.0, 65.0, 43.0, 43.0, 43.0, 54.0, 54.0, -89.0, -34.0, 43.0, 32.0, -34.0, -23.0, -23.0, -67.0, 76.0, 43.0, 10.0, 10.0, 43.0, 32.0, 43.0, -1.0, 21.0, 76.0, 21.0, -67.0, -45.0, -40.0, 32.0, 21.0, -1.0, 32.0, 76.0, 76.0, 76.0, 65.0, 76.0, -1.0, 32.0, -56.0, -45.0, 10.0, -56.0, 21.0, 54.0, 43.0, 65.0, 21.0, 65.0, 76.0, 54.0, 32.0, 10.0, 76.0, 43.0, -23.0, 21.0, 43.0, 32.0, 43.0, 54.0, -23.0, -23.0, -1.0, 10.0, -67.0, 21.0, -78.0, -23.0, -45.0, 76.0, 65.0, 76.0, 54.0, 65.0, 76.0, 76.0, 65.0, 10.0, 43.0, -34.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2048068315785034, "mean_inference_ms": 10.380527117437023, "mean_action_processing_ms": 0.09069599386323017, "mean_env_wait_ms": 0.04511995807995875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004431009292602539, "StateBufferConnector_ms": 0.0027451515197753906, "ViewRequirementAgentConnector_ms": 0.08118486404418945}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 26.0, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 21.0, -1.0, -12.0, 21.0, -34.0, 32.0, 43.0, 32.0, 65.0, 65.0, 65.0, 43.0, 43.0, 43.0, 54.0, 54.0, -89.0, -34.0, 43.0, 32.0, -34.0, -23.0, -23.0, -67.0, 76.0, 43.0, 10.0, 10.0, 43.0, 32.0, 43.0, -1.0, 21.0, 76.0, 21.0, -67.0, -45.0, -40.0, 32.0, 21.0, -1.0, 32.0, 76.0, 76.0, 76.0, 65.0, 76.0, -1.0, 32.0, -56.0, -45.0, 10.0, -56.0, 21.0, 54.0, 43.0, 65.0, 21.0, 65.0, 76.0, 54.0, 32.0, 10.0, 76.0, 43.0, -23.0, 21.0, 43.0, 32.0, 43.0, 54.0, -23.0, -23.0, -1.0, 10.0, -67.0, 21.0, -78.0, -23.0, -45.0, 76.0, 65.0, 76.0, 54.0, 65.0, 76.0, 76.0, 65.0, 10.0, 43.0, -34.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2048068315785034, "mean_inference_ms": 10.380527117437023, "mean_action_processing_ms": 0.09069599386323017, "mean_env_wait_ms": 0.04511995807995875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004431009292602539, "StateBufferConnector_ms": 0.0027451515197753906, "ViewRequirementAgentConnector_ms": 0.08118486404418945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 75060.076, "sample_time_ms": 41423.65, "learn_time_ms": 33628.916, "learn_throughput": 118.945, "synch_weights_time_ms": 6.907}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2000, "training_iteration": 38, "trial_id": "38794_00001", "date": "2023-06-01_21-19-32", "timestamp": 1685643572, "time_this_iter_s": 75.92566299438477, "time_total_s": 3246.458760499954, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3246.458760499954, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 39.048113207547175, "ram_util_percent": 76.13490566037736}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 21.0, "episode_reward_mean": 55.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, 21.0, 76.0, 54.0, 21.0, 54.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19067735196784708, "mean_inference_ms": 10.20026831148945, "mean_action_processing_ms": 0.08757595977160312, "mean_env_wait_ms": 0.043892328734581446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004715919494628906, "StateBufferConnector_ms": 0.002772808074951172, "ViewRequirementAgentConnector_ms": 0.08352518081665039}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.684277534484863, "policy_loss": -0.006296850275248289, "vf_loss": 6.69000244140625, "vf_explained_var": 0.025320641696453094, "kl": 0.011425089091062546, "entropy": 2.2313802242279053, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 20.12, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 65.0, 76.0, -1.0, 32.0, -56.0, -45.0, 10.0, -56.0, 21.0, 54.0, 43.0, 65.0, 21.0, 65.0, 76.0, 54.0, 32.0, 10.0, 76.0, 43.0, -23.0, 21.0, 43.0, 32.0, 43.0, 54.0, -23.0, -23.0, -1.0, 10.0, -67.0, 21.0, -78.0, -23.0, -45.0, 76.0, 65.0, 76.0, 54.0, 65.0, 76.0, 76.0, 65.0, 10.0, 43.0, -34.0, 54.0, 54.0, 43.0, -23.0, 10.0, -1.0, -34.0, -12.0, 21.0, 21.0, -1.0, 43.0, 54.0, -1.0, 21.0, 21.0, -1.0, -56.0, 21.0, 21.0, 21.0, -12.0, 32.0, -1.0, 43.0, 54.0, 32.0, 21.0, 76.0, 76.0, -12.0, 21.0, -45.0, 43.0, 32.0, -23.0, 32.0, -12.0, -12.0, -23.0, -45.0, -34.0, 65.0, 76.0, 76.0, 21.0, 43.0, 54.0, 32.0, -12.0, -34.0, 43.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20429416352931642, "mean_inference_ms": 10.355129191955072, "mean_action_processing_ms": 0.09043988476913598, "mean_env_wait_ms": 0.04496027467784096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044481754302978516, "StateBufferConnector_ms": 0.0028808116912841797, "ViewRequirementAgentConnector_ms": 0.0831766128540039}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 20.12, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 65.0, 76.0, -1.0, 32.0, -56.0, -45.0, 10.0, -56.0, 21.0, 54.0, 43.0, 65.0, 21.0, 65.0, 76.0, 54.0, 32.0, 10.0, 76.0, 43.0, -23.0, 21.0, 43.0, 32.0, 43.0, 54.0, -23.0, -23.0, -1.0, 10.0, -67.0, 21.0, -78.0, -23.0, -45.0, 76.0, 65.0, 76.0, 54.0, 65.0, 76.0, 76.0, 65.0, 10.0, 43.0, -34.0, 54.0, 54.0, 43.0, -23.0, 10.0, -1.0, -34.0, -12.0, 21.0, 21.0, -1.0, 43.0, 54.0, -1.0, 21.0, 21.0, -1.0, -56.0, 21.0, 21.0, 21.0, -12.0, 32.0, -1.0, 43.0, 54.0, 32.0, 21.0, 76.0, 76.0, -12.0, 21.0, -45.0, 43.0, 32.0, -23.0, 32.0, -12.0, -12.0, -23.0, -45.0, -34.0, 65.0, 76.0, 76.0, 21.0, 43.0, 54.0, 32.0, -12.0, -34.0, 43.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20429416352931642, "mean_inference_ms": 10.355129191955072, "mean_action_processing_ms": 0.09043988476913598, "mean_env_wait_ms": 0.04496027467784096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044481754302978516, "StateBufferConnector_ms": 0.0028808116912841797, "ViewRequirementAgentConnector_ms": 0.0831766128540039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 74884.359, "sample_time_ms": 41191.339, "learn_time_ms": 33685.447, "learn_throughput": 118.746, "synch_weights_time_ms": 6.966}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 2052, "training_iteration": 39, "trial_id": "38794_00001", "date": "2023-06-01_21-20-53", "timestamp": 1685643653, "time_this_iter_s": 80.78885221481323, "time_total_s": 3327.2476127147675, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3327.2476127147675, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 46.70176991150442, "ram_util_percent": 76.67345132743361}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -23.0, "episode_reward_mean": 40.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 21.0, 43.0, 43.0, 54.0, 43.0, 54.0, 76.0, 21.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19034815949792314, "mean_inference_ms": 10.182321755879254, "mean_action_processing_ms": 0.08739063188530206, "mean_env_wait_ms": 0.04378407688729995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005052089691162109, "StateBufferConnector_ms": 0.0028705596923828125, "ViewRequirementAgentConnector_ms": 0.08505582809448242}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.729985237121582, "policy_loss": -0.0073517258279025555, "vf_loss": 5.7368998527526855, "vf_explained_var": 0.01980871707201004, "kl": 0.008736629970371723, "entropy": 2.1028168201446533, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 22.92, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -12.0, 21.0, 21.0, -1.0, 43.0, 54.0, -1.0, 21.0, 21.0, -1.0, -56.0, 21.0, 21.0, 21.0, -12.0, 32.0, -1.0, 43.0, 54.0, 32.0, 21.0, 76.0, 76.0, -12.0, 21.0, -45.0, 43.0, 32.0, -23.0, 32.0, -12.0, -12.0, -23.0, -45.0, -34.0, 65.0, 76.0, 76.0, 21.0, 43.0, 54.0, 32.0, -12.0, -34.0, 43.0, -45.0, -45.0, 65.0, -56.0, -12.0, -45.0, -12.0, 10.0, 76.0, -1.0, 54.0, -1.0, -12.0, 21.0, 43.0, 54.0, 76.0, 43.0, 21.0, 43.0, 54.0, 65.0, 65.0, 32.0, 54.0, 21.0, 54.0, 32.0, 10.0, 54.0, 54.0, 32.0, 54.0, 54.0, -1.0, 65.0, 54.0, 21.0, -23.0, 65.0, 54.0, 65.0, -34.0, -67.0, 54.0, 65.0, 65.0, 54.0, 59.0, 65.0, 65.0, -34.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20400127053747888, "mean_inference_ms": 10.337811665975519, "mean_action_processing_ms": 0.09028254104409025, "mean_env_wait_ms": 0.044872918707772734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004708528518676758, "StateBufferConnector_ms": 0.002912282943725586, "ViewRequirementAgentConnector_ms": 0.0871269702911377}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 22.92, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -12.0, 21.0, 21.0, -1.0, 43.0, 54.0, -1.0, 21.0, 21.0, -1.0, -56.0, 21.0, 21.0, 21.0, -12.0, 32.0, -1.0, 43.0, 54.0, 32.0, 21.0, 76.0, 76.0, -12.0, 21.0, -45.0, 43.0, 32.0, -23.0, 32.0, -12.0, -12.0, -23.0, -45.0, -34.0, 65.0, 76.0, 76.0, 21.0, 43.0, 54.0, 32.0, -12.0, -34.0, 43.0, -45.0, -45.0, 65.0, -56.0, -12.0, -45.0, -12.0, 10.0, 76.0, -1.0, 54.0, -1.0, -12.0, 21.0, 43.0, 54.0, 76.0, 43.0, 21.0, 43.0, 54.0, 65.0, 65.0, 32.0, 54.0, 21.0, 54.0, 32.0, 10.0, 54.0, 54.0, 32.0, 54.0, 54.0, -1.0, 65.0, 54.0, 21.0, -23.0, 65.0, 54.0, 65.0, -34.0, -67.0, 54.0, 65.0, 65.0, 54.0, 59.0, 65.0, 65.0, -34.0, 43.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20400127053747888, "mean_inference_ms": 10.337811665975519, "mean_action_processing_ms": 0.09028254104409025, "mean_env_wait_ms": 0.044872918707772734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004708528518676758, "StateBufferConnector_ms": 0.002912282943725586, "ViewRequirementAgentConnector_ms": 0.0871269702911377}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 74007.613, "sample_time_ms": 40511.997, "learn_time_ms": 33488.281, "learn_throughput": 119.445, "synch_weights_time_ms": 6.768}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2105, "training_iteration": 40, "trial_id": "38794_00001", "date": "2023-06-01_21-22-15", "timestamp": 1685643735, "time_this_iter_s": 81.8008759021759, "time_total_s": 3409.0484886169434, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3409.0484886169434, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 48.72543859649122, "ram_util_percent": 77.41403508771928}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -56.0, "episode_reward_mean": -1.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -45.0, -56.0, -34.0, -12.0, 21.0, 32.0, 21.0, -1.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1901883238267273, "mean_inference_ms": 10.176685378914227, "mean_action_processing_ms": 0.08735563087775547, "mean_env_wait_ms": 0.04375132037419525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050449371337890625, "StateBufferConnector_ms": 0.0027489662170410156, "ViewRequirementAgentConnector_ms": 0.08458614349365234}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.691312789916992, "policy_loss": -0.012840044684708118, "vf_loss": 5.70363712310791, "vf_explained_var": 0.0008805516408756375, "kl": 0.010314198210835457, "entropy": 1.9824974536895752, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 31.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, 76.0, -1.0, 54.0, -1.0, -12.0, 21.0, 43.0, 54.0, 76.0, 43.0, 21.0, 43.0, 54.0, 65.0, 65.0, 32.0, 54.0, 21.0, 54.0, 32.0, 10.0, 54.0, 54.0, 32.0, 54.0, 54.0, -1.0, 65.0, 54.0, 21.0, -23.0, 65.0, 54.0, 65.0, -34.0, -67.0, 54.0, 65.0, 65.0, 54.0, 59.0, 65.0, 65.0, -34.0, 43.0, -1.0, 32.0, 21.0, 76.0, 65.0, 32.0, 21.0, -23.0, 32.0, 70.0, 54.0, 21.0, 54.0, -12.0, -1.0, 10.0, 43.0, 54.0, 43.0, 65.0, 76.0, -12.0, 32.0, -67.0, 32.0, -67.0, 32.0, 32.0, 54.0, 54.0, 43.0, 65.0, 10.0, -1.0, -34.0, 32.0, 21.0, 65.0, 54.0, 21.0, 32.0, 21.0, 76.0, -12.0, -78.0, -1.0, 65.0, 54.0, 32.0, 65.0, -45.0, 54.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2038203666763092, "mean_inference_ms": 10.326536119315833, "mean_action_processing_ms": 0.09017504524324231, "mean_env_wait_ms": 0.04481467702483116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004942417144775391, "StateBufferConnector_ms": 0.0029478073120117188, "ViewRequirementAgentConnector_ms": 0.09085607528686523}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 31.0, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, 10.0, 76.0, -1.0, 54.0, -1.0, -12.0, 21.0, 43.0, 54.0, 76.0, 43.0, 21.0, 43.0, 54.0, 65.0, 65.0, 32.0, 54.0, 21.0, 54.0, 32.0, 10.0, 54.0, 54.0, 32.0, 54.0, 54.0, -1.0, 65.0, 54.0, 21.0, -23.0, 65.0, 54.0, 65.0, -34.0, -67.0, 54.0, 65.0, 65.0, 54.0, 59.0, 65.0, 65.0, -34.0, 43.0, -1.0, 32.0, 21.0, 76.0, 65.0, 32.0, 21.0, -23.0, 32.0, 70.0, 54.0, 21.0, 54.0, -12.0, -1.0, 10.0, 43.0, 54.0, 43.0, 65.0, 76.0, -12.0, 32.0, -67.0, 32.0, -67.0, 32.0, 32.0, 54.0, 54.0, 43.0, 65.0, 10.0, -1.0, -34.0, 32.0, 21.0, 65.0, 54.0, 21.0, 32.0, 21.0, 76.0, -12.0, -78.0, -1.0, 65.0, 54.0, 32.0, 65.0, -45.0, 54.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2038203666763092, "mean_inference_ms": 10.326536119315833, "mean_action_processing_ms": 0.09017504524324231, "mean_env_wait_ms": 0.04481467702483116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004942417144775391, "StateBufferConnector_ms": 0.0029478073120117188, "ViewRequirementAgentConnector_ms": 0.09085607528686523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 74168.446, "sample_time_ms": 40601.136, "learn_time_ms": 33559.892, "learn_throughput": 119.19, "synch_weights_time_ms": 6.825}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2157, "training_iteration": 41, "trial_id": "38794_00001", "date": "2023-06-01_21-23-38", "timestamp": 1685643818, "time_this_iter_s": 83.1817090511322, "time_total_s": 3492.2301976680756, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3492.2301976680756, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 47.94869565217392, "ram_util_percent": 77.63478260869563}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": -1.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 65.0, 32.0, -56.0, -122.0, 10.0, 10.0, 10.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1901935236685774, "mean_inference_ms": 10.19580422261578, "mean_action_processing_ms": 0.08735093275432107, "mean_env_wait_ms": 0.043740148088103795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005233287811279297, "StateBufferConnector_ms": 0.0031185150146484375, "ViewRequirementAgentConnector_ms": 0.09504318237304688}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.77754545211792, "policy_loss": -0.006061238702386618, "vf_loss": 5.7833051681518555, "vf_explained_var": 0.007690503261983395, "kl": 0.006026285234838724, "entropy": 2.0090668201446533, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 26.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -23.0, 32.0, 70.0, 54.0, 21.0, 54.0, -12.0, -1.0, 10.0, 43.0, 54.0, 43.0, 65.0, 76.0, -12.0, 32.0, -67.0, 32.0, -67.0, 32.0, 32.0, 54.0, 54.0, 43.0, 65.0, 10.0, -1.0, -34.0, 32.0, 21.0, 65.0, 54.0, 21.0, 32.0, 21.0, 76.0, -12.0, -78.0, -1.0, 65.0, 54.0, 32.0, 65.0, -45.0, 54.0, 54.0, 43.0, -122.0, -45.0, 65.0, 54.0, 43.0, 76.0, 54.0, 54.0, 59.0, 32.0, 43.0, 76.0, 76.0, 76.0, 76.0, 54.0, 43.0, -34.0, 43.0, 21.0, 43.0, 43.0, 43.0, -89.0, 43.0, 43.0, 32.0, 32.0, -1.0, 76.0, 43.0, -34.0, -34.0, -45.0, 43.0, 10.0, 76.0, 21.0, 21.0, -111.0, 21.0, -12.0, -23.0, 21.0, 65.0, -1.0, 43.0, 48.0, 32.0, 54.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20357447254333358, "mean_inference_ms": 10.311561128881927, "mean_action_processing_ms": 0.09003672635341062, "mean_env_wait_ms": 0.04473749070435376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004870414733886719, "StateBufferConnector_ms": 0.0029747486114501953, "ViewRequirementAgentConnector_ms": 0.08954000473022461}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 26.1, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -23.0, 32.0, 70.0, 54.0, 21.0, 54.0, -12.0, -1.0, 10.0, 43.0, 54.0, 43.0, 65.0, 76.0, -12.0, 32.0, -67.0, 32.0, -67.0, 32.0, 32.0, 54.0, 54.0, 43.0, 65.0, 10.0, -1.0, -34.0, 32.0, 21.0, 65.0, 54.0, 21.0, 32.0, 21.0, 76.0, -12.0, -78.0, -1.0, 65.0, 54.0, 32.0, 65.0, -45.0, 54.0, 54.0, 43.0, -122.0, -45.0, 65.0, 54.0, 43.0, 76.0, 54.0, 54.0, 59.0, 32.0, 43.0, 76.0, 76.0, 76.0, 76.0, 54.0, 43.0, -34.0, 43.0, 21.0, 43.0, 43.0, 43.0, -89.0, 43.0, 43.0, 32.0, 32.0, -1.0, 76.0, 43.0, -34.0, -34.0, -45.0, 43.0, 10.0, 76.0, 21.0, 21.0, -111.0, 21.0, -12.0, -23.0, 21.0, 65.0, -1.0, 43.0, 48.0, 32.0, 54.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20357447254333358, "mean_inference_ms": 10.311561128881927, "mean_action_processing_ms": 0.09003672635341062, "mean_env_wait_ms": 0.04473749070435376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004870414733886719, "StateBufferConnector_ms": 0.0029747486114501953, "ViewRequirementAgentConnector_ms": 0.08954000473022461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 73534.876, "sample_time_ms": 40288.335, "learn_time_ms": 33239.263, "learn_throughput": 120.34, "synch_weights_time_ms": 6.69}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2210, "training_iteration": 42, "trial_id": "38794_00001", "date": "2023-06-01_21-24-58", "timestamp": 1685643898, "time_this_iter_s": 80.13754916191101, "time_total_s": 3572.3677468299866, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3572.3677468299866, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 48.66696428571429, "ram_util_percent": 77.20357142857142}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -78.0, "episode_reward_mean": -9.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -12.0, -45.0, 54.0, 54.0, 43.0, -34.0, -1.0, -78.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19048222610997964, "mean_inference_ms": 10.21645215831339, "mean_action_processing_ms": 0.08746776713293683, "mean_env_wait_ms": 0.043829404929507085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006325244903564453, "StateBufferConnector_ms": 0.0030422210693359375, "ViewRequirementAgentConnector_ms": 0.10253429412841797}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.193915843963623, "policy_loss": -0.009422605857253075, "vf_loss": 6.202645778656006, "vf_explained_var": 0.004790870472788811, "kl": 0.013851117342710495, "entropy": 1.9801521301269531, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 23.35, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 54.0, 54.0, 59.0, 32.0, 43.0, 76.0, 76.0, 76.0, 76.0, 54.0, 43.0, -34.0, 43.0, 21.0, 43.0, 43.0, 43.0, -89.0, 43.0, 43.0, 32.0, 32.0, -1.0, 76.0, 43.0, -34.0, -34.0, -45.0, 43.0, 10.0, 76.0, 21.0, 21.0, -111.0, 21.0, -12.0, -23.0, 21.0, 65.0, -1.0, 43.0, 48.0, 32.0, 54.0, 54.0, 76.0, 32.0, 54.0, 43.0, 43.0, -45.0, -12.0, -45.0, -89.0, -67.0, -34.0, -23.0, -12.0, -56.0, 43.0, -12.0, 54.0, 54.0, 32.0, 32.0, 54.0, 76.0, 43.0, 54.0, 15.0, 43.0, -23.0, 10.0, 54.0, 54.0, 10.0, 32.0, 54.0, 43.0, -1.0, 43.0, 65.0, 65.0, 76.0, 65.0, 21.0, -78.0, -111.0, -1.0, 54.0, 54.0, 54.0, -56.0, 21.0, 43.0, 21.0, 32.0, 76.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2032052940753769, "mean_inference_ms": 10.28953250070639, "mean_action_processing_ms": 0.08984101701360565, "mean_env_wait_ms": 0.04462183200096604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00464320182800293, "StateBufferConnector_ms": 0.0029006004333496094, "ViewRequirementAgentConnector_ms": 0.08475565910339355}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 23.35, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 54.0, 54.0, 59.0, 32.0, 43.0, 76.0, 76.0, 76.0, 76.0, 54.0, 43.0, -34.0, 43.0, 21.0, 43.0, 43.0, 43.0, -89.0, 43.0, 43.0, 32.0, 32.0, -1.0, 76.0, 43.0, -34.0, -34.0, -45.0, 43.0, 10.0, 76.0, 21.0, 21.0, -111.0, 21.0, -12.0, -23.0, 21.0, 65.0, -1.0, 43.0, 48.0, 32.0, 54.0, 54.0, 76.0, 32.0, 54.0, 43.0, 43.0, -45.0, -12.0, -45.0, -89.0, -67.0, -34.0, -23.0, -12.0, -56.0, 43.0, -12.0, 54.0, 54.0, 32.0, 32.0, 54.0, 76.0, 43.0, 54.0, 15.0, 43.0, -23.0, 10.0, 54.0, 54.0, 10.0, 32.0, 54.0, 43.0, -1.0, 43.0, 65.0, 65.0, 76.0, 65.0, 21.0, -78.0, -111.0, -1.0, 54.0, 54.0, 54.0, -56.0, 21.0, 43.0, 21.0, 32.0, 76.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2032052940753769, "mean_inference_ms": 10.28953250070639, "mean_action_processing_ms": 0.08984101701360565, "mean_env_wait_ms": 0.04462183200096604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00464320182800293, "StateBufferConnector_ms": 0.0029006004333496094, "ViewRequirementAgentConnector_ms": 0.08475565910339355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 73541.063, "sample_time_ms": 40052.515, "learn_time_ms": 33480.936, "learn_throughput": 119.471, "synch_weights_time_ms": 6.984}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2263, "training_iteration": 43, "trial_id": "38794_00001", "date": "2023-06-01_21-26-21", "timestamp": 1685643981, "time_this_iter_s": 82.73358488082886, "time_total_s": 3655.1013317108154, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3655.1013317108154, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 49.412931034482774, "ram_util_percent": 77.04568965517241}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 10.0, "episode_reward_mean": 36.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 21.0, 32.0, 43.0, 21.0, 10.0, 10.0, 54.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19038135984512092, "mean_inference_ms": 10.21069341190537, "mean_action_processing_ms": 0.08739935596402526, "mean_env_wait_ms": 0.043775821351672774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004904270172119141, "StateBufferConnector_ms": 0.0029706954956054688, "ViewRequirementAgentConnector_ms": 0.08790969848632812}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 6.214420795440674, "policy_loss": -0.008378812111914158, "vf_loss": 6.222192287445068, "vf_explained_var": 0.012677978724241257, "kl": 0.01214918028563261, "entropy": 1.9771504402160645, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 18.29, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, -89.0, -67.0, -34.0, -23.0, -12.0, -56.0, 43.0, -12.0, 54.0, 54.0, 32.0, 32.0, 54.0, 76.0, 43.0, 54.0, 15.0, 43.0, -23.0, 10.0, 54.0, 54.0, 10.0, 32.0, 54.0, 43.0, -1.0, 43.0, 65.0, 65.0, 76.0, 65.0, 21.0, -78.0, -111.0, -1.0, 54.0, 54.0, 54.0, -56.0, 21.0, 43.0, 21.0, 32.0, 76.0, -1.0, 10.0, 43.0, 32.0, -78.0, 32.0, 76.0, 65.0, -34.0, -12.0, -89.0, 32.0, -45.0, 76.0, 43.0, -12.0, 54.0, 10.0, 54.0, -67.0, -34.0, 32.0, 21.0, -56.0, -67.0, 21.0, 54.0, 32.0, 65.0, 54.0, 76.0, 65.0, 54.0, 32.0, 10.0, -12.0, 10.0, -23.0, -12.0, 43.0, 43.0, 70.0, 65.0, 15.0, -12.0, -34.0, 76.0, 76.0, 54.0, 65.0, 54.0, 21.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20293972419997627, "mean_inference_ms": 10.273856557645892, "mean_action_processing_ms": 0.08970482760281817, "mean_env_wait_ms": 0.044542004580116874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004656791687011719, "StateBufferConnector_ms": 0.0029349327087402344, "ViewRequirementAgentConnector_ms": 0.08645057678222656}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 18.29, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, -89.0, -67.0, -34.0, -23.0, -12.0, -56.0, 43.0, -12.0, 54.0, 54.0, 32.0, 32.0, 54.0, 76.0, 43.0, 54.0, 15.0, 43.0, -23.0, 10.0, 54.0, 54.0, 10.0, 32.0, 54.0, 43.0, -1.0, 43.0, 65.0, 65.0, 76.0, 65.0, 21.0, -78.0, -111.0, -1.0, 54.0, 54.0, 54.0, -56.0, 21.0, 43.0, 21.0, 32.0, 76.0, -1.0, 10.0, 43.0, 32.0, -78.0, 32.0, 76.0, 65.0, -34.0, -12.0, -89.0, 32.0, -45.0, 76.0, 43.0, -12.0, 54.0, 10.0, 54.0, -67.0, -34.0, 32.0, 21.0, -56.0, -67.0, 21.0, 54.0, 32.0, 65.0, 54.0, 76.0, 65.0, 54.0, 32.0, 10.0, -12.0, 10.0, -23.0, -12.0, 43.0, 43.0, 70.0, 65.0, 15.0, -12.0, -34.0, 76.0, 76.0, 54.0, 65.0, 54.0, 21.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20293972419997627, "mean_inference_ms": 10.273856557645892, "mean_action_processing_ms": 0.08970482760281817, "mean_env_wait_ms": 0.044542004580116874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004656791687011719, "StateBufferConnector_ms": 0.0029349327087402344, "ViewRequirementAgentConnector_ms": 0.08645057678222656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 73317.368, "sample_time_ms": 40004.32, "learn_time_ms": 33305.487, "learn_throughput": 120.1, "synch_weights_time_ms": 6.941}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 2315, "training_iteration": 44, "trial_id": "38794_00001", "date": "2023-06-01_21-27-43", "timestamp": 1685644063, "time_this_iter_s": 81.57549595832825, "time_total_s": 3736.6768276691437, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3736.6768276691437, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 45.3561403508772, "ram_util_percent": 78.95175438596489}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 47.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 43.0, 54.0, -34.0, 76.0, 43.0, 10.0, 76.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19034412617481386, "mean_inference_ms": 10.213630415048485, "mean_action_processing_ms": 0.08738386342059881, "mean_env_wait_ms": 0.043750586542747605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004632472991943359, "StateBufferConnector_ms": 0.002930164337158203, "ViewRequirementAgentConnector_ms": 0.09133338928222656}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 5.775757789611816, "policy_loss": -0.016768964007496834, "vf_loss": 5.791306495666504, "vf_explained_var": -0.0036224983632564545, "kl": 0.024395545944571495, "entropy": 1.924606442451477, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 20.11, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 65.0, -34.0, -12.0, -89.0, 32.0, -45.0, 76.0, 43.0, -12.0, 54.0, 10.0, 54.0, -67.0, -34.0, 32.0, 21.0, -56.0, -67.0, 21.0, 54.0, 32.0, 65.0, 54.0, 76.0, 65.0, 54.0, 32.0, 10.0, -12.0, 10.0, -23.0, -12.0, 43.0, 43.0, 70.0, 65.0, 15.0, -12.0, -34.0, 76.0, 76.0, 54.0, 65.0, 54.0, 21.0, -45.0, -100.0, -45.0, -12.0, 21.0, 43.0, 65.0, 65.0, 32.0, 65.0, 10.0, -111.0, 65.0, 54.0, 54.0, 76.0, 32.0, 76.0, 76.0, 32.0, 32.0, 10.0, 32.0, 43.0, 65.0, 54.0, -78.0, -12.0, -56.0, -23.0, 32.0, -56.0, -89.0, -23.0, -56.0, 21.0, -12.0, 54.0, 32.0, 54.0, 65.0, 54.0, 76.0, 65.0, 65.0, 32.0, -89.0, -1.0, 54.0, 65.0, 54.0, 32.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20275280415901684, "mean_inference_ms": 10.262315236718266, "mean_action_processing_ms": 0.08960177705010768, "mean_env_wait_ms": 0.04448539720745136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048062801361083984, "StateBufferConnector_ms": 0.002938508987426758, "ViewRequirementAgentConnector_ms": 0.08744287490844727}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 20.11, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 65.0, -34.0, -12.0, -89.0, 32.0, -45.0, 76.0, 43.0, -12.0, 54.0, 10.0, 54.0, -67.0, -34.0, 32.0, 21.0, -56.0, -67.0, 21.0, 54.0, 32.0, 65.0, 54.0, 76.0, 65.0, 54.0, 32.0, 10.0, -12.0, 10.0, -23.0, -12.0, 43.0, 43.0, 70.0, 65.0, 15.0, -12.0, -34.0, 76.0, 76.0, 54.0, 65.0, 54.0, 21.0, -45.0, -100.0, -45.0, -12.0, 21.0, 43.0, 65.0, 65.0, 32.0, 65.0, 10.0, -111.0, 65.0, 54.0, 54.0, 76.0, 32.0, 76.0, 76.0, 32.0, 32.0, 10.0, 32.0, 43.0, 65.0, 54.0, -78.0, -12.0, -56.0, -23.0, 32.0, -56.0, -89.0, -23.0, -56.0, 21.0, -12.0, 54.0, 32.0, 54.0, 65.0, 54.0, 76.0, 65.0, 65.0, 32.0, -89.0, -1.0, 54.0, 65.0, 54.0, 32.0, 43.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20275280415901684, "mean_inference_ms": 10.262315236718266, "mean_action_processing_ms": 0.08960177705010768, "mean_env_wait_ms": 0.04448539720745136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048062801361083984, "StateBufferConnector_ms": 0.002938508987426758, "ViewRequirementAgentConnector_ms": 0.08744287490844727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 73025.976, "sample_time_ms": 39815.854, "learn_time_ms": 33202.429, "learn_throughput": 120.473, "synch_weights_time_ms": 7.029}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 2368, "training_iteration": 45, "trial_id": "38794_00001", "date": "2023-06-01_21-29-05", "timestamp": 1685644145, "time_this_iter_s": 82.31916427612305, "time_total_s": 3818.9959919452667, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3818.9959919452667, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 46.30608695652174, "ram_util_percent": 78.20608695652174}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": 32.0, "episode_reward_mean": 45.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 43.0, 54.0, 32.0, 32.0, 32.0, 43.0, 65.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026914882269835, "mean_inference_ms": 10.205328537818307, "mean_action_processing_ms": 0.08730339255861734, "mean_env_wait_ms": 0.043706563035927806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004985332489013672, "StateBufferConnector_ms": 0.0032329559326171875, "ViewRequirementAgentConnector_ms": 0.08966922760009766}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 6.71362829208374, "policy_loss": -0.010780767537653446, "vf_loss": 6.723247051239014, "vf_explained_var": 0.012867601588368416, "kl": 0.015493002720177174, "entropy": 1.9434298276901245, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": 16.38, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 32.0, 65.0, 10.0, -111.0, 65.0, 54.0, 54.0, 76.0, 32.0, 76.0, 76.0, 32.0, 32.0, 10.0, 32.0, 43.0, 65.0, 54.0, -78.0, -12.0, -56.0, -23.0, 32.0, -56.0, -89.0, -23.0, -56.0, 21.0, -12.0, 54.0, 32.0, 54.0, 65.0, 54.0, 76.0, 65.0, 65.0, 32.0, -89.0, -1.0, 54.0, 65.0, 54.0, 32.0, 43.0, 10.0, 10.0, -12.0, 54.0, 10.0, 65.0, 43.0, 76.0, 32.0, -23.0, 21.0, 21.0, 43.0, -1.0, -12.0, 10.0, 21.0, 43.0, 32.0, 21.0, 43.0, 54.0, 54.0, 43.0, 43.0, 21.0, -45.0, -188.0, -78.0, 43.0, 32.0, 43.0, -23.0, 21.0, -56.0, -12.0, 32.0, 65.0, 43.0, 32.0, 54.0, -12.0, 21.0, -12.0, 54.0, -67.0, -56.0, 32.0, 10.0, 10.0, 21.0, 10.0, -89.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20269577157963625, "mean_inference_ms": 10.260283044229187, "mean_action_processing_ms": 0.08956923762102288, "mean_env_wait_ms": 0.04446364727091979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005009174346923828, "StateBufferConnector_ms": 0.0030782222747802734, "ViewRequirementAgentConnector_ms": 0.09071159362792969}}, "episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": 16.38, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 32.0, 65.0, 10.0, -111.0, 65.0, 54.0, 54.0, 76.0, 32.0, 76.0, 76.0, 32.0, 32.0, 10.0, 32.0, 43.0, 65.0, 54.0, -78.0, -12.0, -56.0, -23.0, 32.0, -56.0, -89.0, -23.0, -56.0, 21.0, -12.0, 54.0, 32.0, 54.0, 65.0, 54.0, 76.0, 65.0, 65.0, 32.0, -89.0, -1.0, 54.0, 65.0, 54.0, 32.0, 43.0, 10.0, 10.0, -12.0, 54.0, 10.0, 65.0, 43.0, 76.0, 32.0, -23.0, 21.0, 21.0, 43.0, -1.0, -12.0, 10.0, 21.0, 43.0, 32.0, 21.0, 43.0, 54.0, 54.0, 43.0, 43.0, 21.0, -45.0, -188.0, -78.0, 43.0, 32.0, 43.0, -23.0, 21.0, -56.0, -12.0, 32.0, 65.0, 43.0, 32.0, 54.0, -12.0, 21.0, -12.0, 54.0, -67.0, -56.0, 32.0, 10.0, 10.0, 21.0, 10.0, -89.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20269577157963625, "mean_inference_ms": 10.260283044229187, "mean_action_processing_ms": 0.08956923762102288, "mean_env_wait_ms": 0.04446364727091979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005009174346923828, "StateBufferConnector_ms": 0.0030782222747802734, "ViewRequirementAgentConnector_ms": 0.09071159362792969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 73268.431, "sample_time_ms": 40074.574, "learn_time_ms": 33186.139, "learn_throughput": 120.532, "synch_weights_time_ms": 7.05}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 2421, "training_iteration": 46, "trial_id": "38794_00001", "date": "2023-06-01_21-30-30", "timestamp": 1685644230, "time_this_iter_s": 84.84739398956299, "time_total_s": 3903.8433859348297, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3903.8433859348297, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 49.40423728813559, "ram_util_percent": 78.38389830508476}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 43.0, "episode_reward_mean": 61.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 43.0, 43.0, 54.0, 76.0, 76.0, 76.0, 65.0, 76.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19047945818766637, "mean_inference_ms": 10.218662743218545, "mean_action_processing_ms": 0.08737445228033945, "mean_env_wait_ms": 0.04374156296311606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00537872314453125, "StateBufferConnector_ms": 0.003426074981689453, "ViewRequirementAgentConnector_ms": 0.09642601013183594}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 5.756258010864258, "policy_loss": -0.007665074430406094, "vf_loss": 5.763101100921631, "vf_explained_var": 0.021128108724951744, "kl": 0.01096305251121521, "entropy": 1.809824824333191, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": 19.35, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 76.0, 32.0, -23.0, 21.0, 21.0, 43.0, -1.0, -12.0, 10.0, 21.0, 43.0, 32.0, 21.0, 43.0, 54.0, 54.0, 43.0, 43.0, 21.0, -45.0, -188.0, -78.0, 43.0, 32.0, 43.0, -23.0, 21.0, -56.0, -12.0, 32.0, 65.0, 43.0, 32.0, 54.0, -12.0, 21.0, -12.0, 54.0, -67.0, -56.0, 32.0, 10.0, 10.0, 21.0, 10.0, -89.0, -34.0, 21.0, 65.0, 54.0, -12.0, -67.0, 32.0, -23.0, -1.0, 10.0, -45.0, -56.0, -45.0, -56.0, -23.0, 65.0, 76.0, 65.0, 54.0, 54.0, -34.0, 32.0, 54.0, 76.0, 21.0, -1.0, 43.0, 65.0, 43.0, 76.0, 65.0, 76.0, 54.0, 32.0, 43.0, 32.0, 54.0, 65.0, 54.0, 65.0, 65.0, 43.0, 32.0, 43.0, 65.0, 65.0, 21.0, -23.0, 21.0, 32.0, 32.0, 10.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2026477407828139, "mean_inference_ms": 10.26003192723029, "mean_action_processing_ms": 0.08955015165101443, "mean_env_wait_ms": 0.044449548961182674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005156517028808594, "StateBufferConnector_ms": 0.003184795379638672, "ViewRequirementAgentConnector_ms": 0.09233522415161133}}, "episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": 19.35, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 76.0, 32.0, -23.0, 21.0, 21.0, 43.0, -1.0, -12.0, 10.0, 21.0, 43.0, 32.0, 21.0, 43.0, 54.0, 54.0, 43.0, 43.0, 21.0, -45.0, -188.0, -78.0, 43.0, 32.0, 43.0, -23.0, 21.0, -56.0, -12.0, 32.0, 65.0, 43.0, 32.0, 54.0, -12.0, 21.0, -12.0, 54.0, -67.0, -56.0, 32.0, 10.0, 10.0, 21.0, 10.0, -89.0, -34.0, 21.0, 65.0, 54.0, -12.0, -67.0, 32.0, -23.0, -1.0, 10.0, -45.0, -56.0, -45.0, -56.0, -23.0, 65.0, 76.0, 65.0, 54.0, 54.0, -34.0, 32.0, 54.0, 76.0, 21.0, -1.0, 43.0, 65.0, 43.0, 76.0, 65.0, 76.0, 54.0, 32.0, 43.0, 32.0, 54.0, 65.0, 54.0, 65.0, 65.0, 43.0, 32.0, 43.0, 65.0, 65.0, 21.0, -23.0, 21.0, 32.0, 32.0, 10.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2026477407828139, "mean_inference_ms": 10.26003192723029, "mean_action_processing_ms": 0.08955015165101443, "mean_env_wait_ms": 0.044449548961182674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005156517028808594, "StateBufferConnector_ms": 0.003184795379638672, "ViewRequirementAgentConnector_ms": 0.09233522415161133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 73734.608, "sample_time_ms": 40237.049, "learn_time_ms": 33489.641, "learn_throughput": 119.44, "synch_weights_time_ms": 7.225}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 2473, "training_iteration": 47, "trial_id": "38794_00001", "date": "2023-06-01_21-31-54", "timestamp": 1685644314, "time_this_iter_s": 83.76825904846191, "time_total_s": 3987.6116449832916, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3987.6116449832916, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 47.86410256410256, "ram_util_percent": 78.04273504273506}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 10.0, "episode_reward_mean": 46.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 76.0, 54.0, 54.0, 76.0, 21.0, 32.0, 10.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19023218508081205, "mean_inference_ms": 10.199760123468511, "mean_action_processing_ms": 0.08722246452949113, "mean_env_wait_ms": 0.04365761085761842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004780292510986328, "StateBufferConnector_ms": 0.0028395652770996094, "ViewRequirementAgentConnector_ms": 0.0825810432434082}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 5.981332778930664, "policy_loss": -0.005260867532342672, "vf_loss": 5.986087322235107, "vf_explained_var": -0.002526253927499056, "kl": 0.0067492080852389336, "entropy": 1.6818428039550781, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 21.32, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -23.0, -1.0, 10.0, -45.0, -56.0, -45.0, -56.0, -23.0, 65.0, 76.0, 65.0, 54.0, 54.0, -34.0, 32.0, 54.0, 76.0, 21.0, -1.0, 43.0, 65.0, 43.0, 76.0, 65.0, 76.0, 54.0, 32.0, 43.0, 32.0, 54.0, 65.0, 54.0, 65.0, 65.0, 43.0, 32.0, 43.0, 65.0, 65.0, 21.0, -23.0, 21.0, 32.0, 32.0, 10.0, 10.0, 76.0, 76.0, 48.0, 32.0, -56.0, 10.0, -56.0, 65.0, 65.0, 65.0, 65.0, 54.0, 32.0, 54.0, 76.0, -12.0, -12.0, 10.0, 43.0, -12.0, 32.0, 54.0, 76.0, 65.0, -84.0, -1.0, 54.0, 65.0, 65.0, 21.0, 65.0, 54.0, -12.0, 32.0, -23.0, -1.0, 32.0, -100.0, 43.0, -144.0, -1.0, -45.0, -111.0, 76.0, 32.0, 43.0, -56.0, -12.0, -78.0, -56.0, -34.0, 32.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20276040317439367, "mean_inference_ms": 10.274153868126298, "mean_action_processing_ms": 0.08961362226389881, "mean_env_wait_ms": 0.04448309426615838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005502462387084961, "StateBufferConnector_ms": 0.0032727718353271484, "ViewRequirementAgentConnector_ms": 0.0969092845916748}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 21.32, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -23.0, -1.0, 10.0, -45.0, -56.0, -45.0, -56.0, -23.0, 65.0, 76.0, 65.0, 54.0, 54.0, -34.0, 32.0, 54.0, 76.0, 21.0, -1.0, 43.0, 65.0, 43.0, 76.0, 65.0, 76.0, 54.0, 32.0, 43.0, 32.0, 54.0, 65.0, 54.0, 65.0, 65.0, 43.0, 32.0, 43.0, 65.0, 65.0, 21.0, -23.0, 21.0, 32.0, 32.0, 10.0, 10.0, 76.0, 76.0, 48.0, 32.0, -56.0, 10.0, -56.0, 65.0, 65.0, 65.0, 65.0, 54.0, 32.0, 54.0, 76.0, -12.0, -12.0, 10.0, 43.0, -12.0, 32.0, 54.0, 76.0, 65.0, -84.0, -1.0, 54.0, 65.0, 65.0, 21.0, 65.0, 54.0, -12.0, 32.0, -23.0, -1.0, 32.0, -100.0, 43.0, -144.0, -1.0, -45.0, -111.0, 76.0, 32.0, 43.0, -56.0, -12.0, -78.0, -56.0, -34.0, 32.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20276040317439367, "mean_inference_ms": 10.274153868126298, "mean_action_processing_ms": 0.08961362226389881, "mean_env_wait_ms": 0.04448309426615838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005502462387084961, "StateBufferConnector_ms": 0.0032727718353271484, "ViewRequirementAgentConnector_ms": 0.0969092845916748}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 75225.13, "sample_time_ms": 41371.218, "learn_time_ms": 33845.921, "learn_throughput": 118.183, "synch_weights_time_ms": 7.27}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 2526, "training_iteration": 48, "trial_id": "38794_00001", "date": "2023-06-01_21-33-24", "timestamp": 1685644404, "time_this_iter_s": 90.85981273651123, "time_total_s": 4078.471457719803, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4078.471457719803, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 54.417460317460325, "ram_util_percent": 78.01428571428572}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 10.0, "episode_reward_mean": 43.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 54.0, 21.0, 76.0, 65.0, 10.0, 43.0, 65.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18994658581216495, "mean_inference_ms": 10.180232962835763, "mean_action_processing_ms": 0.08704211554969407, "mean_env_wait_ms": 0.04355465891102529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038909912109375, "StateBufferConnector_ms": 0.0024366378784179688, "ViewRequirementAgentConnector_ms": 0.07947921752929688}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 5.531853199005127, "policy_loss": -0.006389723625034094, "vf_loss": 5.537775039672852, "vf_explained_var": -0.002234641695395112, "kl": 0.006235755980014801, "entropy": 1.5629404783248901, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -177.0, "episode_reward_mean": 17.31, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -56.0, 65.0, 65.0, 65.0, 65.0, 54.0, 32.0, 54.0, 76.0, -12.0, -12.0, 10.0, 43.0, -12.0, 32.0, 54.0, 76.0, 65.0, -84.0, -1.0, 54.0, 65.0, 65.0, 21.0, 65.0, 54.0, -12.0, 32.0, -23.0, -1.0, 32.0, -100.0, 43.0, -144.0, -1.0, -45.0, -111.0, 76.0, 32.0, 43.0, -56.0, -12.0, -78.0, -56.0, -34.0, 32.0, -12.0, -23.0, 76.0, 21.0, 76.0, 54.0, 76.0, 76.0, 32.0, 65.0, 76.0, 65.0, 32.0, 43.0, 76.0, 65.0, 21.0, -45.0, -45.0, -67.0, -45.0, 21.0, 43.0, -12.0, -12.0, 54.0, -56.0, 65.0, 10.0, 54.0, 65.0, -45.0, 43.0, 21.0, 65.0, 65.0, 65.0, 65.0, 76.0, 43.0, 43.0, -67.0, -12.0, 65.0, 21.0, 43.0, 54.0, -12.0, -78.0, 32.0, 10.0, -177.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20287462711441823, "mean_inference_ms": 10.287868865796211, "mean_action_processing_ms": 0.08967008822314726, "mean_env_wait_ms": 0.04451765232143862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00533604621887207, "StateBufferConnector_ms": 0.003128528594970703, "ViewRequirementAgentConnector_ms": 0.09473609924316406}}, "episode_reward_max": 76.0, "episode_reward_min": -177.0, "episode_reward_mean": 17.31, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -56.0, 65.0, 65.0, 65.0, 65.0, 54.0, 32.0, 54.0, 76.0, -12.0, -12.0, 10.0, 43.0, -12.0, 32.0, 54.0, 76.0, 65.0, -84.0, -1.0, 54.0, 65.0, 65.0, 21.0, 65.0, 54.0, -12.0, 32.0, -23.0, -1.0, 32.0, -100.0, 43.0, -144.0, -1.0, -45.0, -111.0, 76.0, 32.0, 43.0, -56.0, -12.0, -78.0, -56.0, -34.0, 32.0, -12.0, -23.0, 76.0, 21.0, 76.0, 54.0, 76.0, 76.0, 32.0, 65.0, 76.0, 65.0, 32.0, 43.0, 76.0, 65.0, 21.0, -45.0, -45.0, -67.0, -45.0, 21.0, 43.0, -12.0, -12.0, 54.0, -56.0, 65.0, 10.0, 54.0, 65.0, -45.0, 43.0, 21.0, 65.0, 65.0, 65.0, 65.0, 76.0, 43.0, 43.0, -67.0, -12.0, 65.0, 21.0, 43.0, 54.0, -12.0, -78.0, 32.0, 10.0, -177.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20287462711441823, "mean_inference_ms": 10.287868865796211, "mean_action_processing_ms": 0.08967008822314726, "mean_env_wait_ms": 0.04451765232143862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00533604621887207, "StateBufferConnector_ms": 0.003128528594970703, "ViewRequirementAgentConnector_ms": 0.09473609924316406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 75225.902, "sample_time_ms": 41552.119, "learn_time_ms": 33665.884, "learn_throughput": 118.815, "synch_weights_time_ms": 7.167}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 2578, "training_iteration": 49, "trial_id": "38794_00001", "date": "2023-06-01_21-34-45", "timestamp": 1685644485, "time_this_iter_s": 80.73822689056396, "time_total_s": 4159.209684610367, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4159.209684610367, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 47.03628318584071, "ram_util_percent": 77.8867256637168}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -122.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.0, 32.0, -1.0, -45.0, 65.0, 43.0, 10.0, 65.0, 54.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1902038124196702, "mean_inference_ms": 10.189617964121004, "mean_action_processing_ms": 0.08713295922706367, "mean_env_wait_ms": 0.043603370780741044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005972385406494141, "StateBufferConnector_ms": 0.002880096435546875, "ViewRequirementAgentConnector_ms": 0.09364604949951172}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 4.834336757659912, "policy_loss": -0.007231933064758778, "vf_loss": 4.840909004211426, "vf_explained_var": -0.008390853181481361, "kl": 0.008789585903286934, "entropy": 1.544743299484253, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -177.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 32.0, 65.0, 76.0, 65.0, 32.0, 43.0, 76.0, 65.0, 21.0, -45.0, -45.0, -67.0, -45.0, 21.0, 43.0, -12.0, -12.0, 54.0, -56.0, 65.0, 10.0, 54.0, 65.0, -45.0, 43.0, 21.0, 65.0, 65.0, 65.0, 65.0, 76.0, 43.0, 43.0, -67.0, -12.0, 65.0, 21.0, 43.0, 54.0, -12.0, -78.0, 32.0, 10.0, -177.0, 32.0, 76.0, 76.0, -1.0, 10.0, 21.0, 54.0, 65.0, 76.0, 32.0, 21.0, -89.0, 32.0, 21.0, 76.0, 76.0, 76.0, 32.0, 76.0, 43.0, 10.0, 54.0, 10.0, -1.0, -34.0, -23.0, 54.0, 65.0, 54.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 76.0, 76.0, 10.0, 76.0, 43.0, 21.0, -89.0, 54.0, 21.0, -45.0, 10.0, 32.0, 21.0, -23.0, 43.0, 21.0, 65.0, 54.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2026112917983891, "mean_inference_ms": 10.275853305666441, "mean_action_processing_ms": 0.089531849728812, "mean_env_wait_ms": 0.04443915257431701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046803951263427734, "StateBufferConnector_ms": 0.002799510955810547, "ViewRequirementAgentConnector_ms": 0.08399581909179688}}, "episode_reward_max": 76.0, "episode_reward_min": -177.0, "episode_reward_mean": 28.7, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 32.0, 65.0, 76.0, 65.0, 32.0, 43.0, 76.0, 65.0, 21.0, -45.0, -45.0, -67.0, -45.0, 21.0, 43.0, -12.0, -12.0, 54.0, -56.0, 65.0, 10.0, 54.0, 65.0, -45.0, 43.0, 21.0, 65.0, 65.0, 65.0, 65.0, 76.0, 43.0, 43.0, -67.0, -12.0, 65.0, 21.0, 43.0, 54.0, -12.0, -78.0, 32.0, 10.0, -177.0, 32.0, 76.0, 76.0, -1.0, 10.0, 21.0, 54.0, 65.0, 76.0, 32.0, 21.0, -89.0, 32.0, 21.0, 76.0, 76.0, 76.0, 32.0, 76.0, 43.0, 10.0, 54.0, 10.0, -1.0, -34.0, -23.0, 54.0, 65.0, 54.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 76.0, 76.0, 10.0, 76.0, 43.0, 21.0, -89.0, 54.0, 21.0, -45.0, 10.0, 32.0, 21.0, -23.0, 43.0, 21.0, 65.0, 54.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2026112917983891, "mean_inference_ms": 10.275853305666441, "mean_action_processing_ms": 0.089531849728812, "mean_env_wait_ms": 0.04443915257431701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046803951263427734, "StateBufferConnector_ms": 0.002799510955810547, "ViewRequirementAgentConnector_ms": 0.08399581909179688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 74916.194, "sample_time_ms": 41397.472, "learn_time_ms": 33510.786, "learn_throughput": 119.365, "synch_weights_time_ms": 7.181}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 2631, "training_iteration": 50, "trial_id": "38794_00001", "date": "2023-06-01_21-36-05", "timestamp": 1685644565, "time_this_iter_s": 79.63817501068115, "time_total_s": 4238.847859621048, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4238.847859621048, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 46.96126126126127, "ram_util_percent": 75.77567567567566}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -34.0, "episode_reward_mean": 22.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 10.0, 43.0, 76.0, -12.0, 65.0, 43.0, -34.0, -7.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004609371307438, "mean_inference_ms": 10.178904904783094, "mean_action_processing_ms": 0.08705396689865749, "mean_env_wait_ms": 0.043547450873336384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005056858062744141, "StateBufferConnector_ms": 0.0028586387634277344, "ViewRequirementAgentConnector_ms": 0.08143424987792969}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 5.3202900886535645, "policy_loss": -0.006755614187568426, "vf_loss": 5.3262481689453125, "vf_explained_var": 0.015304435044527054, "kl": 0.010626838542521, "entropy": 1.5356311798095703, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 33.65, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 76.0, 32.0, 21.0, -89.0, 32.0, 21.0, 76.0, 76.0, 76.0, 32.0, 76.0, 43.0, 10.0, 54.0, 10.0, -1.0, -34.0, -23.0, 54.0, 65.0, 54.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 76.0, 76.0, 10.0, 76.0, 43.0, 21.0, -89.0, 54.0, 21.0, -45.0, 10.0, 32.0, 21.0, -23.0, 43.0, 21.0, 65.0, 54.0, 65.0, 76.0, 32.0, -23.0, -23.0, 21.0, 32.0, 32.0, -34.0, 54.0, 65.0, 65.0, 65.0, 76.0, 65.0, 54.0, 54.0, 54.0, -34.0, 54.0, 76.0, 43.0, 76.0, 10.0, 43.0, 54.0, 76.0, 54.0, -23.0, 43.0, 54.0, 43.0, 65.0, 54.0, 65.0, 76.0, 54.0, 43.0, 43.0, -1.0, -56.0, -56.0, 43.0, 65.0, 43.0, 76.0, 32.0, 21.0, -1.0, -45.0, -1.0, 10.0, 21.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20234661125735032, "mean_inference_ms": 10.263012819658618, "mean_action_processing_ms": 0.08939634563090743, "mean_env_wait_ms": 0.04435190801673727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004631519317626953, "StateBufferConnector_ms": 0.0027761459350585938, "ViewRequirementAgentConnector_ms": 0.08475422859191895}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 33.65, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, 76.0, 32.0, 21.0, -89.0, 32.0, 21.0, 76.0, 76.0, 76.0, 32.0, 76.0, 43.0, 10.0, 54.0, 10.0, -1.0, -34.0, -23.0, 54.0, 65.0, 54.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 76.0, 76.0, 10.0, 76.0, 43.0, 21.0, -89.0, 54.0, 21.0, -45.0, 10.0, 32.0, 21.0, -23.0, 43.0, 21.0, 65.0, 54.0, 65.0, 76.0, 32.0, -23.0, -23.0, 21.0, 32.0, 32.0, -34.0, 54.0, 65.0, 65.0, 65.0, 76.0, 65.0, 54.0, 54.0, 54.0, -34.0, 54.0, 76.0, 43.0, 76.0, 10.0, 43.0, 54.0, 76.0, 54.0, -23.0, 43.0, 54.0, 43.0, 65.0, 54.0, 65.0, 76.0, 54.0, 43.0, 43.0, -1.0, -56.0, -56.0, 43.0, 65.0, 43.0, 76.0, 32.0, 21.0, -1.0, -45.0, -1.0, 10.0, 21.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20234661125735032, "mean_inference_ms": 10.263012819658618, "mean_action_processing_ms": 0.08939634563090743, "mean_env_wait_ms": 0.04435190801673727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004631519317626953, "StateBufferConnector_ms": 0.0027761459350585938, "ViewRequirementAgentConnector_ms": 0.08475422859191895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 74728.071, "sample_time_ms": 41335.343, "learn_time_ms": 33384.927, "learn_throughput": 119.815, "synch_weights_time_ms": 7.067}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 2684, "training_iteration": 51, "trial_id": "38794_00001", "date": "2023-06-01_21-37-26", "timestamp": 1685644646, "time_this_iter_s": 81.05227589607239, "time_total_s": 4319.90013551712, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4319.90013551712, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 44.6646017699115, "ram_util_percent": 63.19469026548673}}
{"evaluation": {"episode_reward_max": -1.0, "episode_reward_min": -122.0, "episode_reward_mean": -36.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, -34.0, -34.0, -45.0, -1.0, -34.0, -122.0, -34.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1898254207662145, "mean_inference_ms": 10.164520204261787, "mean_action_processing_ms": 0.08694273339438507, "mean_env_wait_ms": 0.0434621547549267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005328655242919922, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.08686304092407227}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 5.441133499145508, "policy_loss": -0.004547587595880032, "vf_loss": 5.444699764251709, "vf_explained_var": 0.043786026537418365, "kl": 0.013088951818645, "entropy": 1.3755748271942139, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 31.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 32.0, -34.0, 54.0, 65.0, 65.0, 65.0, 76.0, 65.0, 54.0, 54.0, 54.0, -34.0, 54.0, 76.0, 43.0, 76.0, 10.0, 43.0, 54.0, 76.0, 54.0, -23.0, 43.0, 54.0, 43.0, 65.0, 54.0, 65.0, 76.0, 54.0, 43.0, 43.0, -1.0, -56.0, -56.0, 43.0, 65.0, 43.0, 76.0, 32.0, 21.0, -1.0, -45.0, -1.0, 10.0, 21.0, -45.0, -100.0, -23.0, -56.0, -73.0, -56.0, -56.0, 76.0, 76.0, 76.0, 76.0, 76.0, 43.0, 32.0, 43.0, 76.0, 43.0, -1.0, 10.0, 32.0, 32.0, 43.0, 43.0, 76.0, -1.0, 65.0, 76.0, 32.0, -23.0, 10.0, 76.0, 76.0, 54.0, 43.0, 76.0, 43.0, 65.0, 76.0, 76.0, 76.0, 65.0, -12.0, 43.0, -1.0, -34.0, -23.0, -23.0, 54.0, 54.0, 54.0, 32.0, -1.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2021577903371635, "mean_inference_ms": 10.252834938456594, "mean_action_processing_ms": 0.08930125052623698, "mean_env_wait_ms": 0.04428995874662231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004658222198486328, "StateBufferConnector_ms": 0.0028448104858398438, "ViewRequirementAgentConnector_ms": 0.08569860458374023}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 31.5, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 32.0, -34.0, 54.0, 65.0, 65.0, 65.0, 76.0, 65.0, 54.0, 54.0, 54.0, -34.0, 54.0, 76.0, 43.0, 76.0, 10.0, 43.0, 54.0, 76.0, 54.0, -23.0, 43.0, 54.0, 43.0, 65.0, 54.0, 65.0, 76.0, 54.0, 43.0, 43.0, -1.0, -56.0, -56.0, 43.0, 65.0, 43.0, 76.0, 32.0, 21.0, -1.0, -45.0, -1.0, 10.0, 21.0, -45.0, -100.0, -23.0, -56.0, -73.0, -56.0, -56.0, 76.0, 76.0, 76.0, 76.0, 76.0, 43.0, 32.0, 43.0, 76.0, 43.0, -1.0, 10.0, 32.0, 32.0, 43.0, 43.0, 76.0, -1.0, 65.0, 76.0, 32.0, -23.0, 10.0, 76.0, 76.0, 54.0, 43.0, 76.0, 43.0, 65.0, 76.0, 76.0, 76.0, 65.0, -12.0, 43.0, -1.0, -34.0, -23.0, -23.0, 54.0, 54.0, 54.0, 32.0, -1.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2021577903371635, "mean_inference_ms": 10.252834938456594, "mean_action_processing_ms": 0.08930125052623698, "mean_env_wait_ms": 0.04428995874662231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004658222198486328, "StateBufferConnector_ms": 0.0028448104858398438, "ViewRequirementAgentConnector_ms": 0.08569860458374023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 74824.706, "sample_time_ms": 41409.318, "learn_time_ms": 33407.594, "learn_throughput": 119.733, "synch_weights_time_ms": 7.058}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 2736, "training_iteration": 52, "trial_id": "38794_00001", "date": "2023-06-01_21-38-46", "timestamp": 1685644726, "time_this_iter_s": 79.9032142162323, "time_total_s": 4399.803349733353, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4399.803349733353, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 44.09464285714285, "ram_util_percent": 59.698214285714286}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -31.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.0, -12.0, -45.0, -1.0, -12.0, -56.0, -78.0, -45.0, -23.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18983374865756295, "mean_inference_ms": 10.162946428023506, "mean_action_processing_ms": 0.08695689235187323, "mean_env_wait_ms": 0.04346797862902514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005431175231933594, "StateBufferConnector_ms": 0.0029325485229492188, "ViewRequirementAgentConnector_ms": 0.08988142013549805}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 4.361073017120361, "policy_loss": -0.01046033762395382, "vf_loss": 4.3706793785095215, "vf_explained_var": -0.001510533969849348, "kl": 0.011383245699107647, "entropy": 1.01372492313385, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 44.65, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 76.0, 76.0, 76.0, 76.0, 76.0, 43.0, 32.0, 43.0, 76.0, 43.0, -1.0, 10.0, 32.0, 32.0, 43.0, 43.0, 76.0, -1.0, 65.0, 76.0, 32.0, -23.0, 10.0, 76.0, 76.0, 54.0, 43.0, 76.0, 43.0, 65.0, 76.0, 76.0, 76.0, 65.0, -12.0, 43.0, -1.0, -34.0, -23.0, -23.0, 54.0, 54.0, 54.0, 32.0, -1.0, -23.0, 21.0, 65.0, 32.0, 76.0, 76.0, 76.0, 54.0, 54.0, 54.0, 54.0, 54.0, 65.0, 76.0, 76.0, 76.0, 10.0, 32.0, 21.0, -23.0, 10.0, 32.0, -34.0, -56.0, 21.0, 43.0, -1.0, 10.0, 76.0, 65.0, 54.0, 76.0, 54.0, 54.0, 54.0, 76.0, 65.0, 76.0, 76.0, 65.0, 21.0, 76.0, 65.0, 76.0, 65.0, 65.0, 76.0, 65.0, 76.0, 54.0, 65.0, 76.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2019504962348406, "mean_inference_ms": 10.240569094907388, "mean_action_processing_ms": 0.08920590362119821, "mean_env_wait_ms": 0.04422801921947345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004630327224731445, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.08531522750854492}}, "episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 44.65, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, 76.0, 76.0, 76.0, 76.0, 76.0, 43.0, 32.0, 43.0, 76.0, 43.0, -1.0, 10.0, 32.0, 32.0, 43.0, 43.0, 76.0, -1.0, 65.0, 76.0, 32.0, -23.0, 10.0, 76.0, 76.0, 54.0, 43.0, 76.0, 43.0, 65.0, 76.0, 76.0, 76.0, 65.0, -12.0, 43.0, -1.0, -34.0, -23.0, -23.0, 54.0, 54.0, 54.0, 32.0, -1.0, -23.0, 21.0, 65.0, 32.0, 76.0, 76.0, 76.0, 54.0, 54.0, 54.0, 54.0, 54.0, 65.0, 76.0, 76.0, 76.0, 10.0, 32.0, 21.0, -23.0, 10.0, 32.0, -34.0, -56.0, 21.0, 43.0, -1.0, 10.0, 76.0, 65.0, 54.0, 76.0, 54.0, 54.0, 54.0, 76.0, 65.0, 76.0, 76.0, 65.0, 21.0, 76.0, 65.0, 76.0, 65.0, 65.0, 76.0, 65.0, 76.0, 54.0, 65.0, 76.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2019504962348406, "mean_inference_ms": 10.240569094907388, "mean_action_processing_ms": 0.08920590362119821, "mean_env_wait_ms": 0.04422801921947345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004630327224731445, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.08531522750854492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 74648.512, "sample_time_ms": 41531.396, "learn_time_ms": 33109.673, "learn_throughput": 120.811, "synch_weights_time_ms": 6.751}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 2789, "training_iteration": 53, "trial_id": "38794_00001", "date": "2023-06-01_21-40-06", "timestamp": 1685644806, "time_this_iter_s": 80.18282008171082, "time_total_s": 4479.9861698150635, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4479.9861698150635, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 45.845535714285724, "ram_util_percent": 64.77767857142858}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 17.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 43.0, 76.0, 21.0, -45.0, -89.0, -34.0, 32.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18974977819860506, "mean_inference_ms": 10.15569349207936, "mean_action_processing_ms": 0.0869029533944107, "mean_env_wait_ms": 0.043421396255632586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004944801330566406, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.0899362564086914}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 4.394964694976807, "policy_loss": -0.008572612889111042, "vf_loss": 4.40287446975708, "vf_explained_var": 0.002839011140167713, "kl": 0.00883598905056715, "entropy": 0.7791928648948669, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 45.09, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 54.0, 54.0, 54.0, 65.0, 76.0, 76.0, 76.0, 10.0, 32.0, 21.0, -23.0, 10.0, 32.0, -34.0, -56.0, 21.0, 43.0, -1.0, 10.0, 76.0, 65.0, 54.0, 76.0, 54.0, 54.0, 54.0, 76.0, 65.0, 76.0, 76.0, 65.0, 21.0, 76.0, 65.0, 76.0, 65.0, 65.0, 76.0, 65.0, 76.0, 54.0, 65.0, 76.0, 43.0, 76.0, 32.0, 54.0, -12.0, 43.0, 76.0, 21.0, -78.0, 76.0, -56.0, 54.0, 43.0, -1.0, -67.0, -78.0, 43.0, 76.0, 21.0, -23.0, -12.0, 21.0, 76.0, 76.0, 76.0, 76.0, 65.0, 76.0, 43.0, 76.0, 65.0, 54.0, 65.0, 43.0, 54.0, 54.0, 32.0, 65.0, 32.0, 43.0, -12.0, 21.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 76.0, 65.0, 65.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2017933572944001, "mean_inference_ms": 10.230098414660064, "mean_action_processing_ms": 0.08912948986886489, "mean_env_wait_ms": 0.044184163871406924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004743814468383789, "StateBufferConnector_ms": 0.0028197765350341797, "ViewRequirementAgentConnector_ms": 0.08708357810974121}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 45.09, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 54.0, 54.0, 54.0, 65.0, 76.0, 76.0, 76.0, 10.0, 32.0, 21.0, -23.0, 10.0, 32.0, -34.0, -56.0, 21.0, 43.0, -1.0, 10.0, 76.0, 65.0, 54.0, 76.0, 54.0, 54.0, 54.0, 76.0, 65.0, 76.0, 76.0, 65.0, 21.0, 76.0, 65.0, 76.0, 65.0, 65.0, 76.0, 65.0, 76.0, 54.0, 65.0, 76.0, 43.0, 76.0, 32.0, 54.0, -12.0, 43.0, 76.0, 21.0, -78.0, 76.0, -56.0, 54.0, 43.0, -1.0, -67.0, -78.0, 43.0, 76.0, 21.0, -23.0, -12.0, 21.0, 76.0, 76.0, 76.0, 76.0, 65.0, 76.0, 43.0, 76.0, 65.0, 54.0, 65.0, 43.0, 54.0, 54.0, 32.0, 65.0, 32.0, 43.0, -12.0, 21.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 76.0, 65.0, 65.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2017933572944001, "mean_inference_ms": 10.230098414660064, "mean_action_processing_ms": 0.08912948986886489, "mean_env_wait_ms": 0.044184163871406924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004743814468383789, "StateBufferConnector_ms": 0.0028197765350341797, "ViewRequirementAgentConnector_ms": 0.08708357810974121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 74555.371, "sample_time_ms": 41482.759, "learn_time_ms": 33065.126, "learn_throughput": 120.973, "synch_weights_time_ms": 6.781}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 2842, "training_iteration": 54, "trial_id": "38794_00001", "date": "2023-06-01_21-41-27", "timestamp": 1685644887, "time_this_iter_s": 80.49635624885559, "time_total_s": 4560.482526063919, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4560.482526063919, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 47.62589285714286, "ram_util_percent": 67.64285714285714}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -1.0, "episode_reward_mean": 61.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 43.0, 65.0, 76.0, 76.0, 76.0, 76.0, 76.0, 54.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1896186917681594, "mean_inference_ms": 10.146688272535469, "mean_action_processing_ms": 0.08681672534453025, "mean_env_wait_ms": 0.04336023521190631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004756450653076172, "StateBufferConnector_ms": 0.0028181076049804688, "ViewRequirementAgentConnector_ms": 0.08447647094726562}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 5.296004772186279, "policy_loss": -0.008643051609396935, "vf_loss": 5.3041605949401855, "vf_explained_var": -0.0031113361474126577, "kl": 0.006496354006230831, "entropy": 0.8419449925422668, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 37.39, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -78.0, 76.0, -56.0, 54.0, 43.0, -1.0, -67.0, -78.0, 43.0, 76.0, 21.0, -23.0, -12.0, 21.0, 76.0, 76.0, 76.0, 76.0, 65.0, 76.0, 43.0, 76.0, 65.0, 54.0, 65.0, 43.0, 54.0, 54.0, 32.0, 65.0, 32.0, 43.0, -12.0, 21.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 76.0, 65.0, 65.0, 43.0, 54.0, 65.0, 54.0, 76.0, 43.0, 43.0, 65.0, -12.0, 21.0, 32.0, 65.0, 76.0, 21.0, 54.0, 65.0, 76.0, 76.0, 32.0, 76.0, -1.0, 10.0, -56.0, 43.0, 65.0, 32.0, 21.0, 32.0, 54.0, 10.0, 65.0, 65.0, 10.0, -1.0, -56.0, -1.0, 65.0, 54.0, 76.0, 54.0, 10.0, 65.0, 54.0, 65.0, -23.0, -12.0, -12.0, 54.0, 76.0, -1.0, -56.0, -1.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20159792406933935, "mean_inference_ms": 10.217675505513323, "mean_action_processing_ms": 0.08902838401562345, "mean_env_wait_ms": 0.044127533645496486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004664421081542969, "StateBufferConnector_ms": 0.0026972293853759766, "ViewRequirementAgentConnector_ms": 0.08548402786254883}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 37.39, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -78.0, 76.0, -56.0, 54.0, 43.0, -1.0, -67.0, -78.0, 43.0, 76.0, 21.0, -23.0, -12.0, 21.0, 76.0, 76.0, 76.0, 76.0, 65.0, 76.0, 43.0, 76.0, 65.0, 54.0, 65.0, 43.0, 54.0, 54.0, 32.0, 65.0, 32.0, 43.0, -12.0, 21.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 76.0, 65.0, 65.0, 43.0, 54.0, 65.0, 54.0, 76.0, 43.0, 43.0, 65.0, -12.0, 21.0, 32.0, 65.0, 76.0, 21.0, 54.0, 65.0, 76.0, 76.0, 32.0, 76.0, -1.0, 10.0, -56.0, 43.0, 65.0, 32.0, 21.0, 32.0, 54.0, 10.0, 65.0, 65.0, 10.0, -1.0, -56.0, -1.0, 65.0, 54.0, 76.0, 54.0, 10.0, 65.0, 54.0, 65.0, -23.0, -12.0, -12.0, 54.0, 76.0, -1.0, -56.0, -1.0, 32.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20159792406933935, "mean_inference_ms": 10.217675505513323, "mean_action_processing_ms": 0.08902838401562345, "mean_env_wait_ms": 0.044127533645496486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004664421081542969, "StateBufferConnector_ms": 0.0026972293853759766, "ViewRequirementAgentConnector_ms": 0.08548402786254883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 74266.761, "sample_time_ms": 41354.447, "learn_time_ms": 32904.834, "learn_throughput": 121.563, "synch_weights_time_ms": 6.81}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 2894, "training_iteration": 55, "trial_id": "38794_00001", "date": "2023-06-01_21-42-45", "timestamp": 1685644965, "time_this_iter_s": 78.89490723609924, "time_total_s": 4639.377433300018, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4639.377433300018, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 44.81818181818181, "ram_util_percent": 67.41090909090909}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 52.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, 10.0, 76.0, 76.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.189406164679345, "mean_inference_ms": 10.131662242218352, "mean_action_processing_ms": 0.08669307011695979, "mean_env_wait_ms": 0.04327465545044103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004804134368896484, "StateBufferConnector_ms": 0.002803802490234375, "ViewRequirementAgentConnector_ms": 0.08577823638916016}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 4.742034912109375, "policy_loss": -0.008870520628988743, "vf_loss": 4.750356197357178, "vf_explained_var": 0.00305735832080245, "kl": 0.007326349150389433, "entropy": 0.6949050426483154, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 34.64, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -12.0, 21.0, 32.0, 65.0, 76.0, 21.0, 54.0, 65.0, 76.0, 76.0, 32.0, 76.0, -1.0, 10.0, -56.0, 43.0, 65.0, 32.0, 21.0, 32.0, 54.0, 10.0, 65.0, 65.0, 10.0, -1.0, -56.0, -1.0, 65.0, 54.0, 76.0, 54.0, 10.0, 65.0, 54.0, 65.0, -23.0, -12.0, -12.0, 54.0, 76.0, -1.0, -56.0, -1.0, 32.0, 21.0, 10.0, -111.0, 65.0, 10.0, 65.0, 76.0, -12.0, 65.0, 65.0, 76.0, 76.0, 76.0, 54.0, 10.0, 32.0, 65.0, 43.0, -23.0, -23.0, -12.0, 54.0, 65.0, 76.0, 10.0, 43.0, 76.0, 43.0, -12.0, 10.0, 76.0, 76.0, 21.0, -1.0, 43.0, 76.0, 54.0, 54.0, 76.0, 65.0, 76.0, 76.0, 65.0, 43.0, 43.0, -56.0, 43.0, 54.0, -23.0, 32.0, -12.0, 65.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20148214261086791, "mean_inference_ms": 10.213400860998155, "mean_action_processing_ms": 0.08896819769543363, "mean_env_wait_ms": 0.04409289198103927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004914999008178711, "StateBufferConnector_ms": 0.0028498172760009766, "ViewRequirementAgentConnector_ms": 0.08944821357727051}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 34.64, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, -12.0, 21.0, 32.0, 65.0, 76.0, 21.0, 54.0, 65.0, 76.0, 76.0, 32.0, 76.0, -1.0, 10.0, -56.0, 43.0, 65.0, 32.0, 21.0, 32.0, 54.0, 10.0, 65.0, 65.0, 10.0, -1.0, -56.0, -1.0, 65.0, 54.0, 76.0, 54.0, 10.0, 65.0, 54.0, 65.0, -23.0, -12.0, -12.0, 54.0, 76.0, -1.0, -56.0, -1.0, 32.0, 21.0, 10.0, -111.0, 65.0, 10.0, 65.0, 76.0, -12.0, 65.0, 65.0, 76.0, 76.0, 76.0, 54.0, 10.0, 32.0, 65.0, 43.0, -23.0, -23.0, -12.0, 54.0, 65.0, 76.0, 10.0, 43.0, 76.0, 43.0, -12.0, 10.0, 76.0, 76.0, 21.0, -1.0, 43.0, 76.0, 54.0, 54.0, 76.0, 65.0, 76.0, 76.0, 65.0, 43.0, 43.0, -56.0, 43.0, 54.0, -23.0, 32.0, -12.0, 65.0, 54.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20148214261086791, "mean_inference_ms": 10.213400860998155, "mean_action_processing_ms": 0.08896819769543363, "mean_env_wait_ms": 0.04409289198103927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004914999008178711, "StateBufferConnector_ms": 0.0028498172760009766, "ViewRequirementAgentConnector_ms": 0.08944821357727051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 74369.804, "sample_time_ms": 41324.767, "learn_time_ms": 33036.094, "learn_throughput": 121.08, "synch_weights_time_ms": 8.268}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 2947, "training_iteration": 56, "trial_id": "38794_00001", "date": "2023-06-01_21-44-11", "timestamp": 1685645051, "time_this_iter_s": 85.4576461315155, "time_total_s": 4724.835079431534, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4724.835079431534, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 49.20840336134454, "ram_util_percent": 67.86218487394959}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 54.0, "episode_reward_mean": 70.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, 65.0, 76.0, 54.0, 54.0, 76.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18919892611699196, "mean_inference_ms": 10.119873357802634, "mean_action_processing_ms": 0.08657410579530025, "mean_env_wait_ms": 0.04319935959326186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004782676696777344, "StateBufferConnector_ms": 0.0027942657470703125, "ViewRequirementAgentConnector_ms": 0.08065462112426758}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 5.706674575805664, "policy_loss": -0.0065287151373922825, "vf_loss": 5.712839603424072, "vf_explained_var": 0.0008223107433877885, "kl": 0.0048530749045312405, "entropy": 0.5509518384933472, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 22.32, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 65.0, 65.0, 76.0, 76.0, 76.0, 54.0, 10.0, 32.0, 65.0, 43.0, -23.0, -23.0, -12.0, 54.0, 65.0, 76.0, 10.0, 43.0, 76.0, 43.0, -12.0, 10.0, 76.0, 76.0, 21.0, -1.0, 43.0, 76.0, 54.0, 54.0, 76.0, 65.0, 76.0, 76.0, 65.0, 43.0, 43.0, -56.0, 43.0, 54.0, -23.0, 32.0, -12.0, 65.0, 54.0, 32.0, -67.0, -45.0, -100.0, -1.0, 54.0, 54.0, 76.0, 54.0, -12.0, -89.0, 65.0, 21.0, -78.0, -23.0, 76.0, 43.0, -67.0, -111.0, 32.0, -89.0, -23.0, 65.0, 76.0, 76.0, 65.0, 43.0, -45.0, 21.0, 21.0, 10.0, -89.0, 76.0, 65.0, 65.0, -67.0, 32.0, 76.0, 65.0, -23.0, -34.0, 10.0, -1.0, 76.0, -1.0, 76.0, 76.0, 76.0, 54.0, -111.0, 32.0, -100.0, -67.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20132358999382716, "mean_inference_ms": 10.20752300131417, "mean_action_processing_ms": 0.08888647342892743, "mean_env_wait_ms": 0.044048340689487625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004951953887939453, "StateBufferConnector_ms": 0.0029463768005371094, "ViewRequirementAgentConnector_ms": 0.08793807029724121}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 22.32, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, 65.0, 65.0, 76.0, 76.0, 76.0, 54.0, 10.0, 32.0, 65.0, 43.0, -23.0, -23.0, -12.0, 54.0, 65.0, 76.0, 10.0, 43.0, 76.0, 43.0, -12.0, 10.0, 76.0, 76.0, 21.0, -1.0, 43.0, 76.0, 54.0, 54.0, 76.0, 65.0, 76.0, 76.0, 65.0, 43.0, 43.0, -56.0, 43.0, 54.0, -23.0, 32.0, -12.0, 65.0, 54.0, 32.0, -67.0, -45.0, -100.0, -1.0, 54.0, 54.0, 76.0, 54.0, -12.0, -89.0, 65.0, 21.0, -78.0, -23.0, 76.0, 43.0, -67.0, -111.0, 32.0, -89.0, -23.0, 65.0, 76.0, 76.0, 65.0, 43.0, -45.0, 21.0, 21.0, 10.0, -89.0, 76.0, 65.0, 65.0, -67.0, 32.0, 76.0, 65.0, -23.0, -34.0, 10.0, -1.0, 76.0, -1.0, 76.0, 76.0, 76.0, 54.0, -111.0, 32.0, -100.0, -67.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20132358999382716, "mean_inference_ms": 10.20752300131417, "mean_action_processing_ms": 0.08888647342892743, "mean_env_wait_ms": 0.044048340689487625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004951953887939453, "StateBufferConnector_ms": 0.0029463768005371094, "ViewRequirementAgentConnector_ms": 0.08793807029724121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 73968.442, "sample_time_ms": 41063.318, "learn_time_ms": 32896.402, "learn_throughput": 121.594, "synch_weights_time_ms": 8.014}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 3000, "training_iteration": 57, "trial_id": "38794_00001", "date": "2023-06-01_21-45-30", "timestamp": 1685645130, "time_this_iter_s": 78.67372298240662, "time_total_s": 4803.50880241394, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4803.50880241394, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 44.10825688073394, "ram_util_percent": 65.52201834862386}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 8.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 76.0, 54.0, 32.0, 54.0, 32.0, -111.0, -133.0, -12.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18901019711770398, "mean_inference_ms": 10.109524834932447, "mean_action_processing_ms": 0.08645885958461388, "mean_env_wait_ms": 0.043131224984322855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004613399505615234, "StateBufferConnector_ms": 0.002586841583251953, "ViewRequirementAgentConnector_ms": 0.08659124374389648}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 4.643710136413574, "policy_loss": -0.00784712377935648, "vf_loss": 4.651408672332764, "vf_explained_var": 0.00045981822768226266, "kl": 0.003963554743677378, "entropy": 0.44590073823928833, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 18.69, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 54.0, -12.0, -89.0, 65.0, 21.0, -78.0, -23.0, 76.0, 43.0, -67.0, -111.0, 32.0, -89.0, -23.0, 65.0, 76.0, 76.0, 65.0, 43.0, -45.0, 21.0, 21.0, 10.0, -89.0, 76.0, 65.0, 65.0, -67.0, 32.0, 76.0, 65.0, -23.0, -34.0, 10.0, -1.0, 76.0, -1.0, 76.0, 76.0, 76.0, 54.0, -111.0, 32.0, -100.0, -67.0, -45.0, -34.0, 54.0, -56.0, -45.0, 76.0, -12.0, -1.0, -133.0, 21.0, 32.0, -34.0, 65.0, 65.0, 76.0, 76.0, 76.0, 76.0, 54.0, 65.0, 76.0, 76.0, -78.0, -23.0, 65.0, 76.0, 65.0, 54.0, 76.0, 54.0, 21.0, 54.0, -1.0, -1.0, -12.0, -166.0, 43.0, 43.0, -56.0, -56.0, 76.0, -56.0, -1.0, 21.0, 43.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20106868174187378, "mean_inference_ms": 10.194043600279791, "mean_action_processing_ms": 0.08876025556732378, "mean_env_wait_ms": 0.04397422329501722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046863555908203125, "StateBufferConnector_ms": 0.002819061279296875, "ViewRequirementAgentConnector_ms": 0.08264708518981934}}, "episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 18.69, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 54.0, -12.0, -89.0, 65.0, 21.0, -78.0, -23.0, 76.0, 43.0, -67.0, -111.0, 32.0, -89.0, -23.0, 65.0, 76.0, 76.0, 65.0, 43.0, -45.0, 21.0, 21.0, 10.0, -89.0, 76.0, 65.0, 65.0, -67.0, 32.0, 76.0, 65.0, -23.0, -34.0, 10.0, -1.0, 76.0, -1.0, 76.0, 76.0, 76.0, 54.0, -111.0, 32.0, -100.0, -67.0, -45.0, -34.0, 54.0, -56.0, -45.0, 76.0, -12.0, -1.0, -133.0, 21.0, 32.0, -34.0, 65.0, 65.0, 76.0, 76.0, 76.0, 76.0, 54.0, 65.0, 76.0, 76.0, -78.0, -23.0, 65.0, 76.0, 65.0, 54.0, 76.0, 54.0, 21.0, 54.0, -1.0, -1.0, -12.0, -166.0, 43.0, 43.0, -56.0, -56.0, 76.0, -56.0, -1.0, 21.0, 43.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20106868174187378, "mean_inference_ms": 10.194043600279791, "mean_action_processing_ms": 0.08876025556732378, "mean_env_wait_ms": 0.04397422329501722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046863555908203125, "StateBufferConnector_ms": 0.002819061279296875, "ViewRequirementAgentConnector_ms": 0.08264708518981934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 72803.882, "sample_time_ms": 40118.98, "learn_time_ms": 32676.236, "learn_throughput": 122.413, "synch_weights_time_ms": 7.958}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 3052, "training_iteration": 58, "trial_id": "38794_00001", "date": "2023-06-01_21-46-49", "timestamp": 1685645209, "time_this_iter_s": 79.37209701538086, "time_total_s": 4882.880899429321, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4882.880899429321, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 43.719819819819826, "ram_util_percent": 63.85495495495495}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": 6.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 76.0, 21.0, 54.0, -45.0, 43.0, 54.0, -122.0, -78.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18883223612427974, "mean_inference_ms": 10.098555769626532, "mean_action_processing_ms": 0.08635981278953211, "mean_env_wait_ms": 0.043066766434803026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004487037658691406, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.08287668228149414}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 4.500078201293945, "policy_loss": -0.002267989795655012, "vf_loss": 4.502259254455566, "vf_explained_var": 0.0008888456504791975, "kl": 0.00460031209513545, "entropy": 0.5171123743057251, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 30.35, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -1.0, -133.0, 21.0, 32.0, -34.0, 65.0, 65.0, 76.0, 76.0, 76.0, 76.0, 54.0, 65.0, 76.0, 76.0, -78.0, -23.0, 65.0, 76.0, 65.0, 54.0, 76.0, 54.0, 21.0, 54.0, -1.0, -1.0, -12.0, -166.0, 43.0, 43.0, -56.0, -56.0, 76.0, -56.0, -1.0, 21.0, 43.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 21.0, -12.0, 43.0, 65.0, 65.0, 43.0, 76.0, 76.0, 76.0, 43.0, 76.0, 21.0, -155.0, 32.0, -23.0, -23.0, -89.0, -89.0, 54.0, 54.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 65.0, 65.0, -45.0, -1.0, 54.0, -34.0, -12.0, 54.0, -56.0, 43.0, 10.0, 21.0, -122.0, 54.0, 32.0, 43.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 54.0, 76.0, -23.0, 76.0, 32.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20090051180781807, "mean_inference_ms": 10.184231200994047, "mean_action_processing_ms": 0.08867695991184377, "mean_env_wait_ms": 0.043923888470442964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004769325256347656, "StateBufferConnector_ms": 0.002865314483642578, "ViewRequirementAgentConnector_ms": 0.08615899085998535}}, "episode_reward_max": 76.0, "episode_reward_min": -166.0, "episode_reward_mean": 30.35, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -1.0, -133.0, 21.0, 32.0, -34.0, 65.0, 65.0, 76.0, 76.0, 76.0, 76.0, 54.0, 65.0, 76.0, 76.0, -78.0, -23.0, 65.0, 76.0, 65.0, 54.0, 76.0, 54.0, 21.0, 54.0, -1.0, -1.0, -12.0, -166.0, 43.0, 43.0, -56.0, -56.0, 76.0, -56.0, -1.0, 21.0, 43.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 21.0, -12.0, 43.0, 65.0, 65.0, 43.0, 76.0, 76.0, 76.0, 43.0, 76.0, 21.0, -155.0, 32.0, -23.0, -23.0, -89.0, -89.0, 54.0, 54.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 65.0, 65.0, -45.0, -1.0, 54.0, -34.0, -12.0, 54.0, -56.0, 43.0, 10.0, 21.0, -122.0, 54.0, 32.0, 43.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 54.0, 76.0, -23.0, 76.0, 32.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20090051180781807, "mean_inference_ms": 10.184231200994047, "mean_action_processing_ms": 0.08867695991184377, "mean_env_wait_ms": 0.043923888470442964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004769325256347656, "StateBufferConnector_ms": 0.002865314483642578, "ViewRequirementAgentConnector_ms": 0.08615899085998535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 72727.058, "sample_time_ms": 39950.046, "learn_time_ms": 32768.384, "learn_throughput": 122.069, "synch_weights_time_ms": 7.915}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 3105, "training_iteration": 59, "trial_id": "38794_00001", "date": "2023-06-01_21-48-09", "timestamp": 1685645289, "time_this_iter_s": 80.14496207237244, "time_total_s": 4963.025861501694, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4963.025861501694, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 46.59464285714286, "ram_util_percent": 64.06696428571429}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 8.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 54.0, 76.0, 10.0, -45.0, -23.0, 76.0, 32.0, -1.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1886098683553553, "mean_inference_ms": 10.08683890486618, "mean_action_processing_ms": 0.08626071087286838, "mean_env_wait_ms": 0.04299695898400558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005085468292236328, "StateBufferConnector_ms": 0.002586841583251953, "ViewRequirementAgentConnector_ms": 0.08133888244628906}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 9.999999747378752e-05, "total_loss": 5.562990188598633, "policy_loss": -0.003703680355101824, "vf_loss": 5.566661357879639, "vf_explained_var": -0.0037665627896785736, "kl": 0.0034875667188316584, "entropy": 0.5787360072135925, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 20.56, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, 43.0, 76.0, 21.0, -155.0, 32.0, -23.0, -23.0, -89.0, -89.0, 54.0, 54.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 65.0, 65.0, -45.0, -1.0, 54.0, -34.0, -12.0, 54.0, -56.0, 43.0, 10.0, 21.0, -122.0, 54.0, 32.0, 43.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 54.0, 76.0, -23.0, 76.0, 32.0, 76.0, 76.0, -133.0, -23.0, -89.0, -56.0, -1.0, 76.0, 76.0, 76.0, 76.0, -23.0, 21.0, -56.0, 32.0, 21.0, 21.0, -45.0, -34.0, -111.0, 54.0, 54.0, 76.0, 54.0, 65.0, 54.0, 65.0, 43.0, 54.0, -100.0, 21.0, 21.0, 10.0, -23.0, -56.0, 10.0, 43.0, 65.0, 21.0, 10.0, -100.0, 54.0, 76.0, 76.0, 54.0, 10.0, 21.0, -1.0, 10.0, -23.0, -111.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20072506750023542, "mean_inference_ms": 10.173982384398425, "mean_action_processing_ms": 0.08858981098267665, "mean_env_wait_ms": 0.04387151145241602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004658699035644531, "StateBufferConnector_ms": 0.002832651138305664, "ViewRequirementAgentConnector_ms": 0.0863046646118164}}, "episode_reward_max": 76.0, "episode_reward_min": -155.0, "episode_reward_mean": 20.56, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, 43.0, 76.0, 21.0, -155.0, 32.0, -23.0, -23.0, -89.0, -89.0, 54.0, 54.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 65.0, 65.0, -45.0, -1.0, 54.0, -34.0, -12.0, 54.0, -56.0, 43.0, 10.0, 21.0, -122.0, 54.0, 32.0, 43.0, 65.0, 76.0, 76.0, 76.0, 65.0, 76.0, 54.0, 76.0, -23.0, 76.0, 32.0, 76.0, 76.0, -133.0, -23.0, -89.0, -56.0, -1.0, 76.0, 76.0, 76.0, 76.0, -23.0, 21.0, -56.0, 32.0, 21.0, 21.0, -45.0, -34.0, -111.0, 54.0, 54.0, 76.0, 54.0, 65.0, 54.0, 65.0, 43.0, 54.0, -100.0, 21.0, 21.0, 10.0, -23.0, -56.0, 10.0, 43.0, 65.0, 21.0, 10.0, -100.0, 54.0, 76.0, 76.0, 54.0, 10.0, 21.0, -1.0, 10.0, -23.0, -111.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20072506750023542, "mean_inference_ms": 10.173982384398425, "mean_action_processing_ms": 0.08858981098267665, "mean_env_wait_ms": 0.04387151145241602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004658699035644531, "StateBufferConnector_ms": 0.002832651138305664, "ViewRequirementAgentConnector_ms": 0.0863046646118164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 72759.184, "sample_time_ms": 40006.521, "learn_time_ms": 32743.999, "learn_throughput": 122.16, "synch_weights_time_ms": 7.944}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 3157, "training_iteration": 60, "trial_id": "38794_00001", "date": "2023-06-01_21-49-28", "timestamp": 1685645368, "time_this_iter_s": 78.96190786361694, "time_total_s": 5041.987769365311, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5041.987769365311, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 45.49, "ram_util_percent": 64.24454545454545}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": 35.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -12.0, 76.0, 76.0, 65.0, 21.0, -45.0, -23.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18835059520777137, "mean_inference_ms": 10.070618186179365, "mean_action_processing_ms": 0.08611438298091179, "mean_env_wait_ms": 0.04290681257540234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004401206970214844, "StateBufferConnector_ms": 0.00274658203125, "ViewRequirementAgentConnector_ms": 0.07993221282958984}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 9.999999747378752e-05, "total_loss": 4.429596424102783, "policy_loss": -0.0013040424091741443, "vf_loss": 4.430880546569824, "vf_explained_var": -0.00011129000631626695, "kl": 0.004183036275207996, "entropy": 0.5444837212562561, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 27.05, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 76.0, 76.0, 76.0, 76.0, -23.0, 21.0, -56.0, 32.0, 21.0, 21.0, -45.0, -34.0, -111.0, 54.0, 54.0, 76.0, 54.0, 65.0, 54.0, 65.0, 43.0, 54.0, -100.0, 21.0, 21.0, 10.0, -23.0, -56.0, 10.0, 43.0, 65.0, 21.0, 10.0, -100.0, 54.0, 76.0, 76.0, 54.0, 10.0, 21.0, -1.0, 10.0, -23.0, -111.0, 32.0, 54.0, 10.0, -34.0, 10.0, -34.0, -67.0, 65.0, 76.0, 76.0, 76.0, 76.0, 10.0, 54.0, 76.0, -89.0, 32.0, -133.0, 32.0, 76.0, 76.0, 76.0, 54.0, 76.0, 76.0, 65.0, 10.0, 76.0, 76.0, -1.0, -23.0, 21.0, -45.0, 76.0, -34.0, 54.0, 21.0, 76.0, 32.0, 43.0, 54.0, 76.0, 76.0, 76.0, 65.0, -34.0, 43.0, 54.0, 54.0, 10.0, 43.0, 32.0, 76.0, 76.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005019700061162, "mean_inference_ms": 10.162289984120736, "mean_action_processing_ms": 0.08848276206835798, "mean_env_wait_ms": 0.04380638574854201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004687070846557617, "StateBufferConnector_ms": 0.0027647018432617188, "ViewRequirementAgentConnector_ms": 0.08407354354858398}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 27.05, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 76.0, 76.0, 76.0, 76.0, -23.0, 21.0, -56.0, 32.0, 21.0, 21.0, -45.0, -34.0, -111.0, 54.0, 54.0, 76.0, 54.0, 65.0, 54.0, 65.0, 43.0, 54.0, -100.0, 21.0, 21.0, 10.0, -23.0, -56.0, 10.0, 43.0, 65.0, 21.0, 10.0, -100.0, 54.0, 76.0, 76.0, 54.0, 10.0, 21.0, -1.0, 10.0, -23.0, -111.0, 32.0, 54.0, 10.0, -34.0, 10.0, -34.0, -67.0, 65.0, 76.0, 76.0, 76.0, 76.0, 10.0, 54.0, 76.0, -89.0, 32.0, -133.0, 32.0, 76.0, 76.0, 76.0, 54.0, 76.0, 76.0, 65.0, 10.0, 76.0, 76.0, -1.0, -23.0, 21.0, -45.0, 76.0, -34.0, 54.0, 21.0, 76.0, 32.0, 43.0, 54.0, 76.0, 76.0, 76.0, 65.0, -34.0, 43.0, 54.0, 54.0, 10.0, 43.0, 32.0, 76.0, 76.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005019700061162, "mean_inference_ms": 10.162289984120736, "mean_action_processing_ms": 0.08848276206835798, "mean_env_wait_ms": 0.04380638574854201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004687070846557617, "StateBufferConnector_ms": 0.0027647018432617188, "ViewRequirementAgentConnector_ms": 0.08407354354858398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 72500.368, "sample_time_ms": 39836.337, "learn_time_ms": 32655.3, "learn_throughput": 122.492, "synch_weights_time_ms": 7.988}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 3210, "training_iteration": 61, "trial_id": "38794_00001", "date": "2023-06-01_21-50-46", "timestamp": 1685645446, "time_this_iter_s": 78.03751802444458, "time_total_s": 5120.025287389755, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5120.025287389755, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 42.6462962962963, "ram_util_percent": 64.3185185185185}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -19.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -56.0, 43.0, 76.0, -78.0, 32.0, -45.0, -133.0, -78.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1882048971353804, "mean_inference_ms": 10.061248879195784, "mean_action_processing_ms": 0.08602247171168623, "mean_env_wait_ms": 0.04283793068041419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005786418914794922, "StateBufferConnector_ms": 0.0029420852661132812, "ViewRequirementAgentConnector_ms": 0.08846282958984375}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0023437500931322575, "cur_lr": 9.999999747378752e-05, "total_loss": 4.76738166809082, "policy_loss": -0.0055791037157177925, "vf_loss": 4.77295446395874, "vf_explained_var": 0.0015118742594495416, "kl": 0.0028418777510523796, "entropy": 0.4340408146381378, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 37.06, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, 76.0, 10.0, 54.0, 76.0, -89.0, 32.0, -133.0, 32.0, 76.0, 76.0, 76.0, 54.0, 76.0, 76.0, 65.0, 10.0, 76.0, 76.0, -1.0, -23.0, 21.0, -45.0, 76.0, -34.0, 54.0, 21.0, 76.0, 32.0, 43.0, 54.0, 76.0, 76.0, 76.0, 65.0, -34.0, 43.0, 54.0, 54.0, 10.0, 43.0, 32.0, 76.0, 76.0, 65.0, 21.0, 76.0, 21.0, -56.0, -34.0, 54.0, 54.0, 54.0, 76.0, 76.0, 54.0, 76.0, 76.0, 76.0, -12.0, 10.0, -34.0, -45.0, -111.0, -12.0, 54.0, 32.0, 32.0, 43.0, -1.0, 54.0, 76.0, 43.0, 21.0, -78.0, -23.0, 32.0, 65.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 65.0, 76.0, 32.0, -56.0, -67.0, 43.0, 65.0, 76.0, 76.0, 43.0, 54.0, 65.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20024604971849225, "mean_inference_ms": 10.149450177862171, "mean_action_processing_ms": 0.08835566193864879, "mean_env_wait_ms": 0.04372786241549818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00469517707824707, "StateBufferConnector_ms": 0.0027055740356445312, "ViewRequirementAgentConnector_ms": 0.08176279067993164}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 37.06, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, 76.0, 10.0, 54.0, 76.0, -89.0, 32.0, -133.0, 32.0, 76.0, 76.0, 76.0, 54.0, 76.0, 76.0, 65.0, 10.0, 76.0, 76.0, -1.0, -23.0, 21.0, -45.0, 76.0, -34.0, 54.0, 21.0, 76.0, 32.0, 43.0, 54.0, 76.0, 76.0, 76.0, 65.0, -34.0, 43.0, 54.0, 54.0, 10.0, 43.0, 32.0, 76.0, 76.0, 65.0, 21.0, 76.0, 21.0, -56.0, -34.0, 54.0, 54.0, 54.0, 76.0, 76.0, 54.0, 76.0, 76.0, 76.0, -12.0, 10.0, -34.0, -45.0, -111.0, -12.0, 54.0, 32.0, 32.0, 43.0, -1.0, 54.0, 76.0, 43.0, 21.0, -78.0, -23.0, 32.0, 65.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 65.0, 76.0, 32.0, -56.0, -67.0, 43.0, 65.0, 76.0, 76.0, 43.0, 54.0, 65.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20024604971849225, "mean_inference_ms": 10.149450177862171, "mean_action_processing_ms": 0.08835566193864879, "mean_env_wait_ms": 0.04372786241549818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00469517707824707, "StateBufferConnector_ms": 0.0027055740356445312, "ViewRequirementAgentConnector_ms": 0.08176279067993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 72365.566, "sample_time_ms": 39705.799, "learn_time_ms": 32651.099, "learn_throughput": 122.507, "synch_weights_time_ms": 7.912}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 3263, "training_iteration": 62, "trial_id": "38794_00001", "date": "2023-06-01_21-52-05", "timestamp": 1685645525, "time_this_iter_s": 78.60173892974854, "time_total_s": 5198.627026319504, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5198.627026319504, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 43.96090909090909, "ram_util_percent": 64.33727272727273}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 43.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 32.0, -12.0, 10.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18803531226626627, "mean_inference_ms": 10.051467111391974, "mean_action_processing_ms": 0.08592859838907216, "mean_env_wait_ms": 0.042782289731228926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005238056182861328, "StateBufferConnector_ms": 0.0027799606323242188, "ViewRequirementAgentConnector_ms": 0.08460283279418945}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0011718750465661287, "cur_lr": 9.999999747378752e-05, "total_loss": 5.398355007171631, "policy_loss": -0.0035753974225372076, "vf_loss": 5.401926040649414, "vf_explained_var": 1.0177989679505117e-05, "kl": 0.003881242824718356, "entropy": 0.3509208858013153, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": 18.36, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 54.0, 76.0, 76.0, 54.0, 76.0, 76.0, 76.0, -12.0, 10.0, -34.0, -45.0, -111.0, -12.0, 54.0, 32.0, 32.0, 43.0, -1.0, 54.0, 76.0, 43.0, 21.0, -78.0, -23.0, 32.0, 65.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 65.0, 76.0, 32.0, -56.0, -67.0, 43.0, 65.0, 76.0, 76.0, 43.0, 54.0, 65.0, 32.0, 65.0, 65.0, 76.0, -12.0, 76.0, 10.0, -56.0, -67.0, 76.0, 43.0, -23.0, 65.0, 65.0, 21.0, -12.0, 54.0, -1.0, -56.0, -45.0, -100.0, -45.0, -188.0, 32.0, 43.0, 76.0, 76.0, 76.0, 65.0, -67.0, -78.0, -1.0, 76.0, 65.0, 43.0, 43.0, -78.0, -12.0, -56.0, -89.0, -45.0, -56.0, 54.0, -34.0, -100.0, -155.0, 43.0, 65.0, 65.0, 43.0, -89.0, -12.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20002942509527968, "mean_inference_ms": 10.138228682435786, "mean_action_processing_ms": 0.08824208608455464, "mean_env_wait_ms": 0.04365854032190763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00464177131652832, "StateBufferConnector_ms": 0.002768993377685547, "ViewRequirementAgentConnector_ms": 0.08334612846374512}}, "episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": 18.36, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 54.0, 54.0, 76.0, 76.0, 54.0, 76.0, 76.0, 76.0, -12.0, 10.0, -34.0, -45.0, -111.0, -12.0, 54.0, 32.0, 32.0, 43.0, -1.0, 54.0, 76.0, 43.0, 21.0, -78.0, -23.0, 32.0, 65.0, 76.0, 76.0, 65.0, 76.0, 76.0, 65.0, 65.0, 76.0, 32.0, -56.0, -67.0, 43.0, 65.0, 76.0, 76.0, 43.0, 54.0, 65.0, 32.0, 65.0, 65.0, 76.0, -12.0, 76.0, 10.0, -56.0, -67.0, 76.0, 43.0, -23.0, 65.0, 65.0, 21.0, -12.0, 54.0, -1.0, -56.0, -45.0, -100.0, -45.0, -188.0, 32.0, 43.0, 76.0, 76.0, 76.0, 65.0, -67.0, -78.0, -1.0, 76.0, 65.0, 43.0, 43.0, -78.0, -12.0, -56.0, -89.0, -45.0, -56.0, 54.0, -34.0, -100.0, -155.0, 43.0, 65.0, 65.0, 43.0, -89.0, -12.0, 76.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20002942509527968, "mean_inference_ms": 10.138228682435786, "mean_action_processing_ms": 0.08824208608455464, "mean_env_wait_ms": 0.04365854032190763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00464177131652832, "StateBufferConnector_ms": 0.002768993377685547, "ViewRequirementAgentConnector_ms": 0.08334612846374512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 72405.997, "sample_time_ms": 39684.335, "learn_time_ms": 32712.887, "learn_throughput": 122.276, "synch_weights_time_ms": 7.988}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 3315, "training_iteration": 63, "trial_id": "38794_00001", "date": "2023-06-01_21-53-25", "timestamp": 1685645605, "time_this_iter_s": 80.07866096496582, "time_total_s": 5278.70568728447, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5278.70568728447, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 46.19639639639639, "ram_util_percent": 64.02882882882882}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -15.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -1.0, -45.0, -111.0, 43.0, -34.0, -23.0, -122.0, 54.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18787617839379459, "mean_inference_ms": 10.040953888640889, "mean_action_processing_ms": 0.08583233541315052, "mean_env_wait_ms": 0.04272427018448842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004813671112060547, "StateBufferConnector_ms": 0.002536773681640625, "ViewRequirementAgentConnector_ms": 0.08449316024780273}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 9.999999747378752e-05, "total_loss": 5.116181373596191, "policy_loss": -0.003316122107207775, "vf_loss": 5.119496822357178, "vf_explained_var": -6.146728903644316e-09, "kl": 0.0012081180466338992, "entropy": 0.3240365982055664, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": 9.89, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -67.0, 76.0, 43.0, -23.0, 65.0, 65.0, 21.0, -12.0, 54.0, -1.0, -56.0, -45.0, -100.0, -45.0, -188.0, 32.0, 43.0, 76.0, 76.0, 76.0, 65.0, -67.0, -78.0, -1.0, 76.0, 65.0, 43.0, 43.0, -78.0, -12.0, -56.0, -89.0, -45.0, -56.0, 54.0, -34.0, -100.0, -155.0, 43.0, 65.0, 65.0, 43.0, -89.0, -12.0, 76.0, 76.0, 76.0, 76.0, -34.0, 10.0, -1.0, 54.0, 76.0, 65.0, -67.0, -34.0, -34.0, 10.0, -45.0, 32.0, 76.0, 76.0, 76.0, 21.0, 43.0, -67.0, -34.0, -100.0, -67.0, 76.0, -45.0, -1.0, -67.0, 43.0, 65.0, -56.0, 32.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, -45.0, -67.0, 76.0, 10.0, 65.0, 76.0, 10.0, 21.0, -1.0, -12.0, 21.0, 32.0, 65.0, 65.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19982992855360648, "mean_inference_ms": 10.128078407501203, "mean_action_processing_ms": 0.08813428402256665, "mean_env_wait_ms": 0.04359580074063034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045928955078125, "StateBufferConnector_ms": 0.0027434825897216797, "ViewRequirementAgentConnector_ms": 0.0841667652130127}}, "episode_reward_max": 76.0, "episode_reward_min": -188.0, "episode_reward_mean": 9.89, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -67.0, 76.0, 43.0, -23.0, 65.0, 65.0, 21.0, -12.0, 54.0, -1.0, -56.0, -45.0, -100.0, -45.0, -188.0, 32.0, 43.0, 76.0, 76.0, 76.0, 65.0, -67.0, -78.0, -1.0, 76.0, 65.0, 43.0, 43.0, -78.0, -12.0, -56.0, -89.0, -45.0, -56.0, 54.0, -34.0, -100.0, -155.0, 43.0, 65.0, 65.0, 43.0, -89.0, -12.0, 76.0, 76.0, 76.0, 76.0, -34.0, 10.0, -1.0, 54.0, 76.0, 65.0, -67.0, -34.0, -34.0, 10.0, -45.0, 32.0, 76.0, 76.0, 76.0, 21.0, 43.0, -67.0, -34.0, -100.0, -67.0, 76.0, -45.0, -1.0, -67.0, 43.0, 65.0, -56.0, 32.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, -45.0, -67.0, 76.0, 10.0, 65.0, 76.0, 10.0, 21.0, -1.0, -12.0, 21.0, 32.0, 65.0, 65.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19982992855360648, "mean_inference_ms": 10.128078407501203, "mean_action_processing_ms": 0.08813428402256665, "mean_env_wait_ms": 0.04359580074063034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045928955078125, "StateBufferConnector_ms": 0.0027434825897216797, "ViewRequirementAgentConnector_ms": 0.0841667652130127}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 72236.745, "sample_time_ms": 39556.166, "learn_time_ms": 32671.91, "learn_throughput": 122.429, "synch_weights_time_ms": 7.882}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 3368, "training_iteration": 64, "trial_id": "38794_00001", "date": "2023-06-01_21-54-43", "timestamp": 1685645683, "time_this_iter_s": 78.49183487892151, "time_total_s": 5357.197522163391, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5357.197522163391, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 41.82844036697248, "ram_util_percent": 63.43211009174312}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -111.0, "episode_reward_mean": -36.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -78.0, -1.0, -23.0, -1.0, -1.0, 21.0, -100.0, -111.0, -111.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18775549734346525, "mean_inference_ms": 10.033018596114275, "mean_action_processing_ms": 0.08575432368279065, "mean_env_wait_ms": 0.042680448777390745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004427433013916016, "StateBufferConnector_ms": 0.0027704238891601562, "ViewRequirementAgentConnector_ms": 0.08667469024658203}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 9.999999747378752e-05, "total_loss": 5.5552239418029785, "policy_loss": -0.0024748428259044886, "vf_loss": 5.557698726654053, "vf_explained_var": 1.2571302249853034e-05, "kl": 0.0021384030114859343, "entropy": 0.30982130765914917, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 10.55, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 65.0, -67.0, -34.0, -34.0, 10.0, -45.0, 32.0, 76.0, 76.0, 76.0, 21.0, 43.0, -67.0, -34.0, -100.0, -67.0, 76.0, -45.0, -1.0, -67.0, 43.0, 65.0, -56.0, 32.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, -45.0, -67.0, 76.0, 10.0, 65.0, 76.0, 10.0, 21.0, -1.0, -12.0, 21.0, 32.0, 65.0, 65.0, 10.0, -100.0, -56.0, -12.0, -34.0, 76.0, 54.0, 76.0, 76.0, 76.0, 76.0, -89.0, 43.0, -56.0, -12.0, -89.0, 54.0, 76.0, -12.0, -78.0, 10.0, -100.0, -78.0, -100.0, 32.0, 21.0, -89.0, -67.0, -100.0, 21.0, -111.0, -67.0, 65.0, -89.0, 10.0, 43.0, 76.0, -78.0, 32.0, 76.0, -78.0, 54.0, 43.0, 76.0, 65.0, 76.0, 54.0, 76.0, 65.0, 65.0, 10.0, 54.0, -78.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199607517002962, "mean_inference_ms": 10.116521489678309, "mean_action_processing_ms": 0.08801609219508172, "mean_env_wait_ms": 0.04352751941573882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583835601806641, "StateBufferConnector_ms": 0.0027239322662353516, "ViewRequirementAgentConnector_ms": 0.08328628540039062}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 10.55, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 65.0, -67.0, -34.0, -34.0, 10.0, -45.0, 32.0, 76.0, 76.0, 76.0, 21.0, 43.0, -67.0, -34.0, -100.0, -67.0, 76.0, -45.0, -1.0, -67.0, 43.0, 65.0, -56.0, 32.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, -45.0, -67.0, 76.0, 10.0, 65.0, 76.0, 10.0, 21.0, -1.0, -12.0, 21.0, 32.0, 65.0, 65.0, 10.0, -100.0, -56.0, -12.0, -34.0, 76.0, 54.0, 76.0, 76.0, 76.0, 76.0, -89.0, 43.0, -56.0, -12.0, -89.0, 54.0, 76.0, -12.0, -78.0, 10.0, -100.0, -78.0, -100.0, 32.0, 21.0, -89.0, -67.0, -100.0, 21.0, -111.0, -67.0, 65.0, -89.0, 10.0, 43.0, 76.0, -78.0, 32.0, 76.0, -78.0, 54.0, 43.0, 76.0, 65.0, 76.0, 54.0, 76.0, 65.0, 65.0, 10.0, 54.0, -78.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199607517002962, "mean_inference_ms": 10.116521489678309, "mean_action_processing_ms": 0.08801609219508172, "mean_env_wait_ms": 0.04352751941573882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583835601806641, "StateBufferConnector_ms": 0.0027239322662353516, "ViewRequirementAgentConnector_ms": 0.08328628540039062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 72258.166, "sample_time_ms": 39540.08, "learn_time_ms": 32709.567, "learn_throughput": 122.288, "synch_weights_time_ms": 7.727}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 3421, "training_iteration": 65, "trial_id": "38794_00001", "date": "2023-06-01_21-56-02", "timestamp": 1685645762, "time_this_iter_s": 79.0039427280426, "time_total_s": 5436.201464891434, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5436.201464891434, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 43.278181818181814, "ram_util_percent": 63.679090909090924}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -14.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -45.0, -23.0, -122.0, -34.0, 76.0, 76.0, 43.0, 32.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18759484482245004, "mean_inference_ms": 10.025736670614714, "mean_action_processing_ms": 0.08568466951424956, "mean_env_wait_ms": 0.04264295073835638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004661083221435547, "StateBufferConnector_ms": 0.0026106834411621094, "ViewRequirementAgentConnector_ms": 0.08330821990966797}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0001464843808207661, "cur_lr": 9.999999747378752e-05, "total_loss": 4.617222309112549, "policy_loss": -0.0025770238135010004, "vf_loss": 4.61979866027832, "vf_explained_var": -0.0001551116438349709, "kl": 0.0010456063318997622, "entropy": 0.36404067277908325, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 76.0, 76.0, 76.0, -89.0, 43.0, -56.0, -12.0, -89.0, 54.0, 76.0, -12.0, -78.0, 10.0, -100.0, -78.0, -100.0, 32.0, 21.0, -89.0, -67.0, -100.0, 21.0, -111.0, -67.0, 65.0, -89.0, 10.0, 43.0, 76.0, -78.0, 32.0, 76.0, -78.0, 54.0, 43.0, 76.0, 65.0, 76.0, 54.0, 76.0, 65.0, 65.0, 10.0, 54.0, -78.0, 65.0, 76.0, 43.0, 76.0, 76.0, 76.0, 32.0, -23.0, 76.0, 54.0, 43.0, 32.0, 76.0, 10.0, 43.0, 76.0, 76.0, 76.0, 76.0, 43.0, -1.0, -12.0, 65.0, 65.0, -12.0, 43.0, 10.0, 76.0, 32.0, -78.0, -45.0, 10.0, -45.0, -12.0, -56.0, 21.0, 76.0, 76.0, 76.0, 32.0, 10.0, 43.0, -45.0, -45.0, -111.0, -111.0, 65.0, 76.0, 65.0, 76.0, 10.0, -34.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19942588807683573, "mean_inference_ms": 10.106238971002044, "mean_action_processing_ms": 0.08791767941553859, "mean_env_wait_ms": 0.04346743524423579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00468754768371582, "StateBufferConnector_ms": 0.002857685089111328, "ViewRequirementAgentConnector_ms": 0.08404850959777832}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 16.6, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 76.0, 76.0, 76.0, 76.0, -89.0, 43.0, -56.0, -12.0, -89.0, 54.0, 76.0, -12.0, -78.0, 10.0, -100.0, -78.0, -100.0, 32.0, 21.0, -89.0, -67.0, -100.0, 21.0, -111.0, -67.0, 65.0, -89.0, 10.0, 43.0, 76.0, -78.0, 32.0, 76.0, -78.0, 54.0, 43.0, 76.0, 65.0, 76.0, 54.0, 76.0, 65.0, 65.0, 10.0, 54.0, -78.0, 65.0, 76.0, 43.0, 76.0, 76.0, 76.0, 32.0, -23.0, 76.0, 54.0, 43.0, 32.0, 76.0, 10.0, 43.0, 76.0, 76.0, 76.0, 76.0, 43.0, -1.0, -12.0, 65.0, 65.0, -12.0, 43.0, 10.0, 76.0, 32.0, -78.0, -45.0, 10.0, -45.0, -12.0, -56.0, 21.0, 76.0, 76.0, 76.0, 32.0, 10.0, 43.0, -45.0, -45.0, -111.0, -111.0, 65.0, 76.0, 65.0, 76.0, 10.0, -34.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19942588807683573, "mean_inference_ms": 10.106238971002044, "mean_action_processing_ms": 0.08791767941553859, "mean_env_wait_ms": 0.04346743524423579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00468754768371582, "StateBufferConnector_ms": 0.002857685089111328, "ViewRequirementAgentConnector_ms": 0.08404850959777832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 71839.239, "sample_time_ms": 39123.15, "learn_time_ms": 32709.002, "learn_throughput": 122.29, "synch_weights_time_ms": 6.274}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 3473, "training_iteration": 66, "trial_id": "38794_00001", "date": "2023-06-01_21-57-24", "timestamp": 1685645844, "time_this_iter_s": 81.45667719841003, "time_total_s": 5517.658142089844, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5517.658142089844, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 45.968421052631584, "ram_util_percent": 64.98684210526315}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 13.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, 43.0, -67.0, -111.0, 54.0, 76.0, 76.0, 76.0, 76.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1874565879195646, "mean_inference_ms": 10.01681844370782, "mean_action_processing_ms": 0.08560685472246243, "mean_env_wait_ms": 0.0425966084559451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004975795745849609, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.08537054061889648}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 6.4920148849487305, "policy_loss": -0.003120435168966651, "vf_loss": 6.495135307312012, "vf_explained_var": 0.005578883457928896, "kl": 0.002288074465468526, "entropy": 0.30189239978790283, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 8.35, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -23.0, 76.0, 54.0, 43.0, 32.0, 76.0, 10.0, 43.0, 76.0, 76.0, 76.0, 76.0, 43.0, -1.0, -12.0, 65.0, 65.0, -12.0, 43.0, 10.0, 76.0, 32.0, -78.0, -45.0, 10.0, -45.0, -12.0, -56.0, 21.0, 76.0, 76.0, 76.0, 32.0, 10.0, 43.0, -45.0, -45.0, -111.0, -111.0, 65.0, 76.0, 65.0, 76.0, 10.0, -34.0, 54.0, 65.0, 10.0, 10.0, -34.0, 32.0, -89.0, -34.0, -34.0, -12.0, 10.0, 65.0, -23.0, -1.0, 32.0, -12.0, -12.0, -45.0, -89.0, 10.0, -23.0, 32.0, -133.0, -45.0, 43.0, -56.0, 32.0, 76.0, 43.0, -111.0, -111.0, -34.0, 43.0, 10.0, -111.0, -56.0, -111.0, -100.0, 10.0, 54.0, 65.0, 76.0, 21.0, 76.0, 65.0, 65.0, 54.0, -100.0, 76.0, 76.0, 54.0, -56.0, 10.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19926222876488772, "mean_inference_ms": 10.095851807072853, "mean_action_processing_ms": 0.08783282729458691, "mean_env_wait_ms": 0.04341506949152942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004761934280395508, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.08509516716003418}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": 8.35, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -23.0, 76.0, 54.0, 43.0, 32.0, 76.0, 10.0, 43.0, 76.0, 76.0, 76.0, 76.0, 43.0, -1.0, -12.0, 65.0, 65.0, -12.0, 43.0, 10.0, 76.0, 32.0, -78.0, -45.0, 10.0, -45.0, -12.0, -56.0, 21.0, 76.0, 76.0, 76.0, 32.0, 10.0, 43.0, -45.0, -45.0, -111.0, -111.0, 65.0, 76.0, 65.0, 76.0, 10.0, -34.0, 54.0, 65.0, 10.0, 10.0, -34.0, 32.0, -89.0, -34.0, -34.0, -12.0, 10.0, 65.0, -23.0, -1.0, 32.0, -12.0, -12.0, -45.0, -89.0, 10.0, -23.0, 32.0, -133.0, -45.0, 43.0, -56.0, 32.0, 76.0, 43.0, -111.0, -111.0, -34.0, 43.0, 10.0, -111.0, -56.0, -111.0, -100.0, 10.0, 54.0, 65.0, 76.0, 21.0, 76.0, 65.0, 65.0, 54.0, -100.0, 76.0, 76.0, 54.0, -56.0, 10.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19926222876488772, "mean_inference_ms": 10.095851807072853, "mean_action_processing_ms": 0.08783282729458691, "mean_env_wait_ms": 0.04341506949152942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004761934280395508, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.08509516716003418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 71860.922, "sample_time_ms": 39143.945, "learn_time_ms": 32709.769, "learn_throughput": 122.288, "synch_weights_time_ms": 6.403}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 3526, "training_iteration": 67, "trial_id": "38794_00001", "date": "2023-06-01_21-58-43", "timestamp": 1685645923, "time_this_iter_s": 78.86914992332458, "time_total_s": 5596.527292013168, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5596.527292013168, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 40.67727272727272, "ram_util_percent": 66.15181818181819}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -45.0, "episode_reward_mean": -4.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -34.0, -12.0, -23.0, -23.0, -23.0, 10.0, -45.0, -1.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18731885432357404, "mean_inference_ms": 10.00818425026087, "mean_action_processing_ms": 0.08553799934997634, "mean_env_wait_ms": 0.04255320228167297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004956722259521484, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.08303165435791016}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 5.800317764282227, "policy_loss": -0.002821540692821145, "vf_loss": 5.803140163421631, "vf_explained_var": -0.0008696377626620233, "kl": 0.001441211556084454, "entropy": 0.24857600033283234, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -1.33, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -34.0, -34.0, -12.0, 10.0, 65.0, -23.0, -1.0, 32.0, -12.0, -12.0, -45.0, -89.0, 10.0, -23.0, 32.0, -133.0, -45.0, 43.0, -56.0, 32.0, 76.0, 43.0, -111.0, -111.0, -34.0, 43.0, 10.0, -111.0, -56.0, -111.0, -100.0, 10.0, 54.0, 65.0, 76.0, 21.0, 76.0, 65.0, 65.0, 54.0, -100.0, 76.0, 76.0, 54.0, -56.0, 10.0, -12.0, -89.0, -100.0, -12.0, -45.0, -89.0, 76.0, -12.0, 76.0, 32.0, 43.0, 76.0, 76.0, 76.0, 65.0, -111.0, 21.0, -56.0, 32.0, 76.0, 76.0, 10.0, -78.0, -100.0, -45.0, 76.0, -78.0, -45.0, 76.0, 21.0, 65.0, 10.0, -67.0, 65.0, 43.0, 10.0, 65.0, -23.0, 10.0, -67.0, -67.0, 10.0, 10.0, -67.0, -1.0, 43.0, 10.0, -45.0, -23.0, -45.0, 54.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19909312210816282, "mean_inference_ms": 10.085471871798921, "mean_action_processing_ms": 0.0877533839035957, "mean_env_wait_ms": 0.04336734832819549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004667520523071289, "StateBufferConnector_ms": 0.002857208251953125, "ViewRequirementAgentConnector_ms": 0.08396768569946289}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -1.33, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.0, -34.0, -34.0, -12.0, 10.0, 65.0, -23.0, -1.0, 32.0, -12.0, -12.0, -45.0, -89.0, 10.0, -23.0, 32.0, -133.0, -45.0, 43.0, -56.0, 32.0, 76.0, 43.0, -111.0, -111.0, -34.0, 43.0, 10.0, -111.0, -56.0, -111.0, -100.0, 10.0, 54.0, 65.0, 76.0, 21.0, 76.0, 65.0, 65.0, 54.0, -100.0, 76.0, 76.0, 54.0, -56.0, 10.0, -12.0, -89.0, -100.0, -12.0, -45.0, -89.0, 76.0, -12.0, 76.0, 32.0, 43.0, 76.0, 76.0, 76.0, 65.0, -111.0, 21.0, -56.0, 32.0, 76.0, 76.0, 10.0, -78.0, -100.0, -45.0, 76.0, -78.0, -45.0, 76.0, 21.0, 65.0, 10.0, -67.0, 65.0, 43.0, 10.0, 65.0, -23.0, 10.0, -67.0, -67.0, 10.0, 10.0, -67.0, -1.0, 43.0, 10.0, -45.0, -23.0, -45.0, 54.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19909312210816282, "mean_inference_ms": 10.085471871798921, "mean_action_processing_ms": 0.0877533839035957, "mean_env_wait_ms": 0.04336734832819549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004667520523071289, "StateBufferConnector_ms": 0.002857208251953125, "ViewRequirementAgentConnector_ms": 0.08396768569946289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 71795.207, "sample_time_ms": 39098.78, "learn_time_ms": 32689.094, "learn_throughput": 122.365, "synch_weights_time_ms": 6.53}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 3578, "training_iteration": 68, "trial_id": "38794_00001", "date": "2023-06-01_22-00-02", "timestamp": 1685646002, "time_this_iter_s": 78.64107894897461, "time_total_s": 5675.168370962143, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5675.168370962143, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 43.88715596330273, "ram_util_percent": 66.42844036697248}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -19.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -1.0, 54.0, -56.0, 54.0, 76.0, -89.0, -89.0, -56.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18725025851835508, "mean_inference_ms": 10.002094121567707, "mean_action_processing_ms": 0.08548829791970548, "mean_env_wait_ms": 0.04252099269783217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004401206970214844, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.08899450302124023}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.831054760259576e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 4.646956443786621, "policy_loss": -0.0010036680614575744, "vf_loss": 4.6479597091674805, "vf_explained_var": -8.377283666050062e-05, "kl": 0.0006645399844273925, "entropy": 0.20956020057201385, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 17.86, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -12.0, 76.0, 32.0, 43.0, 76.0, 76.0, 76.0, 65.0, -111.0, 21.0, -56.0, 32.0, 76.0, 76.0, 10.0, -78.0, -100.0, -45.0, 76.0, -78.0, -45.0, 76.0, 21.0, 65.0, 10.0, -67.0, 65.0, 43.0, 10.0, 65.0, -23.0, 10.0, -67.0, -67.0, 10.0, 10.0, -67.0, -1.0, 43.0, 10.0, -45.0, -23.0, -45.0, 54.0, 65.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -111.0, -100.0, 32.0, 65.0, 65.0, -45.0, -56.0, 65.0, 54.0, -12.0, 10.0, 76.0, 76.0, 76.0, 43.0, -67.0, -111.0, 10.0, -45.0, 43.0, 76.0, 76.0, 43.0, 76.0, 43.0, 76.0, 10.0, 76.0, 76.0, 54.0, 32.0, -23.0, -89.0, 54.0, 32.0, 21.0, 76.0, 54.0, 32.0, 43.0, 76.0, 76.0, 21.0, -67.0, -23.0, -40.0, -34.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19892346063982622, "mean_inference_ms": 10.07616796046859, "mean_action_processing_ms": 0.08768133299176714, "mean_env_wait_ms": 0.04332354700933365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045948028564453125, "StateBufferConnector_ms": 0.0028104782104492188, "ViewRequirementAgentConnector_ms": 0.08458161354064941}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 17.86, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, -12.0, 76.0, 32.0, 43.0, 76.0, 76.0, 76.0, 65.0, -111.0, 21.0, -56.0, 32.0, 76.0, 76.0, 10.0, -78.0, -100.0, -45.0, 76.0, -78.0, -45.0, 76.0, 21.0, 65.0, 10.0, -67.0, 65.0, 43.0, 10.0, 65.0, -23.0, 10.0, -67.0, -67.0, 10.0, 10.0, -67.0, -1.0, 43.0, 10.0, -45.0, -23.0, -45.0, 54.0, 65.0, 76.0, 65.0, 76.0, 76.0, 76.0, 76.0, -111.0, -100.0, 32.0, 65.0, 65.0, -45.0, -56.0, 65.0, 54.0, -12.0, 10.0, 76.0, 76.0, 76.0, 43.0, -67.0, -111.0, 10.0, -45.0, 43.0, 76.0, 76.0, 43.0, 76.0, 43.0, 76.0, 10.0, 76.0, 76.0, 54.0, 32.0, -23.0, -89.0, 54.0, 32.0, 21.0, 76.0, 54.0, 32.0, 43.0, 76.0, 76.0, 21.0, -67.0, -23.0, -40.0, -34.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19892346063982622, "mean_inference_ms": 10.07616796046859, "mean_action_processing_ms": 0.08768133299176714, "mean_env_wait_ms": 0.04332354700933365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045948028564453125, "StateBufferConnector_ms": 0.0028104782104492188, "ViewRequirementAgentConnector_ms": 0.08458161354064941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 71774.951, "sample_time_ms": 39004.418, "learn_time_ms": 32763.128, "learn_throughput": 122.088, "synch_weights_time_ms": 6.602}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 3631, "training_iteration": 69, "trial_id": "38794_00001", "date": "2023-06-01_22-01-22", "timestamp": 1685646082, "time_this_iter_s": 80.03342700004578, "time_total_s": 5755.201797962189, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5755.201797962189, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 46.10982142857142, "ram_util_percent": 66.82053571428571}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": -6.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -12.0, 10.0, 76.0, -56.0, -67.0, -1.0, -12.0, -67.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18724157241916226, "mean_inference_ms": 9.998400317410574, "mean_action_processing_ms": 0.08548933505895447, "mean_env_wait_ms": 0.04250805946344792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005590915679931641, "StateBufferConnector_ms": 0.0028896331787109375, "ViewRequirementAgentConnector_ms": 0.0899505615234375}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.15527380129788e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 6.402717113494873, "policy_loss": -0.0015750949969515204, "vf_loss": 6.404292106628418, "vf_explained_var": 0.00010988364374497905, "kl": 0.00023691842216067016, "entropy": 0.19445250928401947, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 4.11, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.0, 32.0, 65.0, 65.0, -45.0, -56.0, 65.0, 54.0, -12.0, 10.0, 76.0, 76.0, 76.0, 43.0, -67.0, -111.0, 10.0, -45.0, 43.0, 76.0, 76.0, 43.0, 76.0, 43.0, 76.0, 10.0, 76.0, 76.0, 54.0, 32.0, -23.0, -89.0, 54.0, 32.0, 21.0, 76.0, 54.0, 32.0, 43.0, 76.0, 76.0, 21.0, -67.0, -23.0, -40.0, -34.0, -12.0, -12.0, -67.0, -1.0, -89.0, -67.0, 32.0, 76.0, 76.0, 76.0, -100.0, 32.0, 76.0, -67.0, -100.0, -78.0, -34.0, -1.0, -23.0, 76.0, 76.0, -67.0, -67.0, 32.0, -12.0, 32.0, -67.0, -67.0, -23.0, 21.0, -67.0, -67.0, -23.0, -1.0, 76.0, 76.0, 43.0, -34.0, 32.0, 10.0, -67.0, -89.0, -67.0, -67.0, -12.0, -89.0, 21.0, 21.0, -67.0, 54.0, 43.0, -78.0, 10.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19881033028342535, "mean_inference_ms": 10.069861661040166, "mean_action_processing_ms": 0.08763647976523675, "mean_env_wait_ms": 0.04329782294989954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004938840866088867, "StateBufferConnector_ms": 0.0029175281524658203, "ViewRequirementAgentConnector_ms": 0.08838272094726562}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 4.11, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.0, 32.0, 65.0, 65.0, -45.0, -56.0, 65.0, 54.0, -12.0, 10.0, 76.0, 76.0, 76.0, 43.0, -67.0, -111.0, 10.0, -45.0, 43.0, 76.0, 76.0, 43.0, 76.0, 43.0, 76.0, 10.0, 76.0, 76.0, 54.0, 32.0, -23.0, -89.0, 54.0, 32.0, 21.0, 76.0, 54.0, 32.0, 43.0, 76.0, 76.0, 21.0, -67.0, -23.0, -40.0, -34.0, -12.0, -12.0, -67.0, -1.0, -89.0, -67.0, 32.0, 76.0, 76.0, 76.0, -100.0, 32.0, 76.0, -67.0, -100.0, -78.0, -34.0, -1.0, -23.0, 76.0, 76.0, -67.0, -67.0, 32.0, -12.0, 32.0, -67.0, -67.0, -23.0, 21.0, -67.0, -67.0, -23.0, -1.0, 76.0, 76.0, 43.0, -34.0, 32.0, 10.0, -67.0, -89.0, -67.0, -67.0, -12.0, -89.0, 21.0, 21.0, -67.0, 54.0, 43.0, -78.0, 10.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19881033028342535, "mean_inference_ms": 10.069861661040166, "mean_action_processing_ms": 0.08763647976523675, "mean_env_wait_ms": 0.04329782294989954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004938840866088867, "StateBufferConnector_ms": 0.0029175281524658203, "ViewRequirementAgentConnector_ms": 0.08838272094726562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 72006.475, "sample_time_ms": 39145.421, "learn_time_ms": 32853.6, "learn_throughput": 121.752, "synch_weights_time_ms": 6.645}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 3684, "training_iteration": 70, "trial_id": "38794_00001", "date": "2023-06-01_22-02-43", "timestamp": 1685646163, "time_this_iter_s": 81.54827094078064, "time_total_s": 5836.750068902969, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5836.750068902969, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 48.23185840707964, "ram_util_percent": 67.94159292035398}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 5.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, -56.0, -56.0, -23.0, -12.0, 76.0, -12.0, 65.0, 76.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18716771290562567, "mean_inference_ms": 9.992698794137102, "mean_action_processing_ms": 0.08544510349890058, "mean_env_wait_ms": 0.04248597341308323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048065185546875, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.08701324462890625}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.57763690064894e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 7.049090385437012, "policy_loss": -0.0035254540853202343, "vf_loss": 7.052615642547607, "vf_explained_var": -0.0004387388762552291, "kl": 0.0005667837685905397, "entropy": 0.16550453007221222, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -13.65, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 76.0, 76.0, 76.0, -100.0, 32.0, 76.0, -67.0, -100.0, -78.0, -34.0, -1.0, -23.0, 76.0, 76.0, -67.0, -67.0, 32.0, -12.0, 32.0, -67.0, -67.0, -23.0, 21.0, -67.0, -67.0, -23.0, -1.0, 76.0, 76.0, 43.0, -34.0, 32.0, 10.0, -67.0, -89.0, -67.0, -67.0, -12.0, -89.0, 21.0, 21.0, -67.0, 54.0, 43.0, -78.0, 10.0, 76.0, 54.0, 32.0, -23.0, -45.0, -67.0, 43.0, -56.0, -56.0, -78.0, 32.0, 21.0, -111.0, 21.0, -45.0, 32.0, -45.0, -89.0, -23.0, 76.0, -23.0, 32.0, 10.0, -89.0, -45.0, -1.0, 10.0, 43.0, 10.0, 76.0, -23.0, -89.0, -1.0, -56.0, -78.0, -23.0, -78.0, -23.0, 76.0, 32.0, -34.0, 76.0, 76.0, -45.0, -78.0, -100.0, 10.0, -45.0, -78.0, 10.0, -45.0, -67.0, -111.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19871630272262858, "mean_inference_ms": 10.064106233716497, "mean_action_processing_ms": 0.08759104194812833, "mean_env_wait_ms": 0.04327373391738733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004991054534912109, "StateBufferConnector_ms": 0.0030159950256347656, "ViewRequirementAgentConnector_ms": 0.08774757385253906}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -13.65, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 76.0, 76.0, 76.0, -100.0, 32.0, 76.0, -67.0, -100.0, -78.0, -34.0, -1.0, -23.0, 76.0, 76.0, -67.0, -67.0, 32.0, -12.0, 32.0, -67.0, -67.0, -23.0, 21.0, -67.0, -67.0, -23.0, -1.0, 76.0, 76.0, 43.0, -34.0, 32.0, 10.0, -67.0, -89.0, -67.0, -67.0, -12.0, -89.0, 21.0, 21.0, -67.0, 54.0, 43.0, -78.0, 10.0, 76.0, 54.0, 32.0, -23.0, -45.0, -67.0, 43.0, -56.0, -56.0, -78.0, 32.0, 21.0, -111.0, 21.0, -45.0, 32.0, -45.0, -89.0, -23.0, 76.0, -23.0, 32.0, 10.0, -89.0, -45.0, -1.0, 10.0, 43.0, 10.0, 76.0, -23.0, -89.0, -1.0, -56.0, -78.0, -23.0, -78.0, -23.0, 76.0, 32.0, -34.0, 76.0, 76.0, -45.0, -78.0, -100.0, 10.0, -45.0, -78.0, 10.0, -45.0, -67.0, -111.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19871630272262858, "mean_inference_ms": 10.064106233716497, "mean_action_processing_ms": 0.08759104194812833, "mean_env_wait_ms": 0.04327373391738733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004991054534912109, "StateBufferConnector_ms": 0.0030159950256347656, "ViewRequirementAgentConnector_ms": 0.08774757385253906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 72138.51, "sample_time_ms": 39165.9, "learn_time_ms": 32965.257, "learn_throughput": 121.34, "synch_weights_time_ms": 6.544}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 3736, "training_iteration": 71, "trial_id": "38794_00001", "date": "2023-06-01_22-04-03", "timestamp": 1685646243, "time_this_iter_s": 79.75137281417847, "time_total_s": 5916.501441717148, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5916.501441717148, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 44.708928571428565, "ram_util_percent": 67.93303571428571}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -34.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -45.0, 21.0, 76.0, -67.0, -78.0, -122.0, -78.0, 54.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.187083496314318, "mean_inference_ms": 9.987577696044015, "mean_action_processing_ms": 0.085413986426065, "mean_env_wait_ms": 0.04245651014231835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005757808685302734, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.08738279342651367}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.28881845032447e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 8.793705940246582, "policy_loss": -0.003954544197767973, "vf_loss": 8.797661781311035, "vf_explained_var": 0.0028571186121553183, "kl": 0.0011408888967707753, "entropy": 0.13235929608345032, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -38.95, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -56.0, -56.0, -78.0, 32.0, 21.0, -111.0, 21.0, -45.0, 32.0, -45.0, -89.0, -23.0, 76.0, -23.0, 32.0, 10.0, -89.0, -45.0, -1.0, 10.0, 43.0, 10.0, 76.0, -23.0, -89.0, -1.0, -56.0, -78.0, -23.0, -78.0, -23.0, 76.0, 32.0, -34.0, 76.0, 76.0, -45.0, -78.0, -100.0, 10.0, -45.0, -78.0, 10.0, -45.0, -67.0, -111.0, -67.0, -78.0, -67.0, -78.0, -56.0, -100.0, -67.0, -89.0, -12.0, 76.0, -67.0, -78.0, -111.0, -23.0, -67.0, -100.0, -89.0, -56.0, -78.0, -67.0, -67.0, 32.0, -34.0, -67.0, -56.0, -67.0, -1.0, -56.0, -1.0, -100.0, 21.0, -67.0, -67.0, -45.0, -23.0, -78.0, -78.0, -56.0, -89.0, -122.0, -67.0, 32.0, -67.0, -12.0, -111.0, -45.0, -100.0, -111.0, -23.0, 54.0, -67.0, -45.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19862524787180866, "mean_inference_ms": 10.058186747989486, "mean_action_processing_ms": 0.08754804173063238, "mean_env_wait_ms": 0.04325022555232362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048809051513671875, "StateBufferConnector_ms": 0.002923250198364258, "ViewRequirementAgentConnector_ms": 0.08662676811218262}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -38.95, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, -56.0, -56.0, -78.0, 32.0, 21.0, -111.0, 21.0, -45.0, 32.0, -45.0, -89.0, -23.0, 76.0, -23.0, 32.0, 10.0, -89.0, -45.0, -1.0, 10.0, 43.0, 10.0, 76.0, -23.0, -89.0, -1.0, -56.0, -78.0, -23.0, -78.0, -23.0, 76.0, 32.0, -34.0, 76.0, 76.0, -45.0, -78.0, -100.0, 10.0, -45.0, -78.0, 10.0, -45.0, -67.0, -111.0, -67.0, -78.0, -67.0, -78.0, -56.0, -100.0, -67.0, -89.0, -12.0, 76.0, -67.0, -78.0, -111.0, -23.0, -67.0, -100.0, -89.0, -56.0, -78.0, -67.0, -67.0, 32.0, -34.0, -67.0, -56.0, -67.0, -1.0, -56.0, -1.0, -100.0, 21.0, -67.0, -67.0, -45.0, -23.0, -78.0, -78.0, -56.0, -89.0, -122.0, -67.0, 32.0, -67.0, -12.0, -111.0, -45.0, -100.0, -111.0, -23.0, 54.0, -67.0, -45.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19862524787180866, "mean_inference_ms": 10.058186747989486, "mean_action_processing_ms": 0.08754804173063238, "mean_env_wait_ms": 0.04325022555232362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048809051513671875, "StateBufferConnector_ms": 0.002923250198364258, "ViewRequirementAgentConnector_ms": 0.08662676811218262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 72406.319, "sample_time_ms": 39366.357, "learn_time_ms": 33032.419, "learn_throughput": 121.093, "synch_weights_time_ms": 6.724}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 3789, "training_iteration": 72, "trial_id": "38794_00001", "date": "2023-06-01_22-05-24", "timestamp": 1685646324, "time_this_iter_s": 81.394690990448, "time_total_s": 5997.896132707596, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5997.896132707596, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 48.21327433628318, "ram_util_percent": 67.20265486725664}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -31.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, 10.0, -67.0, -100.0, -111.0, -34.0, 43.0, 76.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18705560836122298, "mean_inference_ms": 9.98516962077485, "mean_action_processing_ms": 0.08539627857510437, "mean_env_wait_ms": 0.042441781623746684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005419254302978516, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.09006023406982422}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.144409225162235e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 6.475278377532959, "policy_loss": -0.0012895972467958927, "vf_loss": 6.47656774520874, "vf_explained_var": 0.005602122750133276, "kl": 0.0006162718054838479, "entropy": 0.11070278286933899, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -32.68, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -89.0, -12.0, 76.0, -67.0, -78.0, -111.0, -23.0, -67.0, -100.0, -89.0, -56.0, -78.0, -67.0, -67.0, 32.0, -34.0, -67.0, -56.0, -67.0, -1.0, -56.0, -1.0, -100.0, 21.0, -67.0, -67.0, -45.0, -23.0, -78.0, -78.0, -56.0, -89.0, -122.0, -67.0, 32.0, -67.0, -12.0, -111.0, -45.0, -100.0, -111.0, -23.0, 54.0, -67.0, -45.0, -89.0, -89.0, -78.0, 65.0, 65.0, 10.0, -23.0, -56.0, -133.0, -89.0, -67.0, 43.0, 43.0, 76.0, 76.0, 43.0, -1.0, 76.0, 76.0, 65.0, 65.0, 76.0, 65.0, -111.0, 54.0, -67.0, -67.0, -1.0, -122.0, -12.0, -67.0, -67.0, -67.0, -78.0, -89.0, -89.0, -23.0, -23.0, -34.0, -89.0, -78.0, -89.0, -23.0, -89.0, -67.0, -67.0, 21.0, 76.0, 76.0, 32.0, -67.0, 32.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1985481194517152, "mean_inference_ms": 10.052916309883631, "mean_action_processing_ms": 0.08751746646242893, "mean_env_wait_ms": 0.04323086724682099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00495147705078125, "StateBufferConnector_ms": 0.0029458999633789062, "ViewRequirementAgentConnector_ms": 0.08761405944824219}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -32.68, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -89.0, -12.0, 76.0, -67.0, -78.0, -111.0, -23.0, -67.0, -100.0, -89.0, -56.0, -78.0, -67.0, -67.0, 32.0, -34.0, -67.0, -56.0, -67.0, -1.0, -56.0, -1.0, -100.0, 21.0, -67.0, -67.0, -45.0, -23.0, -78.0, -78.0, -56.0, -89.0, -122.0, -67.0, 32.0, -67.0, -12.0, -111.0, -45.0, -100.0, -111.0, -23.0, 54.0, -67.0, -45.0, -89.0, -89.0, -78.0, 65.0, 65.0, 10.0, -23.0, -56.0, -133.0, -89.0, -67.0, 43.0, 43.0, 76.0, 76.0, 43.0, -1.0, 76.0, 76.0, 65.0, 65.0, 76.0, 65.0, -111.0, 54.0, -67.0, -67.0, -1.0, -122.0, -12.0, -67.0, -67.0, -67.0, -78.0, -89.0, -89.0, -23.0, -23.0, -34.0, -89.0, -78.0, -89.0, -23.0, -89.0, -67.0, -67.0, 21.0, 76.0, 76.0, 32.0, -67.0, 32.0, 43.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1985481194517152, "mean_inference_ms": 10.052916309883631, "mean_action_processing_ms": 0.08751746646242893, "mean_env_wait_ms": 0.04323086724682099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00495147705078125, "StateBufferConnector_ms": 0.0029458999633789062, "ViewRequirementAgentConnector_ms": 0.08761405944824219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 72468.92, "sample_time_ms": 39373.378, "learn_time_ms": 33088.046, "learn_throughput": 120.89, "synch_weights_time_ms": 6.672}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 3842, "training_iteration": 73, "trial_id": "38794_00001", "date": "2023-06-01_22-06-45", "timestamp": 1685646405, "time_this_iter_s": 80.996248960495, "time_total_s": 6078.892381668091, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6078.892381668091, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 47.41504424778761, "ram_util_percent": 66.82035398230089}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -67.0, "episode_reward_mean": -37.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -1.0, -34.0, -23.0, -56.0, -67.0, -67.0, -34.0, -67.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18688106335077848, "mean_inference_ms": 9.974649070716278, "mean_action_processing_ms": 0.08531083160425892, "mean_env_wait_ms": 0.042384414495143005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004842281341552734, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.07786750793457031}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.722046125811175e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 7.096342086791992, "policy_loss": -0.0004821587644983083, "vf_loss": 7.096823692321777, "vf_explained_var": 0.007923048920929432, "kl": 0.0009794324869289994, "entropy": 0.11966197192668915, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -16.62, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -56.0, -133.0, -89.0, -67.0, 43.0, 43.0, 76.0, 76.0, 43.0, -1.0, 76.0, 76.0, 65.0, 65.0, 76.0, 65.0, -111.0, 54.0, -67.0, -67.0, -1.0, -122.0, -12.0, -67.0, -67.0, -67.0, -78.0, -89.0, -89.0, -23.0, -23.0, -34.0, -89.0, -78.0, -89.0, -23.0, -89.0, -67.0, -67.0, 21.0, 76.0, 76.0, 32.0, -67.0, 32.0, 43.0, 76.0, -67.0, -1.0, -100.0, -56.0, 76.0, -78.0, -23.0, -56.0, -23.0, 76.0, 10.0, -67.0, -78.0, -89.0, -67.0, -23.0, -56.0, -67.0, -67.0, -111.0, 32.0, 76.0, 76.0, 10.0, -67.0, -1.0, 32.0, -56.0, -12.0, -67.0, -34.0, -67.0, -78.0, -56.0, 10.0, 65.0, -67.0, -67.0, -67.0, 43.0, 76.0, -34.0, 21.0, 76.0, 43.0, 32.0, 76.0, 76.0, -23.0, -56.0, 43.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1984438094051356, "mean_inference_ms": 10.046377642247279, "mean_action_processing_ms": 0.08746909493675716, "mean_env_wait_ms": 0.04320109822287285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004694461822509766, "StateBufferConnector_ms": 0.0029065608978271484, "ViewRequirementAgentConnector_ms": 0.08641576766967773}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -16.62, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.0, -56.0, -133.0, -89.0, -67.0, 43.0, 43.0, 76.0, 76.0, 43.0, -1.0, 76.0, 76.0, 65.0, 65.0, 76.0, 65.0, -111.0, 54.0, -67.0, -67.0, -1.0, -122.0, -12.0, -67.0, -67.0, -67.0, -78.0, -89.0, -89.0, -23.0, -23.0, -34.0, -89.0, -78.0, -89.0, -23.0, -89.0, -67.0, -67.0, 21.0, 76.0, 76.0, 32.0, -67.0, 32.0, 43.0, 76.0, -67.0, -1.0, -100.0, -56.0, 76.0, -78.0, -23.0, -56.0, -23.0, 76.0, 10.0, -67.0, -78.0, -89.0, -67.0, -23.0, -56.0, -67.0, -67.0, -111.0, 32.0, 76.0, 76.0, 10.0, -67.0, -1.0, 32.0, -56.0, -12.0, -67.0, -34.0, -67.0, -78.0, -56.0, 10.0, 65.0, -67.0, -67.0, -67.0, 43.0, 76.0, -34.0, 21.0, 76.0, 43.0, 32.0, 76.0, 76.0, -23.0, -56.0, 43.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1984438094051356, "mean_inference_ms": 10.046377642247279, "mean_action_processing_ms": 0.08746909493675716, "mean_env_wait_ms": 0.04320109822287285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004694461822509766, "StateBufferConnector_ms": 0.0029065608978271484, "ViewRequirementAgentConnector_ms": 0.08641576766967773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 72490.969, "sample_time_ms": 39424.535, "learn_time_ms": 33058.975, "learn_throughput": 120.996, "synch_weights_time_ms": 6.631}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 3894, "training_iteration": 74, "trial_id": "38794_00001", "date": "2023-06-01_22-08-04", "timestamp": 1685646484, "time_this_iter_s": 78.57476091384888, "time_total_s": 6157.46714258194, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6157.46714258194, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 45.16513761467889, "ram_util_percent": 66.8467889908257}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -34.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -45.0, 43.0, -78.0, -67.0, -89.0, 43.0, 76.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18682651516763843, "mean_inference_ms": 9.971029693495904, "mean_action_processing_ms": 0.08528738807697897, "mean_env_wait_ms": 0.04235958354945467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004673004150390625, "StateBufferConnector_ms": 0.0031495094299316406, "ViewRequirementAgentConnector_ms": 0.08962631225585938}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.8610230629055877e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 7.554780006408691, "policy_loss": -0.0024920180439949036, "vf_loss": 7.557272434234619, "vf_explained_var": 2.4835269951672956e-10, "kl": 0.0006806908641010523, "entropy": 0.11024312674999237, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -24.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -23.0, -56.0, -23.0, 76.0, 10.0, -67.0, -78.0, -89.0, -67.0, -23.0, -56.0, -67.0, -67.0, -111.0, 32.0, 76.0, 76.0, 10.0, -67.0, -1.0, 32.0, -56.0, -12.0, -67.0, -34.0, -67.0, -78.0, -56.0, 10.0, 65.0, -67.0, -67.0, -67.0, 43.0, 76.0, -34.0, 21.0, 76.0, 43.0, 32.0, 76.0, 76.0, -23.0, -56.0, 43.0, -89.0, -12.0, 76.0, -1.0, -34.0, 54.0, -67.0, -78.0, -67.0, -67.0, -67.0, -111.0, -67.0, -34.0, -67.0, -1.0, -67.0, -23.0, -56.0, 32.0, -67.0, -45.0, -111.0, -89.0, -34.0, 32.0, -78.0, -67.0, -67.0, -67.0, -111.0, -89.0, -89.0, 21.0, -34.0, -89.0, -67.0, -67.0, -1.0, 76.0, 76.0, 76.0, -67.0, 21.0, -67.0, 32.0, -67.0, 43.0, 32.0, 65.0, -1.0, 54.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19836668697086168, "mean_inference_ms": 10.04135203818515, "mean_action_processing_ms": 0.08742793622250901, "mean_env_wait_ms": 0.043179747967524496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004628419876098633, "StateBufferConnector_ms": 0.002869129180908203, "ViewRequirementAgentConnector_ms": 0.08620500564575195}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -24.1, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.0, -23.0, -56.0, -23.0, 76.0, 10.0, -67.0, -78.0, -89.0, -67.0, -23.0, -56.0, -67.0, -67.0, -111.0, 32.0, 76.0, 76.0, 10.0, -67.0, -1.0, 32.0, -56.0, -12.0, -67.0, -34.0, -67.0, -78.0, -56.0, 10.0, 65.0, -67.0, -67.0, -67.0, 43.0, 76.0, -34.0, 21.0, 76.0, 43.0, 32.0, 76.0, 76.0, -23.0, -56.0, 43.0, -89.0, -12.0, 76.0, -1.0, -34.0, 54.0, -67.0, -78.0, -67.0, -67.0, -67.0, -111.0, -67.0, -34.0, -67.0, -1.0, -67.0, -23.0, -56.0, 32.0, -67.0, -45.0, -111.0, -89.0, -34.0, 32.0, -78.0, -67.0, -67.0, -67.0, -111.0, -89.0, -89.0, 21.0, -34.0, -89.0, -67.0, -67.0, -1.0, 76.0, 76.0, 76.0, -67.0, 21.0, -67.0, 32.0, -67.0, 43.0, 32.0, 65.0, -1.0, 54.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19836668697086168, "mean_inference_ms": 10.04135203818515, "mean_action_processing_ms": 0.08742793622250901, "mean_env_wait_ms": 0.043179747967524496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004628419876098633, "StateBufferConnector_ms": 0.002869129180908203, "ViewRequirementAgentConnector_ms": 0.08620500564575195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 72653.076, "sample_time_ms": 39613.12, "learn_time_ms": 33032.464, "learn_throughput": 121.093, "synch_weights_time_ms": 6.663}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 3947, "training_iteration": 75, "trial_id": "38794_00001", "date": "2023-06-01_22-09-25", "timestamp": 1685646565, "time_this_iter_s": 80.76670503616333, "time_total_s": 6238.233847618103, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6238.233847618103, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 43.949557522123904, "ram_util_percent": 65.9150442477876}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -100.0, "episode_reward_mean": -31.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.0, -67.0, 43.0, -78.0, -12.0, -56.0, -1.0, -89.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18678161238177687, "mean_inference_ms": 9.967944894507557, "mean_action_processing_ms": 0.085263632747292, "mean_env_wait_ms": 0.04233588072090494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006263256072998047, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.08284807205200195}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4305115314527939e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 6.918078422546387, "policy_loss": -0.00032554587232880294, "vf_loss": 6.9184041023254395, "vf_explained_var": 0.0004319372237659991, "kl": 0.00037574933958239853, "entropy": 0.11250888556241989, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -26.41, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -67.0, -67.0, -67.0, -111.0, -67.0, -34.0, -67.0, -1.0, -67.0, -23.0, -56.0, 32.0, -67.0, -45.0, -111.0, -89.0, -34.0, 32.0, -78.0, -67.0, -67.0, -67.0, -111.0, -89.0, -89.0, 21.0, -34.0, -89.0, -67.0, -67.0, -1.0, 76.0, 76.0, 76.0, -67.0, 21.0, -67.0, 32.0, -67.0, 43.0, 32.0, 65.0, -1.0, 54.0, -67.0, -67.0, -67.0, -67.0, -89.0, -45.0, -23.0, 21.0, -56.0, -67.0, 65.0, 76.0, -78.0, -89.0, -67.0, -78.0, -89.0, -67.0, 32.0, 43.0, -56.0, -89.0, 54.0, -100.0, 65.0, -67.0, -111.0, -45.0, 21.0, 43.0, 65.0, 76.0, 76.0, -67.0, -45.0, -56.0, 10.0, -56.0, 21.0, 76.0, 76.0, -89.0, -89.0, -78.0, -67.0, 32.0, 76.0, 21.0, -45.0, 76.0, 43.0, -56.0, 76.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19830985678643365, "mean_inference_ms": 10.0377403108101, "mean_action_processing_ms": 0.08739937546498552, "mean_env_wait_ms": 0.043167959244207715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004771232604980469, "StateBufferConnector_ms": 0.0028629302978515625, "ViewRequirementAgentConnector_ms": 0.08741021156311035}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -26.41, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.0, -67.0, -67.0, -67.0, -111.0, -67.0, -34.0, -67.0, -1.0, -67.0, -23.0, -56.0, 32.0, -67.0, -45.0, -111.0, -89.0, -34.0, 32.0, -78.0, -67.0, -67.0, -67.0, -111.0, -89.0, -89.0, 21.0, -34.0, -89.0, -67.0, -67.0, -1.0, 76.0, 76.0, 76.0, -67.0, 21.0, -67.0, 32.0, -67.0, 43.0, 32.0, 65.0, -1.0, 54.0, -67.0, -67.0, -67.0, -67.0, -89.0, -45.0, -23.0, 21.0, -56.0, -67.0, 65.0, 76.0, -78.0, -89.0, -67.0, -78.0, -89.0, -67.0, 32.0, 43.0, -56.0, -89.0, 54.0, -100.0, 65.0, -67.0, -111.0, -45.0, 21.0, 43.0, 65.0, 76.0, 76.0, -67.0, -45.0, -56.0, 10.0, -56.0, 21.0, 76.0, 76.0, -89.0, -89.0, -78.0, -67.0, 32.0, 76.0, 21.0, -45.0, 76.0, 43.0, -56.0, 76.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19830985678643365, "mean_inference_ms": 10.0377403108101, "mean_action_processing_ms": 0.08739937546498552, "mean_env_wait_ms": 0.043167959244207715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004771232604980469, "StateBufferConnector_ms": 0.0028629302978515625, "ViewRequirementAgentConnector_ms": 0.08741021156311035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 72581.464, "sample_time_ms": 39705.69, "learn_time_ms": 32868.241, "learn_throughput": 121.698, "synch_weights_time_ms": 6.712}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 4000, "training_iteration": 76, "trial_id": "38794_00001", "date": "2023-06-01_22-10-46", "timestamp": 1685646646, "time_this_iter_s": 80.88746190071106, "time_total_s": 6319.121309518814, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6319.121309518814, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 43.251327433628326, "ram_util_percent": 66.50973451327434}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -57.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -67.0, -56.0, -100.0, -67.0, -34.0, -67.0, -67.0, -67.0, -122.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1867450543913031, "mean_inference_ms": 9.966747137562404, "mean_action_processing_ms": 0.08525460292879848, "mean_env_wait_ms": 0.042321638343041715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005180835723876953, "StateBufferConnector_ms": 0.0027561187744140625, "ViewRequirementAgentConnector_ms": 0.08587360382080078}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.152557657263969e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 7.2863264083862305, "policy_loss": -0.0004923985688947141, "vf_loss": 7.286818981170654, "vf_explained_var": 1.0554989104960555e-09, "kl": 0.00020453626348171383, "entropy": 0.11202382296323776, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -19.15, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -56.0, -67.0, 65.0, 76.0, -78.0, -89.0, -67.0, -78.0, -89.0, -67.0, 32.0, 43.0, -56.0, -89.0, 54.0, -100.0, 65.0, -67.0, -111.0, -45.0, 21.0, 43.0, 65.0, 76.0, 76.0, -67.0, -45.0, -56.0, 10.0, -56.0, 21.0, 76.0, 76.0, -89.0, -89.0, -78.0, -67.0, 32.0, 76.0, 21.0, -45.0, 76.0, 43.0, -56.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -23.0, -67.0, -67.0, -67.0, 21.0, 32.0, -100.0, -67.0, -1.0, 76.0, -100.0, -89.0, -23.0, -78.0, 10.0, 76.0, -12.0, -78.0, -100.0, -56.0, 76.0, 76.0, 54.0, -89.0, -12.0, 43.0, 21.0, -67.0, -67.0, 10.0, -56.0, -56.0, 10.0, 76.0, -34.0, 10.0, 32.0, -89.0, -45.0, -67.0, -67.0, -67.0, -89.0, -23.0, 54.0, -1.0, -78.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982460478400809, "mean_inference_ms": 10.034184699178182, "mean_action_processing_ms": 0.08737630631469566, "mean_env_wait_ms": 0.0431552491738103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004969358444213867, "StateBufferConnector_ms": 0.002912282943725586, "ViewRequirementAgentConnector_ms": 0.08723783493041992}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -19.15, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -56.0, -67.0, 65.0, 76.0, -78.0, -89.0, -67.0, -78.0, -89.0, -67.0, 32.0, 43.0, -56.0, -89.0, 54.0, -100.0, 65.0, -67.0, -111.0, -45.0, 21.0, 43.0, 65.0, 76.0, 76.0, -67.0, -45.0, -56.0, 10.0, -56.0, 21.0, 76.0, 76.0, -89.0, -89.0, -78.0, -67.0, 32.0, 76.0, 21.0, -45.0, 76.0, 43.0, -56.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -23.0, -67.0, -67.0, -67.0, 21.0, 32.0, -100.0, -67.0, -1.0, 76.0, -100.0, -89.0, -23.0, -78.0, 10.0, 76.0, -12.0, -78.0, -100.0, -56.0, 76.0, 76.0, 54.0, -89.0, -12.0, 43.0, 21.0, -67.0, -67.0, 10.0, -56.0, -56.0, 10.0, 76.0, -34.0, 10.0, 32.0, -89.0, -45.0, -67.0, -67.0, -67.0, -89.0, -23.0, 54.0, -1.0, -78.0, 65.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982460478400809, "mean_inference_ms": 10.034184699178182, "mean_action_processing_ms": 0.08737630631469566, "mean_env_wait_ms": 0.0431552491738103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004969358444213867, "StateBufferConnector_ms": 0.002912282943725586, "ViewRequirementAgentConnector_ms": 0.08723783493041992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 72790.844, "sample_time_ms": 39890.256, "learn_time_ms": 32893.088, "learn_throughput": 121.606, "synch_weights_time_ms": 6.701}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 4052, "training_iteration": 77, "trial_id": "38794_00001", "date": "2023-06-01_22-12-07", "timestamp": 1685646727, "time_this_iter_s": 81.3092098236084, "time_total_s": 6400.4305193424225, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6400.4305193424225, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 46.63982300884956, "ram_util_percent": 67.65929203539822}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -100.0, "episode_reward_mean": -28.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -67.0, -34.0, -100.0, -67.0, -45.0, -67.0, 32.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18668931653565926, "mean_inference_ms": 9.96241489725777, "mean_action_processing_ms": 0.08521872962671997, "mean_env_wait_ms": 0.042299045825225375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005481243133544922, "StateBufferConnector_ms": 0.0029754638671875, "ViewRequirementAgentConnector_ms": 0.09042978286743164}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.5762788286319847e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 7.50236177444458, "policy_loss": -0.001831435482017696, "vf_loss": 7.504193305969238, "vf_explained_var": -0.0003077936707995832, "kl": 0.0001518863282399252, "entropy": 0.10523565858602524, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -23.44, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, 21.0, 32.0, -100.0, -67.0, -1.0, 76.0, -100.0, -89.0, -23.0, -78.0, 10.0, 76.0, -12.0, -78.0, -100.0, -56.0, 76.0, 76.0, 54.0, -89.0, -12.0, 43.0, 21.0, -67.0, -67.0, 10.0, -56.0, -56.0, 10.0, 76.0, -34.0, 10.0, 32.0, -89.0, -45.0, -67.0, -67.0, -67.0, -89.0, -23.0, 54.0, -1.0, -78.0, 65.0, 76.0, -12.0, -45.0, -67.0, -78.0, 10.0, 76.0, 76.0, 76.0, 21.0, 76.0, -1.0, 21.0, 76.0, -12.0, -56.0, 21.0, -56.0, -67.0, -67.0, -67.0, -89.0, -12.0, -78.0, -67.0, 76.0, 76.0, 76.0, 76.0, -100.0, -67.0, -111.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -23.0, -67.0, -12.0, -67.0, -34.0, 76.0, -100.0, -89.0, -67.0, -67.0, -89.0, -67.0, -67.0, -23.0, -67.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19816612257678506, "mean_inference_ms": 10.029317144262201, "mean_action_processing_ms": 0.08734155678916647, "mean_env_wait_ms": 0.043136031769404566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048868656158447266, "StateBufferConnector_ms": 0.0029134750366210938, "ViewRequirementAgentConnector_ms": 0.08539199829101562}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -23.44, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, 21.0, 32.0, -100.0, -67.0, -1.0, 76.0, -100.0, -89.0, -23.0, -78.0, 10.0, 76.0, -12.0, -78.0, -100.0, -56.0, 76.0, 76.0, 54.0, -89.0, -12.0, 43.0, 21.0, -67.0, -67.0, 10.0, -56.0, -56.0, 10.0, 76.0, -34.0, 10.0, 32.0, -89.0, -45.0, -67.0, -67.0, -67.0, -89.0, -23.0, 54.0, -1.0, -78.0, 65.0, 76.0, -12.0, -45.0, -67.0, -78.0, 10.0, 76.0, 76.0, 76.0, 21.0, 76.0, -1.0, 21.0, 76.0, -12.0, -56.0, 21.0, -56.0, -67.0, -67.0, -67.0, -89.0, -12.0, -78.0, -67.0, 76.0, 76.0, 76.0, 76.0, -100.0, -67.0, -111.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -23.0, -67.0, -12.0, -67.0, -34.0, 76.0, -100.0, -89.0, -67.0, -67.0, -89.0, -67.0, -67.0, -23.0, -67.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19816612257678506, "mean_inference_ms": 10.029317144262201, "mean_action_processing_ms": 0.08734155678916647, "mean_env_wait_ms": 0.043136031769404566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048868656158447266, "StateBufferConnector_ms": 0.0029134750366210938, "ViewRequirementAgentConnector_ms": 0.08539199829101562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 72871.216, "sample_time_ms": 39936.608, "learn_time_ms": 32927.124, "learn_throughput": 121.48, "synch_weights_time_ms": 6.676}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 4105, "training_iteration": 78, "trial_id": "38794_00001", "date": "2023-06-01_22-13-27", "timestamp": 1685646807, "time_this_iter_s": 79.60243368148804, "time_total_s": 6480.0329530239105, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6480.0329530239105, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 45.082882882882885, "ram_util_percent": 67.47747747747749}}
{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -111.0, "episode_reward_mean": -63.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -56.0, -1.0, 21.0, -78.0, -111.0, -89.0, -100.0, -67.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18670795160040302, "mean_inference_ms": 9.962428702367152, "mean_action_processing_ms": 0.08521263712289277, "mean_env_wait_ms": 0.042289601194138035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004901885986328125, "StateBufferConnector_ms": 0.0028181076049804688, "ViewRequirementAgentConnector_ms": 0.08780956268310547}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7881394143159923e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 7.0583271980285645, "policy_loss": -0.0006135219009593129, "vf_loss": 7.058940410614014, "vf_explained_var": -0.0017361297504976392, "kl": 0.00029996977536939085, "entropy": 0.12290585786104202, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -22.34, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, 21.0, 76.0, -1.0, 21.0, 76.0, -12.0, -56.0, 21.0, -56.0, -67.0, -67.0, -67.0, -89.0, -12.0, -78.0, -67.0, 76.0, 76.0, 76.0, 76.0, -100.0, -67.0, -111.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -23.0, -67.0, -12.0, -67.0, -34.0, 76.0, -100.0, -89.0, -67.0, -67.0, -89.0, -67.0, -67.0, -23.0, -67.0, 43.0, -89.0, -45.0, 10.0, 76.0, 76.0, 76.0, 76.0, -56.0, -23.0, -45.0, 76.0, -67.0, -12.0, -56.0, -89.0, -12.0, -67.0, 43.0, 76.0, 76.0, -45.0, -67.0, -89.0, -78.0, -67.0, 21.0, -34.0, -100.0, -45.0, -89.0, -67.0, -89.0, -67.0, -89.0, -67.0, -89.0, -67.0, -67.0, -34.0, 76.0, 76.0, -78.0, 54.0, 76.0, 76.0, 76.0, 65.0, 76.0, -78.0, -67.0, -89.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19805302161745167, "mean_inference_ms": 10.022829383751674, "mean_action_processing_ms": 0.08728591483163826, "mean_env_wait_ms": 0.04310575695022549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004712581634521484, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.08513760566711426}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -22.34, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, 21.0, 76.0, -1.0, 21.0, 76.0, -12.0, -56.0, 21.0, -56.0, -67.0, -67.0, -67.0, -89.0, -12.0, -78.0, -67.0, 76.0, 76.0, 76.0, 76.0, -100.0, -67.0, -111.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -23.0, -67.0, -12.0, -67.0, -34.0, 76.0, -100.0, -89.0, -67.0, -67.0, -89.0, -67.0, -67.0, -23.0, -67.0, 43.0, -89.0, -45.0, 10.0, 76.0, 76.0, 76.0, 76.0, -56.0, -23.0, -45.0, 76.0, -67.0, -12.0, -56.0, -89.0, -12.0, -67.0, 43.0, 76.0, 76.0, -45.0, -67.0, -89.0, -78.0, -67.0, 21.0, -34.0, -100.0, -45.0, -89.0, -67.0, -89.0, -67.0, -89.0, -67.0, -89.0, -67.0, -67.0, -34.0, 76.0, 76.0, -78.0, 54.0, 76.0, 76.0, 76.0, 65.0, 76.0, -78.0, -67.0, -89.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19805302161745167, "mean_inference_ms": 10.022829383751674, "mean_action_processing_ms": 0.08728591483163826, "mean_env_wait_ms": 0.04310575695022549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004712581634521484, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.08513760566711426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 72809.139, "sample_time_ms": 39942.157, "learn_time_ms": 32859.504, "learn_throughput": 121.73, "synch_weights_time_ms": 6.666}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 4157, "training_iteration": 79, "trial_id": "38794_00001", "date": "2023-06-01_22-14-46", "timestamp": 1685646886, "time_this_iter_s": 79.70912981033325, "time_total_s": 6559.742082834244, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6559.742082834244, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 45.256756756756765, "ram_util_percent": 66.54414414414414}}
{"evaluation": {"episode_reward_max": 10.0, "episode_reward_min": -89.0, "episode_reward_mean": -51.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -56.0, -67.0, -67.0, 10.0, -56.0, -67.0, -67.0, -89.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18668611183642708, "mean_inference_ms": 9.959042020339, "mean_action_processing_ms": 0.08519495657577661, "mean_env_wait_ms": 0.04227651843675506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005218982696533203, "StateBufferConnector_ms": 0.0027751922607421875, "ViewRequirementAgentConnector_ms": 0.08470535278320312}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.940697071579962e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 8.009710311889648, "policy_loss": -0.0044445376843214035, "vf_loss": 8.014155387878418, "vf_explained_var": 1.4570045095751993e-05, "kl": 0.0008914727950468659, "entropy": 0.10601429641246796, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -31.25, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, -56.0, -23.0, -45.0, 76.0, -67.0, -12.0, -56.0, -89.0, -12.0, -67.0, 43.0, 76.0, 76.0, -45.0, -67.0, -89.0, -78.0, -67.0, 21.0, -34.0, -100.0, -45.0, -89.0, -67.0, -89.0, -67.0, -89.0, -67.0, -89.0, -67.0, -67.0, -34.0, 76.0, 76.0, -78.0, 54.0, 76.0, 76.0, 76.0, 65.0, 76.0, -78.0, -67.0, -89.0, -67.0, -67.0, 21.0, 76.0, 32.0, -78.0, 10.0, 76.0, 76.0, -78.0, -78.0, -45.0, -78.0, -45.0, -67.0, 10.0, -67.0, 10.0, -12.0, 10.0, -89.0, -89.0, -89.0, -67.0, 32.0, -67.0, -89.0, -34.0, -89.0, -67.0, -67.0, -67.0, -89.0, -56.0, -56.0, -78.0, 43.0, -45.0, -111.0, -100.0, -89.0, -56.0, 43.0, -45.0, 43.0, 76.0, -89.0, -34.0, -45.0, -67.0, -67.0, -23.0, -100.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19796453301646597, "mean_inference_ms": 10.018162576567866, "mean_action_processing_ms": 0.0872409780817387, "mean_env_wait_ms": 0.0430820057191558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004779815673828125, "StateBufferConnector_ms": 0.0028231143951416016, "ViewRequirementAgentConnector_ms": 0.08681583404541016}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -31.25, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, -56.0, -23.0, -45.0, 76.0, -67.0, -12.0, -56.0, -89.0, -12.0, -67.0, 43.0, 76.0, 76.0, -45.0, -67.0, -89.0, -78.0, -67.0, 21.0, -34.0, -100.0, -45.0, -89.0, -67.0, -89.0, -67.0, -89.0, -67.0, -89.0, -67.0, -67.0, -34.0, 76.0, 76.0, -78.0, 54.0, 76.0, 76.0, 76.0, 65.0, 76.0, -78.0, -67.0, -89.0, -67.0, -67.0, 21.0, 76.0, 32.0, -78.0, 10.0, 76.0, 76.0, -78.0, -78.0, -45.0, -78.0, -45.0, -67.0, 10.0, -67.0, 10.0, -12.0, 10.0, -89.0, -89.0, -89.0, -67.0, 32.0, -67.0, -89.0, -34.0, -89.0, -67.0, -67.0, -67.0, -89.0, -56.0, -56.0, -78.0, 43.0, -45.0, -111.0, -100.0, -89.0, -56.0, 43.0, -45.0, 43.0, 76.0, -89.0, -34.0, -45.0, -67.0, -67.0, -23.0, -100.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19796453301646597, "mean_inference_ms": 10.018162576567866, "mean_action_processing_ms": 0.0872409780817387, "mean_env_wait_ms": 0.0430820057191558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004779815673828125, "StateBufferConnector_ms": 0.0028231143951416016, "ViewRequirementAgentConnector_ms": 0.08681583404541016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 72769.191, "sample_time_ms": 39950.816, "learn_time_ms": 32810.967, "learn_throughput": 121.91, "synch_weights_time_ms": 6.609}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 4210, "training_iteration": 80, "trial_id": "38794_00001", "date": "2023-06-01_22-16-07", "timestamp": 1685646967, "time_this_iter_s": 81.10886812210083, "time_total_s": 6640.850950956345, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6640.850950956345, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 46.16017699115044, "ram_util_percent": 66.39203539823009}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -89.0, "episode_reward_mean": -45.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -78.0, 10.0, -34.0, -67.0, -78.0, -67.0, -89.0, -67.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18660847635421446, "mean_inference_ms": 9.954484640216794, "mean_action_processing_ms": 0.08514269396598084, "mean_env_wait_ms": 0.04224212477812554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050258636474609375, "StateBufferConnector_ms": 0.0030088424682617188, "ViewRequirementAgentConnector_ms": 0.08946418762207031}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.470348535789981e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 8.435193061828613, "policy_loss": 1.0458783435751684e-05, "vf_loss": 8.435182571411133, "vf_explained_var": 6.558497716468992e-06, "kl": 0.00032386963721364737, "entropy": 0.09348004311323166, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -45.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, -78.0, -78.0, -45.0, -78.0, -45.0, -67.0, 10.0, -67.0, 10.0, -12.0, 10.0, -89.0, -89.0, -89.0, -67.0, 32.0, -67.0, -89.0, -34.0, -89.0, -67.0, -67.0, -67.0, -89.0, -56.0, -56.0, -78.0, 43.0, -45.0, -111.0, -100.0, -89.0, -56.0, 43.0, -45.0, 43.0, 76.0, -89.0, -34.0, -45.0, -67.0, -67.0, -23.0, -100.0, -67.0, -89.0, 43.0, -67.0, 21.0, 76.0, 43.0, 65.0, -67.0, -1.0, -67.0, -67.0, -45.0, -67.0, -78.0, -67.0, -89.0, 10.0, -67.0, 32.0, 76.0, -12.0, -67.0, -1.0, -1.0, -67.0, -67.0, -67.0, -78.0, -45.0, -67.0, -89.0, -56.0, -78.0, -67.0, -67.0, -111.0, -67.0, -100.0, 21.0, -100.0, -89.0, -67.0, -67.0, -89.0, -78.0, -67.0, -12.0, -23.0, -56.0, -67.0, -56.0, -67.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19786384702048976, "mean_inference_ms": 10.012797538128634, "mean_action_processing_ms": 0.08718573519036985, "mean_env_wait_ms": 0.04305507556301677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004652976989746094, "StateBufferConnector_ms": 0.0028150081634521484, "ViewRequirementAgentConnector_ms": 0.08567452430725098}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -45.0, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, -78.0, -78.0, -45.0, -78.0, -45.0, -67.0, 10.0, -67.0, 10.0, -12.0, 10.0, -89.0, -89.0, -89.0, -67.0, 32.0, -67.0, -89.0, -34.0, -89.0, -67.0, -67.0, -67.0, -89.0, -56.0, -56.0, -78.0, 43.0, -45.0, -111.0, -100.0, -89.0, -56.0, 43.0, -45.0, 43.0, 76.0, -89.0, -34.0, -45.0, -67.0, -67.0, -23.0, -100.0, -67.0, -89.0, 43.0, -67.0, 21.0, 76.0, 43.0, 65.0, -67.0, -1.0, -67.0, -67.0, -45.0, -67.0, -78.0, -67.0, -89.0, 10.0, -67.0, 32.0, 76.0, -12.0, -67.0, -1.0, -1.0, -67.0, -67.0, -67.0, -78.0, -45.0, -67.0, -89.0, -56.0, -78.0, -67.0, -67.0, -111.0, -67.0, -100.0, 21.0, -100.0, -89.0, -67.0, -67.0, -89.0, -78.0, -67.0, -12.0, -23.0, -56.0, -67.0, -56.0, -67.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19786384702048976, "mean_inference_ms": 10.012797538128634, "mean_action_processing_ms": 0.08718573519036985, "mean_env_wait_ms": 0.04305507556301677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004652976989746094, "StateBufferConnector_ms": 0.0028150081634521484, "ViewRequirementAgentConnector_ms": 0.08567452430725098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 72674.065, "sample_time_ms": 39884.455, "learn_time_ms": 32782.113, "learn_throughput": 122.018, "synch_weights_time_ms": 6.689}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 4263, "training_iteration": 81, "trial_id": "38794_00001", "date": "2023-06-01_22-17-26", "timestamp": 1685647046, "time_this_iter_s": 78.79108810424805, "time_total_s": 6719.642039060593, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6719.642039060593, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 44.98818181818181, "ram_util_percent": 66.44818181818182}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -46.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 21.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -89.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1865345783551631, "mean_inference_ms": 9.951214488806198, "mean_action_processing_ms": 0.08510432304022039, "mean_env_wait_ms": 0.04222142799864555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00545501708984375, "StateBufferConnector_ms": 0.002899169921875, "ViewRequirementAgentConnector_ms": 0.08616447448730469}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2351742678949904e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 8.101014137268066, "policy_loss": -0.00041042049997486174, "vf_loss": 8.101424217224121, "vf_explained_var": 1.4919912246114109e-05, "kl": 0.00016169591981451958, "entropy": 0.08265279233455658, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -43.79, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 65.0, -67.0, -1.0, -67.0, -67.0, -45.0, -67.0, -78.0, -67.0, -89.0, 10.0, -67.0, 32.0, 76.0, -12.0, -67.0, -1.0, -1.0, -67.0, -67.0, -67.0, -78.0, -45.0, -67.0, -89.0, -56.0, -78.0, -67.0, -67.0, -111.0, -67.0, -100.0, 21.0, -100.0, -89.0, -67.0, -67.0, -89.0, -78.0, -67.0, -12.0, -23.0, -56.0, -67.0, -56.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -100.0, 21.0, -56.0, -12.0, -67.0, -78.0, -67.0, 54.0, -67.0, -89.0, -67.0, -89.0, -56.0, -78.0, -67.0, -67.0, -67.0, -67.0, -89.0, -34.0, 76.0, 76.0, -1.0, -89.0, -67.0, 10.0, -1.0, -67.0, -67.0, -23.0, -100.0, 21.0, 65.0, 76.0, -67.0, -67.0, 21.0, -56.0, -67.0, 21.0, -67.0, -67.0, -67.0, -45.0, -67.0, 65.0, 76.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19774484414844523, "mean_inference_ms": 10.006011345749501, "mean_action_processing_ms": 0.08712248559629648, "mean_env_wait_ms": 0.04302075320307621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004791736602783203, "StateBufferConnector_ms": 0.0029282569885253906, "ViewRequirementAgentConnector_ms": 0.08662104606628418}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -43.79, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 65.0, -67.0, -1.0, -67.0, -67.0, -45.0, -67.0, -78.0, -67.0, -89.0, 10.0, -67.0, 32.0, 76.0, -12.0, -67.0, -1.0, -1.0, -67.0, -67.0, -67.0, -78.0, -45.0, -67.0, -89.0, -56.0, -78.0, -67.0, -67.0, -111.0, -67.0, -100.0, 21.0, -100.0, -89.0, -67.0, -67.0, -89.0, -78.0, -67.0, -12.0, -23.0, -56.0, -67.0, -56.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -100.0, 21.0, -56.0, -12.0, -67.0, -78.0, -67.0, 54.0, -67.0, -89.0, -67.0, -89.0, -56.0, -78.0, -67.0, -67.0, -67.0, -67.0, -89.0, -34.0, 76.0, 76.0, -1.0, -89.0, -67.0, 10.0, -1.0, -67.0, -67.0, -23.0, -100.0, 21.0, 65.0, 76.0, -67.0, -67.0, 21.0, -56.0, -67.0, 21.0, -67.0, -67.0, -67.0, -45.0, -67.0, 65.0, 76.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19774484414844523, "mean_inference_ms": 10.006011345749501, "mean_action_processing_ms": 0.08712248559629648, "mean_env_wait_ms": 0.04302075320307621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004791736602783203, "StateBufferConnector_ms": 0.0029282569885253906, "ViewRequirementAgentConnector_ms": 0.08662104606628418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 72472.774, "sample_time_ms": 39792.51, "learn_time_ms": 32672.876, "learn_throughput": 122.426, "synch_weights_time_ms": 6.59}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 4315, "training_iteration": 82, "trial_id": "38794_00001", "date": "2023-06-01_22-18-46", "timestamp": 1685647126, "time_this_iter_s": 79.41952776908875, "time_total_s": 6799.061566829681, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6799.061566829681, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 44.151818181818186, "ram_util_percent": 66.45909090909092}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": -42.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -78.0, 21.0, -56.0, -67.0, -56.0, 76.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18651147436845056, "mean_inference_ms": 9.949647330128114, "mean_action_processing_ms": 0.08510502760382453, "mean_env_wait_ms": 0.04221486659016803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005271434783935547, "StateBufferConnector_ms": 0.0029850006103515625, "ViewRequirementAgentConnector_ms": 0.08632183074951172}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1175871339474952e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 7.7568583488464355, "policy_loss": -0.0010813536355271935, "vf_loss": 7.75793981552124, "vf_explained_var": -0.0009130233083851635, "kl": 0.00011264371278230101, "entropy": 0.08316467702388763, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -32.79, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -56.0, -12.0, -67.0, -78.0, -67.0, 54.0, -67.0, -89.0, -67.0, -89.0, -56.0, -78.0, -67.0, -67.0, -67.0, -67.0, -89.0, -34.0, 76.0, 76.0, -1.0, -89.0, -67.0, 10.0, -1.0, -67.0, -67.0, -23.0, -100.0, 21.0, 65.0, 76.0, -67.0, -67.0, 21.0, -56.0, -67.0, 21.0, -67.0, -67.0, -67.0, -45.0, -67.0, 65.0, 76.0, -89.0, -78.0, -67.0, -67.0, -12.0, 32.0, -67.0, 65.0, -89.0, 32.0, 76.0, -67.0, -67.0, -100.0, -67.0, -34.0, -56.0, -67.0, -67.0, -67.0, -67.0, 10.0, -56.0, -67.0, 43.0, -67.0, -23.0, 76.0, -67.0, 21.0, -67.0, -67.0, -56.0, -89.0, -89.0, -67.0, 21.0, 32.0, 32.0, 54.0, -34.0, 10.0, -67.0, -67.0, 65.0, 76.0, -67.0, -67.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19766356383906308, "mean_inference_ms": 10.001312272282592, "mean_action_processing_ms": 0.08708182075697848, "mean_env_wait_ms": 0.04299779913601803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004887104034423828, "StateBufferConnector_ms": 0.0029304027557373047, "ViewRequirementAgentConnector_ms": 0.0874793529510498}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -32.79, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -56.0, -12.0, -67.0, -78.0, -67.0, 54.0, -67.0, -89.0, -67.0, -89.0, -56.0, -78.0, -67.0, -67.0, -67.0, -67.0, -89.0, -34.0, 76.0, 76.0, -1.0, -89.0, -67.0, 10.0, -1.0, -67.0, -67.0, -23.0, -100.0, 21.0, 65.0, 76.0, -67.0, -67.0, 21.0, -56.0, -67.0, 21.0, -67.0, -67.0, -67.0, -45.0, -67.0, 65.0, 76.0, -89.0, -78.0, -67.0, -67.0, -12.0, 32.0, -67.0, 65.0, -89.0, 32.0, 76.0, -67.0, -67.0, -100.0, -67.0, -34.0, -56.0, -67.0, -67.0, -67.0, -67.0, 10.0, -56.0, -67.0, 43.0, -67.0, -23.0, 76.0, -67.0, 21.0, -67.0, -67.0, -56.0, -89.0, -89.0, -67.0, 21.0, 32.0, 32.0, 54.0, -34.0, 10.0, -67.0, -67.0, 65.0, 76.0, -67.0, -67.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19766356383906308, "mean_inference_ms": 10.001312272282592, "mean_action_processing_ms": 0.08708182075697848, "mean_env_wait_ms": 0.04299779913601803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004887104034423828, "StateBufferConnector_ms": 0.0029304027557373047, "ViewRequirementAgentConnector_ms": 0.0874793529510498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 72435.738, "sample_time_ms": 39831.98, "learn_time_ms": 32596.209, "learn_throughput": 122.714, "synch_weights_time_ms": 6.733}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 4368, "training_iteration": 83, "trial_id": "38794_00001", "date": "2023-06-01_22-20-06", "timestamp": 1685647206, "time_this_iter_s": 80.63373279571533, "time_total_s": 6879.695299625397, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6879.695299625397, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 45.36696428571429, "ram_util_percent": 66.58660714285715}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -49.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -122.0, -34.0, 76.0, -67.0, -89.0, 65.0, -78.0, -67.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18645690027886666, "mean_inference_ms": 9.947228724118363, "mean_action_processing_ms": 0.08509404860078981, "mean_env_wait_ms": 0.04220578745230423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00499725341796875, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.08307456970214844}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.587935669737476e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 8.585711479187012, "policy_loss": -0.0015284131513908505, "vf_loss": 8.587240219116211, "vf_explained_var": -7.698933046640377e-09, "kl": 0.00033267762046307325, "entropy": 0.102512426674366, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -37.41, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -89.0, 32.0, 76.0, -67.0, -67.0, -100.0, -67.0, -34.0, -56.0, -67.0, -67.0, -67.0, -67.0, 10.0, -56.0, -67.0, 43.0, -67.0, -23.0, 76.0, -67.0, 21.0, -67.0, -67.0, -56.0, -89.0, -89.0, -67.0, 21.0, 32.0, 32.0, 54.0, -34.0, 10.0, -67.0, -67.0, 65.0, 76.0, -67.0, -67.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 76.0, -56.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -23.0, 76.0, -1.0, -56.0, 43.0, -45.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -56.0, -67.0, -100.0, 10.0, -67.0, -67.0, -67.0, -23.0, -67.0, -1.0, -56.0, -67.0, -89.0, -67.0, -67.0, -67.0, 10.0, -67.0, -67.0, -67.0, -78.0, -89.0, -45.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1975813723758864, "mean_inference_ms": 9.996979216776175, "mean_action_processing_ms": 0.08704210415716117, "mean_env_wait_ms": 0.04297826146127113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004705905914306641, "StateBufferConnector_ms": 0.0027687549591064453, "ViewRequirementAgentConnector_ms": 0.0854501724243164}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -37.41, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, -89.0, 32.0, 76.0, -67.0, -67.0, -100.0, -67.0, -34.0, -56.0, -67.0, -67.0, -67.0, -67.0, 10.0, -56.0, -67.0, 43.0, -67.0, -23.0, 76.0, -67.0, 21.0, -67.0, -67.0, -56.0, -89.0, -89.0, -67.0, 21.0, 32.0, 32.0, 54.0, -34.0, 10.0, -67.0, -67.0, 65.0, 76.0, -67.0, -67.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 76.0, -56.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -23.0, 76.0, -1.0, -56.0, 43.0, -45.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -56.0, -67.0, -100.0, 10.0, -67.0, -67.0, -67.0, -23.0, -67.0, -1.0, -56.0, -67.0, -89.0, -67.0, -67.0, -67.0, 10.0, -67.0, -67.0, -67.0, -78.0, -89.0, -45.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1975813723758864, "mean_inference_ms": 9.996979216776175, "mean_action_processing_ms": 0.08704210415716117, "mean_env_wait_ms": 0.04297826146127113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004705905914306641, "StateBufferConnector_ms": 0.0027687549591064453, "ViewRequirementAgentConnector_ms": 0.0854501724243164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 72603.216, "sample_time_ms": 39852.02, "learn_time_ms": 32743.504, "learn_throughput": 122.162, "synch_weights_time_ms": 6.879}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 4421, "training_iteration": 84, "trial_id": "38794_00001", "date": "2023-06-01_22-21-27", "timestamp": 1685647287, "time_this_iter_s": 80.67608284950256, "time_total_s": 6960.371382474899, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6960.371382474899, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 48.332743362831856, "ram_util_percent": 67.03008849557521}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": -35.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -78.0, -67.0, -1.0, 32.0, -23.0, 76.0, -78.0, -78.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18647687302029015, "mean_inference_ms": 9.948014563461296, "mean_action_processing_ms": 0.08512255566084828, "mean_env_wait_ms": 0.042212396761859575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004866123199462891, "StateBufferConnector_ms": 0.0027680397033691406, "ViewRequirementAgentConnector_ms": 0.09257316589355469}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.793967834868738e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 8.245624542236328, "policy_loss": -0.0003026596095878631, "vf_loss": 8.245927810668945, "vf_explained_var": -5.712111672551146e-09, "kl": 0.00041569260065443814, "entropy": 0.12225722521543503, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -43.24, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -78.0, -67.0, -23.0, 76.0, -1.0, -56.0, 43.0, -45.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -56.0, -67.0, -100.0, 10.0, -67.0, -67.0, -67.0, -23.0, -67.0, -1.0, -56.0, -67.0, -89.0, -67.0, -67.0, -67.0, 10.0, -67.0, -67.0, -67.0, -78.0, -89.0, -45.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -23.0, 76.0, -23.0, -67.0, -67.0, 76.0, -89.0, -12.0, 76.0, 76.0, -45.0, 43.0, 10.0, 76.0, -67.0, 10.0, -56.0, -67.0, -89.0, -67.0, -78.0, -78.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, 76.0, -67.0, -89.0, -78.0, -56.0, 32.0, -67.0, -67.0, -78.0, -12.0, 10.0, 21.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19748144652850144, "mean_inference_ms": 9.991763514364969, "mean_action_processing_ms": 0.08699154827751848, "mean_env_wait_ms": 0.04295291015965314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004604339599609375, "StateBufferConnector_ms": 0.0027658939361572266, "ViewRequirementAgentConnector_ms": 0.08453583717346191}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -43.24, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -78.0, -67.0, -23.0, 76.0, -1.0, -56.0, 43.0, -45.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -56.0, -67.0, -100.0, 10.0, -67.0, -67.0, -67.0, -23.0, -67.0, -1.0, -56.0, -67.0, -89.0, -67.0, -67.0, -67.0, 10.0, -67.0, -67.0, -67.0, -78.0, -89.0, -45.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -23.0, 76.0, -23.0, -67.0, -67.0, 76.0, -89.0, -12.0, 76.0, 76.0, -45.0, 43.0, 10.0, 76.0, -67.0, 10.0, -56.0, -67.0, -89.0, -67.0, -78.0, -78.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, 76.0, -67.0, -89.0, -78.0, -56.0, 32.0, -67.0, -67.0, -78.0, -12.0, 10.0, 21.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19748144652850144, "mean_inference_ms": 9.991763514364969, "mean_action_processing_ms": 0.08699154827751848, "mean_env_wait_ms": 0.04295291015965314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004604339599609375, "StateBufferConnector_ms": 0.0027658939361572266, "ViewRequirementAgentConnector_ms": 0.08453583717346191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 72586.552, "sample_time_ms": 39733.872, "learn_time_ms": 32844.597, "learn_throughput": 121.786, "synch_weights_time_ms": 7.252}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 4473, "training_iteration": 85, "trial_id": "38794_00001", "date": "2023-06-01_22-22-48", "timestamp": 1685647368, "time_this_iter_s": 80.8489818572998, "time_total_s": 7041.220364332199, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7041.220364332199, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 48.175892857142856, "ram_util_percent": 68.13571428571429}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -37.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -67.0, -67.0, -1.0, 76.0, 54.0, -89.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18641124351873706, "mean_inference_ms": 9.945283490768384, "mean_action_processing_ms": 0.08511031498912425, "mean_env_wait_ms": 0.04218407136566904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118846893310547, "StateBufferConnector_ms": 0.0029397010803222656, "ViewRequirementAgentConnector_ms": 0.08436203002929688}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.396983917434369e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 6.505452632904053, "policy_loss": -0.0006510911043733358, "vf_loss": 6.506103515625, "vf_explained_var": 1.4274070281317108e-07, "kl": 0.0005595622351393104, "entropy": 0.11558489501476288, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -24.32, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -23.0, 76.0, -23.0, -67.0, -67.0, 76.0, -89.0, -12.0, 76.0, 76.0, -45.0, 43.0, 10.0, 76.0, -67.0, 10.0, -56.0, -67.0, -89.0, -67.0, -78.0, -78.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, 76.0, -67.0, -89.0, -78.0, -56.0, 32.0, -67.0, -67.0, -78.0, -12.0, 10.0, 21.0, -67.0, -67.0, -100.0, -67.0, -67.0, -1.0, 76.0, 32.0, 76.0, -67.0, -67.0, 32.0, -89.0, 32.0, 76.0, 76.0, -12.0, -56.0, -133.0, -78.0, -67.0, -67.0, -34.0, -56.0, -89.0, -56.0, -100.0, -67.0, -67.0, -1.0, 43.0, -1.0, -1.0, -56.0, -56.0, 76.0, -78.0, 76.0, 76.0, 32.0, 76.0, -122.0, -67.0, -78.0, 43.0, -67.0, 54.0, 54.0, -56.0, 43.0, 65.0, 76.0, 76.0, 43.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19739052949188504, "mean_inference_ms": 9.986511073515757, "mean_action_processing_ms": 0.08694334878249695, "mean_env_wait_ms": 0.042927257402769904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004576444625854492, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.08568716049194336}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -24.32, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -23.0, 76.0, -23.0, -67.0, -67.0, 76.0, -89.0, -12.0, 76.0, 76.0, -45.0, 43.0, 10.0, 76.0, -67.0, 10.0, -56.0, -67.0, -89.0, -67.0, -78.0, -78.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, 76.0, -67.0, -89.0, -78.0, -56.0, 32.0, -67.0, -67.0, -78.0, -12.0, 10.0, 21.0, -67.0, -67.0, -100.0, -67.0, -67.0, -1.0, 76.0, 32.0, 76.0, -67.0, -67.0, 32.0, -89.0, 32.0, 76.0, 76.0, -12.0, -56.0, -133.0, -78.0, -67.0, -67.0, -34.0, -56.0, -89.0, -56.0, -100.0, -67.0, -67.0, -1.0, 43.0, -1.0, -1.0, -56.0, -56.0, 76.0, -78.0, 76.0, 76.0, 32.0, 76.0, -122.0, -67.0, -78.0, 43.0, -67.0, 54.0, 54.0, -56.0, 43.0, 65.0, 76.0, 76.0, 43.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19739052949188504, "mean_inference_ms": 9.986511073515757, "mean_action_processing_ms": 0.08694334878249695, "mean_env_wait_ms": 0.042927257402769904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004576444625854492, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.08568716049194336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 72458.866, "sample_time_ms": 39665.543, "learn_time_ms": 32785.226, "learn_throughput": 122.006, "synch_weights_time_ms": 7.262}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 4526, "training_iteration": 86, "trial_id": "38794_00001", "date": "2023-06-01_22-24-08", "timestamp": 1685647448, "time_this_iter_s": 79.58973813056946, "time_total_s": 7120.810102462769, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7120.810102462769, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 46.783035714285724, "ram_util_percent": 68.41964285714286}}
{"evaluation": {"episode_reward_max": -12.0, "episode_reward_min": -89.0, "episode_reward_mean": -63.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -78.0, -56.0, -67.0, -67.0, -67.0, -12.0, -89.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.186412683230408, "mean_inference_ms": 9.948225228767466, "mean_action_processing_ms": 0.08513030302585686, "mean_env_wait_ms": 0.04218408599565975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004787445068359375, "StateBufferConnector_ms": 0.002911090850830078, "ViewRequirementAgentConnector_ms": 0.08585214614868164}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.984919587171845e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 7.496947765350342, "policy_loss": -0.002467572456225753, "vf_loss": 7.499414920806885, "vf_explained_var": -2.4835269396561444e-09, "kl": 0.00033704761881381273, "entropy": 0.10621175915002823, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -22.78, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 76.0, -67.0, -67.0, 32.0, -89.0, 32.0, 76.0, 76.0, -12.0, -56.0, -133.0, -78.0, -67.0, -67.0, -34.0, -56.0, -89.0, -56.0, -100.0, -67.0, -67.0, -1.0, 43.0, -1.0, -1.0, -56.0, -56.0, 76.0, -78.0, 76.0, 76.0, 32.0, 76.0, -122.0, -67.0, -78.0, 43.0, -67.0, 54.0, 54.0, -56.0, 43.0, 65.0, 76.0, 76.0, 43.0, -89.0, -67.0, -67.0, -67.0, -67.0, -89.0, -67.0, -89.0, -100.0, -34.0, 76.0, -56.0, 76.0, 76.0, 43.0, -78.0, -67.0, -89.0, -78.0, -67.0, -34.0, -67.0, -78.0, -78.0, -56.0, -89.0, -89.0, 32.0, 76.0, -78.0, -89.0, -67.0, -67.0, -12.0, -45.0, 76.0, 54.0, 76.0, 76.0, 76.0, -67.0, -1.0, -56.0, -56.0, -78.0, -67.0, -12.0, 10.0, -67.0, -67.0, -67.0, -12.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19730851454370105, "mean_inference_ms": 9.98180050697934, "mean_action_processing_ms": 0.0869018472989087, "mean_env_wait_ms": 0.04290284044527672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004677295684814453, "StateBufferConnector_ms": 0.0028142929077148438, "ViewRequirementAgentConnector_ms": 0.08575677871704102}}, "episode_reward_max": 76.0, "episode_reward_min": -133.0, "episode_reward_mean": -22.78, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 76.0, -67.0, -67.0, 32.0, -89.0, 32.0, 76.0, 76.0, -12.0, -56.0, -133.0, -78.0, -67.0, -67.0, -34.0, -56.0, -89.0, -56.0, -100.0, -67.0, -67.0, -1.0, 43.0, -1.0, -1.0, -56.0, -56.0, 76.0, -78.0, 76.0, 76.0, 32.0, 76.0, -122.0, -67.0, -78.0, 43.0, -67.0, 54.0, 54.0, -56.0, 43.0, 65.0, 76.0, 76.0, 43.0, -89.0, -67.0, -67.0, -67.0, -67.0, -89.0, -67.0, -89.0, -100.0, -34.0, 76.0, -56.0, 76.0, 76.0, 43.0, -78.0, -67.0, -89.0, -78.0, -67.0, -34.0, -67.0, -78.0, -78.0, -56.0, -89.0, -89.0, 32.0, 76.0, -78.0, -89.0, -67.0, -67.0, -12.0, -45.0, 76.0, 54.0, 76.0, 76.0, 76.0, -67.0, -1.0, -56.0, -56.0, -78.0, -67.0, -12.0, 10.0, -67.0, -67.0, -67.0, -12.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19730851454370105, "mean_inference_ms": 9.98180050697934, "mean_action_processing_ms": 0.0869018472989087, "mean_env_wait_ms": 0.04290284044527672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004677295684814453, "StateBufferConnector_ms": 0.0028142929077148438, "ViewRequirementAgentConnector_ms": 0.08575677871704102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 72468.365, "sample_time_ms": 39578.504, "learn_time_ms": 32881.786, "learn_throughput": 121.648, "synch_weights_time_ms": 7.224}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 4578, "training_iteration": 87, "trial_id": "38794_00001", "date": "2023-06-01_22-25-29", "timestamp": 1685647529, "time_this_iter_s": 81.65822100639343, "time_total_s": 7202.468323469162, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7202.468323469162, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 48.21150442477875, "ram_util_percent": 68.39292035398229}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": -7.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 21.0, -67.0, -67.0, -67.0, -67.0, 10.0, 76.0, 76.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18635911716659614, "mean_inference_ms": 9.94573489531784, "mean_action_processing_ms": 0.08512621987791245, "mean_env_wait_ms": 0.04217697778719663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005218982696533203, "StateBufferConnector_ms": 0.0030374526977539062, "ViewRequirementAgentConnector_ms": 0.08686542510986328}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.4924597935859225e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 7.908369541168213, "policy_loss": -0.0006347783491946757, "vf_loss": 7.909004211425781, "vf_explained_var": -6.643434247166624e-09, "kl": 0.00015052432718221098, "entropy": 0.09859093278646469, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -29.71, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -89.0, -100.0, -34.0, 76.0, -56.0, 76.0, 76.0, 43.0, -78.0, -67.0, -89.0, -78.0, -67.0, -34.0, -67.0, -78.0, -78.0, -56.0, -89.0, -89.0, 32.0, 76.0, -78.0, -89.0, -67.0, -67.0, -12.0, -45.0, 76.0, 54.0, 76.0, 76.0, 76.0, -67.0, -1.0, -56.0, -56.0, -78.0, -67.0, -12.0, 10.0, -67.0, -67.0, -67.0, -12.0, 76.0, 76.0, 76.0, 10.0, -78.0, -67.0, -1.0, 65.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, 21.0, 76.0, 76.0, -12.0, 76.0, 65.0, -67.0, -89.0, -67.0, -67.0, -89.0, -89.0, -1.0, -56.0, -78.0, -67.0, -67.0, -67.0, 10.0, -56.0, -67.0, -89.0, -78.0, -78.0, -45.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19722198925859147, "mean_inference_ms": 9.976979289774341, "mean_action_processing_ms": 0.08686004855049051, "mean_env_wait_ms": 0.04287735001929006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004792213439941406, "StateBufferConnector_ms": 0.002888917922973633, "ViewRequirementAgentConnector_ms": 0.08648037910461426}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -29.71, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -89.0, -100.0, -34.0, 76.0, -56.0, 76.0, 76.0, 43.0, -78.0, -67.0, -89.0, -78.0, -67.0, -34.0, -67.0, -78.0, -78.0, -56.0, -89.0, -89.0, 32.0, 76.0, -78.0, -89.0, -67.0, -67.0, -12.0, -45.0, 76.0, 54.0, 76.0, 76.0, 76.0, -67.0, -1.0, -56.0, -56.0, -78.0, -67.0, -12.0, 10.0, -67.0, -67.0, -67.0, -12.0, 76.0, 76.0, 76.0, 10.0, -78.0, -67.0, -1.0, 65.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, 21.0, 76.0, 76.0, -12.0, 76.0, 65.0, -67.0, -89.0, -67.0, -67.0, -89.0, -89.0, -1.0, -56.0, -78.0, -67.0, -67.0, -67.0, 10.0, -56.0, -67.0, -89.0, -78.0, -78.0, -45.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19722198925859147, "mean_inference_ms": 9.976979289774341, "mean_action_processing_ms": 0.08686004855049051, "mean_env_wait_ms": 0.04287735001929006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004792213439941406, "StateBufferConnector_ms": 0.002888917922973633, "ViewRequirementAgentConnector_ms": 0.08648037910461426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 72482.12, "sample_time_ms": 39580.519, "learn_time_ms": 32893.567, "learn_throughput": 121.604, "synch_weights_time_ms": 7.173}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 4631, "training_iteration": 88, "trial_id": "38794_00001", "date": "2023-06-01_22-26-49", "timestamp": 1685647609, "time_this_iter_s": 79.82296419143677, "time_total_s": 7282.291287660599, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7282.291287660599, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 47.95178571428572, "ram_util_percent": 67.26607142857144}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -25.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, 76.0, -89.0, -67.0, -67.0, -67.0, -89.0, -89.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1864114156418398, "mean_inference_ms": 9.945700486226126, "mean_action_processing_ms": 0.08514229849242397, "mean_env_wait_ms": 0.04218864359143438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005145072937011719, "StateBufferConnector_ms": 0.003306865692138672, "ViewRequirementAgentConnector_ms": 0.09140253067016602}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7462298967929613e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 9.523453712463379, "policy_loss": -0.0007213575881905854, "vf_loss": 9.524173736572266, "vf_explained_var": 0.00019303281442262232, "kl": 0.0004987554275430739, "entropy": 0.06360387057065964, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -50.94, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, 21.0, 76.0, 76.0, -12.0, 76.0, 65.0, -67.0, -89.0, -67.0, -67.0, -89.0, -89.0, -1.0, -56.0, -78.0, -67.0, -67.0, -67.0, 10.0, -56.0, -67.0, -89.0, -78.0, -78.0, -45.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -67.0, 43.0, -56.0, -111.0, -67.0, -56.0, -67.0, -67.0, -67.0, -67.0, -89.0, -89.0, -67.0, -56.0, -67.0, -67.0, -89.0, 21.0, 54.0, -67.0, -67.0, -67.0, -67.0, -100.0, -67.0, -67.0, -67.0, -89.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -89.0, -23.0, -78.0, -89.0, -67.0, 10.0, -67.0, -89.0, -111.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19712091416902366, "mean_inference_ms": 9.97078803170331, "mean_action_processing_ms": 0.08680695158660551, "mean_env_wait_ms": 0.042844351202534374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004541635513305664, "StateBufferConnector_ms": 0.0029642581939697266, "ViewRequirementAgentConnector_ms": 0.08500933647155762}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -50.94, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, 21.0, 76.0, 76.0, -12.0, 76.0, 65.0, -67.0, -89.0, -67.0, -67.0, -89.0, -89.0, -1.0, -56.0, -78.0, -67.0, -67.0, -67.0, 10.0, -56.0, -67.0, -89.0, -78.0, -78.0, -45.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -67.0, 43.0, -56.0, -111.0, -67.0, -56.0, -67.0, -67.0, -67.0, -67.0, -89.0, -89.0, -67.0, -56.0, -67.0, -67.0, -89.0, 21.0, 54.0, -67.0, -67.0, -67.0, -67.0, -100.0, -67.0, -67.0, -67.0, -89.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -89.0, -23.0, -78.0, -89.0, -67.0, 10.0, -67.0, -89.0, -111.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19712091416902366, "mean_inference_ms": 9.97078803170331, "mean_action_processing_ms": 0.08680695158660551, "mean_env_wait_ms": 0.042844351202534374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004541635513305664, "StateBufferConnector_ms": 0.0029642581939697266, "ViewRequirementAgentConnector_ms": 0.08500933647155762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 72426.569, "sample_time_ms": 39511.795, "learn_time_ms": 32906.793, "learn_throughput": 121.555, "synch_weights_time_ms": 7.117}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 4684, "training_iteration": 89, "trial_id": "38794_00001", "date": "2023-06-01_22-28-08", "timestamp": 1685647688, "time_this_iter_s": 79.13968896865845, "time_total_s": 7361.430976629257, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7361.430976629257, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 45.81636363636363, "ram_util_percent": 66.60909090909091}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": -42.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 21.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.186305598828115, "mean_inference_ms": 9.93981236395516, "mean_action_processing_ms": 0.08508860058443664, "mean_env_wait_ms": 0.042148571321416015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005023479461669922, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.08130311965942383}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.731149483964806e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 8.885567665100098, "policy_loss": -0.0005862580146640539, "vf_loss": 8.886153221130371, "vf_explained_var": -0.0003311544714961201, "kl": 0.00014549351180903614, "entropy": 0.05813087150454521, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -58.64, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, -89.0, -89.0, -67.0, -56.0, -67.0, -67.0, -89.0, 21.0, 54.0, -67.0, -67.0, -67.0, -67.0, -100.0, -67.0, -67.0, -67.0, -89.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -89.0, -23.0, -78.0, -89.0, -67.0, 10.0, -67.0, -89.0, -111.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -89.0, -12.0, -67.0, -67.0, -100.0, -67.0, -67.0, -56.0, -67.0, 10.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -100.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -12.0, 10.0, -67.0, 21.0, -56.0, -1.0, -56.0, -67.0, -100.0, 10.0, -56.0, -67.0, 21.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -100.0, -89.0, -67.0, -12.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19706893734201408, "mean_inference_ms": 9.96670302309657, "mean_action_processing_ms": 0.08677551855424354, "mean_env_wait_ms": 0.042826098365401195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004584789276123047, "StateBufferConnector_ms": 0.0028650760650634766, "ViewRequirementAgentConnector_ms": 0.08662080764770508}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -58.64, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, -89.0, -89.0, -67.0, -56.0, -67.0, -67.0, -89.0, 21.0, 54.0, -67.0, -67.0, -67.0, -67.0, -100.0, -67.0, -67.0, -67.0, -89.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -89.0, -23.0, -78.0, -89.0, -67.0, 10.0, -67.0, -89.0, -111.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -89.0, -12.0, -67.0, -67.0, -100.0, -67.0, -67.0, -56.0, -67.0, 10.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -100.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -12.0, 10.0, -67.0, 21.0, -56.0, -1.0, -56.0, -67.0, -100.0, 10.0, -56.0, -67.0, 21.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -100.0, -89.0, -67.0, -12.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19706893734201408, "mean_inference_ms": 9.96670302309657, "mean_action_processing_ms": 0.08677551855424354, "mean_env_wait_ms": 0.042826098365401195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004584789276123047, "StateBufferConnector_ms": 0.0028650760650634766, "ViewRequirementAgentConnector_ms": 0.08662080764770508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 72427.892, "sample_time_ms": 39534.33, "learn_time_ms": 32885.668, "learn_throughput": 121.634, "synch_weights_time_ms": 7.026}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 4736, "training_iteration": 90, "trial_id": "38794_00001", "date": "2023-06-01_22-29-29", "timestamp": 1685647769, "time_this_iter_s": 80.8987488746643, "time_total_s": 7442.3297255039215, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7442.3297255039215, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 48.12035398230089, "ram_util_percent": 67.45929203539824}}
{"evaluation": {"episode_reward_max": -45.0, "episode_reward_min": -89.0, "episode_reward_mean": -68.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -45.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18622133665343663, "mean_inference_ms": 9.936421670504297, "mean_action_processing_ms": 0.08504621099480127, "mean_env_wait_ms": 0.04211489197744573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005161762237548828, "StateBufferConnector_ms": 0.003039836883544922, "ViewRequirementAgentConnector_ms": 0.08892059326171875}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.365574741982403e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 8.814861297607422, "policy_loss": -0.0019933185540139675, "vf_loss": 8.816853523254395, "vf_explained_var": -0.0001841861812863499, "kl": 0.0001547595311421901, "entropy": 0.0495021678507328, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -51.49, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -100.0, -67.0, -67.0, -56.0, -67.0, 10.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -100.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -12.0, 10.0, -67.0, 21.0, -56.0, -1.0, -56.0, -67.0, -100.0, 10.0, -56.0, -67.0, 21.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -100.0, -89.0, -67.0, -12.0, 65.0, -78.0, -78.0, -23.0, -67.0, -67.0, -67.0, 43.0, -67.0, -89.0, -67.0, -67.0, -67.0, -100.0, -67.0, -67.0, -100.0, -67.0, -67.0, -1.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 32.0, -67.0, -67.0, 54.0, -89.0, -67.0, -67.0, -78.0, -100.0, -1.0, 76.0, -45.0, -67.0, -67.0, -122.0, -78.0, -56.0, -67.0, -67.0, -1.0, -56.0, -67.0, -67.0, 32.0, -56.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19700502723915364, "mean_inference_ms": 9.961976896711041, "mean_action_processing_ms": 0.08674069607515919, "mean_env_wait_ms": 0.04280559712359427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047283172607421875, "StateBufferConnector_ms": 0.002872943878173828, "ViewRequirementAgentConnector_ms": 0.08660101890563965}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -51.49, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -100.0, -67.0, -67.0, -56.0, -67.0, 10.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -100.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -12.0, 10.0, -67.0, 21.0, -56.0, -1.0, -56.0, -67.0, -100.0, 10.0, -56.0, -67.0, 21.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -100.0, -89.0, -67.0, -12.0, 65.0, -78.0, -78.0, -23.0, -67.0, -67.0, -67.0, 43.0, -67.0, -89.0, -67.0, -67.0, -67.0, -100.0, -67.0, -67.0, -100.0, -67.0, -67.0, -1.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 32.0, -67.0, -67.0, 54.0, -89.0, -67.0, -67.0, -78.0, -100.0, -1.0, 76.0, -45.0, -67.0, -67.0, -122.0, -78.0, -56.0, -67.0, -67.0, -1.0, -56.0, -67.0, -67.0, 32.0, -56.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19700502723915364, "mean_inference_ms": 9.961976896711041, "mean_action_processing_ms": 0.08674069607515919, "mean_env_wait_ms": 0.04280559712359427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047283172607421875, "StateBufferConnector_ms": 0.002872943878173828, "ViewRequirementAgentConnector_ms": 0.08660101890563965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 72400.269, "sample_time_ms": 39481.011, "learn_time_ms": 32911.312, "learn_throughput": 121.539, "synch_weights_time_ms": 7.084}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 4789, "training_iteration": 91, "trial_id": "38794_00001", "date": "2023-06-01_22-30-48", "timestamp": 1685647848, "time_this_iter_s": 78.54518818855286, "time_total_s": 7520.874913692474, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7520.874913692474, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 45.0697247706422, "ram_util_percent": 67.22293577981651}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -25.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -89.0, 10.0, -67.0, -67.0, 21.0, 76.0, -78.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18620680614265267, "mean_inference_ms": 9.934981278711252, "mean_action_processing_ms": 0.08503133274304835, "mean_env_wait_ms": 0.04210546918558506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005409717559814453, "StateBufferConnector_ms": 0.0031304359436035156, "ViewRequirementAgentConnector_ms": 0.08700370788574219}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.1827873709912016e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 9.411232948303223, "policy_loss": 0.00043440412264317274, "vf_loss": 9.410798072814941, "vf_explained_var": -1.1175871339474952e-09, "kl": 5.0273964006919414e-05, "entropy": 0.04386051744222641, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -54.35, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -67.0, -89.0, -67.0, -67.0, -67.0, -100.0, -67.0, -67.0, -100.0, -67.0, -67.0, -1.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 32.0, -67.0, -67.0, 54.0, -89.0, -67.0, -67.0, -78.0, -100.0, -1.0, 76.0, -45.0, -67.0, -67.0, -122.0, -78.0, -56.0, -67.0, -67.0, -1.0, -56.0, -67.0, -67.0, 32.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -34.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 21.0, 76.0, -67.0, 32.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19689151375691322, "mean_inference_ms": 9.954687455159494, "mean_action_processing_ms": 0.08668197349784602, "mean_env_wait_ms": 0.04276590599435792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046176910400390625, "StateBufferConnector_ms": 0.0027794837951660156, "ViewRequirementAgentConnector_ms": 0.08358883857727051}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -54.35, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, -67.0, -89.0, -67.0, -67.0, -67.0, -100.0, -67.0, -67.0, -100.0, -67.0, -67.0, -1.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 32.0, -67.0, -67.0, 54.0, -89.0, -67.0, -67.0, -78.0, -100.0, -1.0, 76.0, -45.0, -67.0, -67.0, -122.0, -78.0, -56.0, -67.0, -67.0, -1.0, -56.0, -67.0, -67.0, 32.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -34.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 21.0, 76.0, -67.0, 32.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19689151375691322, "mean_inference_ms": 9.954687455159494, "mean_action_processing_ms": 0.08668197349784602, "mean_env_wait_ms": 0.04276590599435792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046176910400390625, "StateBufferConnector_ms": 0.0027794837951660156, "ViewRequirementAgentConnector_ms": 0.08358883857727051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 72341.537, "sample_time_ms": 39405.115, "learn_time_ms": 32928.432, "learn_throughput": 121.476, "synch_weights_time_ms": 7.124}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 4842, "training_iteration": 92, "trial_id": "38794_00001", "date": "2023-06-01_22-32-07", "timestamp": 1685647927, "time_this_iter_s": 78.92839694023132, "time_total_s": 7599.803310632706, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7599.803310632706, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 44.51818181818181, "ram_util_percent": 67.71454545454544}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -48.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -78.0, -67.0, -67.0, -67.0, -67.0, 10.0, 76.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18610154305179566, "mean_inference_ms": 9.928603202728182, "mean_action_processing_ms": 0.08498082327111747, "mean_env_wait_ms": 0.04207308551684004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004982948303222656, "StateBufferConnector_ms": 0.002834796905517578, "ViewRequirementAgentConnector_ms": 0.08069515228271484}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0913936854956008e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 9.36642074584961, "policy_loss": -0.0005725612281821668, "vf_loss": 9.366991996765137, "vf_explained_var": -2.5456150520852816e-09, "kl": 9.789771138457581e-05, "entropy": 0.04929699748754501, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -57.43, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -34.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 21.0, 76.0, -67.0, 32.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, 54.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 21.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -12.0, -23.0, -67.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -67.0, -67.0, -89.0, 32.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1968005814294864, "mean_inference_ms": 9.949614391306191, "mean_action_processing_ms": 0.08663922038871961, "mean_env_wait_ms": 0.042736504736016145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004620552062988281, "StateBufferConnector_ms": 0.0027456283569335938, "ViewRequirementAgentConnector_ms": 0.08406400680541992}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -57.43, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -34.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 21.0, 76.0, -67.0, 32.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -1.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, 54.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 21.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -12.0, -23.0, -67.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -67.0, -67.0, -89.0, 32.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1968005814294864, "mean_inference_ms": 9.949614391306191, "mean_action_processing_ms": 0.08663922038871961, "mean_env_wait_ms": 0.042736504736016145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004620552062988281, "StateBufferConnector_ms": 0.0027456283569335938, "ViewRequirementAgentConnector_ms": 0.08406400680541992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 72279.676, "sample_time_ms": 39362.033, "learn_time_ms": 32909.761, "learn_throughput": 121.544, "synch_weights_time_ms": 7.023}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 4894, "training_iteration": 93, "trial_id": "38794_00001", "date": "2023-06-01_22-33-26", "timestamp": 1685648006, "time_this_iter_s": 79.63917899131775, "time_total_s": 7679.442489624023, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7679.442489624023, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 45.76126126126126, "ram_util_percent": 69.43693693693695}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -67.0, "episode_reward_mean": -48.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, 32.0, -56.0, -67.0, -67.0, -34.0, -56.0, -45.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1860606263398413, "mean_inference_ms": 9.926073889010777, "mean_action_processing_ms": 0.08497240028056163, "mean_env_wait_ms": 0.042057272965442725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004773139953613281, "StateBufferConnector_ms": 0.0032401084899902344, "ViewRequirementAgentConnector_ms": 0.08970022201538086}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.456968427478004e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 7.987673759460449, "policy_loss": 4.212176281725988e-05, "vf_loss": 7.9876322746276855, "vf_explained_var": -0.0006529931561090052, "kl": 4.494606037042104e-05, "entropy": 0.05238478258252144, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -47.09, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, -67.0, 21.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -12.0, -23.0, -67.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -67.0, -67.0, -89.0, 32.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -89.0, -67.0, -67.0, -67.0, 43.0, 76.0, 76.0, -23.0, -56.0, 21.0, 76.0, 76.0, -67.0, -67.0, -67.0, -89.0, 43.0, -56.0, 76.0, 43.0, -67.0, -34.0, -78.0, -67.0, -67.0, -1.0, -45.0, 76.0, -89.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, 32.0, -67.0, -67.0, -111.0, -67.0, 76.0, -89.0, -67.0, -67.0, -89.0, -67.0, -56.0, -67.0, -67.0, 43.0, -78.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1967181361064013, "mean_inference_ms": 9.945470762141683, "mean_action_processing_ms": 0.0866015177112812, "mean_env_wait_ms": 0.042712109960520606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004673957824707031, "StateBufferConnector_ms": 0.002773284912109375, "ViewRequirementAgentConnector_ms": 0.08486318588256836}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -47.09, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, -67.0, 21.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -12.0, -23.0, -67.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -67.0, -67.0, -67.0, -67.0, -67.0, -45.0, -67.0, -67.0, -89.0, 32.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -89.0, -67.0, -67.0, -67.0, 43.0, 76.0, 76.0, -23.0, -56.0, 21.0, 76.0, 76.0, -67.0, -67.0, -67.0, -89.0, 43.0, -56.0, 76.0, 43.0, -67.0, -34.0, -78.0, -67.0, -67.0, -1.0, -45.0, 76.0, -89.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, 32.0, -67.0, -67.0, -111.0, -67.0, 76.0, -89.0, -67.0, -67.0, -89.0, -67.0, -56.0, -67.0, -67.0, 43.0, -78.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1967181361064013, "mean_inference_ms": 9.945470762141683, "mean_action_processing_ms": 0.0866015177112812, "mean_env_wait_ms": 0.042712109960520606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004673957824707031, "StateBufferConnector_ms": 0.002773284912109375, "ViewRequirementAgentConnector_ms": 0.08486318588256836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 72157.925, "sample_time_ms": 39341.853, "learn_time_ms": 32808.233, "learn_throughput": 121.921, "synch_weights_time_ms": 6.971}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 4947, "training_iteration": 94, "trial_id": "38794_00001", "date": "2023-06-01_22-34-46", "timestamp": 1685648086, "time_this_iter_s": 79.41364884376526, "time_total_s": 7758.856138467789, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7758.856138467789, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 43.6972972972973, "ram_util_percent": 69.4855855855856}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": -41.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 76.0, -45.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18606342633155798, "mean_inference_ms": 9.926338037033378, "mean_action_processing_ms": 0.0849722812064171, "mean_env_wait_ms": 0.042047581975343584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004494190216064453, "StateBufferConnector_ms": 0.0029969215393066406, "ViewRequirementAgentConnector_ms": 0.08878946304321289}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.728484213739002e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 8.96436595916748, "policy_loss": -0.0005805694963783026, "vf_loss": 8.964946746826172, "vf_explained_var": -3.725290298461914e-09, "kl": 8.838532085064799e-05, "entropy": 0.05457155779004097, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -43.24, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 76.0, -23.0, -56.0, 21.0, 76.0, 76.0, -67.0, -67.0, -67.0, -89.0, 43.0, -56.0, 76.0, 43.0, -67.0, -34.0, -78.0, -67.0, -67.0, -1.0, -45.0, 76.0, -89.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, 32.0, -67.0, -67.0, -111.0, -67.0, 76.0, -89.0, -67.0, -67.0, -89.0, -67.0, -56.0, -67.0, -67.0, 43.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -12.0, 76.0, -67.0, -67.0, -1.0, -67.0, -67.0, -67.0, -67.0, -12.0, -45.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -122.0, -67.0, -45.0, 76.0, -67.0, -67.0, -78.0, -67.0, -56.0, -1.0, -67.0, -67.0, 43.0, -67.0, -78.0, -56.0, 76.0, -67.0, -67.0, -67.0, -89.0, -67.0, -89.0, -89.0, -78.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966136847469482, "mean_inference_ms": 9.940104500964697, "mean_action_processing_ms": 0.08654711479848316, "mean_env_wait_ms": 0.042677578829960566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004534006118774414, "StateBufferConnector_ms": 0.002672433853149414, "ViewRequirementAgentConnector_ms": 0.08319473266601562}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -43.24, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, 76.0, -23.0, -56.0, 21.0, 76.0, 76.0, -67.0, -67.0, -67.0, -89.0, 43.0, -56.0, 76.0, 43.0, -67.0, -34.0, -78.0, -67.0, -67.0, -1.0, -45.0, 76.0, -89.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, 32.0, -67.0, -67.0, -111.0, -67.0, 76.0, -89.0, -67.0, -67.0, -89.0, -67.0, -56.0, -67.0, -67.0, 43.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -12.0, 76.0, -67.0, -67.0, -1.0, -67.0, -67.0, -67.0, -67.0, -12.0, -45.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -122.0, -67.0, -45.0, 76.0, -67.0, -67.0, -78.0, -67.0, -56.0, -1.0, -67.0, -67.0, 43.0, -67.0, -78.0, -56.0, 76.0, -67.0, -67.0, -67.0, -89.0, -67.0, -89.0, -89.0, -78.0, -67.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966136847469482, "mean_inference_ms": 9.940104500964697, "mean_action_processing_ms": 0.08654711479848316, "mean_env_wait_ms": 0.042677578829960566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004534006118774414, "StateBufferConnector_ms": 0.002672433853149414, "ViewRequirementAgentConnector_ms": 0.08319473266601562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 71999.734, "sample_time_ms": 39270.023, "learn_time_ms": 32722.21, "learn_throughput": 122.241, "synch_weights_time_ms": 6.634}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 5000, "training_iteration": 95, "trial_id": "38794_00001", "date": "2023-06-01_22-36-05", "timestamp": 1685648165, "time_this_iter_s": 79.21121883392334, "time_total_s": 7838.067357301712, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7838.067357301712, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 45.31818181818182, "ram_util_percent": 67.27181818181818}}
{"evaluation": {"episode_reward_max": 21.0, "episode_reward_min": -89.0, "episode_reward_mean": -58.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, 21.0, -78.0, -78.0, -89.0, -67.0, -23.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18595772431599028, "mean_inference_ms": 9.920919819379836, "mean_action_processing_ms": 0.08492722646380443, "mean_env_wait_ms": 0.042017558313733314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004942417144775391, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.08062362670898438}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.364242106869501e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 8.005111694335938, "policy_loss": 0.0005957845714874566, "vf_loss": 8.0045166015625, "vf_explained_var": 0.001924411510117352, "kl": 8.515406807418913e-05, "entropy": 0.06006760522723198, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -41.92, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, -67.0, -67.0, -1.0, -67.0, -67.0, -67.0, -67.0, -12.0, -45.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -122.0, -67.0, -45.0, 76.0, -67.0, -67.0, -78.0, -67.0, -56.0, -1.0, -67.0, -67.0, 43.0, -67.0, -78.0, -56.0, 76.0, -67.0, -67.0, -67.0, -89.0, -67.0, -89.0, -89.0, -78.0, -67.0, -67.0, -67.0, -67.0, -23.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, -67.0, -67.0, -67.0, -67.0, 54.0, 76.0, -67.0, -67.0, 43.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -89.0, 10.0, -67.0, -67.0, -67.0, -67.0, -1.0, 76.0, -12.0, -67.0, -67.0, -67.0, -67.0, 32.0, 76.0, -78.0, -67.0, -1.0, -56.0, -67.0, -67.0, -67.0, 32.0, -12.0, -56.0, 21.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19649985556519772, "mean_inference_ms": 9.934311983666884, "mean_action_processing_ms": 0.08648829735311837, "mean_env_wait_ms": 0.0426406042847066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426479339599609, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.08220219612121582}}, "episode_reward_max": 76.0, "episode_reward_min": -122.0, "episode_reward_mean": -41.92, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [76.0, -67.0, -67.0, -1.0, -67.0, -67.0, -67.0, -67.0, -12.0, -45.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -122.0, -67.0, -45.0, 76.0, -67.0, -67.0, -78.0, -67.0, -56.0, -1.0, -67.0, -67.0, 43.0, -67.0, -78.0, -56.0, 76.0, -67.0, -67.0, -67.0, -89.0, -67.0, -89.0, -89.0, -78.0, -67.0, -67.0, -67.0, -67.0, -23.0, -89.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, -67.0, -67.0, -67.0, -67.0, 54.0, 76.0, -67.0, -67.0, 43.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -89.0, 10.0, -67.0, -67.0, -67.0, -67.0, -1.0, 76.0, -12.0, -67.0, -67.0, -67.0, -67.0, 32.0, 76.0, -78.0, -67.0, -1.0, -56.0, -67.0, -67.0, -67.0, 32.0, -12.0, -56.0, 21.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19649985556519772, "mean_inference_ms": 9.934311983666884, "mean_action_processing_ms": 0.08648829735311837, "mean_env_wait_ms": 0.0426406042847066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426479339599609, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.08220219612121582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 71916.331, "sample_time_ms": 39202.577, "learn_time_ms": 32706.268, "learn_throughput": 122.301, "synch_weights_time_ms": 6.621}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 5052, "training_iteration": 96, "trial_id": "38794_00001", "date": "2023-06-01_22-37-23", "timestamp": 1685648243, "time_this_iter_s": 78.5183379650116, "time_total_s": 7916.585695266724, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7916.585695266724, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 44.95454545454545, "ram_util_percent": 67.56909090909092}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -40.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -89.0, -67.0, -89.0, -1.0, -56.0, 21.0, 76.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1859165997631381, "mean_inference_ms": 9.92064460748392, "mean_action_processing_ms": 0.08491731385650036, "mean_env_wait_ms": 0.04200367397099765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004789829254150391, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.0839686393737793}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.821210534347505e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 8.728142738342285, "policy_loss": -0.00019234833598602563, "vf_loss": 8.728334426879883, "vf_explained_var": -7.078051478259795e-09, "kl": 0.0001942394592333585, "entropy": 0.055544279515743256, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -40.71, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, -34.0, -67.0, -67.0, -67.0, -67.0, 54.0, 76.0, -67.0, -67.0, 43.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -89.0, 10.0, -67.0, -67.0, -67.0, -67.0, -1.0, 76.0, -12.0, -67.0, -67.0, -67.0, -67.0, 32.0, 76.0, -78.0, -67.0, -1.0, -56.0, -67.0, -67.0, -67.0, 32.0, -12.0, -56.0, 21.0, 65.0, -78.0, -67.0, -111.0, -12.0, -1.0, -67.0, -67.0, -78.0, -89.0, -67.0, -34.0, 76.0, -78.0, -67.0, -67.0, -12.0, -56.0, 76.0, -78.0, -67.0, -89.0, -89.0, -67.0, -100.0, -67.0, -67.0, 43.0, 21.0, -67.0, 21.0, -45.0, -1.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19641297091111107, "mean_inference_ms": 9.928908245029197, "mean_action_processing_ms": 0.0864406308392838, "mean_env_wait_ms": 0.042610792044657335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00450444221496582, "StateBufferConnector_ms": 0.002789020538330078, "ViewRequirementAgentConnector_ms": 0.08422970771789551}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": -40.71, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, -34.0, -67.0, -67.0, -67.0, -67.0, 54.0, 76.0, -67.0, -67.0, 43.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -89.0, 10.0, -67.0, -67.0, -67.0, -67.0, -1.0, 76.0, -12.0, -67.0, -67.0, -67.0, -67.0, 32.0, 76.0, -78.0, -67.0, -1.0, -56.0, -67.0, -67.0, -67.0, 32.0, -12.0, -56.0, 21.0, 65.0, -78.0, -67.0, -111.0, -12.0, -1.0, -67.0, -67.0, -78.0, -89.0, -67.0, -34.0, 76.0, -78.0, -67.0, -67.0, -12.0, -56.0, 76.0, -78.0, -67.0, -89.0, -89.0, -67.0, -100.0, -67.0, -67.0, 43.0, 21.0, -67.0, 21.0, -45.0, -1.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19641297091111107, "mean_inference_ms": 9.928908245029197, "mean_action_processing_ms": 0.0864406308392838, "mean_env_wait_ms": 0.042610792044657335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00450444221496582, "StateBufferConnector_ms": 0.002789020538330078, "ViewRequirementAgentConnector_ms": 0.08422970771789551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 71702.228, "sample_time_ms": 39140.636, "learn_time_ms": 32554.052, "learn_throughput": 122.873, "synch_weights_time_ms": 6.69}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 5105, "training_iteration": 97, "trial_id": "38794_00001", "date": "2023-06-01_22-38-43", "timestamp": 1685648323, "time_this_iter_s": 79.2747950553894, "time_total_s": 7995.860490322113, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7995.860490322113, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 44.91454545454545, "ram_util_percent": 68.42454545454545}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -43.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 76.0, -67.0, -89.0, -78.0, -45.0, -67.0, -67.0, -89.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1859637547879913, "mean_inference_ms": 9.924652804330405, "mean_action_processing_ms": 0.08496857424417824, "mean_env_wait_ms": 0.042016680237013895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005128383636474609, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.09296894073486328}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.4106052671737525e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 8.583709716796875, "policy_loss": -0.0008147734333761036, "vf_loss": 8.58452320098877, "vf_explained_var": -4.03573130469681e-09, "kl": 0.0002126245090039447, "entropy": 0.07299299538135529, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -45.99, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -78.0, -89.0, -67.0, -34.0, 76.0, -78.0, -67.0, -67.0, -12.0, -56.0, 76.0, -78.0, -67.0, -89.0, -89.0, -67.0, -100.0, -67.0, -67.0, 43.0, 21.0, -67.0, 21.0, -45.0, -1.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, 10.0, 54.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -56.0, -67.0, -12.0, 43.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -56.0, -67.0, -1.0, -56.0, -67.0, -78.0, 21.0, -56.0, -67.0, -67.0, -67.0, -34.0, -56.0, -67.0, -67.0, 32.0, -89.0, -67.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19635193451051347, "mean_inference_ms": 9.925542671948657, "mean_action_processing_ms": 0.08640782903352445, "mean_env_wait_ms": 0.04259047243267101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004542827606201172, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.08542513847351074}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -45.99, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -78.0, -89.0, -67.0, -34.0, 76.0, -78.0, -67.0, -67.0, -12.0, -56.0, 76.0, -78.0, -67.0, -89.0, -89.0, -67.0, -100.0, -67.0, -67.0, 43.0, 21.0, -67.0, 21.0, -45.0, -1.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, 76.0, -67.0, -67.0, -67.0, -67.0, -78.0, -67.0, -67.0, 10.0, 54.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -56.0, -67.0, -12.0, 43.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -56.0, -67.0, -1.0, -56.0, -67.0, -78.0, 21.0, -56.0, -67.0, -67.0, -67.0, -34.0, -56.0, -67.0, -67.0, 32.0, -89.0, -67.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19635193451051347, "mean_inference_ms": 9.925542671948657, "mean_action_processing_ms": 0.08640782903352445, "mean_env_wait_ms": 0.04259047243267101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004542827606201172, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.08542513847351074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 71934.213, "sample_time_ms": 39223.071, "learn_time_ms": 32703.743, "learn_throughput": 122.31, "synch_weights_time_ms": 6.581}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 5157, "training_iteration": 98, "trial_id": "38794_00001", "date": "2023-06-01_22-40-05", "timestamp": 1685648405, "time_this_iter_s": 82.59848117828369, "time_total_s": 8078.458971500397, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8078.458971500397, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 47.15391304347826, "ram_util_percent": 68.76173913043479}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -23.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -78.0, -45.0, 54.0, 10.0, 76.0, -89.0, -67.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18599053287038397, "mean_inference_ms": 9.927999266511403, "mean_action_processing_ms": 0.08499724536584, "mean_env_wait_ms": 0.04202827350388661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048160552978515625, "StateBufferConnector_ms": 0.0029778480529785156, "ViewRequirementAgentConnector_ms": 0.09049415588378906}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7053026335868762e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 7.952742099761963, "policy_loss": -0.0002984148741234094, "vf_loss": 7.953040599822998, "vf_explained_var": -6.022552678786042e-09, "kl": 0.00011667092621792108, "entropy": 0.06759107112884521, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -38.07, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -56.0, -67.0, -12.0, 43.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -56.0, -67.0, -1.0, -56.0, -67.0, -78.0, 21.0, -56.0, -67.0, -67.0, -67.0, -34.0, -56.0, -67.0, -67.0, 32.0, -89.0, -67.0, -56.0, -56.0, -67.0, -67.0, -67.0, -1.0, 76.0, -89.0, -67.0, -67.0, -67.0, 43.0, -67.0, -78.0, 43.0, 76.0, -89.0, -67.0, -1.0, 65.0, 65.0, -67.0, -67.0, 21.0, -56.0, -67.0, 43.0, 32.0, 21.0, 76.0, -67.0, -1.0, -78.0, -78.0, -67.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -67.0, -89.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196341721078163, "mean_inference_ms": 9.92591434174569, "mean_action_processing_ms": 0.08640487017633663, "mean_env_wait_ms": 0.04258725250785345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004899740219116211, "StateBufferConnector_ms": 0.00283050537109375, "ViewRequirementAgentConnector_ms": 0.08792996406555176}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": -38.07, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, 76.0, 76.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -56.0, -67.0, -12.0, 43.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -56.0, -67.0, -1.0, -56.0, -67.0, -78.0, 21.0, -56.0, -67.0, -67.0, -67.0, -34.0, -56.0, -67.0, -67.0, 32.0, -89.0, -67.0, -56.0, -56.0, -67.0, -67.0, -67.0, -1.0, 76.0, -89.0, -67.0, -67.0, -67.0, 43.0, -67.0, -78.0, 43.0, 76.0, -89.0, -67.0, -1.0, 65.0, 65.0, -67.0, -67.0, 21.0, -56.0, -67.0, 43.0, 32.0, 21.0, 76.0, -67.0, -1.0, -78.0, -78.0, -67.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -67.0, -89.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196341721078163, "mean_inference_ms": 9.92591434174569, "mean_action_processing_ms": 0.08640487017633663, "mean_env_wait_ms": 0.04258725250785345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004899740219116211, "StateBufferConnector_ms": 0.00283050537109375, "ViewRequirementAgentConnector_ms": 0.08792996406555176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 72383.535, "sample_time_ms": 39565.477, "learn_time_ms": 32810.643, "learn_throughput": 121.912, "synch_weights_time_ms": 6.591}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 5210, "training_iteration": 99, "trial_id": "38794_00001", "date": "2023-06-01_22-41-29", "timestamp": 1685648489, "time_this_iter_s": 83.87157702445984, "time_total_s": 8162.330548524857, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8162.330548524857, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 46.6991452991453, "ram_util_percent": 69.41025641025641}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": -32.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -67.0, -67.0, 10.0, 54.0, 76.0, -67.0, -67.0, -67.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18598821887489875, "mean_inference_ms": 9.929992806257236, "mean_action_processing_ms": 0.08499486981466431, "mean_env_wait_ms": 0.04203131232731776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053501129150390625, "StateBufferConnector_ms": 0.003039836883544922, "ViewRequirementAgentConnector_ms": 0.08947134017944336}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.526513167934381e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 9.522113800048828, "policy_loss": -0.0016884577926248312, "vf_loss": 9.523802757263184, "vf_explained_var": -0.0007253690273500979, "kl": 0.00019805465126410127, "entropy": 0.05587535724043846, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -49.95, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -67.0, -67.0, -67.0, 43.0, -67.0, -78.0, 43.0, 76.0, -89.0, -67.0, -1.0, 65.0, 65.0, -67.0, -67.0, 21.0, -56.0, -67.0, 43.0, 32.0, 21.0, 76.0, -67.0, -1.0, -78.0, -78.0, -67.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -67.0, -89.0, -67.0, -67.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -34.0, -78.0, 65.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, -67.0, -67.0, -67.0, -67.0, -1.0, 76.0, -100.0, -67.0, -78.0, -67.0, -100.0, -67.0, -67.0, -78.0, -67.0, -67.0, -78.0, -67.0, -67.0, -100.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -89.0, -67.0, -67.0, -56.0, -67.0, -67.0, -67.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19640776452840028, "mean_inference_ms": 9.930055202600952, "mean_action_processing_ms": 0.08643677145552069, "mean_env_wait_ms": 0.0426056270316673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005094766616821289, "StateBufferConnector_ms": 0.0029044151306152344, "ViewRequirementAgentConnector_ms": 0.09137344360351562}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": -49.95, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.0, -67.0, -67.0, -67.0, 43.0, -67.0, -78.0, 43.0, 76.0, -89.0, -67.0, -1.0, 65.0, 65.0, -67.0, -67.0, 21.0, -56.0, -67.0, 43.0, 32.0, 21.0, 76.0, -67.0, -1.0, -78.0, -78.0, -67.0, 76.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, -56.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, 43.0, -67.0, -89.0, -67.0, -67.0, -67.0, -89.0, -67.0, -67.0, -67.0, -67.0, -34.0, -78.0, 65.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -67.0, -34.0, -67.0, -67.0, -67.0, -67.0, -1.0, 76.0, -100.0, -67.0, -78.0, -67.0, -100.0, -67.0, -67.0, -78.0, -67.0, -67.0, -78.0, -67.0, -67.0, -100.0, -67.0, -67.0, -67.0, -67.0, -67.0, -78.0, -89.0, -67.0, -67.0, -56.0, -67.0, -67.0, -67.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19640776452840028, "mean_inference_ms": 9.930055202600952, "mean_action_processing_ms": 0.08643677145552069, "mean_env_wait_ms": 0.0426056270316673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005094766616821289, "StateBufferConnector_ms": 0.0029044151306152344, "ViewRequirementAgentConnector_ms": 0.09137344360351562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 72846.738, "sample_time_ms": 39830.431, "learn_time_ms": 33007.22, "learn_throughput": 121.186, "synch_weights_time_ms": 8.233}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "episodes_total": 5263, "training_iteration": 100, "trial_id": "38794_00001", "date": "2023-06-01_22-42-55", "timestamp": 1685648575, "time_this_iter_s": 86.0876030921936, "time_total_s": 8248.41815161705, "pid": 46032, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [16, 16], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x286c701f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8248.41815161705, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 49.336666666666666, "ram_util_percent": 69.66499999999999}}
