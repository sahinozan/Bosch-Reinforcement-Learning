{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -78.0, "episode_reward_mean": -9.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -67.0, 21.0, -1.0, -12.0, 43.0, -56.0, 32.0, 32.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2568986820015425, "mean_inference_ms": 24.583625730797742, "mean_action_processing_ms": 0.10929345771298302, "mean_env_wait_ms": 0.0505378462481906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006117820739746094, "StateBufferConnector_ms": 0.0062847137451171875, "ViewRequirementAgentConnector_ms": 0.12749671936035156}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 6.716867923736572, "policy_loss": -0.07558327168226242, "vf_loss": 6.788219451904297, "vf_explained_var": -0.07492318004369736, "kl": 0.021155087277293205, "entropy": 2.9445090293884277, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 510.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": -2.269230769230769, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -12.0, -23.0, -1.0, 54.0, -12.0, -12.0, -1.0, -34.0, 10.0, -12.0, -67.0, -1.0, 32.0, -56.0, 21.0, 10.0, -12.0, 76.0, 32.0, -1.0, -34.0, -67.0, -23.0, 43.0, 10.0, -23.0, -23.0, -34.0, -78.0, -78.0, 54.0, -1.0, -34.0, 43.0, 43.0, -1.0, -1.0, 21.0, 21.0, -23.0, 21.0, 21.0, 32.0, 54.0, 32.0, -34.0, 21.0, 21.0, -12.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27328489780783566, "mean_inference_ms": 24.030607958133153, "mean_action_processing_ms": 0.10352187143567505, "mean_env_wait_ms": 0.04633299501738945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006113602564885066, "StateBufferConnector_ms": 0.005962756963876577, "ViewRequirementAgentConnector_ms": 0.13517691538884088}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": -2.269230769230769, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.0, -12.0, -23.0, -1.0, 54.0, -12.0, -12.0, -1.0, -34.0, 10.0, -12.0, -67.0, -1.0, 32.0, -56.0, 21.0, 10.0, -12.0, 76.0, 32.0, -1.0, -34.0, -67.0, -23.0, 43.0, 10.0, -23.0, -23.0, -34.0, -78.0, -78.0, 54.0, -1.0, -34.0, 43.0, 43.0, -1.0, -1.0, 21.0, 21.0, -23.0, 21.0, 21.0, 32.0, 54.0, 32.0, -34.0, 21.0, 21.0, -12.0, -23.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27328489780783566, "mean_inference_ms": 24.030607958133153, "mean_action_processing_ms": 0.10352187143567505, "mean_env_wait_ms": 0.04633299501738945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006113602564885066, "StateBufferConnector_ms": 0.005962756963876577, "ViewRequirementAgentConnector_ms": 0.13517691538884088}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 180269.512, "sample_time_ms": 97898.304, "learn_time_ms": 82359.936, "learn_throughput": 48.567, "synch_weights_time_ms": 9.224}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 52, "training_iteration": 1, "trial_id": "b0a0c_00056", "date": "2023-05-31_22-56-44", "timestamp": 1685563004, "time_this_iter_s": 199.37362909317017, "time_total_s": 199.37362909317017, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 199.37362909317017, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.49820143884892, "ram_util_percent": 68.7525179856115}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -89.0, "episode_reward_mean": -8.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 32.0, -1.0, -1.0, -23.0, -89.0, -45.0, 21.0, 43.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25640640660072134, "mean_inference_ms": 24.964923375848876, "mean_action_processing_ms": 0.10882687364887986, "mean_env_wait_ms": 0.04895465457071057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005927085876464844, "StateBufferConnector_ms": 0.007908344268798828, "ViewRequirementAgentConnector_ms": 0.1374053955078125}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 5.7415947914123535, "policy_loss": -0.08892624825239182, "vf_loss": 5.821041107177734, "vf_explained_var": -0.07613053917884827, "kl": 0.03159882128238678, "entropy": 2.914907932281494, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1530.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 11.32, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, -1.0, -34.0, 10.0, -12.0, -67.0, -1.0, 32.0, -56.0, 21.0, 10.0, -12.0, 76.0, 32.0, -1.0, -34.0, -67.0, -23.0, 43.0, 10.0, -23.0, -23.0, -34.0, -78.0, -78.0, 54.0, -1.0, -34.0, 43.0, 43.0, -1.0, -1.0, 21.0, 21.0, -23.0, 21.0, 21.0, 32.0, 54.0, 32.0, -34.0, 21.0, 21.0, -12.0, -23.0, 10.0, -67.0, -34.0, -1.0, 43.0, 32.0, 32.0, 43.0, -1.0, 21.0, 21.0, 43.0, 43.0, 32.0, 10.0, 10.0, 32.0, -56.0, 10.0, 32.0, -1.0, 76.0, 54.0, -45.0, 10.0, 21.0, 10.0, 76.0, 76.0, 54.0, 54.0, 65.0, 76.0, 43.0, 10.0, 54.0, 43.0, 10.0, 10.0, 21.0, 43.0, -23.0, 21.0, 54.0, 10.0, -56.0, -12.0, -1.0, 32.0, 32.0, 54.0, 76.0, 65.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27422624287011677, "mean_inference_ms": 24.33590646662935, "mean_action_processing_ms": 0.10390506641657851, "mean_env_wait_ms": 0.04626676338422577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005921602249145508, "StateBufferConnector_ms": 0.00600743293762207, "ViewRequirementAgentConnector_ms": 0.13752245903015137}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 11.32, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, -1.0, -34.0, 10.0, -12.0, -67.0, -1.0, 32.0, -56.0, 21.0, 10.0, -12.0, 76.0, 32.0, -1.0, -34.0, -67.0, -23.0, 43.0, 10.0, -23.0, -23.0, -34.0, -78.0, -78.0, 54.0, -1.0, -34.0, 43.0, 43.0, -1.0, -1.0, 21.0, 21.0, -23.0, 21.0, 21.0, 32.0, 54.0, 32.0, -34.0, 21.0, 21.0, -12.0, -23.0, 10.0, -67.0, -34.0, -1.0, 43.0, 32.0, 32.0, 43.0, -1.0, 21.0, 21.0, 43.0, 43.0, 32.0, 10.0, 10.0, 32.0, -56.0, 10.0, 32.0, -1.0, 76.0, 54.0, -45.0, 10.0, 21.0, 10.0, 76.0, 76.0, 54.0, 54.0, 65.0, 76.0, 43.0, 10.0, 54.0, 43.0, 10.0, 10.0, 21.0, 43.0, -23.0, 21.0, 54.0, 10.0, -56.0, -12.0, -1.0, 32.0, 32.0, 54.0, 76.0, 65.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27422624287011677, "mean_inference_ms": 24.33590646662935, "mean_action_processing_ms": 0.10390506641657851, "mean_env_wait_ms": 0.04626676338422577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005921602249145508, "StateBufferConnector_ms": 0.00600743293762207, "ViewRequirementAgentConnector_ms": 0.13752245903015137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 183101.006, "sample_time_ms": 100202.082, "learn_time_ms": 82888.175, "learn_throughput": 48.258, "synch_weights_time_ms": 9.058}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 105, "training_iteration": 2, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-00-10", "timestamp": 1685563210, "time_this_iter_s": 205.58410787582397, "time_total_s": 404.95773696899414, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 404.95773696899414, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.211888111888115, "ram_util_percent": 70.0979020979021}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -1.0, "episode_reward_mean": 30.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 54.0, 10.0, 10.0, -1.0, 21.0, 65.0, 37.0, 32.0, 65.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524515141107074, "mean_inference_ms": 24.454269530427187, "mean_action_processing_ms": 0.10588188957405006, "mean_env_wait_ms": 0.04695591723798713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005486011505126953, "StateBufferConnector_ms": 0.0056171417236328125, "ViewRequirementAgentConnector_ms": 0.12689828872680664}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 9.999999747378752e-05, "total_loss": 6.562219619750977, "policy_loss": -0.041712310165166855, "vf_loss": 6.589771270751953, "vf_explained_var": -0.0996641293168068, "kl": 0.031466901302337646, "entropy": 2.8726680278778076, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2550.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 15.22, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 43.0, -1.0, 21.0, 21.0, 43.0, 43.0, 32.0, 10.0, 10.0, 32.0, -56.0, 10.0, 32.0, -1.0, 76.0, 54.0, -45.0, 10.0, 21.0, 10.0, 76.0, 76.0, 54.0, 54.0, 65.0, 76.0, 43.0, 10.0, 54.0, 43.0, 10.0, 10.0, 21.0, 43.0, -23.0, 21.0, 54.0, 10.0, -56.0, -12.0, -1.0, 32.0, 32.0, 54.0, 76.0, 65.0, -56.0, 10.0, -56.0, 21.0, -45.0, -67.0, 54.0, -12.0, -1.0, 10.0, -23.0, -34.0, 43.0, 32.0, 32.0, 32.0, 21.0, -34.0, 10.0, 65.0, 65.0, 65.0, 76.0, 21.0, 43.0, 21.0, -45.0, -23.0, -1.0, 10.0, -23.0, 4.0, -78.0, -34.0, 10.0, -56.0, 54.0, -56.0, 21.0, -1.0, -34.0, -1.0, 43.0, 21.0, 21.0, 32.0, 32.0, 76.0, -1.0, -34.0, -12.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2745870608668117, "mean_inference_ms": 24.59145951996667, "mean_action_processing_ms": 0.10403697850211387, "mean_env_wait_ms": 0.04606646833224939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058650970458984375, "StateBufferConnector_ms": 0.006067037582397461, "ViewRequirementAgentConnector_ms": 0.1394062042236328}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 15.22, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 43.0, -1.0, 21.0, 21.0, 43.0, 43.0, 32.0, 10.0, 10.0, 32.0, -56.0, 10.0, 32.0, -1.0, 76.0, 54.0, -45.0, 10.0, 21.0, 10.0, 76.0, 76.0, 54.0, 54.0, 65.0, 76.0, 43.0, 10.0, 54.0, 43.0, 10.0, 10.0, 21.0, 43.0, -23.0, 21.0, 54.0, 10.0, -56.0, -12.0, -1.0, 32.0, 32.0, 54.0, 76.0, 65.0, -56.0, 10.0, -56.0, 21.0, -45.0, -67.0, 54.0, -12.0, -1.0, 10.0, -23.0, -34.0, 43.0, 32.0, 32.0, 32.0, 21.0, -34.0, 10.0, 65.0, 65.0, 65.0, 76.0, 21.0, 43.0, 21.0, -45.0, -23.0, -1.0, 10.0, -23.0, 4.0, -78.0, -34.0, 10.0, -56.0, 54.0, -56.0, 21.0, -1.0, -34.0, -1.0, 43.0, 21.0, 21.0, 32.0, 32.0, 76.0, -1.0, -34.0, -12.0, 21.0, -1.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2745870608668117, "mean_inference_ms": 24.59145951996667, "mean_action_processing_ms": 0.10403697850211387, "mean_env_wait_ms": 0.04606646833224939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058650970458984375, "StateBufferConnector_ms": 0.006067037582397461, "ViewRequirementAgentConnector_ms": 0.1394062042236328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 182590.22, "sample_time_ms": 100074.797, "learn_time_ms": 82504.813, "learn_throughput": 48.482, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 157, "training_iteration": 3, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-03-30", "timestamp": 1685563410, "time_this_iter_s": 199.73609709739685, "time_total_s": 604.693834066391, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 604.693834066391, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.835379061371846, "ram_util_percent": 70.70541516245488}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -56.0, "episode_reward_mean": 3.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 43.0, 21.0, -56.0, 21.0, 10.0, 10.0, -1.0, -56.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517870326294628, "mean_inference_ms": 24.532925961088957, "mean_action_processing_ms": 0.10573640539237679, "mean_env_wait_ms": 0.04644544451537003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005192756652832031, "StateBufferConnector_ms": 0.006289482116699219, "ViewRequirementAgentConnector_ms": 0.13370752334594727}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 9.999999747378752e-05, "total_loss": 6.070742130279541, "policy_loss": -0.029178297147154808, "vf_loss": 6.0750346183776855, "vf_explained_var": -0.08515091240406036, "kl": 0.036867596209049225, "entropy": 2.8659133911132812, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3570.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 10.21, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, -12.0, -1.0, 10.0, -23.0, -34.0, 43.0, 32.0, 32.0, 32.0, 21.0, -34.0, 10.0, 65.0, 65.0, 65.0, 76.0, 21.0, 43.0, 21.0, -45.0, -23.0, -1.0, 10.0, -23.0, 4.0, -78.0, -34.0, 10.0, -56.0, 54.0, -56.0, 21.0, -1.0, -34.0, -1.0, 43.0, 21.0, 21.0, 32.0, 32.0, 76.0, -1.0, -34.0, -12.0, 21.0, -1.0, -34.0, -78.0, 10.0, 32.0, -12.0, 32.0, 43.0, -1.0, 32.0, -1.0, 10.0, 10.0, 10.0, 10.0, 21.0, 10.0, -1.0, -45.0, 10.0, -34.0, -12.0, 32.0, 54.0, -1.0, -1.0, -23.0, 21.0, 10.0, 21.0, -56.0, 26.0, 32.0, 43.0, 43.0, -1.0, -1.0, -56.0, 43.0, 43.0, 43.0, -23.0, 43.0, 76.0, 65.0, 21.0, 54.0, 43.0, 65.0, 32.0, -1.0, -34.0, -12.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2731379037225953, "mean_inference_ms": 24.502680434735712, "mean_action_processing_ms": 0.10345149073419967, "mean_env_wait_ms": 0.04579841185772194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005828857421875, "StateBufferConnector_ms": 0.0059697628021240234, "ViewRequirementAgentConnector_ms": 0.13686490058898926}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 10.21, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -12.0, -1.0, 10.0, -23.0, -34.0, 43.0, 32.0, 32.0, 32.0, 21.0, -34.0, 10.0, 65.0, 65.0, 65.0, 76.0, 21.0, 43.0, 21.0, -45.0, -23.0, -1.0, 10.0, -23.0, 4.0, -78.0, -34.0, 10.0, -56.0, 54.0, -56.0, 21.0, -1.0, -34.0, -1.0, 43.0, 21.0, 21.0, 32.0, 32.0, 76.0, -1.0, -34.0, -12.0, 21.0, -1.0, -34.0, -78.0, 10.0, 32.0, -12.0, 32.0, 43.0, -1.0, 32.0, -1.0, 10.0, 10.0, 10.0, 10.0, 21.0, 10.0, -1.0, -45.0, 10.0, -34.0, -12.0, 32.0, 54.0, -1.0, -1.0, -23.0, 21.0, 10.0, 21.0, -56.0, 26.0, 32.0, 43.0, 43.0, -1.0, -1.0, -56.0, 43.0, 43.0, 43.0, -23.0, 43.0, 76.0, 65.0, 21.0, 54.0, 43.0, 65.0, 32.0, -1.0, -34.0, -12.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2731379037225953, "mean_inference_ms": 24.502680434735712, "mean_action_processing_ms": 0.10345149073419967, "mean_env_wait_ms": 0.04579841185772194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005828857421875, "StateBufferConnector_ms": 0.0059697628021240234, "ViewRequirementAgentConnector_ms": 0.13686490058898926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 182514.642, "sample_time_ms": 99495.653, "learn_time_ms": 83007.607, "learn_throughput": 48.188, "synch_weights_time_ms": 9.889}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 210, "training_iteration": 4, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-06-51", "timestamp": 1685563611, "time_this_iter_s": 201.48576426506042, "time_total_s": 806.1795983314514, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 806.1795983314514, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.2875, "ram_util_percent": 68.23714285714286}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -1.0, "episode_reward_mean": 35.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 43.0, 65.0, 65.0, 10.0, 43.0, 10.0, 43.0, 43.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25014048091865343, "mean_inference_ms": 24.34968302294443, "mean_action_processing_ms": 0.10444458708327811, "mean_env_wait_ms": 0.04566408903527906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00438690185546875, "StateBufferConnector_ms": 0.005409717559814453, "ViewRequirementAgentConnector_ms": 0.12368440628051758}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0125000476837158, "cur_lr": 9.999999747378752e-05, "total_loss": 6.350487232208252, "policy_loss": -0.02184949815273285, "vf_loss": 6.340247631072998, "vf_explained_var": -0.08960752934217453, "kl": 0.03169295936822891, "entropy": 2.835092544555664, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4590.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 7.35, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, -1.0, 32.0, -1.0, 10.0, 10.0, 10.0, 10.0, 21.0, 10.0, -1.0, -45.0, 10.0, -34.0, -12.0, 32.0, 54.0, -1.0, -1.0, -23.0, 21.0, 10.0, 21.0, -56.0, 26.0, 32.0, 43.0, 43.0, -1.0, -1.0, -56.0, 43.0, 43.0, 43.0, -23.0, 43.0, 76.0, 65.0, 21.0, 54.0, 43.0, 65.0, 32.0, -1.0, -34.0, -12.0, -23.0, -1.0, -34.0, 43.0, 43.0, 43.0, -12.0, 43.0, 32.0, 43.0, -1.0, 21.0, -1.0, -45.0, -56.0, 43.0, -1.0, -34.0, -12.0, 43.0, 15.0, 76.0, 10.0, -1.0, -45.0, 21.0, -45.0, -23.0, 65.0, 32.0, -12.0, 43.0, 10.0, 10.0, -23.0, 10.0, 32.0, -12.0, -23.0, 21.0, -23.0, -34.0, 10.0, 10.0, -56.0, -56.0, -56.0, -1.0, -23.0, -45.0, -1.0, 21.0, 21.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2723876361528756, "mean_inference_ms": 24.498345220787705, "mean_action_processing_ms": 0.10318253784185488, "mean_env_wait_ms": 0.04573130584572537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005859851837158203, "StateBufferConnector_ms": 0.006048917770385742, "ViewRequirementAgentConnector_ms": 0.13697290420532227}}, "episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 7.35, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, -1.0, 32.0, -1.0, 10.0, 10.0, 10.0, 10.0, 21.0, 10.0, -1.0, -45.0, 10.0, -34.0, -12.0, 32.0, 54.0, -1.0, -1.0, -23.0, 21.0, 10.0, 21.0, -56.0, 26.0, 32.0, 43.0, 43.0, -1.0, -1.0, -56.0, 43.0, 43.0, 43.0, -23.0, 43.0, 76.0, 65.0, 21.0, 54.0, 43.0, 65.0, 32.0, -1.0, -34.0, -12.0, -23.0, -1.0, -34.0, 43.0, 43.0, 43.0, -12.0, 43.0, 32.0, 43.0, -1.0, 21.0, -1.0, -45.0, -56.0, 43.0, -1.0, -34.0, -12.0, 43.0, 15.0, 76.0, 10.0, -1.0, -45.0, 21.0, -45.0, -23.0, 65.0, 32.0, -12.0, 43.0, 10.0, 10.0, -23.0, 10.0, 32.0, -12.0, -23.0, 21.0, -23.0, -34.0, 10.0, 10.0, -56.0, -56.0, -56.0, -1.0, -23.0, -45.0, -1.0, 21.0, 21.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2723876361528756, "mean_inference_ms": 24.498345220787705, "mean_action_processing_ms": 0.10318253784185488, "mean_env_wait_ms": 0.04573130584572537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005859851837158203, "StateBufferConnector_ms": 0.006048917770385742, "ViewRequirementAgentConnector_ms": 0.13697290420532227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 182246.779, "sample_time_ms": 99964.689, "learn_time_ms": 82270.8, "learn_throughput": 48.62, "synch_weights_time_ms": 9.816}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 263, "training_iteration": 5, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-10-11", "timestamp": 1685563811, "time_this_iter_s": 199.48220491409302, "time_total_s": 1005.6618032455444, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1005.6618032455444, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.55036231884058, "ram_util_percent": 71.29456521739131}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -12.0, "episode_reward_mean": 15.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -12.0, 54.0, 10.0, -1.0, -12.0, 10.0, 21.0, 43.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24856984732940882, "mean_inference_ms": 24.12749633170147, "mean_action_processing_ms": 0.10345771996971284, "mean_env_wait_ms": 0.0450719842992313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004878044128417969, "StateBufferConnector_ms": 0.006206035614013672, "ViewRequirementAgentConnector_ms": 0.1264786720275879}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5187499523162842, "cur_lr": 9.999999747378752e-05, "total_loss": 5.369202613830566, "policy_loss": -0.035535942763090134, "vf_loss": 5.36683988571167, "vf_explained_var": 0.01860661990940571, "kl": 0.024953776970505714, "entropy": 2.81827974319458, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5610.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 12.08, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 43.0, 32.0, 43.0, -1.0, 21.0, -1.0, -45.0, -56.0, 43.0, -1.0, -34.0, -12.0, 43.0, 15.0, 76.0, 10.0, -1.0, -45.0, 21.0, -45.0, -23.0, 65.0, 32.0, -12.0, 43.0, 10.0, 10.0, -23.0, 10.0, 32.0, -12.0, -23.0, 21.0, -23.0, -34.0, 10.0, 10.0, -56.0, -56.0, -56.0, -1.0, -23.0, -45.0, -1.0, 21.0, 21.0, 10.0, 43.0, -12.0, -23.0, 32.0, -1.0, 15.0, 54.0, 32.0, 10.0, -23.0, 43.0, 32.0, 43.0, -12.0, 21.0, 32.0, 10.0, 32.0, -12.0, 10.0, 54.0, 65.0, -34.0, -1.0, 76.0, 43.0, 65.0, 32.0, 32.0, 43.0, 43.0, -34.0, -12.0, 43.0, 43.0, 54.0, 76.0, 54.0, 21.0, 32.0, 10.0, 54.0, 21.0, 21.0, 54.0, 54.0, -1.0, 21.0, 21.0, 21.0, -56.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2713391349215542, "mean_inference_ms": 24.422657428342564, "mean_action_processing_ms": 0.10278551021174336, "mean_env_wait_ms": 0.045574231767859755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056858062744140625, "StateBufferConnector_ms": 0.005877017974853516, "ViewRequirementAgentConnector_ms": 0.13370704650878906}}, "episode_reward_max": 76.0, "episode_reward_min": -56.0, "episode_reward_mean": 12.08, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, 43.0, 32.0, 43.0, -1.0, 21.0, -1.0, -45.0, -56.0, 43.0, -1.0, -34.0, -12.0, 43.0, 15.0, 76.0, 10.0, -1.0, -45.0, 21.0, -45.0, -23.0, 65.0, 32.0, -12.0, 43.0, 10.0, 10.0, -23.0, 10.0, 32.0, -12.0, -23.0, 21.0, -23.0, -34.0, 10.0, 10.0, -56.0, -56.0, -56.0, -1.0, -23.0, -45.0, -1.0, 21.0, 21.0, 10.0, 43.0, -12.0, -23.0, 32.0, -1.0, 15.0, 54.0, 32.0, 10.0, -23.0, 43.0, 32.0, 43.0, -12.0, 21.0, 32.0, 10.0, 32.0, -12.0, 10.0, 54.0, 65.0, -34.0, -1.0, 76.0, 43.0, 65.0, 32.0, 32.0, 43.0, 43.0, -34.0, -12.0, 43.0, 43.0, 54.0, 76.0, 54.0, 21.0, 32.0, 10.0, 54.0, 21.0, 21.0, 54.0, 54.0, -1.0, 21.0, 21.0, 21.0, -56.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2713391349215542, "mean_inference_ms": 24.422657428342564, "mean_action_processing_ms": 0.10278551021174336, "mean_env_wait_ms": 0.045574231767859755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056858062744140625, "StateBufferConnector_ms": 0.005877017974853516, "ViewRequirementAgentConnector_ms": 0.13370704650878906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 181433.925, "sample_time_ms": 98944.097, "learn_time_ms": 82478.414, "learn_throughput": 48.498, "synch_weights_time_ms": 9.949}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 315, "training_iteration": 6, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-13-26", "timestamp": 1685564006, "time_this_iter_s": 195.22206211090088, "time_total_s": 1200.8838653564453, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1200.8838653564453, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.88634686346863, "ram_util_percent": 72.92250922509226}}
{"evaluation": {"episode_reward_max": 76.0, "episode_reward_min": 10.0, "episode_reward_mean": 40.8, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 65.0, 54.0, 10.0, 21.0, 76.0, 54.0, 32.0, 32.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.250538810037442, "mean_inference_ms": 24.259218347854482, "mean_action_processing_ms": 0.10401358888508168, "mean_env_wait_ms": 0.04524365557559651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004999637603759766, "StateBufferConnector_ms": 0.007164478302001953, "ViewRequirementAgentConnector_ms": 0.1381683349609375}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 9.999999747378752e-05, "total_loss": 5.701354503631592, "policy_loss": -0.026014843955636024, "vf_loss": 5.669222354888916, "vf_explained_var": -0.049688681960105896, "kl": 0.025524187833070755, "entropy": 2.8348469734191895, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6630.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 18.96, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 54.0, 32.0, 10.0, -23.0, 43.0, 32.0, 43.0, -12.0, 21.0, 32.0, 10.0, 32.0, -12.0, 10.0, 54.0, 65.0, -34.0, -1.0, 76.0, 43.0, 65.0, 32.0, 32.0, 43.0, 43.0, -34.0, -12.0, 43.0, 43.0, 54.0, 76.0, 54.0, 21.0, 32.0, 10.0, 54.0, 21.0, 21.0, 54.0, 54.0, -1.0, 21.0, 21.0, 21.0, -56.0, -34.0, -1.0, 43.0, -34.0, 10.0, 32.0, 21.0, 21.0, -111.0, 10.0, -12.0, 21.0, 10.0, -1.0, -1.0, 43.0, -34.0, 10.0, 32.0, 32.0, -34.0, -1.0, -1.0, 65.0, -23.0, 43.0, 32.0, 65.0, 54.0, 65.0, -1.0, 43.0, -67.0, -23.0, 54.0, 43.0, -12.0, -67.0, -1.0, 43.0, -12.0, 10.0, -1.0, -34.0, 21.0, 54.0, 43.0, 32.0, 10.0, 65.0, 54.0, 65.0, 65.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2704446832262078, "mean_inference_ms": 24.294901091088278, "mean_action_processing_ms": 0.10253896195373718, "mean_env_wait_ms": 0.04545252002774145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058438777923583984, "StateBufferConnector_ms": 0.005902528762817383, "ViewRequirementAgentConnector_ms": 0.13425731658935547}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 18.96, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.0, 54.0, 32.0, 10.0, -23.0, 43.0, 32.0, 43.0, -12.0, 21.0, 32.0, 10.0, 32.0, -12.0, 10.0, 54.0, 65.0, -34.0, -1.0, 76.0, 43.0, 65.0, 32.0, 32.0, 43.0, 43.0, -34.0, -12.0, 43.0, 43.0, 54.0, 76.0, 54.0, 21.0, 32.0, 10.0, 54.0, 21.0, 21.0, 54.0, 54.0, -1.0, 21.0, 21.0, 21.0, -56.0, -34.0, -1.0, 43.0, -34.0, 10.0, 32.0, 21.0, 21.0, -111.0, 10.0, -12.0, 21.0, 10.0, -1.0, -1.0, 43.0, -34.0, 10.0, 32.0, 32.0, -34.0, -1.0, -1.0, 65.0, -23.0, 43.0, 32.0, 65.0, 54.0, 65.0, -1.0, 43.0, -67.0, -23.0, 54.0, 43.0, -12.0, -67.0, -1.0, 43.0, -12.0, 10.0, -1.0, -34.0, 21.0, 54.0, 43.0, 32.0, 10.0, 65.0, 54.0, 65.0, 65.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2704446832262078, "mean_inference_ms": 24.294901091088278, "mean_action_processing_ms": 0.10253896195373718, "mean_env_wait_ms": 0.04545252002774145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058438777923583984, "StateBufferConnector_ms": 0.005902528762817383, "ViewRequirementAgentConnector_ms": 0.13425731658935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 181430.949, "sample_time_ms": 98893.422, "learn_time_ms": 82526.067, "learn_throughput": 48.47, "synch_weights_time_ms": 9.96}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 368, "training_iteration": 7, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-16-47", "timestamp": 1685564207, "time_this_iter_s": 200.84743404388428, "time_total_s": 1401.7312994003296, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1401.7312994003296, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.01035714285714, "ram_util_percent": 76.06464285714286}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -78.0, "episode_reward_mean": -14.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -45.0, -34.0, 21.0, -23.0, 21.0, -78.0, 32.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25046375546285227, "mean_inference_ms": 24.264586793221724, "mean_action_processing_ms": 0.10415692604640817, "mean_env_wait_ms": 0.04508612560139853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005164146423339844, "StateBufferConnector_ms": 0.005795955657958984, "ViewRequirementAgentConnector_ms": 0.12678146362304688}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 9.999999747378752e-05, "total_loss": 5.810451507568359, "policy_loss": -0.024991128593683243, "vf_loss": 5.750685691833496, "vf_explained_var": -0.04610969126224518, "kl": 0.024803094565868378, "entropy": 2.8184571266174316, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7650.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 12.86, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -111.0, 10.0, -12.0, 21.0, 10.0, -1.0, -1.0, 43.0, -34.0, 10.0, 32.0, 32.0, -34.0, -1.0, -1.0, 65.0, -23.0, 43.0, 32.0, 65.0, 54.0, 65.0, -1.0, 43.0, -67.0, -23.0, 54.0, 43.0, -12.0, -67.0, -1.0, 43.0, -12.0, 10.0, -1.0, -34.0, 21.0, 54.0, 43.0, 32.0, 10.0, 65.0, 54.0, 65.0, 65.0, -12.0, 21.0, -34.0, 76.0, 76.0, 54.0, 43.0, 65.0, 54.0, 43.0, 76.0, -12.0, -1.0, 10.0, -34.0, -12.0, -45.0, -56.0, -23.0, -34.0, -111.0, 10.0, 21.0, 43.0, 10.0, -12.0, -78.0, -1.0, 10.0, 43.0, 10.0, 10.0, 32.0, 32.0, 32.0, 65.0, 65.0, -23.0, -1.0, -45.0, 10.0, 10.0, 10.0, 10.0, 10.0, -1.0, 54.0, -23.0, 32.0, 10.0, 21.0, 32.0, 65.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2704406516845664, "mean_inference_ms": 24.22871330176317, "mean_action_processing_ms": 0.10269517744736273, "mean_env_wait_ms": 0.045469369242124885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060272216796875, "StateBufferConnector_ms": 0.00595855712890625, "ViewRequirementAgentConnector_ms": 0.13615155220031738}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 12.86, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -111.0, 10.0, -12.0, 21.0, 10.0, -1.0, -1.0, 43.0, -34.0, 10.0, 32.0, 32.0, -34.0, -1.0, -1.0, 65.0, -23.0, 43.0, 32.0, 65.0, 54.0, 65.0, -1.0, 43.0, -67.0, -23.0, 54.0, 43.0, -12.0, -67.0, -1.0, 43.0, -12.0, 10.0, -1.0, -34.0, 21.0, 54.0, 43.0, 32.0, 10.0, 65.0, 54.0, 65.0, 65.0, -12.0, 21.0, -34.0, 76.0, 76.0, 54.0, 43.0, 65.0, 54.0, 43.0, 76.0, -12.0, -1.0, 10.0, -34.0, -12.0, -45.0, -56.0, -23.0, -34.0, -111.0, 10.0, 21.0, 43.0, 10.0, -12.0, -78.0, -1.0, 10.0, 43.0, 10.0, 10.0, 32.0, 32.0, 32.0, 65.0, 65.0, -23.0, -1.0, -45.0, 10.0, 10.0, 10.0, 10.0, 10.0, -1.0, 54.0, -23.0, 32.0, 10.0, 21.0, 32.0, 65.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2704406516845664, "mean_inference_ms": 24.22871330176317, "mean_action_processing_ms": 0.10269517744736273, "mean_env_wait_ms": 0.045469369242124885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060272216796875, "StateBufferConnector_ms": 0.00595855712890625, "ViewRequirementAgentConnector_ms": 0.13615155220031738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 180782.421, "sample_time_ms": 98439.441, "learn_time_ms": 82331.605, "learn_throughput": 48.584, "synch_weights_time_ms": 9.892}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 421, "training_iteration": 8, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-20-02", "timestamp": 1685564402, "time_this_iter_s": 195.0796980857849, "time_total_s": 1596.8109974861145, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1596.8109974861145, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 46.48970588235294, "ram_util_percent": 74.01875000000001}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -89.0, "episode_reward_mean": -15.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -23.0, -56.0, 32.0, -89.0, -1.0, -34.0, -1.0, 10.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25246157630147537, "mean_inference_ms": 24.545329475486476, "mean_action_processing_ms": 0.10503751634593037, "mean_env_wait_ms": 0.0453294674009455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005335807800292969, "StateBufferConnector_ms": 0.006375312805175781, "ViewRequirementAgentConnector_ms": 0.14361143112182617}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 9.999999747378752e-05, "total_loss": 6.231724262237549, "policy_loss": -0.004678242839872837, "vf_loss": 6.144936561584473, "vf_explained_var": -0.09352859109640121, "kl": 0.01784425973892212, "entropy": 2.8588268756866455, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8685.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 4.27, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 65.0, 54.0, 43.0, 76.0, -12.0, -1.0, 10.0, -34.0, -12.0, -45.0, -56.0, -23.0, -34.0, -111.0, 10.0, 21.0, 43.0, 10.0, -12.0, -78.0, -1.0, 10.0, 43.0, 10.0, 10.0, 32.0, 32.0, 32.0, 65.0, 65.0, -23.0, -1.0, -45.0, 10.0, 10.0, 10.0, 10.0, 10.0, -1.0, 54.0, -23.0, 32.0, 10.0, 21.0, 32.0, 65.0, 10.0, 32.0, 43.0, 54.0, 43.0, 54.0, 43.0, 10.0, 54.0, 21.0, 21.0, 10.0, -56.0, 32.0, -1.0, -1.0, -89.0, -111.0, -78.0, -45.0, -1.0, -1.0, 21.0, -34.0, 10.0, -45.0, 32.0, -67.0, 21.0, 76.0, 54.0, -34.0, -23.0, -1.0, -100.0, -89.0, -12.0, 21.0, 10.0, -29.0, -84.0, -1.0, 65.0, -12.0, -45.0, -45.0, 21.0, 54.0, 21.0, 32.0, 54.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27062400990877455, "mean_inference_ms": 24.223285567983, "mean_action_processing_ms": 0.10292239367928822, "mean_env_wait_ms": 0.045523649500117294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005974531173706055, "StateBufferConnector_ms": 0.006056785583496094, "ViewRequirementAgentConnector_ms": 0.1371917724609375}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 4.27, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 65.0, 54.0, 43.0, 76.0, -12.0, -1.0, 10.0, -34.0, -12.0, -45.0, -56.0, -23.0, -34.0, -111.0, 10.0, 21.0, 43.0, 10.0, -12.0, -78.0, -1.0, 10.0, 43.0, 10.0, 10.0, 32.0, 32.0, 32.0, 65.0, 65.0, -23.0, -1.0, -45.0, 10.0, 10.0, 10.0, 10.0, 10.0, -1.0, 54.0, -23.0, 32.0, 10.0, 21.0, 32.0, 65.0, 10.0, 32.0, 43.0, 54.0, 43.0, 54.0, 43.0, 10.0, 54.0, 21.0, 21.0, 10.0, -56.0, 32.0, -1.0, -1.0, -89.0, -111.0, -78.0, -45.0, -1.0, -1.0, 21.0, -34.0, 10.0, -45.0, 32.0, -67.0, 21.0, 76.0, 54.0, -34.0, -23.0, -1.0, -100.0, -89.0, -12.0, 21.0, 10.0, -29.0, -84.0, -1.0, 65.0, -12.0, -45.0, -45.0, 21.0, 54.0, 21.0, 32.0, 54.0, 32.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27062400990877455, "mean_inference_ms": 24.223285567983, "mean_action_processing_ms": 0.10292239367928822, "mean_env_wait_ms": 0.045523649500117294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005974531173706055, "StateBufferConnector_ms": 0.006056785583496094, "ViewRequirementAgentConnector_ms": 0.1371917724609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 181640.292, "sample_time_ms": 98811.249, "learn_time_ms": 82817.5, "learn_throughput": 48.299, "synch_weights_time_ms": 10.081}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 473, "training_iteration": 9, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-23-31", "timestamp": 1685564611, "time_this_iter_s": 209.27069187164307, "time_total_s": 1806.0816893577576, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1806.0816893577576, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.44295532646048, "ram_util_percent": 76.25429553264605}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -100.0, "episode_reward_mean": -16.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -100.0, -45.0, 10.0, -1.0, -56.0, -23.0, 32.0, 65.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25387626465269336, "mean_inference_ms": 24.84312328503737, "mean_action_processing_ms": 0.10589900228196485, "mean_env_wait_ms": 0.04558255211050111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061798095703125, "StateBufferConnector_ms": 0.006873607635498047, "ViewRequirementAgentConnector_ms": 0.14249086380004883}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 9.999999747378752e-05, "total_loss": 5.451809406280518, "policy_loss": 0.002299174200743437, "vf_loss": 5.341864109039307, "vf_explained_var": -0.05878686159849167, "kl": 0.021001065149903297, "entropy": 2.831220865249634, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9720.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 8.22, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 10.0, 54.0, 21.0, 21.0, 10.0, -56.0, 32.0, -1.0, -1.0, -89.0, -111.0, -78.0, -45.0, -1.0, -1.0, 21.0, -34.0, 10.0, -45.0, 32.0, -67.0, 21.0, 76.0, 54.0, -34.0, -23.0, -1.0, -100.0, -89.0, -12.0, 21.0, 10.0, -29.0, -84.0, -1.0, 65.0, -12.0, -45.0, -45.0, 21.0, 54.0, 21.0, 32.0, 54.0, 32.0, 54.0, 43.0, 43.0, 65.0, 76.0, 21.0, 76.0, 21.0, -34.0, -56.0, -12.0, -34.0, -51.0, -1.0, -1.0, 32.0, 32.0, 32.0, 21.0, 10.0, -1.0, -1.0, 32.0, 21.0, 32.0, -45.0, 21.0, 10.0, 10.0, -34.0, 43.0, 32.0, 65.0, 54.0, 43.0, 54.0, 48.0, 43.0, 54.0, 21.0, 32.0, -1.0, 10.0, 54.0, 43.0, 54.0, 43.0, -12.0, 10.0, 21.0, 32.0, -12.0, -56.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27101616408947315, "mean_inference_ms": 24.299955762006157, "mean_action_processing_ms": 0.10326706039172195, "mean_env_wait_ms": 0.045608648459352835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005903482437133789, "StateBufferConnector_ms": 0.006015300750732422, "ViewRequirementAgentConnector_ms": 0.13795733451843262}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 8.22, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 10.0, 54.0, 21.0, 21.0, 10.0, -56.0, 32.0, -1.0, -1.0, -89.0, -111.0, -78.0, -45.0, -1.0, -1.0, 21.0, -34.0, 10.0, -45.0, 32.0, -67.0, 21.0, 76.0, 54.0, -34.0, -23.0, -1.0, -100.0, -89.0, -12.0, 21.0, 10.0, -29.0, -84.0, -1.0, 65.0, -12.0, -45.0, -45.0, 21.0, 54.0, 21.0, 32.0, 54.0, 32.0, 54.0, 43.0, 43.0, 65.0, 76.0, 21.0, 76.0, 21.0, -34.0, -56.0, -12.0, -34.0, -51.0, -1.0, -1.0, 32.0, 32.0, 32.0, 21.0, 10.0, -1.0, -1.0, 32.0, 21.0, 32.0, -45.0, 21.0, 10.0, 10.0, -34.0, 43.0, 32.0, 65.0, 54.0, 43.0, 54.0, 48.0, 43.0, 54.0, 21.0, 32.0, -1.0, 10.0, 54.0, 43.0, 54.0, 43.0, -12.0, 10.0, 21.0, 32.0, -12.0, -56.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27101616408947315, "mean_inference_ms": 24.299955762006157, "mean_action_processing_ms": 0.10326706039172195, "mean_env_wait_ms": 0.045608648459352835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005903482437133789, "StateBufferConnector_ms": 0.006015300750732422, "ViewRequirementAgentConnector_ms": 0.13795733451843262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 182196.152, "sample_time_ms": 99059.527, "learn_time_ms": 83124.942, "learn_throughput": 48.12, "synch_weights_time_ms": 10.238}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": true, "episodes_total": 526, "training_iteration": 10, "trial_id": "b0a0c_00056", "date": "2023-05-31_23-27-00", "timestamp": 1685564820, "time_this_iter_s": 208.52182483673096, "time_total_s": 2014.6035141944885, "pid": 62448, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.0001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2014.6035141944885, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.13103448275862, "ram_util_percent": 72.74620689655173}}
