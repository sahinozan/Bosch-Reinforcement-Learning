{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -155.0, "episode_reward_mean": -36.2, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.0, -133.0, -12.0, -23.0, -1.0, -1.0, 43.0, -12.0, 10.0, -78.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18201331741393162, "mean_inference_ms": 10.431614874540271, "mean_action_processing_ms": 0.08533348705076202, "mean_env_wait_ms": 0.04486060173846733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057697296142578125, "StateBufferConnector_ms": 0.0029277801513671875, "ViewRequirementAgentConnector_ms": 0.0836181640625}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-06, "total_loss": 9.201642990112305, "policy_loss": -0.001774535165168345, "vf_loss": 9.203402519226074, "vf_explained_var": 0.0002819150686264038, "kl": 7.37710579414852e-05, "entropy": 2.995640516281128, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 12.307692307692308, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -23.0, -67.0, -45.0, -23.0, 32.0, -40.0, -12.0, 32.0, 10.0, 21.0, 21.0, -56.0, -12.0, 21.0, 32.0, -12.0, 54.0, -23.0, 21.0, 43.0, -12.0, 54.0, 21.0, 21.0, 32.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 59.0, 54.0, 54.0, 21.0, 21.0, -34.0, -12.0, 32.0, -12.0, -1.0, -12.0, 32.0, 65.0, 21.0, 10.0, -23.0, -78.0, -12.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1924924628790007, "mean_inference_ms": 9.963707100358853, "mean_action_processing_ms": 0.08089105596068023, "mean_env_wait_ms": 0.04118515592430628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004627612920907827, "StateBufferConnector_ms": 0.0028688174027663013, "ViewRequirementAgentConnector_ms": 0.0852057567009559}}, "episode_reward_max": 76.0, "episode_reward_min": -78.0, "episode_reward_mean": 12.307692307692308, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.0, -23.0, -67.0, -45.0, -23.0, 32.0, -40.0, -12.0, 32.0, 10.0, 21.0, 21.0, -56.0, -12.0, 21.0, 32.0, -12.0, 54.0, -23.0, 21.0, 43.0, -12.0, 54.0, 21.0, 21.0, 32.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 59.0, 54.0, 54.0, 21.0, 21.0, -34.0, -12.0, 32.0, -12.0, -1.0, -12.0, 32.0, 65.0, 21.0, 10.0, -23.0, -78.0, -12.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1924924628790007, "mean_inference_ms": 9.963707100358853, "mean_action_processing_ms": 0.08089105596068023, "mean_env_wait_ms": 0.04118515592430628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004627612920907827, "StateBufferConnector_ms": 0.0028688174027663013, "ViewRequirementAgentConnector_ms": 0.0852057567009559}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 75470.358, "sample_time_ms": 41168.295, "learn_time_ms": 34293.874, "learn_throughput": 116.639, "synch_weights_time_ms": 6.701}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 52, "training_iteration": 1, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-23-25", "timestamp": 1685543005, "time_this_iter_s": 83.7067220211029, "time_total_s": 83.7067220211029, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 83.7067220211029, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.5974358974359, "ram_util_percent": 77.274358974359}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -45.0, "episode_reward_mean": 17.7, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -1.0, 10.0, 21.0, 43.0, 43.0, 32.0, 21.0, -45.0, 21.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18182763294668905, "mean_inference_ms": 10.310735457982771, "mean_action_processing_ms": 0.08434656809067584, "mean_env_wait_ms": 0.04371132684490698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005900859832763672, "StateBufferConnector_ms": 0.0028276443481445312, "ViewRequirementAgentConnector_ms": 0.08356571197509766}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-06, "total_loss": 9.008654594421387, "policy_loss": -0.0005632726824842393, "vf_loss": 9.009202003479004, "vf_explained_var": -0.00021310213196557015, "kl": 0.0001611562620382756, "entropy": 2.995490550994873, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.91, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -40.0, -12.0, 32.0, 10.0, 21.0, 21.0, -56.0, -12.0, 21.0, 32.0, -12.0, 54.0, -23.0, 21.0, 43.0, -12.0, 54.0, 21.0, 21.0, 32.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 59.0, 54.0, 54.0, 21.0, 21.0, -34.0, -12.0, 32.0, -12.0, -1.0, -12.0, 32.0, 65.0, 21.0, 10.0, -23.0, -78.0, -12.0, 32.0, 43.0, 76.0, 21.0, 21.0, 54.0, 76.0, 54.0, 32.0, -45.0, 43.0, 21.0, 43.0, 10.0, -12.0, -34.0, -34.0, -67.0, 10.0, -23.0, -1.0, 43.0, 76.0, -45.0, -56.0, -23.0, 10.0, -78.0, 10.0, -100.0, -1.0, 43.0, 65.0, 43.0, 65.0, 32.0, -34.0, -1.0, 43.0, 43.0, 54.0, 54.0, 76.0, 43.0, 10.0, -12.0, 65.0, 21.0, 43.0, 32.0, 65.0, 43.0, 65.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1918304943976917, "mean_inference_ms": 10.025154900518762, "mean_action_processing_ms": 0.08043953120002531, "mean_env_wait_ms": 0.040887022559569476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004563331604003906, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.08627867698669434}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 17.91, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, -40.0, -12.0, 32.0, 10.0, 21.0, 21.0, -56.0, -12.0, 21.0, 32.0, -12.0, 54.0, -23.0, 21.0, 43.0, -12.0, 54.0, 21.0, 21.0, 32.0, 54.0, 54.0, 76.0, 76.0, 54.0, 54.0, 59.0, 54.0, 54.0, 21.0, 21.0, -34.0, -12.0, 32.0, -12.0, -1.0, -12.0, 32.0, 65.0, 21.0, 10.0, -23.0, -78.0, -12.0, 32.0, 43.0, 76.0, 21.0, 21.0, 54.0, 76.0, 54.0, 32.0, -45.0, 43.0, 21.0, 43.0, 10.0, -12.0, -34.0, -34.0, -67.0, 10.0, -23.0, -1.0, 43.0, 76.0, -45.0, -56.0, -23.0, 10.0, -78.0, 10.0, -100.0, -1.0, 43.0, 65.0, 43.0, 65.0, 32.0, -34.0, -1.0, 43.0, 43.0, 54.0, 54.0, 76.0, 43.0, 10.0, -12.0, 65.0, 21.0, 43.0, 32.0, 65.0, 43.0, 65.0, -12.0, -12.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1918304943976917, "mean_inference_ms": 10.025154900518762, "mean_action_processing_ms": 0.08043953120002531, "mean_env_wait_ms": 0.040887022559569476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004563331604003906, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.08627867698669434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 76233.836, "sample_time_ms": 41612.856, "learn_time_ms": 34612.929, "learn_throughput": 115.564, "synch_weights_time_ms": 6.826}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 105, "training_iteration": 2, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-24-50", "timestamp": 1685543090, "time_this_iter_s": 85.025799036026, "time_total_s": 168.7325210571289, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.7325210571289, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.41355932203389, "ram_util_percent": 77.06864406779663}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -45.0, "episode_reward_mean": 10.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -23.0, -45.0, 43.0, 43.0, 43.0, 32.0, 43.0, -45.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18116049158212544, "mean_inference_ms": 10.385787157780346, "mean_action_processing_ms": 0.08325261120626873, "mean_env_wait_ms": 0.04288576402877413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00576019287109375, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.08894920349121094}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-06, "total_loss": 9.11063003540039, "policy_loss": -0.0008319933549501002, "vf_loss": 9.111456871032715, "vf_explained_var": 0.0010122880339622498, "kl": 9.533136471873149e-05, "entropy": 2.995387315750122, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 9.89, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 32.0, -45.0, 43.0, 21.0, 43.0, 10.0, -12.0, -34.0, -34.0, -67.0, 10.0, -23.0, -1.0, 43.0, 76.0, -45.0, -56.0, -23.0, 10.0, -78.0, 10.0, -100.0, -1.0, 43.0, 65.0, 43.0, 65.0, 32.0, -34.0, -1.0, 43.0, 43.0, 54.0, 54.0, 76.0, 43.0, 10.0, -12.0, 65.0, 21.0, 43.0, 32.0, 65.0, 43.0, 65.0, -12.0, -12.0, 10.0, 10.0, 32.0, 32.0, -1.0, 10.0, -12.0, 43.0, 65.0, -1.0, 21.0, -23.0, 43.0, -34.0, -23.0, -34.0, -23.0, -34.0, 54.0, -78.0, -12.0, -67.0, 32.0, 21.0, 54.0, 21.0, -1.0, 10.0, -23.0, 21.0, 54.0, 21.0, -45.0, -23.0, -78.0, -34.0, -1.0, 54.0, 65.0, 10.0, -34.0, 54.0, -23.0, 43.0, -23.0, -12.0, 76.0, 76.0, 54.0, 32.0, -1.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19106241214641886, "mean_inference_ms": 10.101866261118579, "mean_action_processing_ms": 0.0799667395187581, "mean_env_wait_ms": 0.04057027625718761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004662036895751953, "StateBufferConnector_ms": 0.0028138160705566406, "ViewRequirementAgentConnector_ms": 0.08730363845825195}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 9.89, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 32.0, -45.0, 43.0, 21.0, 43.0, 10.0, -12.0, -34.0, -34.0, -67.0, 10.0, -23.0, -1.0, 43.0, 76.0, -45.0, -56.0, -23.0, 10.0, -78.0, 10.0, -100.0, -1.0, 43.0, 65.0, 43.0, 65.0, 32.0, -34.0, -1.0, 43.0, 43.0, 54.0, 54.0, 76.0, 43.0, 10.0, -12.0, 65.0, 21.0, 43.0, 32.0, 65.0, 43.0, 65.0, -12.0, -12.0, 10.0, 10.0, 32.0, 32.0, -1.0, 10.0, -12.0, 43.0, 65.0, -1.0, 21.0, -23.0, 43.0, -34.0, -23.0, -34.0, -23.0, -34.0, 54.0, -78.0, -12.0, -67.0, 32.0, 21.0, 54.0, 21.0, -1.0, 10.0, -23.0, 21.0, 54.0, 21.0, -45.0, -23.0, -78.0, -34.0, -1.0, 54.0, 65.0, 10.0, -34.0, 54.0, -23.0, 43.0, -23.0, -12.0, 76.0, 76.0, 54.0, 32.0, -1.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19106241214641886, "mean_inference_ms": 10.101866261118579, "mean_action_processing_ms": 0.0799667395187581, "mean_env_wait_ms": 0.04057027625718761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004662036895751953, "StateBufferConnector_ms": 0.0028138160705566406, "ViewRequirementAgentConnector_ms": 0.08730363845825195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 76593.83, "sample_time_ms": 41778.633, "learn_time_ms": 34807.282, "learn_throughput": 114.918, "synch_weights_time_ms": 6.828}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 157, "training_iteration": 3, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-26-16", "timestamp": 1685543176, "time_this_iter_s": 85.59685897827148, "time_total_s": 254.3293800354004, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 254.3293800354004, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.31848739495799, "ram_util_percent": 77.6050420168067}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -89.0, "episode_reward_mean": 14.4, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -1.0, 65.0, -12.0, 21.0, 32.0, 54.0, 21.0, -12.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1798061037173361, "mean_inference_ms": 10.392565274073945, "mean_action_processing_ms": 0.08242579519415483, "mean_env_wait_ms": 0.042245639699417206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414485931396484, "StateBufferConnector_ms": 0.002663135528564453, "ViewRequirementAgentConnector_ms": 0.08260726928710938}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999747378752e-06, "total_loss": 9.157416343688965, "policy_loss": -0.0012397912796586752, "vf_loss": 9.158655166625977, "vf_explained_var": 0.00044272647937759757, "kl": 8.950501069193706e-05, "entropy": 2.9952480792999268, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 4.72, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -12.0, 43.0, 65.0, -1.0, 21.0, -23.0, 43.0, -34.0, -23.0, -34.0, -23.0, -34.0, 54.0, -78.0, -12.0, -67.0, 32.0, 21.0, 54.0, 21.0, -1.0, 10.0, -23.0, 21.0, 54.0, 21.0, -45.0, -23.0, -78.0, -34.0, -1.0, 54.0, 65.0, 10.0, -34.0, 54.0, -23.0, 43.0, -23.0, -12.0, 76.0, 76.0, 54.0, 32.0, -1.0, -56.0, -45.0, -1.0, -34.0, -111.0, -23.0, -67.0, -45.0, -12.0, -23.0, -12.0, 21.0, -45.0, -45.0, 21.0, 54.0, 21.0, -1.0, 65.0, 43.0, -23.0, 10.0, -1.0, -12.0, 32.0, -78.0, -34.0, -111.0, -1.0, 43.0, 21.0, 21.0, -1.0, 43.0, 32.0, 32.0, 76.0, 65.0, 54.0, 76.0, 21.0, 54.0, 21.0, -45.0, -67.0, 10.0, 10.0, -34.0, 32.0, 32.0, 54.0, 65.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19101743493567538, "mean_inference_ms": 10.11578230598642, "mean_action_processing_ms": 0.07987844202937662, "mean_env_wait_ms": 0.0404999204538104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004659891128540039, "StateBufferConnector_ms": 0.0028426647186279297, "ViewRequirementAgentConnector_ms": 0.08769392967224121}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 4.72, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -12.0, 43.0, 65.0, -1.0, 21.0, -23.0, 43.0, -34.0, -23.0, -34.0, -23.0, -34.0, 54.0, -78.0, -12.0, -67.0, 32.0, 21.0, 54.0, 21.0, -1.0, 10.0, -23.0, 21.0, 54.0, 21.0, -45.0, -23.0, -78.0, -34.0, -1.0, 54.0, 65.0, 10.0, -34.0, 54.0, -23.0, 43.0, -23.0, -12.0, 76.0, 76.0, 54.0, 32.0, -1.0, -56.0, -45.0, -1.0, -34.0, -111.0, -23.0, -67.0, -45.0, -12.0, -23.0, -12.0, 21.0, -45.0, -45.0, 21.0, 54.0, 21.0, -1.0, 65.0, 43.0, -23.0, 10.0, -1.0, -12.0, 32.0, -78.0, -34.0, -111.0, -1.0, 43.0, 21.0, 21.0, -1.0, 43.0, 32.0, 32.0, 76.0, 65.0, 54.0, 76.0, 21.0, 54.0, 21.0, -45.0, -67.0, 10.0, 10.0, -34.0, 32.0, 32.0, 54.0, 65.0, 32.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19101743493567538, "mean_inference_ms": 10.11578230598642, "mean_action_processing_ms": 0.07987844202937662, "mean_env_wait_ms": 0.0404999204538104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004659891128540039, "StateBufferConnector_ms": 0.0028426647186279297, "ViewRequirementAgentConnector_ms": 0.08769392967224121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 76306.919, "sample_time_ms": 41728.082, "learn_time_ms": 34570.874, "learn_throughput": 115.704, "synch_weights_time_ms": 6.865}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 210, "training_iteration": 4, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-27-40", "timestamp": 1685543260, "time_this_iter_s": 83.63202285766602, "time_total_s": 337.9614028930664, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 337.9614028930664, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.57435897435898, "ram_util_percent": 77.54102564102564}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -89.0, "episode_reward_mean": -39.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -45.0, 32.0, -56.0, -45.0, -1.0, -56.0, -34.0, -34.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1787096222774884, "mean_inference_ms": 10.365842298845404, "mean_action_processing_ms": 0.08211409346237522, "mean_env_wait_ms": 0.041939653368003746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048923492431640625, "StateBufferConnector_ms": 0.0026559829711914062, "ViewRequirementAgentConnector_ms": 0.08353233337402344}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999747378752e-06, "total_loss": 9.069887161254883, "policy_loss": -0.0015529801603406668, "vf_loss": 9.07143783569336, "vf_explained_var": -0.00041630107443779707, "kl": 6.337035301839933e-05, "entropy": 2.9951608180999756, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 10.05, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -12.0, -23.0, -12.0, 21.0, -45.0, -45.0, 21.0, 54.0, 21.0, -1.0, 65.0, 43.0, -23.0, 10.0, -1.0, -12.0, 32.0, -78.0, -34.0, -111.0, -1.0, 43.0, 21.0, 21.0, -1.0, 43.0, 32.0, 32.0, 76.0, 65.0, 54.0, 76.0, 21.0, 54.0, 21.0, -45.0, -67.0, 10.0, 10.0, -34.0, 32.0, 32.0, 54.0, 65.0, 32.0, 43.0, 54.0, 10.0, 76.0, 65.0, 32.0, 10.0, -78.0, 10.0, 65.0, 65.0, 10.0, -12.0, 54.0, 54.0, 21.0, -12.0, 10.0, -12.0, 32.0, 21.0, -34.0, -56.0, -12.0, -78.0, 32.0, 32.0, -34.0, -12.0, -34.0, -111.0, -12.0, 32.0, 65.0, 21.0, 21.0, 54.0, 54.0, 21.0, 32.0, 15.0, -1.0, -1.0, -23.0, -1.0, -23.0, -1.0, 32.0, 32.0, -23.0, -1.0, 43.0, -45.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19139136098391007, "mean_inference_ms": 10.101548820790196, "mean_action_processing_ms": 0.08001021415802584, "mean_env_wait_ms": 0.04054502230130881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004682064056396484, "StateBufferConnector_ms": 0.0028541088104248047, "ViewRequirementAgentConnector_ms": 0.08759522438049316}}, "episode_reward_max": 76.0, "episode_reward_min": -111.0, "episode_reward_mean": 10.05, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -12.0, -23.0, -12.0, 21.0, -45.0, -45.0, 21.0, 54.0, 21.0, -1.0, 65.0, 43.0, -23.0, 10.0, -1.0, -12.0, 32.0, -78.0, -34.0, -111.0, -1.0, 43.0, 21.0, 21.0, -1.0, 43.0, 32.0, 32.0, 76.0, 65.0, 54.0, 76.0, 21.0, 54.0, 21.0, -45.0, -67.0, 10.0, 10.0, -34.0, 32.0, 32.0, 54.0, 65.0, 32.0, 43.0, 54.0, 10.0, 76.0, 65.0, 32.0, 10.0, -78.0, 10.0, 65.0, 65.0, 10.0, -12.0, 54.0, 54.0, 21.0, -12.0, 10.0, -12.0, 32.0, 21.0, -34.0, -56.0, -12.0, -78.0, 32.0, 32.0, -34.0, -12.0, -34.0, -111.0, -12.0, 32.0, 65.0, 21.0, 21.0, 54.0, 54.0, 21.0, 32.0, 15.0, -1.0, -1.0, -23.0, -1.0, -23.0, -1.0, 32.0, 32.0, -23.0, -1.0, 43.0, -45.0, 32.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19139136098391007, "mean_inference_ms": 10.101548820790196, "mean_action_processing_ms": 0.08001021415802584, "mean_env_wait_ms": 0.04054502230130881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004682064056396484, "StateBufferConnector_ms": 0.0028541088104248047, "ViewRequirementAgentConnector_ms": 0.08759522438049316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 76066.172, "sample_time_ms": 41667.785, "learn_time_ms": 34390.665, "learn_throughput": 116.311, "synch_weights_time_ms": 6.653}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 263, "training_iteration": 5, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-29-03", "timestamp": 1685543343, "time_this_iter_s": 83.1724259853363, "time_total_s": 421.1338288784027, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 421.1338288784027, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.98695652173913, "ram_util_percent": 77.34173913043479}}
{"evaluation": {"episode_reward_max": 65.0, "episode_reward_min": -67.0, "episode_reward_mean": 5.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -67.0, -23.0, 32.0, 43.0, 32.0, 43.0, 32.0, 65.0, -34.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18078746097282838, "mean_inference_ms": 10.437722269889164, "mean_action_processing_ms": 0.0831657427231802, "mean_env_wait_ms": 0.0422447299099993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005211830139160156, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.08890628814697266}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 9.999999747378752e-06, "total_loss": 8.99213695526123, "policy_loss": -0.0016466003144159913, "vf_loss": 8.993782997131348, "vf_explained_var": 0.0007547154673375189, "kl": 8.631141827208921e-05, "entropy": 2.995044469833374, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 65.0, "episode_reward_min": -111.0, "episode_reward_mean": 9.83, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -78.0, 10.0, 65.0, 65.0, 10.0, -12.0, 54.0, 54.0, 21.0, -12.0, 10.0, -12.0, 32.0, 21.0, -34.0, -56.0, -12.0, -78.0, 32.0, 32.0, -34.0, -12.0, -34.0, -111.0, -12.0, 32.0, 65.0, 21.0, 21.0, 54.0, 54.0, 21.0, 32.0, 15.0, -1.0, -1.0, -23.0, -1.0, -23.0, -1.0, 32.0, 32.0, -23.0, -1.0, 43.0, -45.0, 32.0, -1.0, 21.0, -1.0, 10.0, -1.0, -12.0, -34.0, 10.0, -1.0, -12.0, 21.0, -12.0, -1.0, 21.0, 43.0, -12.0, 43.0, 21.0, -23.0, 32.0, 21.0, -45.0, -34.0, 32.0, 65.0, 54.0, 10.0, 21.0, 21.0, 43.0, -12.0, 43.0, 54.0, 10.0, -45.0, -100.0, -45.0, -34.0, 10.0, 54.0, 65.0, 43.0, 32.0, 32.0, 54.0, 10.0, 54.0, 32.0, 43.0, 43.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1916010242291016, "mean_inference_ms": 10.091498442740182, "mean_action_processing_ms": 0.08014874801599893, "mean_env_wait_ms": 0.04058316994894132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004687309265136719, "StateBufferConnector_ms": 0.0027539730072021484, "ViewRequirementAgentConnector_ms": 0.08732151985168457}}, "episode_reward_max": 65.0, "episode_reward_min": -111.0, "episode_reward_mean": 9.83, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -78.0, 10.0, 65.0, 65.0, 10.0, -12.0, 54.0, 54.0, 21.0, -12.0, 10.0, -12.0, 32.0, 21.0, -34.0, -56.0, -12.0, -78.0, 32.0, 32.0, -34.0, -12.0, -34.0, -111.0, -12.0, 32.0, 65.0, 21.0, 21.0, 54.0, 54.0, 21.0, 32.0, 15.0, -1.0, -1.0, -23.0, -1.0, -23.0, -1.0, 32.0, 32.0, -23.0, -1.0, 43.0, -45.0, 32.0, -1.0, 21.0, -1.0, 10.0, -1.0, -12.0, -34.0, 10.0, -1.0, -12.0, 21.0, -12.0, -1.0, 21.0, 43.0, -12.0, 43.0, 21.0, -23.0, 32.0, 21.0, -45.0, -34.0, 32.0, 65.0, 54.0, 10.0, 21.0, 21.0, 43.0, -12.0, 43.0, 54.0, 10.0, -45.0, -100.0, -45.0, -34.0, 10.0, 54.0, 65.0, 43.0, 32.0, 32.0, 54.0, 10.0, 54.0, 32.0, 43.0, 43.0, 43.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1916010242291016, "mean_inference_ms": 10.091498442740182, "mean_action_processing_ms": 0.08014874801599893, "mean_env_wait_ms": 0.04058316994894132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004687309265136719, "StateBufferConnector_ms": 0.0027539730072021484, "ViewRequirementAgentConnector_ms": 0.08732151985168457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 76093.558, "sample_time_ms": 41646.826, "learn_time_ms": 34439.174, "learn_throughput": 116.147, "synch_weights_time_ms": 6.537}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 315, "training_iteration": 6, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-30-28", "timestamp": 1685543428, "time_this_iter_s": 84.73389625549316, "time_total_s": 505.8677251338959, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 505.8677251338959, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 46.779661016949156, "ram_util_percent": 76.82966101694916}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -89.0, "episode_reward_mean": 15.5, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 43.0, 43.0, 43.0, 43.0, 10.0, -23.0, 10.0, 32.0, -89.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18624053192282056, "mean_inference_ms": 10.6810667173819, "mean_action_processing_ms": 0.08575931076626202, "mean_env_wait_ms": 0.04354022405488534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006897449493408203, "StateBufferConnector_ms": 0.0032019615173339844, "ViewRequirementAgentConnector_ms": 0.10720968246459961}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 9.999999747378752e-06, "total_loss": 8.94737720489502, "policy_loss": -0.0018239617347717285, "vf_loss": 8.949201583862305, "vf_explained_var": 0.0004194274661131203, "kl": 0.0001372644619550556, "entropy": 2.994598865509033, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 20.56, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -34.0, 10.0, -1.0, -12.0, 21.0, -12.0, -1.0, 21.0, 43.0, -12.0, 43.0, 21.0, -23.0, 32.0, 21.0, -45.0, -34.0, 32.0, 65.0, 54.0, 10.0, 21.0, 21.0, 43.0, -12.0, 43.0, 54.0, 10.0, -45.0, -100.0, -45.0, -34.0, 10.0, 54.0, 65.0, 43.0, 32.0, 32.0, 54.0, 10.0, 54.0, 32.0, 43.0, 43.0, 43.0, 43.0, 21.0, 54.0, 43.0, 32.0, 10.0, -1.0, -45.0, -1.0, -89.0, 21.0, -23.0, 21.0, 32.0, 65.0, 54.0, 32.0, 65.0, 65.0, 32.0, 10.0, -1.0, 32.0, 21.0, 32.0, -1.0, 32.0, 54.0, -12.0, -56.0, -1.0, -67.0, 76.0, -12.0, 54.0, 65.0, 32.0, 54.0, 54.0, 76.0, -23.0, 10.0, 65.0, 43.0, 32.0, 54.0, 65.0, 76.0, 76.0, 32.0, 21.0, -1.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19128074260282438, "mean_inference_ms": 10.035539977809554, "mean_action_processing_ms": 0.07999592285626822, "mean_env_wait_ms": 0.04038773606459986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004492521286010742, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.0852956771850586}}, "episode_reward_max": 76.0, "episode_reward_min": -100.0, "episode_reward_mean": 20.56, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -34.0, 10.0, -1.0, -12.0, 21.0, -12.0, -1.0, 21.0, 43.0, -12.0, 43.0, 21.0, -23.0, 32.0, 21.0, -45.0, -34.0, 32.0, 65.0, 54.0, 10.0, 21.0, 21.0, 43.0, -12.0, 43.0, 54.0, 10.0, -45.0, -100.0, -45.0, -34.0, 10.0, 54.0, 65.0, 43.0, 32.0, 32.0, 54.0, 10.0, 54.0, 32.0, 43.0, 43.0, 43.0, 43.0, 21.0, 54.0, 43.0, 32.0, 10.0, -1.0, -45.0, -1.0, -89.0, 21.0, -23.0, 21.0, 32.0, 65.0, 54.0, 32.0, 65.0, 65.0, 32.0, 10.0, -1.0, 32.0, 21.0, 32.0, -1.0, 32.0, 54.0, -12.0, -56.0, -1.0, -67.0, 76.0, -12.0, 54.0, 65.0, 32.0, 54.0, 54.0, 76.0, -23.0, 10.0, 65.0, 43.0, 32.0, 54.0, 65.0, 76.0, 76.0, 32.0, 21.0, -1.0, 21.0, 54.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19128074260282438, "mean_inference_ms": 10.035539977809554, "mean_action_processing_ms": 0.07999592285626822, "mean_env_wait_ms": 0.04038773606459986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004492521286010742, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.0852956771850586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 75829.842, "sample_time_ms": 41237.9, "learn_time_ms": 34582.402, "learn_throughput": 115.666, "synch_weights_time_ms": 8.49}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 368, "training_iteration": 7, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-31-52", "timestamp": 1685543512, "time_this_iter_s": 83.81692290306091, "time_total_s": 589.6846480369568, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 589.6846480369568, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.72393162393163, "ram_util_percent": 73.53247863247866}}
{"evaluation": {"episode_reward_max": 54.0, "episode_reward_min": -100.0, "episode_reward_mean": -2.1, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.0, -34.0, 54.0, 54.0, 43.0, -1.0, 32.0, 21.0, -34.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18773489025073936, "mean_inference_ms": 10.77023032385549, "mean_action_processing_ms": 0.08683717480185706, "mean_env_wait_ms": 0.04404517620571584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289482116699219, "StateBufferConnector_ms": 0.0030922889709472656, "ViewRequirementAgentConnector_ms": 0.09874343872070312}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 8.836812973022461, "policy_loss": -0.0024268492124974728, "vf_loss": 8.839239120483398, "vf_explained_var": 0.0005359826609492302, "kl": 0.00011367304250597954, "entropy": 2.994371175765991, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 24.24, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -1.0, -89.0, 21.0, -23.0, 21.0, 32.0, 65.0, 54.0, 32.0, 65.0, 65.0, 32.0, 10.0, -1.0, 32.0, 21.0, 32.0, -1.0, 32.0, 54.0, -12.0, -56.0, -1.0, -67.0, 76.0, -12.0, 54.0, 65.0, 32.0, 54.0, 54.0, 76.0, -23.0, 10.0, 65.0, 43.0, 32.0, 54.0, 65.0, 76.0, 76.0, 32.0, 21.0, -1.0, 21.0, 54.0, 43.0, 43.0, 21.0, 10.0, 21.0, -34.0, 54.0, 32.0, 54.0, 43.0, -1.0, 59.0, 54.0, 32.0, 32.0, 32.0, 21.0, 21.0, 76.0, 43.0, 32.0, 32.0, 54.0, 32.0, 32.0, -23.0, -1.0, 65.0, -12.0, 10.0, 43.0, 21.0, 32.0, 32.0, 10.0, -34.0, -34.0, 32.0, 32.0, 43.0, 32.0, 32.0, 32.0, 21.0, 21.0, -23.0, 32.0, 10.0, 21.0, -1.0, 32.0, -12.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19203484850729516, "mean_inference_ms": 10.000945740713389, "mean_action_processing_ms": 0.08032830792632321, "mean_env_wait_ms": 0.040488408664075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00453639030456543, "StateBufferConnector_ms": 0.002906322479248047, "ViewRequirementAgentConnector_ms": 0.08861994743347168}}, "episode_reward_max": 76.0, "episode_reward_min": -89.0, "episode_reward_mean": 24.24, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -1.0, -89.0, 21.0, -23.0, 21.0, 32.0, 65.0, 54.0, 32.0, 65.0, 65.0, 32.0, 10.0, -1.0, 32.0, 21.0, 32.0, -1.0, 32.0, 54.0, -12.0, -56.0, -1.0, -67.0, 76.0, -12.0, 54.0, 65.0, 32.0, 54.0, 54.0, 76.0, -23.0, 10.0, 65.0, 43.0, 32.0, 54.0, 65.0, 76.0, 76.0, 32.0, 21.0, -1.0, 21.0, 54.0, 43.0, 43.0, 21.0, 10.0, 21.0, -34.0, 54.0, 32.0, 54.0, 43.0, -1.0, 59.0, 54.0, 32.0, 32.0, 32.0, 21.0, 21.0, 76.0, 43.0, 32.0, 32.0, 54.0, 32.0, 32.0, -23.0, -1.0, 65.0, -12.0, 10.0, 43.0, 21.0, 32.0, 32.0, 10.0, -34.0, -34.0, 32.0, 32.0, 43.0, 32.0, 32.0, 32.0, 21.0, 21.0, -23.0, 32.0, 10.0, 21.0, -1.0, 32.0, -12.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19203484850729516, "mean_inference_ms": 10.000945740713389, "mean_action_processing_ms": 0.08032830792632321, "mean_env_wait_ms": 0.040488408664075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00453639030456543, "StateBufferConnector_ms": 0.002906322479248047, "ViewRequirementAgentConnector_ms": 0.08861994743347168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 75965.133, "sample_time_ms": 41348.635, "learn_time_ms": 34607.169, "learn_throughput": 115.583, "synch_weights_time_ms": 8.29}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 421, "training_iteration": 8, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-33-17", "timestamp": 1685543597, "time_this_iter_s": 85.8832437992096, "time_total_s": 675.5678918361664, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 675.5678918361664, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 44.5225, "ram_util_percent": 74.99249999999999}}
{"evaluation": {"episode_reward_max": 32.0, "episode_reward_min": -155.0, "episode_reward_mean": -45.0, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -12.0, 32.0, -23.0, -67.0, -45.0, 10.0, -111.0, -155.0, -56.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18756617197706724, "mean_inference_ms": 10.647154920823635, "mean_action_processing_ms": 0.08661867913194712, "mean_env_wait_ms": 0.04387267795401591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004732608795166016, "StateBufferConnector_ms": 0.0030231475830078125, "ViewRequirementAgentConnector_ms": 0.08786678314208984}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 9.999999747378752e-06, "total_loss": 8.85940933227539, "policy_loss": -0.0013226259034126997, "vf_loss": 8.860732078552246, "vf_explained_var": 0.0030668058898299932, "kl": 7.111435843398795e-05, "entropy": 2.994475841522217, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 21.6, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 54.0, 32.0, 54.0, 43.0, -1.0, 59.0, 54.0, 32.0, 32.0, 32.0, 21.0, 21.0, 76.0, 43.0, 32.0, 32.0, 54.0, 32.0, 32.0, -23.0, -1.0, 65.0, -12.0, 10.0, 43.0, 21.0, 32.0, 32.0, 10.0, -34.0, -34.0, 32.0, 32.0, 43.0, 32.0, 32.0, 32.0, 21.0, 21.0, -23.0, 32.0, 10.0, 21.0, -1.0, 32.0, -12.0, -23.0, 32.0, -12.0, 21.0, 10.0, -1.0, -34.0, 21.0, 54.0, 65.0, 54.0, 76.0, 54.0, 43.0, 21.0, 32.0, 32.0, 32.0, 32.0, 21.0, 10.0, 43.0, 43.0, 10.0, -1.0, 76.0, 54.0, -34.0, -1.0, 43.0, 10.0, 10.0, 32.0, 32.0, -1.0, 76.0, -23.0, -34.0, 10.0, 21.0, 54.0, 43.0, 54.0, -1.0, 32.0, 32.0, 21.0, -23.0, -12.0, -1.0, -67.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1930390119658354, "mean_inference_ms": 9.99202368841025, "mean_action_processing_ms": 0.08078574392168816, "mean_env_wait_ms": 0.0407123835418097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004758596420288086, "StateBufferConnector_ms": 0.002966642379760742, "ViewRequirementAgentConnector_ms": 0.09100008010864258}}, "episode_reward_max": 76.0, "episode_reward_min": -67.0, "episode_reward_mean": 21.6, "episode_len_mean": 76.0, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, 54.0, 32.0, 54.0, 43.0, -1.0, 59.0, 54.0, 32.0, 32.0, 32.0, 21.0, 21.0, 76.0, 43.0, 32.0, 32.0, 54.0, 32.0, 32.0, -23.0, -1.0, 65.0, -12.0, 10.0, 43.0, 21.0, 32.0, 32.0, 10.0, -34.0, -34.0, 32.0, 32.0, 43.0, 32.0, 32.0, 32.0, 21.0, 21.0, -23.0, 32.0, 10.0, 21.0, -1.0, 32.0, -12.0, -23.0, 32.0, -12.0, 21.0, 10.0, -1.0, -34.0, 21.0, 54.0, 65.0, 54.0, 76.0, 54.0, 43.0, 21.0, 32.0, 32.0, 32.0, 32.0, 21.0, 10.0, 43.0, 43.0, 10.0, -1.0, 76.0, 54.0, -34.0, -1.0, 43.0, 10.0, 10.0, 32.0, 32.0, -1.0, 76.0, -23.0, -34.0, 10.0, 21.0, 54.0, 43.0, 54.0, -1.0, 32.0, 32.0, 21.0, -23.0, -12.0, -1.0, -67.0, -1.0, 10.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1930390119658354, "mean_inference_ms": 9.99202368841025, "mean_action_processing_ms": 0.08078574392168816, "mean_env_wait_ms": 0.0407123835418097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004758596420288086, "StateBufferConnector_ms": 0.002966642379760742, "ViewRequirementAgentConnector_ms": 0.09100008010864258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 75811.001, "sample_time_ms": 41192.973, "learn_time_ms": 34608.766, "learn_throughput": 115.578, "synch_weights_time_ms": 8.211}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 473, "training_iteration": 9, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-34-40", "timestamp": 1685543680, "time_this_iter_s": 82.21079993247986, "time_total_s": 757.7786917686462, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 757.7786917686462, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 45.31754385964912, "ram_util_percent": 73.6236842105263}}
{"evaluation": {"episode_reward_max": 43.0, "episode_reward_min": -100.0, "episode_reward_mean": -26.3, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -45.0, -12.0, -1.0, -23.0, -67.0, -100.0, -23.0, -23.0, 43.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18722756005261948, "mean_inference_ms": 10.598376618766608, "mean_action_processing_ms": 0.08641147500605131, "mean_env_wait_ms": 0.043664099652270645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052928924560546875, "StateBufferConnector_ms": 0.0029134750366210938, "ViewRequirementAgentConnector_ms": 0.0913548469543457}, "num_agent_steps_sampled_this_iter": 760, "num_env_steps_sampled_this_iter": 760, "timesteps_this_iter": 760, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 9.999999747378752e-06, "total_loss": 8.966940879821777, "policy_loss": -0.0023971768096089363, "vf_loss": 8.969338417053223, "vf_explained_var": -0.0004026899114251137, "kl": 0.00010218199895462021, "entropy": 2.9941189289093018, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 13.9, "episode_len_mean": 76.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 21.0, 54.0, 65.0, 54.0, 76.0, 54.0, 43.0, 21.0, 32.0, 32.0, 32.0, 32.0, 21.0, 10.0, 43.0, 43.0, 10.0, -1.0, 76.0, 54.0, -34.0, -1.0, 43.0, 10.0, 10.0, 32.0, 32.0, -1.0, 76.0, -23.0, -34.0, 10.0, 21.0, 54.0, 43.0, 54.0, -1.0, 32.0, 32.0, 21.0, -23.0, -12.0, -1.0, -67.0, -1.0, 10.0, -12.0, -23.0, -12.0, -56.0, -1.0, -67.0, 21.0, -23.0, -45.0, 65.0, 10.0, 54.0, 65.0, 21.0, 32.0, 54.0, 54.0, 65.0, 54.0, -12.0, 32.0, 43.0, -1.0, -1.0, -1.0, 32.0, 32.0, 32.0, -12.0, -144.0, -100.0, -45.0, -45.0, -1.0, -1.0, -12.0, 43.0, -1.0, 54.0, 32.0, 43.0, 54.0, 10.0, 43.0, -1.0, 21.0, 32.0, 43.0, 21.0, 15.0, 10.0, -78.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1934162984627909, "mean_inference_ms": 9.962266242895714, "mean_action_processing_ms": 0.0809626740386722, "mean_env_wait_ms": 0.04076705348309429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004632711410522461, "StateBufferConnector_ms": 0.002806425094604492, "ViewRequirementAgentConnector_ms": 0.08906316757202148}}, "episode_reward_max": 76.0, "episode_reward_min": -144.0, "episode_reward_mean": 13.9, "episode_len_mean": 76.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, 21.0, 54.0, 65.0, 54.0, 76.0, 54.0, 43.0, 21.0, 32.0, 32.0, 32.0, 32.0, 21.0, 10.0, 43.0, 43.0, 10.0, -1.0, 76.0, 54.0, -34.0, -1.0, 43.0, 10.0, 10.0, 32.0, 32.0, -1.0, 76.0, -23.0, -34.0, 10.0, 21.0, 54.0, 43.0, 54.0, -1.0, 32.0, 32.0, 21.0, -23.0, -12.0, -1.0, -67.0, -1.0, 10.0, -12.0, -23.0, -12.0, -56.0, -1.0, -67.0, 21.0, -23.0, -45.0, 65.0, 10.0, 54.0, 65.0, 21.0, 32.0, 54.0, 54.0, 65.0, 54.0, -12.0, 32.0, 43.0, -1.0, -1.0, -1.0, 32.0, 32.0, 32.0, -12.0, -144.0, -100.0, -45.0, -45.0, -1.0, -1.0, -12.0, 43.0, -1.0, 54.0, 32.0, 43.0, 54.0, 10.0, 43.0, -1.0, 21.0, 32.0, 43.0, 21.0, 15.0, 10.0, -78.0, -23.0], "episode_lengths": [76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1934162984627909, "mean_inference_ms": 9.962266242895714, "mean_action_processing_ms": 0.0809626740386722, "mean_env_wait_ms": 0.04076705348309429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004632711410522461, "StateBufferConnector_ms": 0.002806425094604492, "ViewRequirementAgentConnector_ms": 0.08906316757202148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 75592.961, "sample_time_ms": 41113.721, "learn_time_ms": 34470.089, "learn_throughput": 116.043, "synch_weights_time_ms": 8.126}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": true, "episodes_total": 526, "training_iteration": 10, "trial_id": "b0a0c_00023", "date": "2023-05-31_17-36-01", "timestamp": 1685543761, "time_this_iter_s": 81.64040875434875, "time_total_s": 839.419100522995, "pid": 73696, "hostname": "Ozans-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "Supermarket", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x28f7c7ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 839.419100522995, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.90608695652174, "ram_util_percent": 73.43478260869564}}
